montageDefine("c50fb48","runtime/utilities",{dependencies:["runtime/dependencies/gl-matrix"],factory:function(e,t,r){e("runtime/dependencies/gl-matrix"),t.Utilities=Object.create(Object.prototype,{vec3Min:{value:function(e,t){t[0]<e[0]&&(e[0]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[2]<e[2]&&(e[2]=t[2])}},vec3Max:{value:function(e,t){t[0]>e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1]),t[2]>e[2]&&(e[2]=t[2])}},mergeBBox:{value:function(e,t){var i=e[0],r=e[1],a=t[0],c=t[1],n=[i[0]<a[0]?i[0]:a[0],i[1]<a[1]?i[1]:a[1],i[2]<a[2]?i[2]:a[2]],o=[r[0]>c[0]?r[0]:c[0],r[1]>c[1]?r[1]:c[1],r[2]>c[2]?r[2]:c[2]];return[n,o]}},computeBBOXFromVec3Array:{value:function(e){if(0===e.length)return null;for(var t=[e[0][0],e[0][1],e[0][2]],i=[e[0][0],e[0][1],e[0][2]],r=0;r<8;r++)e[r][0]<t[0]&&(t[0]=e[r][0]),e[r][1]<t[1]&&(t[1]=e[r][1]),e[r][2]<t[2]&&(t[2]=e[r][2]),e[r][0]>i[0]&&(i[0]=e[r][0]),e[r][1]>i[1]&&(i[1]=e[r][1]),e[r][2]>i[2]&&(i[2]=e[r][2]);return[t,i]}},transformBBox:{value:function(e,t){var i=e[0],r=e[1],a=0,c=1,n=2,o=mat4.multiplyVec3(t,vec3.createFrom(i[a],i[c],i[n])),v=mat4.multiplyVec3(t,vec3.createFrom(r[a],i[c],i[n])),m=mat4.multiplyVec3(t,vec3.createFrom(i[a],r[c],i[n])),l=mat4.multiplyVec3(t,vec3.createFrom(r[a],r[c],i[n])),u=mat4.multiplyVec3(t,vec3.createFrom(i[a],i[c],r[n])),s=mat4.multiplyVec3(t,vec3.createFrom(r[a],i[c],r[n])),f=mat4.multiplyVec3(t,vec3.createFrom(i[a],r[c],r[n])),d=mat4.multiplyVec3(t,vec3.createFrom(r[a],r[c],r[n]));return this.computeBBOXFromVec3Array([o,v,m,l,u,s,f,d])}},rayIntersectsMesh:{value:function(e,t,i,r,a){var c=t.verticesBuffer;if(null===c)return!1;for(var n=!1,o=t.primitives.length,v=(vec3.create(),vec3.create(),vec3.create(),0);v<o;v++){var m=t.primitives[v];if(a){var l=a.materials;if(l&&l.indexOf(m.material.name)==-1)continue}if(!(null!==m.material.inputs.transparency&&"undefined"!=typeof m.material.inputs.transparency&&m.material.inputs.transparency<1)){var u=m.boundingBox;if(this.intersectsBBOX(u,e))return!0}}return n}},intersectsBBOX:{value:function(e,t){var i,r,a,c,n,o,v=0,m=1,l=2,u=t[1],s=t[0],f=e[0],d=e[1];return u[v]>=0?(i=(f[v]-s[v])/u[v],r=(d[v]-s[v])/u[v]):(i=(d[v]-s[v])/u[v],r=(f[v]-s[v])/u[v]),u[m]>=0?(a=(f[m]-s[m])/u[m],c=(d[m]-s[m])/u[m]):(a=(d[m]-s[m])/u[m],c=(f[m]-s[m])/u[m]),!(i>c||a>r)&&(a>i&&(i=a),c<r&&(r=c),u[l]>=0?(n=(f[l]-s[l])/u[l],o=(d[l]-s[l])/u[l]):(n=(d[l]-s[l])/u[l],o=(f[l]-s[l])/u[l]),!(i>o||n>r)&&(n>i&&(i=n),o<r&&(r=o),!0))}},inverpolateAxisAngle:{value:function(e,t,r,a){var c=0,n=1,o=2,v=o,m=vec4.createFrom(e[0],e[1],e[2],e[3]),l=vec4.createFrom(t[0],t[1],t[2],t[3]);if(v==c){vec3.normalize(m),vec3.normalize(l);var u=vec3.create();vec3.cross(m,l,u);var s=(Math.sqrt(vec3.dot(m,m)),Math.sqrt(vec3.dot(l,l)),Math.acos(vec3.dot(m,l))),f=mat4.identity();mat4.rotate(f,s*r,u),mat4.multiplyVec3(f,m,u),vec3.normalize(u);var d=m[3]+(l[3]-m[3])*r;quat4.fromAngleAxis(d,u,a)}else if(v==n){for(i=0;i<a.length;i++){var h=m[i],x=l[i];l[i]=h+(x-h)*r}quat4.fromAngleAxis(l[3],l,a)}else v==o&&quat4.slerp(e,t,r,a)}},interpolateVec:{value:function(e,t,r,a){for(i=0;i<a.length;i++){var c=e[i],n=t[i];a[i]=c+(n-c)*r}}},idx:{value:function(e,t){return 4*e+t}},decomposeMat4:{value:function(e,t,i,r){var a,c,n=mat4.create(),o=mat4.create(),v=(mat4.create(),mat4.create(),[vec3.create(),vec3.create(),vec3.create()]);mat4.set(e,n);var m,l;for(a=0;a<4;a++)for(c=0;c<4;c++)m=this.idx(a,c),l=this.idx(3,3),n[m]/=n[l];for(mat4.set(n,o),a=0;a<3;a++)m=this.idx(a,3),o[m]=0;for(m=this.idx(3,3),o[m]=1,0==n[this.idx(0,3)]&&0==n[this.idx(1,3)]&&0==n[this.idx(2,3)]||(n[this.idx(0,3)]=0,n[this.idx(1,3)]=0,n[this.idx(2,3)]=0,n[this.idx(3,3)]=1),t[0]=n[this.idx(3,0)],n[this.idx(3,0)]=0,t[1]=n[this.idx(3,1)],n[this.idx(3,1)]=0,t[2]=n[this.idx(3,2)],n[this.idx(3,2)]=0,a=0;a<3;a++)v[a][0]=n[this.idx(a,0)],v[a][1]=n[this.idx(a,1)],v[a][2]=n[this.idx(a,2)];r[0]=vec3.length(v[0]),vec3.normalize(v[0]),r[1]=vec3.length(v[1]),vec3.normalize(v[1]),r[2]=vec3.length(v[2]),vec3.normalize(v[2]);var u=vec3.create();if(vec3.cross(v[1],v[2],u),vec3.dot(v[0],u)<0)for(a=0;a<3;a++)r[a]*=-1,v[a][0]*=-1,v[a][1]*=-1,v[a][2]*=-1;var s=mat3.create();s[0]=v[0][0],s[1]=v[1][0],s[2]=v[2][0],s[3]=v[0][1],s[4]=v[1][1],s[5]=v[2][1],s[6]=v[0][2],s[7]=v[1][2],s[8]=v[2][2],mat3.transpose(s),quat4.fromRotationMatrix(s,i),quat4.normalize(i)}},easeOut:{value:function(e){var t=e,i=0,r=1;return t--,y=r*(t*t*t+1)+i-1,y=-y,y=1-y,y}}})}});