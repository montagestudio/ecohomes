var Montage=require("montage").Montage,Component3D=require("runtime/component-3d").Component3D;exports.Material=Component3D.specialize({constructor:{value:function(){this["super"](),this.addRangeAtPathChangeListener("filterColor",this,"handleFilterColorChange"),this.addOwnPropertyChangeListener("glTFElement",this),this.addOwnPropertyChangeListener("image",this),this.addOwnPropertyChangeListener("opacity",this)}},filterColor:{value:[1,1,1,1]},handleGlTFElementChange:{value:function(){this.handleFilterColorChange(),this.handleImageChange(),this.handleOpacityChange()}},handleFilterColorChange:{value:function(e,t,a){null!=this.glTFElement&&this.glTFElement.parameters.filterColor&&(this.glTFElement.parameters.filterColor.value=this.filterColor,this.scene&&this.scene.dispatchEventNamed("materialUpdate",!0,!1,this))}},handleOpacityChange:{value:function(){null!=this.glTFElement&&this.glTFElement.parameters.transparency&&(this.glTFElement.parameters.transparency.value=this.opacity,this.scene&&this.scene.dispatchEventNamed("materialUpdate",!0,!1,this))}},handleImageChange:{value:function(){if(null!=this.glTFElement&&this.glTFElement.parameters.diffuse&&this._image){var e=this.resolvePathIfNeeded(this._image),t=this.parameterForImagePath(e);this.glTFElement.parameters.diffuse=t,this.scene&&this.scene.dispatchEventNamed("textureUpdate",!0,!1,t)}}},parameterForImagePath:{value:function(e){var t={magFilter:"LINEAR",minFilter:"LINEAR",type:"sampler",wrapS:"REPEAT",wrapT:"REPEAT"},a={id:"source-"+e,type:"image",baseId:"source-"+e,description:{path:e}},i={baseId:"texture-"+e,id:"texture-"+e,format:"RGBA",internalFormat:"RGBA",sampler:t,source:a,type:"texture",target:"TEXTURE_2D"},n={parameter:"diffuse",value:i};return n}},_image:{value:null,writable:!0},image:{set:function(e){if(e&&0!=e.length){var t=e.toLowerCase();t.indexOf(".jpg")==-1&&t.indexOf(".jpeg")==-1&&t.indexOf(".png")==-1||this._image!=e&&(this._image=e)}},get:function(){return this._image}},_opacity:{value:1,writable:!0},opacity:{set:function(e){this._opacity!=e&&(this._opacity=e)},get:function(){return this._opacity}}});