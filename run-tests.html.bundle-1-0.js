montageDefine("b0111a3","ui/component",{dependencies:["../core/core","../core/target","../core/template","../core/document-resources","../core/gate","../core/promise","../core/event/event-manager","../core/serialization/alias","../core/logger","../core/logger","../core/logger","../core/logger","../core/logger","collections/weak-map","collections/map","collections/set","../core/application","../core/core","../core/core"],factory:function(e,t,i){function n(e){return e?e._montage_metadata.objectName+":"+Object.hash(e)+" id: "+e.identifier:"NIL"}var r=e("../core/core").Montage,a=e("../core/target").Target,s=e("../core/template").Template,o=e("../core/document-resources").DocumentResources,l=e("../core/gate").Gate,u=e("../core/promise").Promise,c=e("../core/event/event-manager").defaultEventManager,h=e("../core/serialization/alias").Alias,d=e("../core/logger").logger("component"),m=e("../core/logger").logger("Drawing performance").color.green(),p=e("../core/logger").logger("drawing list").color.blue(),g=e("../core/logger").logger("drawing needsDraw").color.violet(),f=e("../core/logger").logger("drawing").color.blue(),v=e("collections/weak-map"),_=e("collections/map"),b=e("collections/set"),w="data-montage-le-component",y="data-montage-le-arg",E="data-montage-le-arg-begin",C="data-montage-le-arg-end",x=r.specialize({component:{value:null},fromCssClass:{value:null},cssClass:{value:null},toCssClass:{value:null},hasOneFrameDelay:{value:!1},_animationAndTransitionProperties:{value:["-webkit-animation","-moz-animation","-ms-animation","animation","-webkit-transition","-moz-transition","-ms-transition","transition"]},_emptyArray:{value:[]},_parseComputedStyleTimeValue:{value:function(e){var t,i;if("string"!=typeof e||""===e)return this._emptyArray;for(t=e.replace(/s| /g,"").split(","),i=0;i<t.length;i++)t[i]=+t[i];return t}},_getMaxAnimationTime:{value:function(){var e,t,i,n,r,a,s,o=0;if(this.component&&this.component.element){for(e=global.getComputedStyle(this.component.element),a=0;a<this._animationAndTransitionProperties.length;a++)for(t=this._parseComputedStyleTimeValue(e.getPropertyValue(this._animationAndTransitionProperties[a]+"-duration")),i=this._parseComputedStyleTimeValue(e.getPropertyValue(this._animationAndTransitionProperties[a]+"-delay")),r=Math.max(t.length,i.length),s=0;s<r;s++)n="undefined"==typeof t[s]?t[0]||0:t[s],n+="undefined"==typeof i[s]?i[0]||0:i[s],n>o&&(o=n);o>0&&(o+=.3)}return o}},_onAnimationsCompletedTimeout:{value:null},_cancelOnAnimationsCompletedEvent:{value:function(){clearTimeout(this._onAnimationsCompletedTimeout)}},_onAnimationsCompleted:{value:function(e){var t,i=this._getMaxAnimationTime();return i?(t=this,this._cancelOnAnimationsCompletedEvent(),void(this._onAnimationsCompletedTimeout=setTimeout(function(){e.call(t)},1e3*i))):void e.call(this)}},_needsToMeasureAnimationTimeOnNextDraw:{value:!1},_needsToMeasureAnimationTime:{value:!1},handleDidDraw:{value:function(e){this._needsToMeasureAnimationTimeOnNextDraw?(this.fromCssClass&&this.component.classList.remove(this.fromCssClass),this.cssClass&&this.component.classList.add(this.cssClass),this.toCssClass&&this.component.classList.add(this.toCssClass),this._needsToMeasureAnimationTimeOnNextDraw=!1,this._needsToMeasureAnimationTime=!0,this.component.needsDraw=!0):this._needsToMeasureAnimationTime&&(this._onAnimationsCompleted(function(){this._finishedDeferred&&(this._finishedDeferred.resolve(),this._finishedDeferred=null)}),this.component.removeEventListener("didDraw",this,!1),this._needsToMeasureAnimationTime=!1)}},_finishedDeferred:{value:null},finished:{get:function(){return this._finishedDeferred||(this._finishedDeferred=u.pending()),this._finishedDeferred.promise}},play:{value:function(){this.component&&(this._finishedDeferred&&!this._cancelled||(this._cancelled=!1,this._finishedDeferred=u.pending()),this.component.needsDraw=!0,this.fromCssClass?(this.fromCssClass&&this.component.classList.add(this.fromCssClass),this.cssClass&&this.component.classList.remove(this.cssClass),this.toCssClass&&this.component.classList.remove(this.toCssClass),this._needsToMeasureAnimationTime=!1,this._needsToMeasureAnimationTimeOnNextDraw=!0):this.hasOneFrameDelay?(this._needsToMeasureAnimationTime=!1,this._needsToMeasureAnimationTimeOnNextDraw=!0):(this.cssClass&&this.component.classList.add(this.cssClass),this.toCssClass&&this.component.classList.add(this.toCssClass),this._needsToMeasureAnimationTime=!0,this._needsToMeasureAnimationTimeOnNextDraw=!1),this.component.addEventListener("didDraw",this,!1))}},_cancelled:{value:!1},cancel:{value:function(){this._cancelled=!0,this.fromCssClass&&this.component.classList.remove(this.fromCssClass),this.cssClass&&this.component.classList.remove(this.cssClass),this.toCssClass&&this.component.classList.remove(this.toCssClass),this.component.removeEventListener("didDraw",this,!1),this._finishedDeferred&&this._finishedDeferred.reject()}}}),T=t.Component=a.specialize({DOM_ARG_ATTRIBUTE:{value:"data-arg"},drawListLogger:{value:p},delegate:{value:null},_templateObjects:{serializable:!1,value:null},templateObjects:{serializable:!1,get:function(){return this._templateObjects||(this._templateObjects=Object.create(null)),!this._setupTemplateObjectsCompleted&&this._templateDocumentPart&&this._setupTemplateObjects(this._templateDocumentPart.objects),this._templateObjects},set:function(e){this._templateObjects=e}},_nextTarget:{value:null},nextTarget:{get:function(){return this._nextTarget||this.parentComponent},set:function(e){this._nextTarget=e}},_ownerDocumentPart:{value:null},_templateDocumentPart:{value:null},_domArguments:{value:void 0},_domArgumentNames:{value:void 0},_dispatchActionEvent:{value:function(){this.dispatchEvent(this.createActionEvent())},enumerable:!1},createActionEvent:{value:function(){var e=document.createEvent("CustomEvent");return e.initCustomEvent("action",!0,!0,null),e}},canDrawGate:{get:function(){return this._canDrawGate||(this._canDrawGate=(new l).initWithDelegate(this),this._canDrawGate.setField("componentTreeLoaded",!1)),this._canDrawGate},enumerable:!1},_blockDrawGate:{value:null},blockDrawGate:{enumerable:!1,get:function(){return this._blockDrawGate||(this._blockDrawGate=(new l).initWithDelegate(this),this._blockDrawGate.setField("element",!1),this._blockDrawGate.setField("drawRequested",!1)),this._blockDrawGate}},_firstDraw:{enumerable:!1,value:!0},_completedFirstDraw:{enumerable:!1,value:!1},originalElement:{value:null},_element:{enumerable:!1,value:null},element:{get:function(){return this._element},set:function(e){if(null==e)return void console.warn("Tried to set element of ",this," to ",e);if(e.component&&e.component!==this)throw new Error("Element "+e+" is already assigned to another component: "+e.component);if(global._montage_le_flag&&e.setAttribute(w,r.getInfoForObject(this).moduleId),this.isDeserializing)this.eventManager.registerEventHandlerForElement(this,e),this._isTemplateInstantiated?this._templateElement||(this._templateElement=e):(this._element=e,!this.blockDrawGate.value&&this._element&&this.blockDrawGate.setField("element",!0));else{if(!this._firstDraw)return void console.error("Cannot change element of ",this," after it has been set");this.eventManager.registerEventHandlerForElement(this,e),this._element=e,!this.blockDrawGate.value&&this._element&&this.blockDrawGate.setField("element",!0)}this._initializeClassListFromElement(e)}},getElementId:{value:function(){var e=this._element;if(e)return e.getAttribute("data-montage-id")}},_initDomArguments:{value:function(){var e,t,i,n,r=this.element;e=r.querySelectorAll("*["+this.DOM_ARG_ATTRIBUTE+"]"),e.length&&(t={});e:for(var a,s=0;a=e[s];s++){for(n=a;(n=n.parentNode)!==r;)if(n.component)continue e;this._findAndDetachComponents(a),a.parentNode.removeChild(a),i=a.getAttribute(this.DOM_ARG_ATTRIBUTE),a.removeAttribute(this.DOM_ARG_ATTRIBUTE),t[i]=a}this._domArguments=t}},_sharedEmptyArray:{value:[]},getDomArgumentNames:{value:function(){return void 0===this._domArgumentNames&&(this._domArgumentNames=this._domArguments?Object.keys(this._domArguments):this._sharedEmptyArray),this._domArgumentNames}},extractDomArgument:{value:function(e){if(this._domArguments){var t;return t=this._domArguments[e],this._domArguments[e]=null,t}return null}},_getTemplateDomArgument:{value:function(e){var t,i,n,r,a,s,o=this._ownerDocumentPart.template;n=o.getElementById(this.getElementId()),t=n.querySelectorAll("*["+this.DOM_ARG_ATTRIBUTE+"='"+e+"']");e:for(var l,u=0;l=t[u];u++){for(i=l;(i=i.parentNode)!==n;)if(r=o.getElementId(i),r&&(a=o.getSerialization(),s=a.getSerializationLabelsWithElements(r),s.length>0))continue e;return l}}},getTemplateArgumentElement:{value:function(e){var t,i,n,r=this._ownerDocumentPart.template;if(global._montage_le_flag)var a=this.ownerComponent._montage_metadata.moduleId,s=this._montage_metadata.label;return"*"===e?(t=r.getElementById(this.getElementId()),i=r.document.createRange(),i.selectNodeContents(t),n=i.cloneContents(),global._montage_le_flag&&t.children.length>0&&this._leTagStarArgument(a,s,n)):(n=this._getTemplateDomArgument(e).cloneNode(!0),n.removeAttribute(this.DOM_ARG_ATTRIBUTE),global._montage_le_flag&&this._leTagNamedArgument(a,s,n,e)),n}},getTemplateArgumentSerialization:{value:function(e){var t=this._ownerDocumentPart.template;return t._createSerializationWithElementIds(e)}},resolveTemplateArgumentTemplateProperty:{value:function(e){var t,i,n,a,s=e.indexOf(":"),o=e.slice(0,s),l=e.slice(s),u=this._templateDocumentPart;if(r.getInfoForObject(this).label===o)return u&&(n=u.objects[l]),n instanceof h&&(i=u.objects[n.componentLabel],t=n.value.slice(1),a=i.resolveTemplateArgumentTemplateProperty(t),a||(a=t)),a}},setElementWithParentComponent:{value:function(e,t){this._alternateParentComponent=t,this.element!==e&&(this.element=e)}},_application:{value:null},application:{enumerable:!1,get:function(){return this._application||(T.prototype._application=e("../core/application").application)}},eventManager:{enumerable:!1,get:function(){return c}},rootComponent:{enumerable:!1,get:function(){return P}},elementControllerFromEvent:{enumerable:!1,value:function(e,t){return t}},_alternateParentComponent:{value:null},__parentComponent:{value:null},_parentComponent:{set:function(e){this.__parentComponent=e,this.dispatchOwnPropertyChange("parentComponent",e)},get:function(){return this.__parentComponent}},parentComponent:{enumerable:!1,get:function(){return this._parentComponent}},findParentComponent:{value:function(){var e,t=this.element,i=this.eventManager;if(t){for(;null!=(e=t.parentNode)&&null==i.eventHandlerForElement(e);)t=e;return e?i.eventHandlerForElement(e):this._alternateParentComponent}}},querySelectorComponent:{value:function(e){if("string"!=typeof e)throw"querySelectorComponent: Selector needs to be a string.";var t=e.match(/^\s*(?:@([^>\s]+))?(?:\s*(>)?\s*@([^>\s]+)(.*))?$/);if(!t)throw'querySelectorComponent: Syntax error "'+e+'"';var i,n,a,s=this.childComponents,o=t[1],l=(t[2]||" ",t[3]),u=t[4];if(o)for(u=l?"@"+l+u:"",n=0,a;a=s[n];n++){if(o===r.getInfoForObject(a).label)return u?a.querySelectorComponent(u):a;if(i=a.querySelectorComponent(e))return i}else for(n=0,a;a=s[n];n++)if(l===r.getInfoForObject(a).label)return u?a.querySelectorComponent(u):a;return null}},querySelectorAllComponent:{value:function(e,t){if("string"!=typeof e)throw"querySelectorComponent: Selector needs to be a string.";var i=e.match(/^\s*(?:@([^>\s]+))?(?:\s*(>)?\s*@([^>\s]+)(.*))?$/);if(!i)throw'querySelectorComponent: Syntax error "'+e+'"';var n,a,s=this.childComponents,o=i[1],l=(i[2]||" ",i[3]),u=i[4],c=[];if(o)for(u=l?"@"+l+u:"",n=0,a;a=s[n];n++)o!==r.getInfoForObject(a).label||t&&t!==a.ownerComponent?c=c.concat(a.querySelectorAllComponent(e,t)):u?c=c.concat(a.querySelectorAllComponent(u)):c.push(a);else for(n=0,a;a=s[n];n++)l!==r.getInfoForObject(a).label||t&&t!==a.ownerComponent||(u?c=c.concat(a.querySelectorAllComponent(u,t)):c.push(a));return c}},template:{enumerable:!1,value:null},hasTemplate:{enumerable:!1,value:!0},_templateModuleId:{serializable:!1,value:null},_template:{value:null},_treeLevel:{value:0},_addChildComponent:{value:function(e){return this.addChildComponent(e)}},addChildComponent:{value:function(e){this.childComponents.indexOf(e)===-1&&(this.childComponents.push(e),e._parentComponent=this,e._prepareForEnterDocument(),e.needsDraw&&!this.rootComponent.isComponentWaitingNeedsDraw(e)&&e._addToParentsDrawList()),e._shouldBuildIn=!0}},attachToParentComponent:{value:function(){this.detachFromParentComponent(),this._parentComponent=null;var e,t,i=this.findParentComponent();if(i){e=i.childComponents;for(var n=0;t=e[n];n++){var r=t.findParentComponent();r===this&&(i.removeChildComponent(t),r.addChildComponent(t))}i.addChildComponent(this)}}},detachFromParentComponent:{value:function(){var e=this.parentComponent;e&&e.removeChildComponent(this)}},removeChildComponent:{value:function(e){var t=this.childComponents,i=t.indexOf(e);i>-1&&(e._exitDocument(),t.splice(i,1),e._parentComponent=null,e._alternateParentComponent=null,e._addedToDrawList&&(e._addedToDrawList=!1,i=this._drawList.indexOf(e),this._drawList.splice(i,1)),this.rootComponent.removeFromCannotDrawList(e))}},_childComponents:{value:null},childComponents:{enumerable:!1,get:function(){return this._childComponents||(this._childComponents=[])}},_needsEnterDocument:{value:!1},_inDocument:{value:!1},__exitDocument:{value:function(){this._inDocument&&"function"==typeof this.exitDocument&&(this.exitDocument(),this._inDocument=!1)}},_exitDocument:{value:function(){var e;this._needsEnterDocument?this._needsEnterDocument=!1:(e=function(t){for(var i,n=t.childComponents,r=0;i=n[r];r++)i._isComponentExpanded&&e(i);t._inDocument&&t.__exitDocument()})(this)}},exitDocument:{value:function(){this.isActiveTarget&&(c.activeTarget=this.nextTarget)}},_prepareForEnterDocument:{value:function(){this._firstDraw?this._needsEnterDocument=!0:(this.needsDraw=!0,this.traverseComponentTree(function(e){return!e._needsEnterDocument&&(e._needsEnterDocument=!0,void(e.needsDraw=!0))}))}},ownerComponent:{enumerable:!1,value:null},components:{enumerable:!1,value:{}},_isComponentExpanded:{enumerable:!1,value:!1},_isTemplateLoaded:{enumerable:!1,value:!1},_isTemplateInstantiated:{enumerable:!1,value:!1},cleanupDeletedComponentTree:{value:function(e){e&&this.cancelBindings(),this.needsDraw=!1,this.traverseComponentTree(function(t){e&&t.cancelBindings(),t.needsDraw=!1})}},_newDomContent:{enumerable:!1,value:null},_elementsToAppend:{value:null},domContent:{serializable:!1,get:function(){return this._element?Array.prototype.slice.call(this._element.childNodes,0):null},set:function(e){var t,i,n,r=[];if(this._elementsToAppend||(this._elementsToAppend=[]),this._newDomContent=e,this.needsDraw=!0,null===this._newDomContent&&(this._shouldClearDomContentOnNextDraw=!0),"function"==typeof this.contentWillChange&&this.contentWillChange(e),t=this.childComponents,e)for(this._componentsPendingBuildOut||(this._componentsPendingBuildOut=[]),i=t.length-1;i>=0;i--)this._componentsPendingBuildOut.indexOf(t[i])===-1&&this._componentsPendingBuildOut.push(t[i]);else for(this._componentsPendingBuildOut=[],i=t.length-1;i>=0;i--)t[i]._shouldBuildOut=!0;if(e instanceof Element)this._elementsToAppend.push(e),this._findAndDetachComponents(e,r);else if(e&&e[0])for(i=0;i<e.length;i++)this._elementsToAppend.push(e[i]),this._findAndDetachComponents(e[i],r);for(i=0;n=r[i];i++)this.addChildComponent(n)}},_shouldClearDomContentOnNextDraw:{value:!1},_findAndDetachComponents:{value:function(e,t){var i,n=e.component;if(t||(t=[]),n)n.detachFromParentComponent(),t.push(n);else{i=e.children||e.childNodes;for(var r,a=0;r=i[a];a++)this._findAndDetachComponents(r,t)}return t}},clonesChildComponents:{writable:!1,value:!1},_innerTemplate:{value:null},innerTemplate:{serializable:!1,get:function(){var e,t,i,n,r,a,s,o=this._innerTemplate;if(!o&&(e=this._ownerDocumentPart)){t=e.template,i=this.getElementId(),o=t.createTemplateFromElementContents(i),n=o.getSerialization(),r=n.getExternalObjectLabels(),a=e.objects,s=Object.create(null);for(var l,u=0;l=r[u];u++)s[l]=a[l];o.setInstances(s),this._innerTemplate=o}return o},set:function(e){this._innerTemplate=e}},canDraw:{value:function(){return this._canDraw}},_canDraw:{get:function(){return!this._canDrawGate||this._canDrawGate.value},set:function(e){P.componentCanDraw(this,e)},enumerable:!1},_prepareCanDraw:{enumerable:!1,value:function(){if(!this._isComponentTreeLoaded)return this.loadComponentTree()}},_blocksOwnerComponentDraw:{value:!1},_updateOwnerCanDrawGate:{value:function(){this._blocksOwnerComponentDraw&&this.ownerComponent&&this.ownerComponent.canDrawGate.setField(this,this.canDrawGate.value)}},_isComponentTreeLoaded:{value:!1},shouldLoadComponentTree:{value:!0},_loadComponentTreeDeferred:{value:null},loadComponentTree:{value:function(){if(!this._loadComponentTreeDeferred){this.canDrawGate.setField("componentTreeLoaded",!1),(this.needsDraw||this.hasTemplate)&&(this._canDraw=!1);var e=this;this._loadComponentTreeDeferred=this.expandComponent().then(function(){if(e.hasTemplate||e.shouldLoadComponentTree){var t,i,n=e._childComponents;if(n&&n.length){t=[];for(var r=0;i=n[r];r++)t.push(i.loadComponentTree());return u.all(t)}return u.resolve(null)}}).then(function(){e._isComponentTreeLoaded=!0,e._needsEnterDocument&&(e.needsDraw=!0),e.canDrawGate.setField("componentTreeLoaded",!0)})["catch"](function(e){console.error(e)})}return this._loadComponentTreeDeferred}},traverseComponentTree:{value:function(e,t){function i(){var i,r,a=n.childComponents;if(e&&e(n)===!1)return void(t&&t());if(0===(r=a.length))return void(t&&t());for(var s=function(){0===--r&&t&&t()},o=0;i=a[o];o++)i.traverseComponentTree(e,s)}var n=this;this._isComponentExpanded?i():t&&t()}},_expandComponentPromise:{value:null},expandComponent:{value:function(){if(!this._expandComponentPromise)if(this.hasTemplate){var e=this;this._expandComponentPromise=this._instantiateTemplate().then(function(){e._isComponentExpanded=!0,e._addTemplateStylesIfNeeded(),e.needsDraw=!0})["catch"](function(e){console.error(e)})}else this._isComponentExpanded=!0,this._expandComponentPromise=u.resolve();return this._expandComponentPromise}},_templateObjectDescriptor:{value:{enumerable:!0,configurable:!0}},_setupTemplateObjects:{value:function(e){return this._templateObjects=this._templateObjects||Object.create(null),this._addTemplateObjects(e),this._setupTemplateObjectsCompleted=!0,this._templateObjects}},_setupTemplateObjectsCompleted:{value:!1},_addTemplateObjects:{value:function(e){var t=this._templateObjectDescriptor,i=this._templateObjects;for(var n in e){var r=e[n];"object"==typeof r&&null!=r&&(T.prototype.isPrototypeOf(r)&&r!==this&&r.parentComponent!==this?(t.get=this._makeTemplateObjectGetter(this,n,r),Object.defineProperty(i,n,t)):i[n]=r)}}},_makeTemplateObjectGetter:{value:function(e,t,i){var n,r,a,s="@"+t;return function(){if(n)return e.querySelectorAllComponent(s,e);if(r=e.querySelectorAllComponent(s,e),1===r.length)for(a=r[0];a=a.parentComponent;){if(a===e)return Object.defineProperty(this,t,{value:r[0]}),r[0];if(a.clonesChildComponents)break}else if(0===r.length)return i;return n=!0,r}}},_instantiateTemplate:{value:function(){var e=this;return this._loadTemplate().then(function(t){if(!e._element)return u.reject(new Error("Cannot instantiate template without an element.",e));var i=null,n=e._element.ownerDocument;return i||(i=Object.create(null)),i.owner=e,e._isTemplateInstantiated=!0,t.instantiateWithInstances(i,n).then(function(t){t.parentDocumentPart=e._ownerDocumentPart,e._templateDocumentPart=t,t.fragment=null,i=null},function(e){throw new Error(t.getBaseUrl()+":"+e.stack||e)})})}},_templateDidLoad:{value:function(e){this._templateDocumentPart=e,this._templateObjects&&this._setupTemplateObjects(e.objects)}},_loadTemplatePromise:{value:null},_loadTemplate:{value:function(){var e;if(!this._loadTemplatePromise){var t=this;e=r.getInfoForObject(this),this._loadTemplatePromise=s.getTemplateWithModuleId(this.templateModuleId,e.require).then(function(e){return t._template=e,t._isTemplateLoaded=!0,e})}return this._loadTemplatePromise}},templateModuleId:{get:function(){return this._templateModuleId||this._getDefaultTemplateModuleId()}},_getDefaultTemplateModuleId:{value:function(){var e,t,i,n;return n=r.getInfoForObject(this),i=n.moduleId,t=i.lastIndexOf("/"),e=i+"/"+i.slice(t===-1?0:t+1,-5)+".html"}},deserializedFromSerialization:{value:function(){this.attachToParentComponent()}},_deserializedFromTemplate:{value:function(e,t,i){r.getInfoForObject(this).label=t,this._ownerDocumentPart=i,this.hasOwnProperty("identifier")||(this.identifier=t),this.ownerComponent||(T.prototype.isPrototypeOf(e)?this.ownerComponent=e:this.ownerComponent=this.rootComponent,this._updateOwnerCanDrawGate()),this._needsDrawInDeserialization&&(this.needsDraw=!0)}},blueprintModuleId:{serializable:!1,enumerable:!1,get:function(){return this.objectDescriptorModuleId}},blueprint:e("../core/core")._objectDescriptorDescriptor,objectDescriptor:e("../core/core")._objectDescriptorDescriptor,objectDescriptorModuleId:{serializable:!1,enumerable:!1,get:function(){var e=r.getInfoForObject(this),t=e&&!e.isInstance?this:Object.getPrototypeOf(this);if(!Object.getOwnPropertyDescriptor(t,"_objectDescriptorModuleId")||!t._objectDescriptorModuleId){e=r.getInfoForObject(t);var i=e.moduleId,n=i.lastIndexOf("/"),a=i.lastIndexOf(".");n=n===-1?0:n+1,a=a===-1?i.length:a,a=a<n?i.length:a;var s;s=a<i.length&&".reel"===i.slice(a,i.length)?i+"/"+i.slice(n,a)+".meta":i.slice(0,a)+".meta",r.defineProperty(t,"_objectDescriptorModuleId",{value:s})}return t._objectDescriptorModuleId}},gateDidBecomeTrue:{value:function(e){e===this._canDrawGate?(this._canDraw=!0,this._updateOwnerCanDrawGate()):e===this._blockDrawGate&&(P.componentBlockDraw(this),this._prepareCanDraw())},enumerable:!1},gateDidBecomeFalse:{value:function(e){e===this._canDrawGate&&this._updateOwnerCanDrawGate()},enumerable:!1},_canDrawGate:{enumerable:!1,value:null},preparedForActivationEvents:{enumerable:!1,value:!1},_arrayObjectPool:{value:{pool:null,size:200,ix:0}},_getArray:{value:function(){if(null==this._arrayObjectPool.pool){this._arrayObjectPool.pool=[];for(var e=0;e<this._arrayObjectPool.size;e++)this._arrayObjectPool.pool[e]=[]}return this._arrayObjectPool.ix<this._arrayObjectPool.size?this._arrayObjectPool.pool[this._arrayObjectPool.ix++]:[]}},_disposeArray:{value:function(e){this._arrayObjectPool.ix>0&&(e.length=0,this._arrayObjectPool.pool[--this._arrayObjectPool.ix]=e)}},_drawIfNeeded:{enumerable:!1,value:function(e){var t,i,r,a,s=this._firstDraw;if(this._treeLevel=e,s&&(this.originalElement=this.element),this.needsDraw&&P.addToDrawCycle(this),this._needsEnterDocument&&(this._needsEnterDocument=!1,this._willEnterDocument(),this._enterDocument(s),"function"==typeof this.enterDocument&&this.enterDocument(s)),s&&(this.originalElement=null),null!==this._drawList&&this._drawList.length>0){for(i=this._drawList,this._drawList=this._getArray(),a=i.length,r=0;r<a;r++)t=i[r],t._addedToDrawList=!1,t.canDraw()?t._drawIfNeeded(e+1):f.isDebug&&f.debug(n(t)+" can't draw.");this._disposeArray(i)}}},_updateComponentDom:{value:function(){if(this._firstDraw){if(this._prepareForDraw(),this._composerList)for(var e,t=0,i=this._composerList.length;t<i;t++)e=this._composerList[t],e.lazyLoad||this.loadComposer(e);this._firstDraw=!1}(null!==this._newDomContent||this._shouldClearDomContentOnNextDraw)&&(f.isDebug&&d.debug("Component content changed: component ",this._montage_metadata.objectName,this.identifier," newDomContent",this._newDomContent),this._performDomContentChanges())}},_replaceElementWithTemplate:{enumerable:!1,value:function(){var e,t,i,n,r,a=this.element,s=this._templateElement,o=this.element.attributes;for(i=0;n=o[i];i++)e=n.nodeName,global._montage_le_flag&&e===w?t=n.nodeValue:"id"===e||"data-montage-id"===e?t=n.nodeValue:(r=s.getAttribute(e)||"",t=r?r+("style"===e?"; ":" ")+n.nodeValue:n.nodeValue),s.setAttribute(e,t);this._initializeClassListFromElement(s),a.parentNode?a.parentNode.replaceChild(s,a):this._canDrawOutsideDocument||console.warn("Warning: Trying to replace element ",a," which has no parentNode"),this.eventManager.unregisterEventHandlerForElement(a),this.eventManager.registerEventHandlerForElement(this,s),this._element=s,this._templateElement=null,this._newDomContent&&(this._newDomContent=null,this._shouldClearDomContentOnNextDraw=!1)}},_addTemplateStylesIfNeeded:{value:function(){var e=this._templateDocumentPart;e&&this.rootComponent.addStyleSheetsFromTemplate(e.template)}},_prepareForDraw:{value:function(){d.isDebug&&d.debug(this,"_templateElement: "+this._templateElement);var e;global._montage_le_flag&&(e=this.element.children.length>0),this._initDomArguments(),e&&this._leTagArguments(),this._templateElement&&(this._bindTemplateParametersToArguments(),this._replaceElementWithTemplate())},enumerable:!1},_leTagArguments:{value:function(){if(this!==this.rootComponent){var e=this.ownerComponent._montage_metadata.moduleId,t=this._montage_metadata.label,i=this.getDomArgumentNames();if(i&&0!==i.length)for(var n,r=0;n=i[r];r++)this._leTagNamedArgument(e,t,this._domArguments[n],n);else this._leTagStarArgument(e,t,this.element)}}},_getNodeFirstElement:{value:function(e){var t=e.firstElementChild;if(!t){t=e.firstChild;do if(t.nodeType===Node.ELEMENT_NODE)break;while(t=t.nextSibling)}return t}},_getNodeLastElement:{value:function(e){var t=e.lastElementChild;if(!t){t=e.lastChild;do if(t.nodeType===Node.ELEMENT_NODE)break;while(t=t.previousSibling)}return t}},_leTagStarArgument:{value:function(e,t,i){var n=this._getNodeFirstElement(i),r=this._getNodeLastElement(i);n.setAttribute(E,(n.getAttribute(E)||"")+" "+e+","+t),r.setAttribute(C,(r.getAttribute(C)||"")+" "+e+","+t)}},_leTagNamedArgument:{value:function(e,t,i,n){i.setAttribute(y,e+","+t+","+n)}},_bindTemplateParametersToArguments:{value:function(){var e,t,i,n,r,a,s,o=this._templateDocumentPart?this._templateDocumentPart.parameters:null,l=this._domArguments;if(i=this._validateTemplateArguments(l,o))throw i;for(var u in o)if(e=o[u],t=l?l[u]:void 0,"*"===u||"each"===u?0===this._element.childElementCount?e&&e.childElementCount>0?(a=this._element.ownerDocument.createRange(),a.selectNodeContents(e),e.parentNode.replaceChild(a.extractContents(),e)):e.parentNode.removeChild(e):(a=this._element.ownerDocument.createRange(),a.selectNodeContents(this._element),n=a.extractContents()):n=t,n){var c,h;if(n instanceof Element){var d=e.classList,m=n.component?n.component.classList:n.classList;for(c=0,h=d.length;c<h;c++)m.add(d[c])}for(r=this._findAndDetachComponents(n),e.parentNode.replaceChild(n,e),c=0;s=r[c];c++)s.attachToParentComponent()}}},_validateTemplateArguments:{value:function(e,t){var i,n=t?Object.keys(t):void 0;if(n&&0!==n.length){for(i in e)if("*"!==i&&!(i in t))return new Error('"'+i+'" parameter does not exist in '+this.templateModuleId);var r=t["*"];if(r)for(i in t)if("*"!==i&&r.contains(t[i]))return new Error('"'+i+'" parameter cannot be used within an element with the star parameter')}}},prepareForActivationEvents:{enumerable:!1,value:null},_prepareForActivationEvents:{value:function(){if("function"==typeof this.prepareForActivationEvents&&this.prepareForActivationEvents(),this._composerList)for(var e,t=0,i=this._composerList.length;t<i;t++)e=this._composerList[t],e.lazyLoad&&this.loadComposer(e);this.preparedForActivationEvents=!0}},_performDomContentChanges:{value:function(){var e,t,i,n=this._newDomContent;if(n||this._shouldClearDomContentOnNextDraw){for(e=this._element,i=e.childNodes.length-1;i>=0;i--)e.childNodes[i].component||e.removeChild(e.childNodes[i]);if(this._elementsToAppend)for(;this._elementsToAppend.length;)t=this._elementsToAppend.shift(),e.contains(t)||e.appendChild(t);this._newDomContent=null,"function"==typeof this.contentDidChange&&this.contentDidChange(),this._shouldClearDomContentOnNextDraw=!1}}},prepareForDraw:{enumerable:!1,value:null},draw:{enumerable:!1,value:Function.noop},willDraw:{enumerable:!1,value:null},didDraw:{enumerable:!1,value:Function.noop},_addedToDrawList:{value:!1},_addToParentsDrawList:{enumerable:!1,value:function(){if(!this._addedToDrawList){var e=this._parentComponent;e?(e._addToDrawList(this),this.drawListLogger.isDebug&&this.drawListLogger.debug(n(this)+" added to "+n(e)+"'s drawList")):this.drawListLogger.isDebug&&this.drawListLogger.debug(this,"parentComponent is null")}}},_needsDraw:{value:!1},_needsDrawInDeserialization:{value:!1},needsDraw:{enumerable:!1,get:function(){return this._needsDraw},set:function(e){return this.isDeserializing?void(this._needsDrawInDeserialization=!0):(e=!!e,void(this._needsDraw!==e&&(g.isDebug&&g.debug("needsDraw toggled "+e+" for "+this._montage_metadata.objectName),this._needsDraw=e,e&&(this.canDrawGate.value?this._addToParentsDrawList():this.blockDrawGate.setField("drawRequested",!0)))))}},_drawList:{value:null},__addToDrawList:{enumerable:!1,value:function(e){null===this._drawList?(this._drawList=[e],e._addedToDrawList=!0):this._drawList.indexOf(e)===-1&&(this._drawList.push(e),e._addedToDrawList=!0)}},_addToDrawList:{enumerable:!1,value:function(e){this.__addToDrawList(e),this._addToParentsDrawList()}},_templateElement:{enumerable:!1,value:null},surrenderPointer:{value:function(e,t){return!0}},_composerList:{value:null,serializable:!1},composerList:{get:function(){return this._composerList||(this._composerList=[]),this._composerList},serializable:!1},addComposer:{value:function(e){this.addComposerForElement(e,e.element)}},addComposerForElement:{value:function(e,t){e.component=this,e.element=t,this.composerList.push(e),this._firstDraw||(e.lazyLoad?this.preparedForActivationEvents&&this.loadComposer(e):this.loadComposer(e))}},loadComposer:{value:function(e){this._composerList&&this._composerList.indexOf(e)>-1&&a.prototype.loadComposer.call(this,e)}},unloadComposer:{value:function(e){this._composerList&&this._composerList.indexOf(e)>-1&&a.prototype.unloadComposer.call(this,e)}},scheduleComposer:{value:function(e){this.rootComponent.addToComposerList(e)}},removeComposer:{value:function(e){if(this._composerList)for(var t=0,i=this._composerList.length;t<i;t++)if(this._composerList[t]===e){this.unloadComposer(this._composerList[t]),this._composerList.splice(t,1);break}}},clearAllComposers:{value:function(){if(this._composerList){for(var e=this._composerList,t=0,i=e.length;t<i;t++)this.unloadComposer(e[t]);e.length=0}}},localizer:{value:null},_waitForLocalizerMessages:{value:!1},waitForLocalizerMessages:{enumerable:!1,get:function(){return this._waitForLocalizerMessages},set:function(e){if(this._waitForLocalizerMessages!==e)if(e!==!0||this.localizer.messages)this._waitForLocalizerMessages=!1,this.canDrawGate.setField("messages",!0);else{if(!this.localizer)throw"Cannot wait for messages on localizer if it is not set";this._waitForLocalizerMessages=!0,d.debug(this,"waiting for messages from localizer"),this.canDrawGate.setField("messages",!1);var t=this;this.localizer.messagesPromise.then(function(e){d.isDebug&&d.debug(t,"got messages from localizer"),t.canDrawGate.setField("messages",!0)})}}},__elementAttributeValues:{value:null},_elementAttributeValues:{get:function(){return this.__elementAttributeValues||(this.__elementAttributeValues={})}},_elementAttributeDescriptors:{value:null},_getElementAttributeDescriptor:{value:function(e){for(var t,i=this;i&&i._elementAttributeDescriptors&&!(t=i._elementAttributeDescriptors[e]);)i=Object.getPrototypeOf(i);return t}},__shouldBuildIn:{value:!0},_shouldBuildIn:{get:function(){return this.__shouldBuildIn},set:function(e){var t;e=!!e,this.__shouldBuildIn=e,e&&(this.parentComponent&&this.parentComponent._componentsPendingBuildOut&&(t=this.parentComponent._componentsPendingBuildOut.indexOf(this),t!==-1&&this.parentComponent._componentsPendingBuildOut.splice(t,1)),this._shouldBuildOut=!1,this._inDocument&&this._buildIn())}},__shouldBuildOut:{value:!1},_shouldBuildOut:{get:function(){
return this.__shouldBuildOut},set:function(e){e=!!e,this.__shouldBuildOut=e,e&&(this._shouldBuildIn=!1,this._inDocument&&this._buildOut())}},buildInInitialAnimation:{get:function(){var e=null;return this._activeBuildInAnimation&&"object"==typeof this._activeBuildInAnimation&&"undefined"!=typeof this._activeBuildInAnimation.cssClass&&(e=new x,e.component=this,e.fromCssClass=this._activeBuildInAnimation.fromCssClass,e.cssClass=this._activeBuildInAnimation.cssClass,e.toCssClass=this._activeBuildInAnimation.toCssClass),e}},buildInSwitchAnimation:{get:function(){var e=null;return this._activeBuildInAnimation&&"object"==typeof this._activeBuildInAnimation&&"undefined"!=typeof this._activeBuildInAnimation.cssClass&&(e=new x,e.component=this,e.cssClass=this._activeBuildInAnimation.cssClass,e.toCssClass=this._activeBuildInAnimation.toCssClass),e}},buildOutInitialAnimation:{get:function(){var e=null;return this._activeBuildOutAnimation&&"object"==typeof this._activeBuildOutAnimation&&"undefined"!=typeof this._activeBuildOutAnimation.cssClass&&(e=new x,e.component=this,e.hasOneFrameDelay=!0,e.fromCssClass=this._activeBuildOutAnimation.fromCssClass,e.cssClass=this._activeBuildOutAnimation.cssClass,e.toCssClass=this._activeBuildOutAnimation.toCssClass),e}},buildOutSwitchAnimation:{get:function(){var e=null;return this._activeBuildOutAnimation&&"object"==typeof this._activeBuildOutAnimation&&"undefined"!=typeof this._activeBuildOutAnimation.cssClass&&(e=new x,e.component=this,e.cssClass=this._activeBuildOutAnimation.cssClass,e.toCssClass=this._activeBuildOutAnimation.toCssClass),e}},buildInAnimation:{value:null},buildOutAnimation:{value:null},buildInAnimationOverride:{value:null},buildOutAnimationOverride:{value:null},_activeBuildInAnimation:{value:null},_activeBuildOutAnimation:{value:null},_updateActiveBuildAnimations:{value:function(){this.buildInAnimationOverride?this._activeBuildInAnimation=this.buildInAnimationOverride:this._activeBuildInAnimation=this.buildInAnimation,this.buildOutAnimationOverride?this._activeBuildOutAnimation=this.buildOutAnimationOverride:this._activeBuildOutAnimation=this.buildOutAnimation}},_currentBuildAnimation:{value:null},_buildIn:{value:function(){var e=this;this._currentBuildAnimation&&this._currentBuildAnimation.cancel(),this._element&&this._element.parentNode&&this._element.parentNode.component&&(this._isElementAttachedToParent?this._currentBuildAnimation=this.buildInSwitchAnimation:(this._updateActiveBuildAnimations(),this._currentBuildAnimation=this.buildInInitialAnimation),this._currentBuildAnimation&&(this._currentBuildAnimation.play(),this._currentBuildAnimation.finished.then(function(){e._currentBuildAnimation.cancel(),e._currentBuildAnimation=null,e.dispatchEventNamed("buildInEnd",!0,!0)},function(){})))}},_buildOut:{value:function(){var e=this;this._currentBuildAnimation?(this._currentBuildAnimation.cancel(),this._currentBuildAnimation=this.buildOutSwitchAnimation):(this._updateActiveBuildAnimations(),this._currentBuildAnimation=this.buildOutInitialAnimation),this._element&&this._element.parentNode&&this._element.parentNode.component&&(this._currentBuildAnimation?(this._currentBuildAnimation.play(),this._currentBuildAnimation.finished.then(function(){var t=e.parentComponent;e._currentBuildAnimation.cancel(),e._currentBuildAnimation=null,e.detachFromParentComponent(),e.buildInAnimationOverride=null,e.buildOutAnimationOverride=null,e._element.parentNode.component&&e._element.parentNode.removeChild(e._element),e._isElementAttachedToParent=!1,t.dispatchEventNamed("buildOutEnd",!0,!0)},function(){})):(this.detachFromParentComponent(),this.buildInAnimationOverride=null,this.buildOutAnimationOverride=null,this._isElementAttachedToParent&&(this._element.parentNode&&this._element.parentNode.component&&this._element.parentNode.removeChild(this._element),this._isElementAttachedToParent=!1)))}},_willEnterDocument:{value:function(){var e;e=new CustomEvent("willEnterDocument",{details:{component:this},bubbles:!1}),this.dispatchEvent(e),this._inDocument=!0,this.parentComponent&&this.parentComponent._childWillEnterDocument(),this.__shouldBuildIn&&this._buildIn(),this._isElementAttachedToParent=!0,this.__shouldBuildOut&&this._buildOut()}},_childWillEnterDocument:{value:function(){if(this._componentsPendingBuildOut)for(;this._componentsPendingBuildOut.length;)this._componentsPendingBuildOut.pop()._shouldBuildOut=!0}},_enterDocument:{value:function(e){var t;if(e){t=this.originalElement;var i,n,r,a,s,o,l;if(i=t.attributes)for(r=i.length,n=0;n<r;n++)a=i[n].name,s=i[n].value,l=this._getElementAttributeDescriptor(a,this),(l||"undefined"!=typeof this[a])&&"undefined"==typeof this._elementAttributeValues[a]&&(this._elementAttributeValues[a]=s,"undefined"!=typeof this[a]&&null!=this[a]||(this[a]=s));if(l=this._getElementAttributeDescriptor("textContent",this)){var u=t.textContent;"undefined"==typeof this._elementAttributeValues.textContent&&(this._elementAttributeValues.textContent=u,null==this.textContent&&(this.textContent=u))}if(this._elementAttributeDescriptors)for(o in this._elementAttributeDescriptors){l=this._elementAttributeDescriptors[o];var c="_"+o;null===this[c]&&null!==l&&"value"in l&&(this[c]=l.value)}}}},_draw:{value:function(){var e,t=this.element;if(null!==this.__elementAttributeValues)for(var i in this._elementAttributeValues)if(this._elementAttributeValues.hasOwnProperty(i)){var n=this[i];e=this._getElementAttributeDescriptor(i,this),e&&("boolean"===e.dataType?n===!0?(t[i]=!0,t.setAttribute(i,i.toLowerCase())):(t[i]=!1,t.removeAttribute(i)):"undefined"!=typeof n&&("textContent"===i?t.textContent=n:t.setAttribute(i,n))),delete this._elementAttributeValues[i]}this._drawClassListIntoComponent()}},_classList:{value:null},_classListDirty:{value:!1},classList:{get:function(){return null===this._classList&&(this._classList=new b,this._subscribeToToClassListChanges(),this._initializeClassListFromElement(this.element)),this._classList}},_initializeClassListFromElement:{value:function(e){e&&e.classList&&e.classList.length>0&&(this._classList?this._unsubscribeToClassListChanges&&this._unsubscribeToClassListChanges():this._classList=new b,this._classList.addEach(e.classList),this._subscribeToToClassListChanges())}},_unsubscribeToClassListChanges:{value:null},_subscribeToToClassListChanges:{value:function(){this._unsubscribeToClassListChanges=this._classList.addRangeChangeListener(this,"classList")}},handleClassListRangeChange:{value:function(e,t){this._classListDirty=!0,this.needsDraw=!0}},_drawClassListIntoComponent:{value:function(){if(this._classListDirty){for(var e,t=this.element.classList,i=this._classList,n=0,r=t.length;n<r;n++)e=t.item(n),i.has(e)||(t.remove(e),n--,r--);this._classList.forEach(function(e){t.add(e)}),this._classListDirty=!1}}},dispose:{value:function(){this.cancelBindings(),this.detachFromParentComponent(),this._element&&(c.unregisterEventHandlerForElement(this._element),this._element=null),this.childComponents.forEach(function(e){e.dispose()})}}},{addAttributes:{value:function(e){var t,i,n;this.prototype._elementAttributeDescriptors=e;for(i in e)e.hasOwnProperty(i)&&(n=e[i],null===n||"string"==typeof n?(t={value:n,dataType:"string"},e[i]=t):t=n,"undefined"==typeof this[i]&&this.defineAttribute(i,t))}},defineAttributeSetter:{value:function(e,t,i){return function(e,t,i){return function(n,r){var a=this._getElementAttributeDescriptor(e,this);a&&"boolean"===a.dataType&&(n=!(!n&&""!==n)),"undefined"!=typeof n&&this[t]!==n&&(i?i.call(this,n):this[t]=n,this._elementAttributeValues[e]=n,r||(this.needsDraw=!0))}}(e,t,i.set)}},defineAttributeGetter:{value:function(e){return function(e){return function(){return this[e]}}(e)}},defineAttribute:{value:function(e,t){t=t||{};var i="_"+e,n={configurable:"undefined"==typeof t.configurable||t.configurable,enumerable:"undefined"==typeof t.enumerable||t.enumerable,set:this.defineAttributeSetter(e,i,t),get:t.get||this.defineAttributeGetter(i)};this.prototype.hasOwnProperty(i)||r.defineProperty(this.prototype,i,{value:t.value}),r.defineProperty(this.prototype,e,n)}}}),S=T.specialize({constructor:{value:function(){this._drawTree=this._drawTree.bind(this),this._readyToDrawListIndex=new _,this._addedStyleSheetsByTemplate=new v}},init:{value:function(){return this}},needsDraw:{enumerable:!0,get:function(){return!!this._needsDraw},set:function(e){if(this._needsDraw!==e&&(this._needsDraw=!!e,e))for(var t,i=this.childComponents,n=0;t=i[n];n++)g.isDebug&&g.debug(this,"needsDraw = true for: "+t._montage_metadata.exportedSymbol),t.needsDraw=!0}},canDrawGate:{get:function(){return this._canDrawGate||(this._canDrawGate=(new l).initWithDelegate(this))}},_clearNeedsDrawTimeOut:{value:null},_needsDrawList:{value:[]},_cannotDrawList:{value:null},componentBlockDraw:{value:function(e){this._cannotDrawList=this._cannotDrawList?this._cannotDrawList:new b,this._cannotDrawList.add(e),this._clearNeedsDrawTimeOut&&(clearTimeout(this._clearNeedsDrawTimeOut),this._clearNeedsDrawTimeOut=null)}},isComponentWaitingNeedsDraw:{value:function(e){return this._cannotDrawList.has(e)||this._needsDrawList.indexOf(e)>=0}},componentCanDraw:{value:function(e,t){if(t){if(!this._cannotDrawList)return;if(this._cannotDrawList["delete"](e),this._needsDrawList.push(e),0===this._cannotDrawList.size&&this._needsDrawList.length>0&&!this._clearNeedsDrawTimeOut){var i=this;this._clearNeedsDrawTimeOut=setTimeout(function(){i._clearNeedsDrawList()},0)}}else this._clearNeedsDrawTimeOut&&(clearTimeout(this._clearNeedsDrawTimeOut),this._clearNeedsDrawTimeOut=null)}},_clearNeedsDrawList:{value:function(){var e,t,i,n=this._needsDrawList;for(i=n.length,t=0;t<i;t++)e=n[t],(e.needsDraw||e._drawList&&e._drawList.length>0)&&e._addToParentsDrawList();this._clearNeedsDrawTimeOut=null,n.length=0}},removeFromCannotDrawList:{value:function(e){if(this._cannotDrawList&&(this._cannotDrawList["delete"](e),0===this._cannotDrawList.size&&this._needsDrawList.length>0&&!this._clearNeedsDrawTimeOut)){var t=this;this._clearNeedsDrawTimeOut=setTimeout(function(){t._clearNeedsDrawList()},0)}}},_cancelDrawIfScheduled:{value:function(){var e=this.requestedAnimationFrame,t=this.cancelAnimationFrame;null!==e&&(this._frameTime||(d.isDebug&&d.debug(this,"clearing draw"),t?t(e):clearTimeout(e),this.requestedAnimationFrame=null))}},_addToDrawList:{value:function(e){this.__addToDrawList(e),this.drawListLogger.isDebug&&this.drawListLogger.debug(this,this.canDrawGate.value,this.requestedAnimationFrame),this.drawTree()},enumerable:!1},addToComposerList:{value:function(e){this.composerList.push(e),f.isDebug&&f.debug(this,e,"Added to composer list"),this._scheduleComposerRequest=!0,this.drawTree()}},composerListSwap:{get:function(){return this._composerListSwap||(this._composerListSwap=[]),this._composerListSwap}},_composerListSwap:{value:null},_scheduleComposerRequest:{value:!1},requestedAnimationFrame:{value:null,enumerable:!1},requestAnimationFrame:{value:global.requestAnimationFrame||global.webkitRequestAnimationFrame||global.mozRequestAnimationFrame||global.msRequestAnimationFrame||setTimeout,enumerable:!1},cancelAnimationFrame:{value:global.cancelAnimationFrame||global.webkitCancelAnimationFrame||global.mozCancelAnimationFrame||global.msCancelAnimationFrame||clearTimeout,enumerable:!1},_frameTime:{value:null},_oldSource:{value:null},_diff:{value:function(e,t){for(var i={},n={},r=0;r<t.length;r++)null==i[t[r]]&&(i[t[r]]={rows:[],o:null}),i[t[r]].rows.push(r);for(r=0;r<e.length;r++)null==n[e[r]]&&(n[e[r]]={rows:[],n:null}),n[e[r]].rows.push(r);for(r in i)1===i[r].rows.length&&"undefined"!=typeof n[r]&&1===n[r].rows.length&&(t[i[r].rows[0]]={text:t[i[r].rows[0]],row:n[r].rows[0]},e[n[r].rows[0]]={text:e[n[r].rows[0]],row:i[r].rows[0]});for(r=0;r<t.length-1;r++)null!=t[r].text&&null==t[r+1].text&&t[r].row+1<e.length&&null==e[t[r].row+1].text&&t[r+1]==e[t[r].row+1]&&(t[r+1]={text:t[r+1],row:t[r].row+1},e[t[r].row+1]={text:e[t[r].row+1],row:r+1});for(r=t.length-1;r>0;r--)null!=t[r].text&&null==t[r-1].text&&t[r].row>0&&null==e[t[r].row-1].text&&t[r-1]==e[t[r].row-1]&&(t[r-1]={text:t[r-1],row:t[r].row-1},e[t[r].row-1]={text:e[t[r].row-1],row:r-1});return{o:e,n:t}}},_previousDrawDate:{enumerable:!1,value:0},_documentResources:{value:null},_needsStylesheetsDraw:{value:!1},_stylesheets:{value:[]},addStylesheet:{value:function(e){this._stylesheets.push(e),this._needsStylesheetsDraw=!0}},_addedStyleSheetsByTemplate:{value:null},addStyleSheetsFromTemplate:{value:function(e){if(!this._addedStyleSheetsByTemplate.has(e)){for(var t,i=e.getResources(),n=this.element.ownerDocument,r=i.createStylesForDocument(n),a=0;t=r[a];a++)this.addStylesheet(t);this._addedStyleSheetsByTemplate.set(e,!0)}}},__bufferDocumentFragment:{value:null},_bufferDocumentFragment:{get:function(){return this.__bufferDocumentFragment||(this.__bufferDocumentFragment=this._element.ownerDocument.createDocumentFragment())}},drawStylesheets:{value:function(){for(var e,t=this._documentResources,i=this._stylesheets,n=t._document.head,r=this._bufferDocumentFragment;e=i.shift();)t.addStyle(e,r);n.insertBefore(r,n.firstChild),this._needsStylesheetsDraw=!1}},drawTree:{value:function(){if(null===this.requestedAnimationFrame){var e=this.requestAnimationFrame;if(e)this.requestedAnimationFrame=e.call(window,this._drawTree);else{var t=Date.now(),i=17-t+this._previousDrawDate;i<0&&(i=0),this.requestedAnimationFrame=setTimeout(this._drawTree,i),this._previousDrawDate=t+i}this._scheduleComposerRequest=!1}},enumerable:!1},_drawTree:{value:function(e){var t;if(this._needsStylesheetsDraw&&this.drawStylesheets(),!this._documentResources.areStylesLoaded)return m.isDebug&&console.log("Draw Cycle Waiting Stylesheets: ",this._documentResources._expectedStyles.length),this.requestedAnimationFrame=null,void this.drawTree();if(m.isDebug&&(t=window.performance?window.performance.now():Date.now()),this._frameTime=e?e:Date.now(),this._clearNeedsDrawTimeOut&&this._clearNeedsDrawList(),f.isDebug){var i=document.body.innerHTML;if(this._oldSource&&i!==this._oldSource){for(var n=["DOM modified outside of the draw loop"],r=this._diff(this._oldSource.split("\n"),i.split("\n")),a=0;a<r.n.length;a++)if(null==r.n[a].text)n.push("+ "+r.n[a]);else for(var s=r.n[a].row+1;s<r.o.length&&null==r.o[s].text;s++)n.push("- "+r.o[s]);console.warn(n.join("\n"))}console.group((e?f.toTimeString(new Date(e))+" ":"")+"Draw Fired")}if(this.drawIfNeeded(),m.isDebug){var o;o=window.performance?window.performance.now():Date.now(),console.log("Draw Cycle Time: ",o-t,", Components: ",this._lastDrawComponentsCount)}f.isDebug&&(console.groupEnd(),this._oldSource=document.body.innerHTML),this._frameTime=null,this._scheduleComposerRequest&&this.drawTree()}},_readyToDrawList:{enumerable:!1,value:[]},_readyToDrawListIndex:{enumerable:!1,value:null},addToDrawCycle:{value:function(e){var t=this._readyToDrawListIndex;return t.has(e)?void(f.isDebug&&this!==P&&f.debug(n(this)+" added to the draw cycle twice, this should not happen.")):(this._readyToDrawList.push(e),this._readyToDrawListIndex.set(e,!0),void e._updateComponentDom())}},_lastDrawComponentsCount:{value:null},_sortByLevel:{value:function(e,t){return e._treeLevel-t._treeLevel}},drawIfNeeded:{value:function(){var e,t,i,r,a,s,o=this._readyToDrawList,l=0,u=this._composerList,c=f.isDebug;if(o.length=0,this._readyToDrawListIndex.clear(),u&&(s=u.length)>0){for(this._composerList=this.composerListSwap,t=0;t<s;t++)a=u[t],a.needsFrame=!1,a.frame(this._frameTime);u.length=0,this._composerListSwap=u}for(this._drawIfNeeded(0),i=o.length,c&&console.groupCollapsed("willDraw - "+o.length+(o.length>1?" components.":" component."));l<i;){for(t=l;t<i;t++)e=o[t],"function"==typeof e.willDraw&&e.willDraw(this._frameTime),c&&f.debug("Level "+e._treeLevel+" "+n(e));this._drawIfNeeded(0),l=i,i=o.length}for(c&&(console.groupEnd(),console.group("draw - "+o.length+(o.length>1?" components.":" component."))),o.sort(this._sortByLevel),t=0;t<i;t++)e=o[t],e.needsDraw=!1;for(this.requestedAnimationFrame=null,t=i-1;t>=0;t--)e=o[t],e._draw(this._frameTime),e.draw(this._frameTime),c&&f.debug("Level "+e._treeLevel+" "+n(e));for(c&&(console.groupEnd(),console.groupCollapsed("didDraw - "+o.length+(o.length>1?" components.":" component."))),this._didDrawEvent||(this._didDrawEvent=new CustomEvent("didDraw",{bubbles:!1})),t=0;t<i;t++)e=o[t],e.dispatchEvent(this._didDrawEvent),e.didDraw(this._frameTime),e._completedFirstDraw||(r=document.createEvent("CustomEvent"),r.initCustomEvent("firstDraw",!0,!1,null),e.dispatchEvent(r),e._completedFirstDraw=!0),c&&f.debug("Level "+e._treeLevel+" "+n(e));return this._completedFirstDraw||(r=document.createEvent("CustomEvent"),r.initCustomEvent("firstDraw",!0,!1,null),this.dispatchEvent(r),this._completedFirstDraw=!0),c&&console.groupEnd(),m.isDebug&&(this._lastDrawComponentsCount=o.length),!!o.length}},element:{get:function(){return this._element},set:function(e){c.registerEventHandlerForElement(this,e),this._element=e.documentElement,this._documentResources=o.getInstanceForDocument(e)}}}),P=(new S).init();t.__root__=P,T.addAttributes({accesskey:null,contenteditable:null,contextmenu:null,dir:null,draggable:null,dropzone:null,hidden:{dataType:"boolean"},lang:null,spellcheck:null,tabindex:null,title:null})}}),montageDefine("c50fb48","runtime/webgl-renderer",{dependencies:["runtime/dependencies/gl-matrix","runtime/glsl-program","runtime/helpers/resource-manager"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix");var n=e("runtime/glsl-program").GLSLProgram,r=e("runtime/helpers/resource-manager").ResourceManager;t.WebGLRenderer=Object.create(Object.prototype,{WORLD:{value:"WORLD",writable:!1},VIEW:{value:"VIEW",writable:!1},PROJECTION:{value:"PROJECTION",writable:!1},WORLDVIEW:{value:"WORLDVIEW",writable:!1},VIEWPROJECTION:{value:"VIEWPROJECTION",writable:!1},WORLDVIEWPROJECTION:{value:"WORLDVIEWPROJECTION",writable:!1},WORLDINVERSE:{value:"WORLDINVERSE",writable:!1},VIEWINVERSE:{value:"VIEWINVERSE",writable:!1},PROJECTIONINVERSE:{value:"PROJECTIONINVERSE",writable:!1},WORLDVIEWINVERSE:{value:"WORLDVIEWINVERSE",writable:!1},VIEWPROJECTIONINVERSE:{value:"VIEWPROJECTIONINVERSE",writable:!1},WORLDVIEWPROJECTIONINVERSE:{value:"WORLDVIEWPROJECTIONINVERSE",writable:!1},WORLDTRANSPOSE:{value:"WORLDTRANSPOSE",writable:!1},VIEWTRANSPOSE:{value:"VIEWTRANSPOSE",writable:!1},PROJECTIONTRANSPOSE:{value:"PROJECTIONTRANSPOSE",writable:!1},WORLDVIEWTRANSPOSE:{value:"WORLDVIEWTRANSPOSE",writable:!1},VIEWPROJECTIONTRANSPOSE:{value:"VIEWPROJECTIONTRANSPOSE",writable:!1},WORLDVIEWPROJECTIONTRANSPOSE:{value:"WORLDVIEWPROJECTIONTRANSPOSE",writable:!1},WORLDINVERSETRANSPOSE:{value:"WORLDINVERSETRANSPOSE",writable:!1},VIEWINVERSETRANSPOSE:{value:"VIEWINVERSETRANSPOSE",writable:!1},PROJECTIONINVERSETRANSPOSE:{value:"PROJECTIONINVERSETRANSPOSE",writable:!1},WORLDVIEWINVERSETRANSPOSE:{value:"WORLDVIEWINVERSETRANSPOSE",writable:!1},VIEWPROJECTIONINVERSETRANSPOSE:{value:"VIEWPROJECTIONINVERSETRANSPOSE",writable:!1},WORLDVIEWPROJECTIONINVERSETRANSPOSE:{value:"WORLDVIEWPROJECTIONINVERSETRANSPOSE",writable:!1},_bindedProgram:{value:null,writable:!0},_debugProgram:{value:null,writable:!0},_lambertProgram:{value:null,writable:!0},_resourceManager:{value:null,writable:!0},_webGLContext:{value:null,writable:!0},_projectionMatrix:{value:null,writable:!0},shininess:{value:200,writable:!0},light:{value:[0,0,-1],writable:!0},specularColor:{value:[1,1,1],writable:!0},_GLEnumFromString:{value:null,writable:!0},GLContextDidChange:{value:function(e){this._GLEnumFromString=[];var t=this.webGLContext;this._GLEnumFromString.POINTS=t.POINTS,this._GLEnumFromString.LINES=t.LINES,this._GLEnumFromString.LINE_LOOP=t.LINE_LOOP,this._GLEnumFromString.LINE_STRIP=t.LINE_STRIP,this._GLEnumFromString.TRIANGLES=t.TRIANGLES,this._GLEnumFromString.TRIANGLES=t.TRIANGLES,this._GLEnumFromString.TRIANGLE_STRIP=t.TRIANGLE_STRIP,this._GLEnumFromString.TRIANGLE_FAN=t.TRIANGLE_FAN,this._GLEnumFromString.ZERO=t.ZERO,this._GLEnumFromString.ONE=t.ONE,this._GLEnumFromString.SRC_COLOR=t.SRC_COLOR,this._GLEnumFromString.ONE_MINUS_SRC_COLOR=t.ONE_MINUS_SRC_COLOR,this._GLEnumFromString.SRC_ALPHA=t.SRC_ALPHA,this._GLEnumFromString.ONE_MINUS_SRC_ALPHA=t.ONE_MINUS_SRC_ALPHA,this._GLEnumFromString.DST_ALPHA=t.DST_ALPHA,this._GLEnumFromString.ONE_MINUS_DST_ALPHA=t.ONE_MINUS_DST_ALPHA,this._GLEnumFromString.DST_COLOR=t.DST_COLOR,this._GLEnumFromString.ONE_MINUS_DST_COLOR=t.ONE_MINUS_DST_COLOR,this._GLEnumFromString.SRC_ALPHA_SATURATE=t.SRC_ALPHA_SATURATE,this._GLEnumFromString.FUNC_ADD=t.FUNC_ADD,this._GLEnumFromString.BLEND_EQUATION=t.BLEND_EQUATION,this._GLEnumFromString.BLEND_EQUATION_RGB=t.BLEND_EQUATION_RGB,this._GLEnumFromString.BLEND_EQUATION_ALPHA=t.BLEND_EQUATION_ALPHA,this._GLEnumFromString.FUNC_SUBTRACT=t.FUNC_SUBTRACT,this._GLEnumFromString.FUNC_REVERSE_SUBTRACT=t.FUNC_REVERSE_SUBTRACT,this._GLEnumFromString.BLEND_DST_RGB=t.BLEND_DST_RGB,this._GLEnumFromString.BLEND_SRC_RGB=t.BLEND_SRC_RGB,this._GLEnumFromString.BLEND_DST_ALPHA=t.BLEND_DST_ALPHA,this._GLEnumFromString.BLEND_SRC_ALPHA=t.BLEND_SRC_ALPHA,this._GLEnumFromString.CONSTANT_COLOR=t.CONSTANT_COLOR,this._GLEnumFromString.ONE_MINUS_CONSTANT_COLOR=t.ONE_MINUS_CONSTANT_COLOR,this._GLEnumFromString.CONSTANT_ALPHA=t.CONSTANT_ALPHA,this._GLEnumFromString.ONE_MINUS_CONSTANT_ALPHA=t.ONE_MINUS_CONSTANT_ALPHA,this._GLEnumFromString.BLEND_COLOR=t.BLEND_COLOR,this._GLEnumFromString.ARRAY_BUFFER=t.ARRAY_BUFFER,this._GLEnumFromString.ELEMENT_ARRAY_BUFFER=t.ELEMENT_ARRAY_BUFFER,this._GLEnumFromString.ARRAY_BUFFER_BINDING=t.ARRAY_BUFFER_BINDING,this._GLEnumFromString.ELEMENT_ARRAY_BUFFER_BINDING=t.ELEMENT_ARRAY_BUFFER_BINDING,this._GLEnumFromString.STREAM_DRAW=t.STREAM_DRAW,this._GLEnumFromString.STATIC_DRAW=t.STATIC_DRAW,this._GLEnumFromString.DYNAMIC_DRAW=t.DYNAMIC_DRAW,this._GLEnumFromString.BUFFER_SIZE=t.BUFFER_SIZE,this._GLEnumFromString.BUFFER_USAGE=t.BUFFER_USAGE,this._GLEnumFromString.CURRENT_VERTEX_ATTRIB=t.CURRENT_VERTEX_ATTRIB,this._GLEnumFromString.FRONT=t.FRONT,this._GLEnumFromString.BACK=t.BACK,this._GLEnumFromString.FRONT_AND_BACK=t.FRONT_AND_BACK,this._GLEnumFromString.CULL_FACE=t.CULL_FACE,this._GLEnumFromString.BLEND=t.BLEND,this._GLEnumFromString.STENCIL_TEST=t.STENCIL_TEST,this._GLEnumFromString.DEPTH_TEST=t.DEPTH_TEST,this._GLEnumFromString.SCISSOR_TEST=t.SCISSOR_TEST,this._GLEnumFromString.POLYGON_OFFSET_FILL=t.POLYGON_OFFSET_FILL,this._GLEnumFromString.SAMPLE_ALPHA_TO_COVERAGE=t.SAMPLE_ALPHA_TO_COVERAGE,this._GLEnumFromString.SAMPLE_COVERAGE=t.SAMPLE_COVERAGE,this._GLEnumFromString.CW=t.CW,this._GLEnumFromString.CCW=t.CCW,this._GLEnumFromString.BYTE=t.BYTE,this._GLEnumFromString.UNSIGNED_BYTE=t.UNSIGNED_BYTE,this._GLEnumFromString.SHORT=t.SHORT,this._GLEnumFromString.UNSIGNED_SHORT=t.UNSIGNED_SHORT,this._GLEnumFromString.INT=t.INT,this._GLEnumFromString.UNSIGNED_INT=t.UNSIGNED_INT,this._GLEnumFromString.FLOAT=t.FLOAT,this._GLEnumFromString.DEPTH_COMPONENT=t.DEPTH_COMPONENT,this._GLEnumFromString.ALPHA=t.ALPHA,this._GLEnumFromString.RGB=t.RGB,this._GLEnumFromString.RGBA=t.RGBA,this._GLEnumFromString.LUMINANCE=t.LUMINANCE,this._GLEnumFromString.LUMINANCE_ALPHA=t.LUMINANCE_ALPHA,this._GLEnumFromString.UNSIGNED_SHORT_4_4_4_4=t.UNSIGNED_SHORT_4_4_4_4,this._GLEnumFromString.UNSIGNED_SHORT_5_5_5_1=t.UNSIGNED_SHORT_5_5_5_1,this._GLEnumFromString.UNSIGNED_SHORT_5_6_5=t.UNSIGNED_SHORT_5_6_5,this._GLEnumFromString.NEVER=t.NEVER,this._GLEnumFromString.LESS=t.LESS,this._GLEnumFromString.EQUAL=t.EQUAL,this._GLEnumFromString.LEQUAL=t.LEQUAL,this._GLEnumFromString.GREATER=t.GREATER,this._GLEnumFromString.NOTEQUAL=t.NOTEQUAL,this._GLEnumFromString.GEQUAL=t.GEQUAL,this._GLEnumFromString.ALWAYS=t.ALWAYS,this._GLEnumFromString.KEEP=t.KEEP,this._GLEnumFromString.REPLACE=t.REPLACE,this._GLEnumFromString.INCR=t.INCR,this._GLEnumFromString.DECR=t.DECR,this._GLEnumFromString.INVERT=t.INVERT,this._GLEnumFromString.INCR_WRAP=t.INCR_WRAP,this._GLEnumFromString.DECR_WRAP=t.DECR_WRAP,this._GLEnumFromString.NEAREST=t.NEAREST,this._GLEnumFromString.LINEAR=t.LINEAR,this._GLEnumFromString.NEAREST_MIPMAP_NEAREST=t.NEAREST_MIPMAP_NEAREST,this._GLEnumFromString.LINEAR_MIPMAP_NEAREST=t.LINEAR_MIPMAP_NEAREST,this._GLEnumFromString.NEAREST_MIPMAP_LINEAR=t.NEAREST_MIPMAP_LINEAR,this._GLEnumFromString.LINEAR_MIPMAP_LINEAR=t.LINEAR_MIPMAP_LINEAR,this._GLEnumFromString.TEXTURE_MAG_FILTER=t.TEXTURE_MAG_FILTER,this._GLEnumFromString.TEXTURE_MIN_FILTER=t.TEXTURE_MIN_FILTER,this._GLEnumFromString.TEXTURE_WRAP_S=t.TEXTURE_WRAP_S,this._GLEnumFromString.TEXTURE_WRAP_T=t.TEXTURE_WRAP_T,this._GLEnumFromString.TEXTURE_CUBE_MAP=t.TEXTURE_CUBE_MAP,this._GLEnumFromString.TEXTURE_CUBE_MAP_POSITIVE_X=t.TEXTURE_CUBE_MAP_POSITIVE_X,this._GLEnumFromString.TEXTURE_CUBE_MAP_NEGATIVE_X=t.TEXTURE_CUBE_MAP_NEGATIVE_X,this._GLEnumFromString.TEXTURE_CUBE_MAP_POSITIVE_Y=t.TEXTURE_CUBE_MAP_POSITIVE_Y,this._GLEnumFromString.TEXTURE_CUBE_MAP_NEGATIVE_Y=t.TEXTURE_CUBE_MAP_NEGATIVE_Y,this._GLEnumFromString.TEXTURE_CUBE_MAP_POSITIVE_Z=t.TEXTURE_CUBE_MAP_POSITIVE_Z,this._GLEnumFromString.TEXTURE_CUBE_MAP_NEGATIVE_Z=t.TEXTURE_CUBE_MAP_NEGATIVE_Z,this._GLEnumFromString.MAX_CUBE_MAP_TEXTURE_SIZE=t.MAX_CUBE_MAP_TEXTURE_SIZE,this._GLEnumFromString.REPEAT=t.REPEAT,this._GLEnumFromString.CLAMP_TO_EDGE=t.CLAMP_TO_EDGE,this._GLEnumFromString.MIRRORED_REPEAT=t.MIRRORED_REPEAT,this._GLEnumFromString.FLOAT_VEC2=t.FLOAT_VEC2,this._GLEnumFromString.FLOAT_VEC3=t.FLOAT_VEC3,this._GLEnumFromString.FLOAT_VEC4=t.FLOAT_VEC4,this._GLEnumFromString.INT_VEC2=t.INT_VEC2,this._GLEnumFromString.INT_VEC3=t.INT_VEC3,this._GLEnumFromString.INT_VEC4=t.INT_VEC4,this._GLEnumFromString.BOOL=t.BOOL,this._GLEnumFromString.BOOL_VEC2=t.BOOL_VEC2,this._GLEnumFromString.BOOL_VEC3=t.BOOL_VEC3,this._GLEnumFromString.BOOL_VEC3=t.BOOL_VEC3,this._GLEnumFromString.BOOL_VEC4=t.BOOL_VEC4,this._GLEnumFromString.FLOAT_VEC2=t.FLOAT_VEC2,this._GLEnumFromString.FLOAT_VEC3=t.FLOAT_VEC3,this._GLEnumFromString.FLOAT_VEC4=t.FLOAT_VEC4,this._GLEnumFromString.INT_VEC2=t.INT_VEC2,this._GLEnumFromString.INT_VEC3=t.INT_VEC3,this._GLEnumFromString.INT_VEC4=t.INT_VEC4,this._GLEnumFromString.FLOAT_MAT2=t.FLOAT_MAT2,this._GLEnumFromString.FLOAT_MAT3=t.FLOAT_MAT3,this._GLEnumFromString.FLOAT_MAT4=t.FLOAT_MAT4,this._GLEnumFromString.RGBA4=t.RGBA4,this._GLEnumFromString.RGB5_A1=t.RGB5_A1,this._GLEnumFromString.RGB565=t.RGB565,this._GLEnumFromString.DEPTH_COMPONENT16=t.DEPTH_COMPONENT16,this._GLEnumFromString.STENCIL_INDEX=t.STENCIL_INDEX,this._GLEnumFromString.STENCIL_INDEX8=t.STENCIL_INDEX8,this._GLEnumFromString.DEPTH_STENCIL=t.DEPTH_STENCIL}},initWithWebGLContext:{value:function(e){return this.webGLContext=e,this._states={},this}},bindedProgram:{get:function(){return this._bindedProgram},set:function(e){this._bindedProgram!==e&&this._webGLContext&&(this._bindedProgram=e,this._bindedProgram&&this._bindedProgram.use(this._webGLContext,!1))}},projectionMatrix:{get:function(){return this._projectionMatrix},set:function(e){this._projectionMatrix=e}},debugProgram:{get:function(){if(!this._debugProgram){this._debugProgram=Object.create(n);var e="precision highp float;attribute vec3 vert;uniform mat4 u_mvMatrix; uniform mat4 u_projMatrix; void main(void) { gl_Position = u_projMatrix * u_mvMatrix * vec4(vert,1.0); }",t="precision highp float;void main(void) { gl_FragColor = vec4(1.,0.,0.,1.); }";this._debugProgram.initWithShaders({"x-shader/x-vertex":e,"x-shader/x-fragment":t}),this._debugProgram.build(this.webGLContext)||console.log(this._debugProgram.errorLogs)}return this._debugProgram}},lambertProgram:{get:function(){if(!this._lambertProgram){this._lambertProgram=Object.create(n);var e="precision highp float;attribute vec3 vert;attribute vec3 normal; varying vec3 v_normal; uniform mat4 u_mvMatrix; uniform mat3 u_normalMatrix; uniform mat4 u_projMatrix; void main(void) { v_normal = normalize(u_normalMatrix * normal); gl_Position = u_projMatrix * u_mvMatrix * vec4(vert,1.0); }",t="precision highp float; uniform vec3 color; varying vec3 v_normal; void main(void) {  vec3 normal = normalize(v_normal);  float lambert = max(dot(normal,vec3(0.,0.,1.)), 0.); gl_FragColor = vec4(color.xyz *lambert, 1.); }";this._lambertProgram.initWithShaders({"x-shader/x-vertex":e,"x-shader/x-fragment":t}),this._lambertProgram.build(this.webGLContext)||console.log(this._lambertProgram.errorLogs)}return this._lambertProgram}},webGLContext:{get:function(){return this._webGLContext},set:function(e){this._webGLContext=e,this.GLContextDidChange()}},resourceManager:{get:function(){return this._resourceManager||(this._resourceManager=Object.create(r),this._resourceManager.init()),this._resourceManager}},indicesDelegate:{value:{webGLContext:{value:null,writable:!0},handleError:function(e,t){console.log("ERROR:vertexAttributeBufferDelegate:"+e+" :"+t)},convert:function(e,t){var i=this.webGLContext,n=i.getParameter(i.ELEMENT_ARRAY_BUFFER_BINDING),r=i.createBuffer();return i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r),i.bufferData(i.ELEMENT_ARRAY_BUFFER,e,i.STATIC_DRAW),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,n),r},resourceAvailable:function(e,t){}}},setupCompressedMesh:{value:function(e,t,i){var n=e.primitives[0],r=this.webGLContext,a=r.getParameter(r.ELEMENT_ARRAY_BUFFER_BINDING),s=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,s),r.bufferData(r.ELEMENT_ARRAY_BUFFER,i,r.STATIC_DRAW),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,a),s.count=i.length,this.resourceManager.setResource(n.indices.id,s),n.indices={id:n.indices.id,count:s.count};var o,l=t.length/8,u=new Float32Array(3*l),c=new Float32Array(3*l),h=new Float32Array(2*l);for(o=0;o<l;o++){var d=8*o;u[3*o+0]=t[d+0],u[3*o+1]=t[d+1],u[3*o+2]=t[d+2],c[3*o+0]=t[d+5],c[3*o+1]=t[d+6],c[3*o+2]=t[d+7],h[2*o+0]=t[d+3],h[2*o+1]=t[d+4]}a=r.getParameter(r.ARRAY_BUFFER_BINDING),s=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,s),r.bufferData(r.ARRAY_BUFFER,u,r.STATIC_DRAW),s.componentType=r.FLOAT,s.componentsPerAttribute=3,this.resourceManager.setResource(n.semantics.POSITION.id,s),n.semantics.POSITION={id:n.semantics.POSITION.id,count:l,byteStride:12},s=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,s),r.bufferData(r.ARRAY_BUFFER,c,r.STATIC_DRAW),s.componentType=r.FLOAT,s.componentsPerAttribute=3,this.resourceManager.setResource(n.semantics.NORMAL.id,s),n.semantics.NORMAL={id:n.semantics.NORMAL.id,count:l,byteStride:12},s=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,s),r.bufferData(r.ARRAY_BUFFER,h,r.STATIC_DRAW),s.componentType=r.FLOAT,s.componentsPerAttribute=2,this.resourceManager.setResource(n.semantics.TEXCOORD_0.id,s),n.semantics.TEXCOORD_0={id:n.semantics.TEXCOORD_0.id,count:l,byteStride:8},r.bindBuffer(r.ARRAY_BUFFER,a)}},setupCompressedMesh2:{value:function(e,t,i,n,r,a){var s=e.primitives[0],o=this.webGLContext,l=o.getParameter(o.ELEMENT_ARRAY_BUFFER_BINDING),u=o.createBuffer();o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,u),o.bufferData(o.ELEMENT_ARRAY_BUFFER,a,o.STATIC_DRAW),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,l),u.count=a.length,this.resourceManager.setResource(s.indices.id,u),s.indices={id:s.indices.id,count:u.count};var c=t;i=new Float32Array(i,0,3*c),n=new Float32Array(n,0,3*c),r=new Float32Array(r,0,2*c),l=o.getParameter(o.ARRAY_BUFFER_BINDING),u=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,i,o.STATIC_DRAW),u.componentType=o.FLOAT,u.componentsPerAttribute=3,this.resourceManager.setResource(s.semantics.POSITION.id,u),s.semantics.POSITION={id:s.semantics.POSITION.id,count:c,byteStride:12},u=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,n,o.STATIC_DRAW),u.componentType=o.FLOAT,u.componentsPerAttribute=3,this.resourceManager.setResource(s.semantics.NORMAL.id,u),s.semantics.NORMAL={id:s.semantics.NORMAL.id,count:c,byteStride:12},u=o.createBuffer(),o.bindBuffer(o.ARRAY_BUFFER,u),o.bufferData(o.ARRAY_BUFFER,r,o.STATIC_DRAW),u.componentType=o.FLOAT,u.componentsPerAttribute=2,this.resourceManager.setResource(s.semantics.TEXCOORD_0.id,u),s.semantics.TEXCOORD_0={id:s.semantics.TEXCOORD_0.id,count:c,byteStride:8},o.bindBuffer(o.ARRAY_BUFFER,l)}},vertexAttributeBufferDelegate:{
value:{_componentTypeForGLType:function(e,t){switch(t){case"FLOAT":case"FLOAT_VEC2":case"FLOAT_VEC3":case"FLOAT_VEC4":return e.FLOAT;case"UNSIGNED_BYTE":return e.UNSIGNED_BYTE;case"UNSIGNED_SHORT":return e.UNSIGNED_SHORT;default:return null}},_componentsPerElementForGLType:function(e){switch(e){case"FLOAT":case"UNSIGNED_BYTE":case"UNSIGNED_SHORT":return 1;case"FLOAT_VEC2":return 2;case"FLOAT_VEC3":return 3;case"FLOAT_VEC4":return 4;default:return null}},webGLContext:{value:null,writable:!0},handleError:function(e,t){console.log("ERROR:vertexAttributeBufferDelegate:"+e+" :"+t)},convert:function(e,t){var i=t,n=this.webGLContext,r=n.getParameter(n.ARRAY_BUFFER_BINDING),a=n.createBuffer();return n.bindBuffer(n.ARRAY_BUFFER,a),n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW),a.componentType=this._componentTypeForGLType(n,i.type),a.componentsPerAttribute=this._componentsPerElementForGLType(i.type),n.bindBuffer(n.ARRAY_BUFFER,r),a},resourceAvailable:function(e,t){}}},textureDelegate:{value:{webGLContext:{value:null,writable:!0},getGLFilter:function(e){var t=this.webGLContext,i=t.LINEAR;return"LINEAR"===e?i=t.LINEAR:"NEAREST"===e?i=t.NEAREST:"NEAREST_MIPMAP_NEAREST"===e?i=t.NEAREST_MIPMAP_NEAREST:"LINEAR_MIPMAP_NEAREST"===e?i=t.LINEAR_MIPMAP_NEAREST:"NEAREST_MIPMAP_LINEAR"===e?i=t.NEAREST_MIPMAP_LINEAR:"LINEAR_MIPMAP_LINEAR"===e&&(i=t.LINEAR_MIPMAP_LINEAR),i},getGLWrapMode:function(e){var t=this.webGLContext,i=t.REPEAT;return"REPEAT"===e?i=t.REPEAT:"CLAMP_TO_EDGE"===e?i=t.CLAMP_TO_EDGE:"MIRROR_REPEAT"===e&&(i=t.MIRROR_REPEAT),i},handleError:function(e,t){console.log("ERROR:textureDelegate:"+e+" :"+t)},nextHighestPowerOfTwo:function(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1},isPowerOfTwo:function(e){return 0==(e&e-1)},installCubemapSide:function(e,t,i,n){var e=this.webGLContext;e.bindTexture(e.TEXTURE_CUBE_MAP,i),e.texImage2D(t,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},createTextureFromImageAndSampler:function(e,t){var i=this.webGLContext,n=null,r=this.getGLFilter(t.minFilter),a=this.getGLFilter(t.magFilter),s=this.getGLWrapMode(t.wrapS),o=this.getGLWrapMode(t.wrapT),l=!1,u=r===i.NEAREST_MIPMAP_NEAREST||r===i.LINEAR_MIPMAP_NEAREST||r===i.NEAREST_MIPMAP_LINEAR||r===i.LINEAR_MIPMAP_LINEAR;if(u||s===i.REPEAT||o===i.REPEAT){var c=parseInt(e.width),h=parseInt(e.height);if(this.isPowerOfTwo(c)||(c=this.nextHighestPowerOfTwo(c),l=!0),this.isPowerOfTwo(h)||(h=this.nextHighestPowerOfTwo(h),l=!0),l){n=document.createElement("canvas"),n.width=c,n.height=h;var d=n.getContext("2d");d.drawImage(e,0,0,parseInt(n.width),parseInt(n.height)),n.id=e.id,e=n}}var m=i.createTexture();return i.bindTexture(i.TEXTURE_2D,m),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,s),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,o),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,a),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e),u&&i.generateMipmap(i.TEXTURE_2D),i.bindTexture(i.TEXTURE_2D,null),m},convert:function(e,t){var i=this.webGLContext;if(e.sources){if(6===e.sources.length){var n=i.createTexture();return i.bindTexture(i.TEXTURE_CUBE_MAP,n),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),this.installCubemapSide(i,i.TEXTURE_CUBE_MAP_POSITIVE_X,n,t[0]),this.installCubemapSide(i,i.TEXTURE_CUBE_MAP_NEGATIVE_X,n,t[1]),this.installCubemapSide(i,i.TEXTURE_CUBE_MAP_POSITIVE_Y,n,t[2]),this.installCubemapSide(i,i.TEXTURE_CUBE_MAP_NEGATIVE_Y,n,t[3]),this.installCubemapSide(i,i.TEXTURE_CUBE_MAP_POSITIVE_Z,n,t[4]),this.installCubemapSide(i,i.TEXTURE_CUBE_MAP_NEGATIVE_Z,n,t[5]),n}}else if("video"==e.source.type){e.source.videoElement=t;var r=i.createTexture();return i.bindTexture(i.TEXTURE_2D,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e.source.videoElement),i.bindTexture(i.TEXTURE_2D,null),r}return this.createTextureFromImageAndSampler(t,e.sampler)},resourceAvailable:function(e,t){}}},_lastMaxEnabledArray:{value:0,writable:!0},_states:{value:null,writable:!0},setState:{value:function(e,t,i){var n=this.webGLContext;null!=this._states[e]&&1!=i&&this._states[e]===t||(this._states[e]=t,t?n.enable(e):n.disable(e))}},resetStates:{value:function(){var e=this.webGLContext;if(e&&this._lastMaxEnabledArray!==-1)for(var t=0;t<this._lastMaxEnabledArray;t++)e.disableVertexAttribArray(t);this._lastMaxEnabledArray=-1,this.bindedProgram=null,this.setState(e.BLEND,!1)}},renderPrimitive:{value:function(e,t,i,n){var r,a=!1,s=null,o=e.primitive,l=-1,u=this.webGLContext,c=this.bindedProgram,h=0;n||(n=o.material.parameters);var d=c.uniformSymbols;for(r=0;r<d.length;r++){var m=d[r],p=t.instanceProgram.uniforms[m];if(s=null,p=n[p],p&&null!=p.semantic){var g=p.semantic;s=g===this.PROJECTION?this.projectionMatrix:g===this.WORLDVIEW?e.nodeWrapper.worldViewMatrix:e.nodeWrapper.worldViewInverseTransposeMatrix}if(null==s&&null!=p)if(p.source){var f=e.nodeWrapper.scenePassRenderer._nodeWrappers[p.source.id];s=f.worldViewMatrix}else s=p.value;var v=null;if(null!=s){var _=c.getTypeForSymbol(m),b=_===u.SAMPLER_CUBE,w=_===u.SAMPLER_2D;if(b){v=s,this.textureDelegate.webGLContext=this.webGLContext;var v=this.resourceManager.getResource(v,this.textureDelegate,this.webGLContext);if(v){u.activeTexture(u.TEXTURE0+h),u.bindTexture(u.TEXTURE_CUBE_MAP,v);var y=c.getLocationForSymbol(m);"undefined"!=typeof y&&(c.setValueForSymbol(m,h),h++)}}else if(w){v=s,this.textureDelegate.webGLContext=this.webGLContext;var v=this.resourceManager.getResource(v,this.textureDelegate,this.webGLContext);if(v){u.activeTexture(u.TEXTURE0+h),u.bindTexture(u.TEXTURE_2D,v),p.value.source.videoElement&&p.value.source.timeStamp!=i&&(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,p.value.source.videoElement),p.value.source.timeStamp=i);var y=c.getLocationForSymbol(m);"undefined"!=typeof y&&(c.setValueForSymbol(m,h),h++)}if(null==v)return}else c.setValueForSymbol(m,s)}}c.commit(u);var E=0;this.vertexAttributeBufferDelegate.webGLContext=this.webGLContext;var C=t.instanceProgram.attributes,x=c.attributeSymbols;for(r=0;r<x.length;r++){var m=x[r],p=C[m];p=n[p];var g=p.semantic,T=o.semantics[g];if(null!=T){var S=null;if(S=e.compressed?this.resourceManager._getResource(T.id):this.resourceManager.getResource(T,this.vertexAttributeBufferDelegate,T)){u.bindBuffer(u.ARRAY_BUFFER,S);var P=c.getLocationForSymbol(m);"undefined"!=typeof P&&(P>l&&(l=P),u.enableVertexAttribArray(P),u.vertexAttribPointer(P,S.componentsPerAttribute,S.componentType,!1,T.byteStride,0),a&&"POSITION"==g&&u.drawArrays(u.POINTS,0,T.count)),E++}else this._lastMaxEnabledArray=-1}}var A=E===x.length;if(!a){if(A)for(var r=l+1;r<this._lastMaxEnabledArray;r++)u.disableVertexAttribArray(r);var R=null;this.indicesDelegate.webGLContext=this.webGLContext,R=e.compressed?this.resourceManager._getResource(o.indices.id):this.resourceManager.getResource(o.indices,this.indicesDelegate,o),R&&A&&(u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,R),u.drawElements(u.TRIANGLES,o.indices.count,u.UNSIGNED_SHORT,0))}return this._lastMaxEnabledArray=l,A}},programDelegate:{value:{handleError:function(e,t){console.log("ERROR:programDelegate:"+e+" :"+t)},convert:function(e,t){var i=t,r=Object.create(n);return r.initWithShaders(e),r.build(i)||(console.log(e),console.log(r.errorLogs)),r},resourceAvailable:function(e,t){}}},bindRenderTarget:{value:function(e){var t=this.webGLContext,i=!e.FBO;e.previousFBO=t.getParameter(t.FRAMEBUFFER_BINDING),e.FBO||(e.FBO=t.createFramebuffer(),i=!0),t.bindFramebuffer(t.FRAMEBUFFER,e.FBO);var n=e.extras,r=t.drawingBufferWidth!=e.width||t.drawingBufferHeight!=e.height,a=t.drawingBufferWidth,s=t.drawingBufferHeight;(i||r)&&e.attachments.forEach(function(e){if("COLOR_ATTACHMENT0"==e.semantic&&n.picking){var o=t.getParameter(t.TEXTURE_BINDING_2D);i&&(n.pickingTexture=t.createTexture()),r&&(t.bindTexture(t.TEXTURE_2D,n.pickingTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,a,s,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),i&&t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n.pickingTexture,0),t.bindTexture(t.TEXTURE_2D,o)}if("DEPTH_ATTACHMENT"==e.semantic&&n.picking){var l=t.getParameter(t.RENDERBUFFER_BINDING);i&&(n.pickingRenderBuffer=t.createRenderbuffer()),r&&(t.bindRenderbuffer(t.RENDERBUFFER,n.pickingRenderBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,a,s)),i&&t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,n.pickingRenderBuffer),t.bindRenderbuffer(t.RENDERBUFFER,l)}},this),t.clearColor(0,0,0,1),t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT)}},unbindRenderTarget:{value:function(e){var t=this.webGLContext;e.extras.picking&&(e.extras.pickedPixel||(e.extras.pickedPixel=new Uint8Array(4)),t.finish(),t.readPixels(e.extras.coords[0],e.extras.coords[1],1,1,t.RGBA,t.UNSIGNED_BYTE,e.extras.pickedPixel)),t.bindFramebuffer(t.FRAMEBUFFER,e.previousFBO);var i=!1;i&&e.attachments.forEach(function(t){"COLOR_ATTACHMENT0"===t.semantic&&e.extras.picking&&this.drawTexture(e.extras.pickingTexture)},this)}},renderPrimitivesWithPass:{value:function(e,t,i,n){var r=e.length,a=this.webGLContext;if(t.instanceProgram){var s=a,o=this.resourceManager.getResource(t.instanceProgram.program,this.programDelegate,s);if(o){var l=!1,u=!0,c=!0,h=!0,d=t.states,m=a.FUNC_ADD,p=a.SRC_ALPHA,g=a.ONE_MINUS_SRC_ALPHA,f="__PickingPass"===t.id;if(d&&(d.blendEnable===!0&&(l=!0),d.depthTestEnable===!1&&(u=!1),d.depthMask===!1&&(c=!1),d.cullFaceEnable===!1&&(h=!1),d.blendEquation)){var v=d.blendFunc;v&&(v.sfactor&&(p=this._GLEnumFromString[v.sfactor]),v.dfactor&&(g=this._GLEnumFromString[v.dfactor]))}if(this.setState(a.CULL_FACE,h),this.setState(a.BLEND,l),l&&(a.blendEquation(m),a.blendFunc(p,g)),this.bindedProgram=o,f)for(var _=0;_<r;_++){var b=e[_];if(!b.node.hidden){if(!b.pickingColor){var w=b.node.id;if(w){var y=t.extras.nodeIDToColor[w];y||(y=vec4.createFrom(Math.random(),Math.random(),Math.random(),1),t.extras.nodeIDToColor[w]=y),b.pickingColor=y}}this.bindedProgram.setValueForSymbol("u_pickingColor",b.pickingColor),this.renderPrimitive(b,t,n,i)}}else for(var _=0;_<r;_++){var b=e[_];if(!b.node.hidden){var E=1;i=b.primitive.material.parameters;var C=i.transparency;C&&null!=C.value&&(E*=C.value);var x=i.filterColor;x&&null!=x.value&&(E*=x.value[3]),E<1e-5||(E<1&&!l?(this.setState(a.BLEND,!0),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),this.renderPrimitive(b,t,n),this.setState(a.BLEND,!1)):this.renderPrimitive(b,t,n))}}}}}},drawTexture:{value:function(e){var t=this.webGLContext,i=t.isEnabled(t.DEPTH_TEST),r=t.isEnabled(t.CULL_FACE),a=t.isEnabled(t.BLEND);if(this.setState(t.DEPTH_TEST,!1),this.setState(t.CULL_FACE,!1),this.setState(t.BLEND,!1),!this.displayTexture){this.displayTexture={},this.displayTexture.program=Object.create(n);var s="precision highp float;attribute vec3 vert;attribute vec2 uv;uniform mat4 u_projMatrix; varying vec2 v_uv;void main(void) { v_uv = uv;gl_Position = u_projMatrix * vec4(vert,1.0); }",o="precision highp float;uniform sampler2D u_texture;varying vec2 v_uv; void main(void) {  vec4 color = texture2D(u_texture, v_uv);  gl_FragColor = color; }";this.displayTexture.program.initWithShaders({"x-shader/x-vertex":s,"x-shader/x-fragment":o}),this.displayTexture.program.build(t)||console.log(this.displayTexture.program.errorLogs);var l=[-1,-1,0,0,0,1,-1,0,1,0,-1,1,0,0,1,-1,1,0,0,1,1,-1,0,1,0,1,1,0,1,1];this.displayTexture.vertexBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.displayTexture.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(l),t.STATIC_DRAW)}var u=this.displayTexture.program,c=this.displayTexture.vertexBuffer;t.bindBuffer(t.ARRAY_BUFFER,c);var h=mat4.ortho(-1,1,-1,1,0,1e3),d=u.getLocationForSymbol("vert"),m="undefined"!=typeof d;m&&(t.enableVertexAttribArray(d),t.vertexAttribPointer(d,3,t.FLOAT,!1,20,0));var p=u.getLocationForSymbol("uv"),g="undefined"!=typeof p;g&&(t.enableVertexAttribArray(p),t.vertexAttribPointer(p,2,t.FLOAT,!1,20,12));var f=t.getParameter(t.TEXTURE_BINDING_2D);t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e),this.bindedProgram=u;var v=u.getLocationForSymbol("u_projMatrix");v&&u.setValueForSymbol("u_projMatrix",h);var _=u.getLocationForSymbol("u_texture");_&&u.setValueForSymbol("u_texture",0),u.commit(t),t.drawArrays(t.TRIANGLES,0,6),t.bindTexture(t.TEXTURE_2D,f),m&&t.disableVertexAttribArray(d),g&&t.disableVertexAttribArray(p),this.setState(t.DEPTH_TEST,i),this.setState(t.CULL_FACE,r),this.setState(t.BLEND,a)}}})}}),montageDefine("b0111a3","ui/flow.reel/flow",{dependencies:["../component","frb/observers","./flow-bezier-spline","../../core/range-controller"],factory:function(e,t,i){var n=e("../component").Component,r=e("frb/observers").observeProperty,a=e("./flow-bezier-spline").FlowBezierSpline,s=e("../../core/range-controller").RangeController;t.Flow=n.specialize({constructor:{value:function(){this._paths=[],this._visibleIndexes=[],this._needsClearVisibleIndexes=!0,this._slideOffsets={},this.defineBinding("_numberOfIterations",{"<-":"contentController.content.length"}),this.addOwnPropertyChangeListener("_numberOfIterations",this),window.addEventListener("resize",this,!1),this._newVisibleIndexes=[]}},slotContent:{serializable:!0,value:null},__flowTranslateComposer:{value:null},_flowTranslateComposer:{get:function(){return this.__flowTranslateComposer},set:function(e){this.__flowTranslateComposer&&(this.__flowTranslateComposer.removeEventListener("translateStart",this,!1),this.__flowTranslateComposer.removeEventListener("translateEnd",this,!1)),this.__flowTranslateComposer=e,this.__flowTranslateComposer.addEventListener("translateStart",this,!1),this.__flowTranslateComposer.addEventListener("translateEnd",this,!1)}},__firstIteration:{value:null},_firstIteration:{get:function(){return this.__firstIteration},set:function(e){this.__firstIteration=e,this.needsDraw=!0}},handleTranslateStart:{value:function(){this.callDelegateMethod("didTranslateStart",this)}},handleTranslateEnd:{value:function(){this.callDelegateMethod("didTranslateEnd",this)}},_scrollingMode:{value:"linear"},_transform:{value:null},_transformCss:{value:null},_transformPerspective:{value:null},scrollingMode:{serializable:!0,get:function(){return this._scrollingMode},set:function(e){switch(e){case"linear":case"drag":this._scrollingMode=e}}},_linearScrollingVector:{value:[-300,0]},linearScrollingVector:{seriazable:!0,get:function(){return this._linearScrollingVector},set:function(e){this._linearScrollingVector=e}},_repetition:{value:null},momentumDuration:{serializable:!0,value:650},_splinePaths:{value:null},splinePaths:{enumerable:!1,get:function(){return this._splinePaths||(this._splinePaths=[]),this._splinePaths},set:function(e){this._splinePaths=e}},_appendPath:{value:function(e){var t,i,n,r,s,o=new a,l=e.knots,u=e.knots.length,c=[],h=[],d=[],m=[],p=e.units,g=p?Object.keys(p):void 0;if(o._parameterKeys=g,n=o.parameters={},g)for(t=0;r=g[t];t++)n[r]={data:[],units:p[r]};for(t=0;t<u;t++){s=l[t],c[t]=s.knotPosition,d[t]=s.previousHandlerPosition,h[t]=s.nextHandlerPosition,m[t]=s.previousDensity;for(i in p)n[i].data.push(s[i])}o.knots=c,o.previousHandlers=d,o.nextHandlers=h,o.densities=m,o._computeDensitySummation(),this.splinePaths.push(o),e.hasOwnProperty("headOffset")||(e.headOffset=0),e.hasOwnProperty("tailOffset")||(e.tailOffset=0),this._paths.push(e),this._updateLength()}},_paths:{value:null},paths:{get:function(){var e,t,i,n,r,a,s,o,l=(this.splinePaths.length,[]);for(r=0;o=this.splinePaths[r];r++){for(t=o.knots.length,e={knots:[],units:{}},a=0;a<t;a++)n={knotPosition:o.knots[a]},o.nextHandlers&&o.nextHandlers[a]&&(n.nextHandlerPosition=o.nextHandlers[a]),o.previousHandlers&&o.previousHandlers[a]&&(n.previousHandlerPosition=o.previousHandlers[a]),o.densities&&o.densities[a]&&(n.previousDensity=o.densities[a],n.nextDensity=o.densities[a]),e.knots.push(n);for(a in o.parameters)for(e.units[a]=o.parameters[a].units,i=o.parameters[a].data.length,s=0;s<i;s++)e.knots[s][a]=o.parameters[a].data[s];this._paths[r].hasOwnProperty("headOffset")?e.headOffset=this._paths[r].headOffset:e.headOffset=0,this._paths[r].hasOwnProperty("tailOffset")?e.tailOffset=this._paths[r].tailOffset:e.tailOffset=0,l.push(e)}return l},set:function(e){var t,i=e.length;for(this._splinePaths=[],this._paths=[],t=0;t<i;t++)this._appendPath(e[t]);this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_isCameraEnabled:{value:!0},isCameraEnabled:{get:function(){return this._isCameraEnabled},set:function(e){var t=!!e;this._isCameraEnabled!==t&&(this._isCameraEnabled=t,this._isCameraUpdated=!0,this._needsComputeVisibleRange=!0,this.needsDraw=!0)}},_perspective:{value:500},perspective:{get:function(){return this._perspective},set:function(e){var t=parseFloat(e);isNaN(t)||this._perspective===t||(this._perspective=t,this._isCameraUpdated=!0,this._needsComputeVisibleRange=!0,this.needsDraw=!0)}},_cameraElement:{value:null},_cameraPosition:{value:[0,0,800]},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){this._cameraPosition=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_viewpointPosition:{get:function(){return this._isCameraEnabled?this.cameraPosition:[.01*(50-this._sceneOffsetLeft)*this._width,.01*(50-this._sceneOffsetTop)*this._height,this._perspective]}},_cameraTargetPoint:{value:[0,0,0]},cameraTargetPoint:{get:function(){return this._cameraTargetPoint},set:function(e){this._cameraTargetPoint=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_viewpointTargetPoint:{get:function(){return this._isCameraEnabled?this.cameraTargetPoint:[.01*(50-this._sceneOffsetLeft)*this._width,.01*(50-this._sceneOffsetTop)*this._height,0]}},_cameraFov:{value:50},cameraFov:{get:function(){return this._cameraFov},set:function(e){this._cameraFov=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_viewpointFov:{get:function(){return this._isCameraEnabled?this.cameraFov:360*(Math.PI/2-Math.atan2(this._perspective,this._height/2))/Math.PI}},_cameraRoll:{value:0},cameraRoll:{get:function(){return this._cameraRoll},set:function(e){this._cameraRoll=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_sceneOffsetTop:{value:50},sceneOffsetTop:{get:function(){return this._sceneOffsetTop},set:function(e){this._sceneOffsetTop=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_sceneOffsetLeft:{value:50},sceneOffsetLeft:{get:function(){return this._sceneOffsetLeft},set:function(e){this._sceneOffsetLeft=e,this._isCameraUpdated=!0,this.needsDraw=!0,this._needsComputeVisibleRange=!0}},_sceneScaleX:{value:{numerator:1,denominator:1}},_sceneScaleY:{value:{numerator:1,denominator:1}},_sceneScaleZ:{value:{numerator:1,denominator:1}},_sceneScale:{value:{x:{numerator:1,denominator:1},y:{numerator:1,denominator:1},z:{numerator:1,denominator:1}}},_updateSceneScale:{value:function(){this._sceneScale={x:this._sceneScaleX,y:this._sceneScaleY,z:this._sceneScaleZ}}},sceneScaleX:{get:function(){return this._sceneScaleX},set:function(e){"object"!=typeof e||"undefined"==typeof e.numerator||"undefined"==typeof e.denominator||isNaN(e.numerator)||isNaN(e.denominator)||0==e.denominator||(this._sceneScaleX=e,this._updateSceneScale(),this.needsDraw=!0,this._needsComputeVisibleRange=!0)}},sceneScaleY:{get:function(){return this._sceneScaleY},set:function(e){"object"!=typeof e||"undefined"==typeof e.numerator||"undefined"==typeof e.denominator||isNaN(e.numerator)||isNaN(e.denominator)||0==e.denominator||(this._sceneScaleY=e,this._updateSceneScale(),this.needsDraw=!0,this._needsComputeVisibleRange=!0)}},sceneScaleZ:{get:function(){return this._sceneScaleZ},set:function(e){"object"!=typeof e||"undefined"==typeof e.numerator||"undefined"==typeof e.denominator||isNaN(e.numerator)||isNaN(e.denominator)||0==e.denominator||(this._sceneScaleZ=e,this._updateSceneScale(),this.needsDraw=!0,this._needsComputeVisibleRange=!0)}},_stride:{value:0},stride:{get:function(){return this._stride},set:function(e){this._stride=e}},_scrollingTransitionDurationMiliseconds:{value:500},_scrollingTransitionDuration:{value:"500ms"},scrollingTransitionDuration:{get:function(){return this._scrollingTransitionDuration},set:function(e){var t,i,n=e+"";n.length,(i=/^(\d+)ms$/.exec(n))?t=+i[1]:(i=/^(\d+)s$/.exec(n))?t=1e3*+i[1]:(t=+n,n+="ms"),isNaN(t)||this._scrollingTransitionDurationMiliseconds===t||(this._scrollingTransitionDurationMiliseconds=t,this._scrollingTransitionDuration=n)}},hasSelectedIndexScrolling:{value:!1},selectedIndexScrollingOffset:{value:0},_handleSelectedIndexesChange:{value:function(e,t,i){this.hasSelectedIndexScrolling&&e[0]&&this.startScrollingIndexToOffset(Math.floor(this.contentController.content.indexOf(e[0].object)/this._paths.length),this.selectedIndexScrollingOffset)}},_timingFunctions:{value:{ease:[.25,.1,.25,1],linear:[0,0,1,1],"ease-in":[.42,0,1,1],"ease-out":[0,0,.58,1],"ease-in-out":[.42,0,.58,1]}},_scrollingTransitionTimingFunctionBezier:{value:[.25,.1,.25,1]},_scrollingTransitionTimingFunction:{value:"ease"},scrollingTransitionTimingFunction:{get:function(){return this._scrollingTransitionTimingFunction},set:function(e){var t,i,n=e+"";if(this._timingFunctions.hasOwnProperty(n))this._scrollingTransitionTimingFunction=n,this._scrollingTransitionTimingFunctionBezier=this._timingFunctions[n];else if("cubic-bezier("===n.substr(0,13)&&")"===n.substr(n.length-1,1)&&(t=n.substr(13,n.length-14).split(","),4===t.length)){for(i=0;i<4;i++)if(t[i]-=0,isNaN(t[i]))return;t[0]<0?t[0]=0:t[0]>1&&(t[0]=1),t[2]<0?t[2]=0:t[2]>1&&(t[2]=1),this._scrollingTransitionTimingFunction="cubic-bezier("+t+")",this._scrollingTransitionTimingFunctionBezier=t}}},_computeCssCubicBezierValue:{value:function(e,t){var i,n,r,a=.5,s=.25;for(r=0;r<20;r++)i=a*a,n=1-a,3*(n*n*a*t[0]+n*i*t[2])+i*a>e?a-=s:a+=s,s*=.5;return i=a*a,n=1-a,3*(n*n*a*t[1]+n*i*t[3])+i*a}},_isTransitioningScroll:{value:!1},stopScrolling:{value:function(){this._isTransitioningScroll=!1}},startScrollingIndexToOffset:{value:function(e,t){this._scrollingOrigin=this.scroll,this._scrollingDestination=e-t,this._scrollingDestination>this._length?this._scrollingDestination=this._length:this._scrollingDestination<0&&(this._scrollingDestination=0),this._isScrolling=!0,this._scrollingStartTime=Date.now(),this._isTransitioningScroll=!0,this.needsDraw=!0,this.callDelegateMethod("didTranslateStart",this)}},_isCameraUpdated:{value:!0},_width:{value:0},_height:{value:0},_boundingBoxSize:{value:null},boundingBoxSize:{serializable:!0,get:function(){return this._boundingBoxSize},set:function(e){this._boundingBoxSize=e,this.elementsBoundingSphereRadius=.5*Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),this._needsComputeVisibleRange=!0}},_elementsBoundingSphereRadius:{value:1},elementsBoundingSphereRadius:{get:function(){return this._elementsBoundingSphereRadius},set:function(e){this._elementsBoundingSphereRadius!==e&&(this._elementsBoundingSphereRadius=e,this.needsDraw=!0,this._needsComputeVisibleRange=!0)}},_halfPI:{value:.5*Math.PI},_doublePI:{value:2*Math.PI},_computeFrustumNormals:{value:function(){var e,t,i,n,r,a,s,o,l,u=.5*this._viewpointFov*this._doublePI/360,c=Math.sin(u),h=Math.cos(u),d=c*this._width/this._height,m=this._viewpointPosition,p=this._viewpointTargetPoint,g=p[0]-m[0],f=p[1]-m[1],v=p[2]-m[2],_=this._halfPI-Math.atan2(v,g),b=g*Math.sin(_)+v*Math.cos(_),w=this._halfPI-Math.atan2(b,f),y=[[h,0,d],[-h,0,d],[0,h,c],[0,-h,c]],E=[];for(l=0;l<4;l++)o=y[l],e=o[0],t=o[1]*Math.cos(-w)-o[2]*Math.sin(-w),i=o[1]*Math.sin(-w)+o[2]*Math.cos(-w),n=e*Math.cos(-_)-i*Math.sin(-_),r=t,a=e*Math.sin(-_)+i*Math.cos(-_),s=1/Math.sqrt(n*n+r*r+a*a),E.push([n*s,r*s,a*s]);return E}},_segmentsIntersection:{value:function(e,t){for(var i,n,r=0,a=0,s=[];r<e.length&&a<t.length;)e[r][0]>=t[a][1]?a++:e[r][1]<=t[a][0]?r++:(i=e[r][0]>=t[a][0]?e[r][0]:t[a][0],n=e[r][1]<=t[a][1]?e[r][1]:t[a][1],s.push([i,n]),e[r][1]<t[a][1]?r++:e[r][1]>t[a][1]?a++:(r++,a++));return s}},_computeVisibleRange:{value:function(e){var t,i,n,r,a=e._knots.length-1,s=this._viewpointPosition,o=s[0],l=s[1],u=s[2],c=this._computeFrustumNormals(),h=[],d=[],m=[],p=this._elementsBoundingSphereRadius,g=e.getScaledKnots(this._sceneScale),f=e.getScaledNextHandlers(this._sceneScale),v=e.getScaledPreviousHandlers(this._sceneScale),_=[];for(n=0;n<a;n++)if(t=c[0],h=e.directedPlaneBezierIntersection(o-t[0]*p,l-t[1]*p,u-t[2]*p,c[0],g[n],f[n],v[n+1],g[n+1]),h.length&&(t=c[1],d=e.directedPlaneBezierIntersection(o-t[0]*p,l-t[1]*p,u-t[2]*p,c[1],g[n],f[n],v[n+1],g[n+1]),d.length&&(i=this._segmentsIntersection(h,d),i.length&&(t=c[2],h=e.directedPlaneBezierIntersection(o-t[0]*p,l-t[1]*p,u-t[2]*p,c[2],g[n],f[n],v[n+1],g[n+1]),i=this._segmentsIntersection(h,i),i.length))))for(t=c[3],h=e.directedPlaneBezierIntersection(o-t[0]*p,l-t[1]*p,u-t[2]*p,c[3],g[n],f[n],v[n+1],g[n+1]),i=this._segmentsIntersection(h,i),r=0;r<i.length;r++)m.push([n,i[r][0],i[r][1]]);var b,w,y,E,C,x,T,S=e._densities;for(n=0;n<m.length;n++)b=S[m[n][0]],w=S[m[n][0]+1],y=m[n][0]?e._densitySummation[m[n][0]-1]:0,E=m[n][1],C=m[n][2],x=(w-b)*E*E*.5+E*b+y,T=(w-b)*C*C*.5+C*b+y,_.push([x,T]);return _}},_determineCssPrefixedProperties:{value:function(){"webkitTransform"in this.element.style?(this._transform="webkitTransform",this._transformCss="-webkit-transform",this._transformPerspective="webkitPerspective"):"MozTransform"in this.element.style?(this._transform="MozTransform",this._transformCss="-moz-transform",this._transformPerspective="MozPerspective"):"msTransform"in this.element.style?(this._transform="msTransform",this._transformCss="-ms-transform",this._transformPerspective="msPerspective"):(this._transform="transform",this._transformPerspective="perspective")}},_isListeningToResize:{value:!0},isListeningToResize:{get:function(){return this._isListeningToResize},set:function(e){var t=!!e;this._isListeningToResize!==t&&(this._isListeningToResize=t,this._isListeningToResize?window.addEventListener("resize",this,!1):window.removeEventListener("resize",this,!1))}},_needsClearVisibleIndexes:{value:!1},handleResize:{value:function(){this._isCameraUpdated=!0,this._needsComputeVisibleRange=!0,this.needsDraw=!0,this._needsClearVisibleIndexes=!0}},enterDocument:{value:function(e){e&&(this._determineCssPrefixedProperties(),this._repetition.addRangeAtPathChangeListener("selectedIterations",this,"_handleSelectedIndexesChange"))}},_updateVisibleIndexes:{value:function(e,t){var i,n,r,a=this._visibleIndexes,s=a&&!isNaN(a.length)?a.length:0;for(this._needsClearVisibleIndexes&&(this._visibleIndexes.splice(e.length,1/0),this._needsClearVisibleIndexes=!1),r=0;r<s;r++)"number"==typeof t[a[r]]?e[t[a[r]]]=null:(i||(i=[])).push(r);if(i)for(r=n=0;n<i.length&&r<e.length;r++)null!==e[r]&&(a.set(i[n],e[r]),n++);for(n=s;r<e.length;r++)null!==e[r]&&(a.set(n,e[r]),n++)}},_needsComputeVisibleRange:{value:!0},_previousVisibleRanges:{value:null},viewportWidth:{get:function(){return this._width},set:function(e){this._width!==e&&(this._width=e,this._needsComputeVisibleRange=!0)}},viewportHeight:{get:function(){return this._height},set:function(e){this._height!==e&&(this._height=e,this._needsComputeVisibleRange=!0)}},_firstIterationWidth:{value:1},_firstIterationHeight:{value:1},firstIterationWidth:{get:function(){return this._firstIterationWidth},set:function(e){e!==this._firstIterationWidth&&(this._firstIterationWidth=e,this._needsComputeVisibleRange=!0,this._needsClearVisibleIndexes=!0)}},firstIterationHeight:{get:function(){return this._firstIterationHeight},set:function(e){e!==this._firstIterationHeight&&(this._firstIterationHeight=e,this._needsComputeVisibleRange=!0,this._needsClearVisibleIndexes=!0)}},_firstIterationOffsetLeft:{value:0},_firstIterationOffsetTop:{value:0},willDraw:{value:function(e){var t,i,n,r,a,s,o,l,u,c,h,d,m=this._newVisibleIndexes,p={},g=this._paths,f=g.length,v=this.splinePaths;if(this.viewportWidth=this._element.clientWidth,this.viewportHeight=this._element.clientHeight,this.__firstIteration){var _=this.__firstIteration.firstElement.children[0];if(0!==_.offsetWidth&&0!==_.offsetHeight&&(this.firstIterationWidth=_.offsetWidth,this.firstIterationHeight=_.offsetHeight,this._firstIterationOffsetLeft=_.offsetLeft,this._firstIterationOffsetTop=_.offsetTop,!this._boundingBoxSize)){var b=Math.max(Math.abs(this._firstIterationWidth+this._firstIterationOffsetLeft),Math.abs(this._firstIterationOffsetLeft)),w=Math.max(Math.abs(this._firstIterationHeight+this._firstIterationOffsetTop),Math.abs(this._firstIterationOffsetTop));this._elementsBoundingSphereRadius=Math.sqrt(b*b+w*w)}}this._isTransitioningScroll&&(h=(Date.now()-this._scrollingStartTime)/this._scrollingTransitionDurationMiliseconds,d=this._computeCssCubicBezierValue(h,this._scrollingTransitionTimingFunctionBezier),h<1?this.scroll=this._scrollingOrigin+(this._scrollingDestination-this._scrollingOrigin)*d:(this.scroll=this._scrollingDestination,this._isTransitioningScroll=!1,this._needsToCallDidTranslateEndDelegate=!0));var y,E,C,x,T,h=e,c=6,S=this.lastDrawTime?.018*(h-this.lastDrawTime)*this._elasticScrollingSpeed:0,P=1-S/c,A=this._minSlideOffsetIndex,R=this._maxSlideOffsetIndex;if(this.lastDrawTime=h,this._hasElasticScrolling)for(a=0;a<c;a++){for(n=this._draggedSlideIndex-1;n>=A;n--)y=this._getSlideOffset(n),E=this._getSlideOffset(n+1),C=(y-E)*P+E,C>0&&(C=0),this._updateSlideOffset(n,C);for(n=this._draggedSlideIndex+1;n<=R;n++)y=this._getSlideOffset(n),E=this._getSlideOffset(n-1),C=(y-E)*P+E,C<0&&(C=0),this._updateSlideOffset(n,C)}if(v.length){for(l=this._numberOfIterations%f,u=(this._numberOfIterations-l)/f,this._needsComputeVisibleRange&&(this._previousVisibleRanges=[]),s=0;s<f;s++)for(c=u+(s<l?1:0),this._needsComputeVisibleRange?(t=this._computeVisibleRange(v[s]),this._previousVisibleRanges[s]=t,v[s]._computeDensitySummation()):t=this._previousVisibleRanges[s],o=this._scroll-g[s].headOffset,n=0,r=t.length;n<r;n++){for(T=c/2,a=T;T>=1;)i=(0|a)*f+s,x=(0|a)+this._getSlideOffset(i)-o,T/=2,x>=t[n][0]?a-=T:a+=T;a=a-1|0,a<0&&(a=0);do i=a*f+s,x=a+this._getSlideOffset(i)-o,x>=t[n][0]&&x<=t[n][1]&&void 0===p[i]&&(p[i]=m.length,m[m.length]=i),a++;while(x<=t[n][1]&&a<c)}this._needsComputeVisibleRange=!1}this._updateVisibleIndexes(m,p),m.length=0}},draw:{value:function(e){var t,i,n,r,a,s,o,l,u,c,h,d=this._repetition._drawnIterations.length,m=this._visibleIndexes,p=this._viewpointPosition,g=this._viewpointTargetPoint,f=this._splinePaths;if(this._isTransitioningScroll&&(this.needsDraw=!0),this._isCameraUpdated){if(this._isCameraEnabled){var v,_,s=Math.tan((90-.5*this._viewpointFov)*this._doublePI/360)*this._height*.5,b=g[0]-p[0],w=g[1]-p[1],y=g[2]-p[2],E=Math.atan2(-b,-y);v=b*-Math.sin(-E)+y*Math.cos(-E),_=Math.atan2(-w,-v),this._element.style[this._transformPerspective]=s+"px",h="translate3d(0,0,",h+=s,h+="px)rotateX(",h+=_,h+="rad)rotateY(",h+=-E,h+="rad)",h+="translate3d(",h+=-p[0],h+="px,",h+=-p[1],h+="px,",h+=-p[2],h+="px)",this._cameraElement.style[this._transform]=h,this._element.classList.remove("camera-disabled")}else this._element.style[this._transformPerspective]=this._perspective+"px",h="translate3d(",h+=.5*this._width-p[0],h+="px, ",h+=.5*this._height-p[1],h+="px,0)",this._cameraElement.style[this._transform]=h,this._element.classList.add("camera-disabled");this._isCameraUpdated=!1}if(f.length)for(t=0;t<d;t++)u=this.offset(m[t]),c=f[u.pathIndex],
o=c._convertSplineTimeToBezierIndexTime(u.slideTime),i=this._repetition._drawnIterations[t],n=i.cachedFirstElement||i.firstElement,null!==o?((r=n.children[0])&&(n.classList.contains("selected")?r.classList.add("selected"):r.classList.remove("selected"),n.classList.contains("active")?r.classList.add("active"):r.classList.remove("active")),a=c.getPositionAtIndexTime(o,this._sceneScale),l=c.getRotationAtIndexTime(o),h=this._transformCss,h+=":translate3d(",h+=1e-5*(1e5*a[0]>>0),h+="px,",h+=1e-5*(1e5*a[1]>>0),h+="px,",h+=1e-5*(1e5*a[2]>>0),h+="px)",h+=l[2]?"rotateZ("+1e-5*(1e5*l[2]>>0)+"rad)":"",h+=l[1]?"rotateY("+1e-5*(1e5*l[1]>>0)+"rad)":"",h+=l[0]?"rotateX("+1e-5*(1e5*l[0]>>0)+"rad)":"",h+=";",h+=c.getStyleAtIndexTime(o),n.setAttribute("style",h)):n.setAttribute("style","display:none");else for(t=0;t<d;t++)i=this._repetition._drawnIterations[t],n=i.cachedFirstElement||i.firstElement,n.setAttribute("style","display:none");this._slideOffsetsLength&&(this.needsDraw=!0),this._needsToCallDidTranslateEndDelegate&&(this._needsToCallDidTranslateEndDelegate=!1,this.callDelegateMethod("didTranslateEnd",this))}},_updateLength:{value:function(){if(this._paths){var e,t,i,n,r,a,s=this._paths.length,o=0;if(s>0){for(r=this._numberOfIterations%s,n=(this._numberOfIterations-r)/s,a=0;a<s;a++)e=this._paths[a],t=n+(a<r?1:0),i=t-e.tailOffset+e.headOffset-1,i>o&&(o=i);this.length=o}this.needsDraw=!0}}},_numberOfIterations:{value:0},handle_numberOfIterationsChange:{value:function(){this._updateLength()}},content:{get:function(){return this.getPath("contentController.content")},set:function(e){this.contentController=(new s).initWithContent(e)}},contentController:{value:null},isSelectionEnabled:{value:null},selectedIndexes:{serializable:!1,value:null},activeIndexes:{serializable:!1,value:null},observeProperty:{value:function(e,t,i){return r(this,e,t,i)}},templateDidLoad:{value:function(){var e=this;this._repetition.willDraw=function(){e.needsDraw=!0}}},_length:{value:0},length:{get:function(){return this._length},set:function(e){e<0?this._length=0:this._length=e}},_scroll:{value:0},_elasticScrollingRange:{value:20},_hasElasticScrolling:{value:!1},hasElasticScrolling:{get:function(){return this._hasElasticScrolling},set:function(e){e?this._hasElasticScrolling=!0:this._hasElasticScrolling=!1}},_slideOffsets:{value:null},_slideOffsetsLength:{value:0},_maxSlideOffsetIndex:{value:-1},_minSlideOffsetIndex:{value:2e9},_updateSlideOffset:{value:function(e,t){var i=1e-4;e>=0&&(t<-i||t>i?("undefined"==typeof this._slideOffsets[e]&&(this._slideOffsetsLength++,e<this._minSlideOffsetIndex&&(this._minSlideOffsetIndex=e),e>this._maxSlideOffsetIndex&&(this._maxSlideOffsetIndex=e)),this._slideOffsets[e]=t):this._removeSlideOffset(e))}},_incrementSlideOffset:{value:function(e,t){this._updateSlideOffset(e,this._getSlideOffset(e)+t)}},_removeSlideOffset:{value:function(e){if("undefined"!=typeof this._slideOffsets[e]){var t,i,n,r;if(delete this._slideOffsets[e],this._slideOffsetsLength--,e===this._minSlideOffsetIndex)for(t=Object.keys(this._slideOffsets),this._minSlideOffsetIndex=2e9,i=0,r=t.length;i<r;i++)n=0|t[i],n<this._minSlideOffsetIndex&&(this._minSlideOffsetIndex=n);if(e===this._maxSlideOffsetIndex)for("undefined"==typeof t&&(t=Object.keys(this._slideOffsets),r=t.length),this._maxSlideOffsetIndex=-1,i=0;i<r;i++)n=0|t[i],n>this._maxSlideOffsetIndex&&(this._maxSlideOffsetIndex=n)}}},_getSlideOffset:{value:function(e){return e<this._minSlideOffsetIndex?e=this._minSlideOffsetIndex>this._draggedSlideIndex?this._draggedSlideIndex:this._minSlideOffsetIndex:e>this._maxSlideOffsetIndex&&(e=this._maxSlideOffsetIndex<this._draggedSlideIndex?this._draggedSlideIndex:this._maxSlideOffsetIndex),"undefined"!=typeof this._slideOffsets[e]?this._slideOffsets[e]:0}},scroll:{get:function(){return this._scroll},set:function(e){if(e<0&&(e=0),e>this.length&&(e=this.length),this._hasElasticScrolling&&null!==this._draggedSlideIndex){var t,i,n=this._draggedSlideIndex-this._elasticScrollingRange,r=this._draggedSlideIndex+this._elasticScrollingRange;for(n>this._minSlideOffsetIndex&&(n=this._minSlideOffsetIndex),r<this._maxSlideOffsetIndex&&(r=this._maxSlideOffsetIndex),i=e-this._scroll,n<0&&(n=0),t=n;t<=r;t++)t!==this._draggedSlideIndex?this._incrementSlideOffset(t,i):this._removeSlideOffset(t);this._scroll=e}else this._scroll=e;this.needsDraw=!0}},previousStride:{value:function(){var e=Math.round(this.scroll/this.stride),t=(e-1)*this.stride;this.startScrollingIndexToOffset(0,-t)}},nextStride:{value:function(){var e=Math.round(this.scroll/this.stride),t=(e+1)*this.stride;this.startScrollingIndexToOffset(0,-t)}},_isInputEnabled:{value:!0},isInputEnabled:{get:function(){return this._isInputEnabled},set:function(e){e?this._isInputEnabled=!0:this._isInputEnabled=!1}},_draggedSlideIndex:{value:0},draggedSlideIndex:{get:function(){return this._draggedSlideIndex},set:function(e){if(e!==this._draggedSlideIndex){if(null!==e){var t,i=this._getSlideOffset(e),n=this._minSlideOffsetIndex,r=this._maxSlideOffsetIndex;for(this._incrementSlideOffset(this._draggedSlideIndex,-i),t=n;t<=r;t++)t!==this._draggedSlideIndex&&this._incrementSlideOffset(t,-i);this._removeSlideOffset(e),this._scroll-=i,this._flowTranslateComposer._scroll=this._scroll}this._draggedSlideIndex=e,this.needsDraw=!0}}},_elasticScrollingSpeed:{value:1},elasticScrollingSpeed:{get:function(){return this._elasticScrollingSpeed},set:function(e){this._elasticScrollingSpeed=parseFloat(e)}},lastDrawTime:{value:null},offset:{enumerable:!1,value:function(e){var t=this._paths.length,i=e%t,n=Math.floor(e/t)-this._scroll+this._paths[i].headOffset;return{pathIndex:i,slideTime:n+this._getSlideOffset(e)}}},serializeSelf:{value:function(e){e.setAllProperties();for(var t,i=this.originalContent,n=0;t=i[n];n++)t.component&&e.addObject(t.component)}}})}}),montageDefine("c50fb48","runtime/dependencies/gl-matrix",{dependencies:[],factory:function(e,t,i){var n=window;!function(e,r){"object"==typeof t?i.exports=r(n):"function"==typeof define&&define.amd?define([],function(){return r(e)}):r(e)}(this,function(e){"use strict";function t(e){return a=e}function i(){return a="undefined"!=typeof Float32Array?Float32Array:Array}var n=1e-6,r={};!function(){if("undefined"!=typeof Float32Array){var e=new Float32Array(1),t=new Int32Array(e.buffer);r.invsqrt=function(i){var n=.5*i;e[0]=i;var r=1.5;t[0]=1597463007-(t[0]>>1);var a=e[0];return a*(r-n*a*a)}}else r.invsqrt=function(e){return 1/Math.sqrt(e)}}();var a=null;i();var s={};s.create=function(e){var t=new a(3);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):t[0]=t[1]=t[2]=0,t},s.createFrom=function(e,t,i){var n=new a(3);return n[0]=e,n[1]=t,n[2]=i,n},s.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},s.equal=function(e,t){return e===t||Math.abs(e[0]-t[0])<n&&Math.abs(e[1]-t[1])<n&&Math.abs(e[2]-t[2])<n},s.add=function(e,t,i){return i&&e!==i?(i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i):(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e)},s.subtract=function(e,t,i){return i&&e!==i?(i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i):(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e)},s.multiply=function(e,t,i){return i&&e!==i?(i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i):(e[0]*=t[0],e[1]*=t[1],e[2]*=t[2],e)},s.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},s.scale=function(e,t,i){return i&&e!==i?(i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i):(e[0]*=t,e[1]*=t,e[2]*=t,e)},s.normalize=function(e,t){t||(t=e);var i=e[0],n=e[1],r=e[2],a=Math.sqrt(i*i+n*n+r*r);return a?1===a?(t[0]=i,t[1]=n,t[2]=r,t):(a=1/a,t[0]=i*a,t[1]=n*a,t[2]=r*a,t):(t[0]=0,t[1]=0,t[2]=0,t)},s.cross=function(e,t,i){i||(i=e);var n=e[0],r=e[1],a=e[2],s=t[0],o=t[1],l=t[2];return i[0]=r*l-a*o,i[1]=a*s-n*l,i[2]=n*o-r*s,i},s.length=function(e){var t=e[0],i=e[1],n=e[2];return Math.sqrt(t*t+i*i+n*n)},s.squaredLength=function(e){var t=e[0],i=e[1],n=e[2];return t*t+i*i+n*n},s.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},s.direction=function(e,t,i){i||(i=e);var n=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2],s=Math.sqrt(n*n+r*r+a*a);return s?(s=1/s,i[0]=n*s,i[1]=r*s,i[2]=a*s,i):(i[0]=0,i[1]=0,i[2]=0,i)},s.lerp=function(e,t,i,n){return n||(n=e),n[0]=e[0]+i*(t[0]-e[0]),n[1]=e[1]+i*(t[1]-e[1]),n[2]=e[2]+i*(t[2]-e[2]),n},s.dist=function(e,t){var i=t[0]-e[0],n=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(i*i+n*n+r*r)};var o=null,l=new a(4);s.unproject=function(e,t,i,n,r){r||(r=e),o||(o=p.create());var a=o,s=l;return s[0]=2*(e[0]-n[0])/n[2]-1,s[1]=2*(e[1]-n[1])/n[3]-1,s[2]=2*e[2]-1,s[3]=1,p.multiply(i,t,a),p.inverse(a)?(p.multiplyVec4(a,s),0===s[3]?null:(r[0]=s[0]/s[3],r[1]=s[1]/s[3],r[2]=s[2]/s[3],r)):null};var u=s.createFrom(1,0,0),c=s.createFrom(0,1,0),h=s.createFrom(0,0,1),d=s.create();s.rotationTo=function(e,t,i){i||(i=g.create());var n=s.dot(e,t),r=d;if(n>=1)g.set(f,i);else if(n<1e-6-1)s.cross(u,e,r),s.length(r)<1e-6&&s.cross(c,e,r),s.length(r)<1e-6&&s.cross(h,e,r),s.normalize(r),g.fromAngleAxis(Math.PI,r,i);else{var a=Math.sqrt(2*(1+n)),o=1/a;s.cross(e,t,r),i[0]=r[0]*o,i[1]=r[1]*o,i[2]=r[2]*o,i[3]=.5*a,g.normalize(i)}return i[3]>1?i[3]=1:i[3]<-1&&(i[3]=-1),i},s.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"};var m={};m.create=function(e){var t=new a(9);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8]):t[0]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=0,t},m.createFrom=function(e,t,i,n,r,s,o,l,u){var c=new a(9);return c[0]=e,c[1]=t,c[2]=i,c[3]=n,c[4]=r,c[5]=s,c[6]=o,c[7]=l,c[8]=u,c},m.determinant=function(e){var t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8];return t*(u*a-s*l)+i*(-u*r+s*o)+n*(l*r-a*o)},m.inverse=function(e,t){var i,n=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=h*o-l*c,p=-h*s+l*u,g=c*s-o*u,f=n*d+r*p+a*g;return f?(i=1/f,t||(t=m.create()),t[0]=d*i,t[1]=(-h*r+a*c)*i,t[2]=(l*r-a*o)*i,t[3]=p*i,t[4]=(h*n-a*u)*i,t[5]=(-l*n+a*s)*i,t[6]=g*i,t[7]=(-c*n+r*u)*i,t[8]=(o*n-r*s)*i,t):null},m.multiply=function(e,t,i){i||(i=e);var n=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=t[0],m=t[1],p=t[2],g=t[3],f=t[4],v=t[5],_=t[6],b=t[7],w=t[8];return i[0]=d*n+m*s+p*u,i[1]=d*r+m*o+p*c,i[2]=d*a+m*l+p*h,i[3]=g*n+f*s+v*u,i[4]=g*r+f*o+v*c,i[5]=g*a+f*l+v*h,i[6]=_*n+b*s+w*u,i[7]=_*r+b*o+w*c,i[8]=_*a+b*l+w*h,i},m.multiplyVec2=function(e,t,i){i||(i=t);var n=t[0],r=t[1];return i[0]=n*e[0]+r*e[3]+e[6],i[1]=n*e[1]+r*e[4]+e[7],i},m.multiplyVec3=function(e,t,i){i||(i=t);var n=t[0],r=t[1],a=t[2];return i[0]=n*e[0]+r*e[3]+a*e[6],i[1]=n*e[1]+r*e[4]+a*e[7],i[2]=n*e[2]+r*e[5]+a*e[8],i},m.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},m.equal=function(e,t){return e===t||Math.abs(e[0]-t[0])<n&&Math.abs(e[1]-t[1])<n&&Math.abs(e[2]-t[2])<n&&Math.abs(e[3]-t[3])<n&&Math.abs(e[4]-t[4])<n&&Math.abs(e[5]-t[5])<n&&Math.abs(e[6]-t[6])<n&&Math.abs(e[7]-t[7])<n&&Math.abs(e[8]-t[8])<n},m.identity=function(e){return e||(e=m.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},m.transpose=function(e,t){if(!t||e===t){var i=e[1],n=e[2],r=e[5];return e[1]=e[3],e[2]=e[6],e[3]=i,e[5]=e[7],e[6]=n,e[7]=r,e}return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},m.toMat4=function(e,t){return t||(t=p.create()),t[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t},m.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"};var p={};p.create=function(e){var t=new a(16);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},p.createFrom=function(e,t,i,n,r,s,o,l,u,c,h,d,m,p,g,f){var v=new a(16);return v[0]=e,v[1]=t,v[2]=i,v[3]=n,v[4]=r,v[5]=s,v[6]=o,v[7]=l,v[8]=u,v[9]=c,v[10]=h,v[11]=d,v[12]=m,v[13]=p,v[14]=g,v[15]=f,v},p.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},p.equal=function(e,t){return e===t||Math.abs(e[0]-t[0])<n&&Math.abs(e[1]-t[1])<n&&Math.abs(e[2]-t[2])<n&&Math.abs(e[3]-t[3])<n&&Math.abs(e[4]-t[4])<n&&Math.abs(e[5]-t[5])<n&&Math.abs(e[6]-t[6])<n&&Math.abs(e[7]-t[7])<n&&Math.abs(e[8]-t[8])<n&&Math.abs(e[9]-t[9])<n&&Math.abs(e[10]-t[10])<n&&Math.abs(e[11]-t[11])<n&&Math.abs(e[12]-t[12])<n&&Math.abs(e[13]-t[13])<n&&Math.abs(e[14]-t[14])<n&&Math.abs(e[15]-t[15])<n},p.identity=function(e){return e||(e=p.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},p.transpose=function(e,t){if(!t||e===t){var i=e[1],n=e[2],r=e[3],a=e[6],s=e[7],o=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=i,e[6]=e[9],e[7]=e[13],e[8]=n,e[9]=a,e[11]=e[14],e[12]=r,e[13]=s,e[14]=o,e}return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},p.determinant=function(e){var t=e[0],i=e[1],n=e[2],r=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11],m=e[12],p=e[13],g=e[14],f=e[15];return m*c*o*r-u*p*o*r-m*s*h*r+a*p*h*r+u*s*g*r-a*c*g*r-m*c*n*l+u*p*n*l+m*i*h*l-t*p*h*l-u*i*g*l+t*c*g*l+m*s*n*d-a*p*n*d-m*i*o*d+t*p*o*d+a*i*g*d-t*s*g*d-u*s*n*f+a*c*n*f+u*i*o*f-t*c*o*f-a*i*h*f+t*s*h*f},p.inverse=function(e,t){t||(t=e);var i,n=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],m=e[10],p=e[11],g=e[12],f=e[13],v=e[14],_=e[15],b=n*l-r*o,w=n*u-a*o,y=n*c-s*o,E=r*u-a*l,C=r*c-s*l,x=a*c-s*u,T=h*f-d*g,S=h*v-m*g,P=h*_-p*g,A=d*v-m*f,R=d*_-p*f,D=m*_-p*v,L=b*D-w*R+y*A+E*P-C*S+x*T;return L?(i=1/L,t[0]=(l*D-u*R+c*A)*i,t[1]=(-r*D+a*R-s*A)*i,t[2]=(f*x-v*C+_*E)*i,t[3]=(-d*x+m*C-p*E)*i,t[4]=(-o*D+u*P-c*S)*i,t[5]=(n*D-a*P+s*S)*i,t[6]=(-g*x+v*y-_*w)*i,t[7]=(h*x-m*y+p*w)*i,t[8]=(o*R-l*P+c*T)*i,t[9]=(-n*R+r*P-s*T)*i,t[10]=(g*C-f*y+_*b)*i,t[11]=(-h*C+d*y-p*b)*i,t[12]=(-o*A+l*S-u*T)*i,t[13]=(n*A-r*S+a*T)*i,t[14]=(-g*E+f*w-v*b)*i,t[15]=(h*E-d*w+m*b)*i,t):null},p.toRotationMat=function(e,t){return t||(t=p.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},p.toMat3=function(e,t){return t||(t=m.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},p.toInverseMat3=function(e,t){var i,n=e[0],r=e[1],a=e[2],s=e[4],o=e[5],l=e[6],u=e[8],c=e[9],h=e[10],d=h*o-l*c,p=-h*s+l*u,g=c*s-o*u,f=n*d+r*p+a*g;return f?(i=1/f,t||(t=m.create()),t[0]=d*i,t[1]=(-h*r+a*c)*i,t[2]=(l*r-a*o)*i,t[3]=p*i,t[4]=(h*n-a*u)*i,t[5]=(-l*n+a*s)*i,t[6]=g*i,t[7]=(-c*n+r*u)*i,t[8]=(o*n-r*s)*i,t):null},p.multiply=function(e,t,i){i||(i=e);var n=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],m=e[10],p=e[11],g=e[12],f=e[13],v=e[14],_=e[15],b=t[0],w=t[1],y=t[2],E=t[3];return i[0]=b*n+w*o+y*h+E*g,i[1]=b*r+w*l+y*d+E*f,i[2]=b*a+w*u+y*m+E*v,i[3]=b*s+w*c+y*p+E*_,b=t[4],w=t[5],y=t[6],E=t[7],i[4]=b*n+w*o+y*h+E*g,i[5]=b*r+w*l+y*d+E*f,i[6]=b*a+w*u+y*m+E*v,i[7]=b*s+w*c+y*p+E*_,b=t[8],w=t[9],y=t[10],E=t[11],i[8]=b*n+w*o+y*h+E*g,i[9]=b*r+w*l+y*d+E*f,i[10]=b*a+w*u+y*m+E*v,i[11]=b*s+w*c+y*p+E*_,b=t[12],w=t[13],y=t[14],E=t[15],i[12]=b*n+w*o+y*h+E*g,i[13]=b*r+w*l+y*d+E*f,i[14]=b*a+w*u+y*m+E*v,i[15]=b*s+w*c+y*p+E*_,i},p.multiplyVec3=function(e,t,i){i||(i=t);var n=t[0],r=t[1],a=t[2];return i[0]=e[0]*n+e[4]*r+e[8]*a+e[12],i[1]=e[1]*n+e[5]*r+e[9]*a+e[13],i[2]=e[2]*n+e[6]*r+e[10]*a+e[14],i},p.multiplyVec4=function(e,t,i){i||(i=t);var n=t[0],r=t[1],a=t[2],s=t[3];return i[0]=e[0]*n+e[4]*r+e[8]*a+e[12]*s,i[1]=e[1]*n+e[5]*r+e[9]*a+e[13]*s,i[2]=e[2]*n+e[6]*r+e[10]*a+e[14]*s,i[3]=e[3]*n+e[7]*r+e[11]*a+e[15]*s,i},p.translate=function(e,t,i){var n,r,a,s,o,l,u,c,h,d,m,p,g=t[0],f=t[1],v=t[2];return i&&e!==i?(n=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],m=e[10],p=e[11],i[0]=n,i[1]=r,i[2]=a,i[3]=s,i[4]=o,i[5]=l,i[6]=u,i[7]=c,i[8]=h,i[9]=d,i[10]=m,i[11]=p,i[12]=n*g+o*f+h*v+e[12],i[13]=r*g+l*f+d*v+e[13],i[14]=a*g+u*f+m*v+e[14],i[15]=s*g+c*f+p*v+e[15],i):(e[12]=e[0]*g+e[4]*f+e[8]*v+e[12],e[13]=e[1]*g+e[5]*f+e[9]*v+e[13],e[14]=e[2]*g+e[6]*f+e[10]*v+e[14],e[15]=e[3]*g+e[7]*f+e[11]*v+e[15],e)},p.scale=function(e,t,i){var n=t[0],r=t[1],a=t[2];return i&&e!==i?(i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=e[3]*n,i[4]=e[4]*r,i[5]=e[5]*r,i[6]=e[6]*r,i[7]=e[7]*r,i[8]=e[8]*a,i[9]=e[9]*a,i[10]=e[10]*a,i[11]=e[11]*a,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i):(e[0]*=n,e[1]*=n,e[2]*=n,e[3]*=n,e[4]*=r,e[5]*=r,e[6]*=r,e[7]*=r,e[8]*=a,e[9]*=a,e[10]*=a,e[11]*=a,e)},p.rotate=function(e,t,i,n){var r,a,s,o,l,u,c,h,d,m,p,g,f,v,_,b,w,y,E,C,x,T,S,P,A=i[0],R=i[1],D=i[2],L=Math.sqrt(A*A+R*R+D*D);return L?(1!==L&&(L=1/L,A*=L,R*=L,D*=L),r=Math.sin(t),a=Math.cos(t),s=1-a,o=e[0],l=e[1],u=e[2],c=e[3],h=e[4],d=e[5],m=e[6],p=e[7],g=e[8],f=e[9],v=e[10],_=e[11],b=A*A*s+a,w=R*A*s+D*r,y=D*A*s-R*r,E=A*R*s-D*r,C=R*R*s+a,x=D*R*s+A*r,T=A*D*s+R*r,S=R*D*s-A*r,P=D*D*s+a,n?e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=o*b+h*w+g*y,n[1]=l*b+d*w+f*y,n[2]=u*b+m*w+v*y,n[3]=c*b+p*w+_*y,n[4]=o*E+h*C+g*x,n[5]=l*E+d*C+f*x,n[6]=u*E+m*C+v*x,n[7]=c*E+p*C+_*x,n[8]=o*T+h*S+g*P,n[9]=l*T+d*S+f*P,n[10]=u*T+m*S+v*P,n[11]=c*T+p*S+_*P,n):null},p.rotateX=function(e,t,i){var n=Math.sin(t),r=Math.cos(t),a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return i?e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]):i=e,i[4]=a*r+u*n,i[5]=s*r+c*n,i[6]=o*r+h*n,i[7]=l*r+d*n,i[8]=a*-n+u*r,i[9]=s*-n+c*r,i[10]=o*-n+h*r,i[11]=l*-n+d*r,i},p.rotateY=function(e,t,i){var n=Math.sin(t),r=Math.cos(t),a=e[0],s=e[1],o=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return i?e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]):i=e,i[0]=a*r+u*-n,i[1]=s*r+c*-n,i[2]=o*r+h*-n,i[3]=l*r+d*-n,i[8]=a*n+u*r,i[9]=s*n+c*r,i[10]=o*n+h*r,i[11]=l*n+d*r,i},p.rotateZ=function(e,t,i){var n=Math.sin(t),r=Math.cos(t),a=e[0],s=e[1],o=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return i?e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]):i=e,i[0]=a*r+u*n,i[1]=s*r+c*n,i[2]=o*r+h*n,i[3]=l*r+d*n,i[4]=a*-n+u*r,i[5]=s*-n+c*r,i[6]=o*-n+h*r,i[7]=l*-n+d*r,i},p.frustum=function(e,t,i,n,r,a,s){s||(s=p.create());var o=t-e,l=n-i,u=a-r;return s[0]=2*r/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*r/l,s[6]=0,s[7]=0,s[8]=(t+e)/o,s[9]=(n+i)/l,s[10]=-(a+r)/u,s[11]=-1,s[12]=0,s[13]=0,s[14]=-(a*r*2)/u,s[15]=0,s},p.perspective=function(e,t,i,n,r){var a=i*Math.tan(e*Math.PI/360),s=a*t;return p.frustum(-s,s,-a,a,i,n,r)},p.ortho=function(e,t,i,n,r,a,s){s||(s=p.create());var o=t-e,l=n-i,u=a-r;return s[0]=2/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/l,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=-2/u,s[11]=0,s[12]=-(e+t)/o,s[13]=-(n+i)/l,s[14]=-(a+r)/u,s[15]=1,s},p.lookAt=function(e,t,i,n){n||(n=p.create());var r,a,s,o,l,u,c,h,d,m,g=e[0],f=e[1],v=e[2],_=i[0],b=i[1],w=i[2],y=t[0],E=t[1],C=t[2];return g===y&&f===E&&v===C?p.identity(n):(c=g-y,h=f-E,d=v-C,m=1/Math.sqrt(c*c+h*h+d*d),c*=m,h*=m,d*=m,r=b*d-w*h,a=w*c-_*d,s=_*h-b*c,m=Math.sqrt(r*r+a*a+s*s),m?(m=1/m,r*=m,a*=m,s*=m):(r=0,a=0,s=0),o=h*s-d*a,l=d*r-c*s,u=c*a-h*r,m=Math.sqrt(o*o+l*l+u*u),m?(m=1/m,o*=m,l*=m,u*=m):(o=0,l=0,u=0),n[0]=r,n[1]=o,n[2]=c,n[3]=0,n[4]=a,n[5]=l,n[6]=h,n[7]=0,n[8]=s,n[9]=u,n[10]=d,n[11]=0,n[12]=-(r*g+a*f+s*v),n[13]=-(o*g+l*f+u*v),n[14]=-(c*g+h*f+d*v),n[15]=1,n)},p.fromRotationTranslation=function(e,t,i){i||(i=p.create());var n=e[0],r=e[1],a=e[2],s=e[3],o=n+n,l=r+r,u=a+a,c=n*o,h=n*l,d=n*u,m=r*l,g=r*u,f=a*u,v=s*o,_=s*l,b=s*u;return i[0]=1-(m+f),i[1]=h+b,i[2]=d-_,i[3]=0,i[4]=h-b,i[5]=1-(c+f),i[6]=g+v,i[7]=0,i[8]=d+_,i[9]=g-v,i[10]=1-(c+m),i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i},p.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"};var g={};g.create=function(e){var t=new a(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},g.createFrom=function(e,t,i,n){var r=new a(4);return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r},g.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},g.equal=function(e,t){return e===t||Math.abs(e[0]-t[0])<n&&Math.abs(e[1]-t[1])<n&&Math.abs(e[2]-t[2])<n&&Math.abs(e[3]-t[3])<n},g.identity=function(e){return e||(e=g.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};var f=g.identity();g.calculateW=function(e,t){var i=e[0],n=e[1],r=e[2];return t&&e!==t?(t[0]=i,t[1]=n,t[2]=r,t[3]=-Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t):(e[3]=-Math.sqrt(Math.abs(1-i*i-n*n-r*r)),e)},g.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},g.inverse=function(e,t){var i=e[0],n=e[1],r=e[2],a=e[3],s=i*i+n*n+r*r+a*a,o=s?1/s:0;return t&&e!==t?(t[0]=-e[0]*o,t[1]=-e[1]*o,t[2]=-e[2]*o,t[3]=e[3]*o,t):(e[0]*=-o,e[1]*=-o,e[2]*=-o,e[3]*=o,e)},g.conjugate=function(e,t){return t&&e!==t?(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t):(e[0]*=-1,e[1]*=-1,e[2]*=-1,e)},g.length=function(e){var t=e[0],i=e[1],n=e[2],r=e[3];return Math.sqrt(t*t+i*i+n*n+r*r)},g.normalize=function(e,t){t||(t=e);var i=e[0],n=e[1],r=e[2],a=e[3],s=Math.sqrt(i*i+n*n+r*r+a*a);return 0===s?(t[0]=0,t[1]=0,t[2]=0,t[3]=0,t):(s=1/s,t[0]=i*s,t[1]=n*s,t[2]=r*s,t[3]=a*s,t)},g.add=function(e,t,i){return i&&e!==i?(i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i):(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],e)},g.multiply=function(e,t,i){i||(i=e);var n=e[0],r=e[1],a=e[2],s=e[3],o=t[0],l=t[1],u=t[2],c=t[3];return i[0]=n*c+s*o+r*u-a*l,i[1]=r*c+s*l+a*o-n*u,i[2]=a*c+s*u+n*l-r*o,i[3]=s*c-n*o-r*l-a*u,i},g.multiplyVec3=function(e,t,i){i||(i=t);var n=t[0],r=t[1],a=t[2],s=e[0],o=e[1],l=e[2],u=e[3],c=u*n+o*a-l*r,h=u*r+l*n-s*a,d=u*a+s*r-o*n,m=-s*n-o*r-l*a;return i[0]=c*u+m*-s+h*-l-d*-o,i[1]=h*u+m*-o+d*-s-c*-l,i[2]=d*u+m*-l+c*-o-h*-s,i},g.scale=function(e,t,i){return i&&e!==i?(i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i):(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e)},g.toMat3=function(e,t){t||(t=m.create());var i=e[0],n=e[1],r=e[2],a=e[3],s=i+i,o=n+n,l=r+r,u=i*s,c=i*o,h=i*l,d=n*o,p=n*l,g=r*l,f=a*s,v=a*o,_=a*l;return t[0]=1-(d+g),t[1]=c+_,t[2]=h-v,t[3]=c-_,t[4]=1-(u+g),t[5]=p+f,t[6]=h+v,t[7]=p-f,t[8]=1-(u+d),t},g.toMat4=function(e,t){t||(t=p.create());var i=e[0],n=e[1],r=e[2],a=e[3],s=i+i,o=n+n,l=r+r,u=i*s,c=i*o,h=i*l,d=n*o,m=n*l,g=r*l,f=a*s,v=a*o,_=a*l;return t[0]=1-(d+g),t[1]=c+_,t[2]=h-v,t[3]=0,t[4]=c-_,t[5]=1-(u+g),t[6]=m+f,t[7]=0,t[8]=h+v,t[9]=m-f,t[10]=1-(u+d),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},g.slerp=function(e,t,i,n){n||(n=e);var r,a,s,o,l=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],u=1;return l<0&&(l=-l,u=-1),Math.abs(l)>=1?(n!==e&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3]),n):(r=Math.acos(l),a=Math.sqrt(1-l*l),Math.abs(a)<.001?(n[0]=.5*e[0]+.5*t[0],n[1]=.5*e[1]+.5*t[1],n[2]=.5*e[2]+.5*t[2],n[3]=.5*e[3]+.5*t[3],n):(s=Math.sin((1-i)*r)/a,o=Math.sin(i*r)/a,n[0]=e[0]*s+t[0]*u*o,n[1]=e[1]*s+t[1]*u*o,n[2]=e[2]*s+t[2]*u*o,n[3]=e[3]*s+t[3]*u*o,n))},g.fromRotationMatrix=function(e,t){t||(t=g.create());var i=m.create();m.transpose(e,i);var n,r=i[0]+i[4]+i[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(i[7]-i[5])*n,t[1]=(i[2]-i[6])*n,t[2]=(i[3]-i[1])*n;else{var a=g.fromRotationMatrix.s_iNext=g.fromRotationMatrix.s_iNext||[1,2,0],s=0;i[4]>i[0]&&(s=1),i[8]>i[3*s+s]&&(s=2);var o=a[s],l=a[o];n=Math.sqrt(i[3*s+s]-i[3*o+o]-i[3*l+l]+1),t[s]=.5*n,n=.5/n,t[3]=(i[3*l+o]-i[3*o+l])*n,t[o]=(i[3*o+s]+i[3*s+o])*n,t[l]=(i[3*l+s]+i[3*s+l])*n}return t},m.toQuat4=g.fromRotationMatrix,function(){var e=m.create();g.fromAxes=function(t,i,n,r){return e[0]=i[0],e[3]=i[1],e[6]=i[2],e[1]=n[0],e[4]=n[1],e[7]=n[2],e[2]=t[0],e[5]=t[1],e[8]=t[2],g.fromRotationMatrix(e,r)}}(),g.identity=function(e){return e||(e=g.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},g.fromAngleAxis=function(e,t,i){i||(i=g.create());var n=.5*e,r=Math.sin(n);return i[3]=Math.cos(n),i[0]=r*t[0],i[1]=r*t[1],i[2]=r*t[2],i},g.toAngleAxis=function(e,t){t||(t=e);var i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(i>0){t[3]=2*Math.acos(e[3]);var n=r.invsqrt(i);t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n}else t[3]=0,t[0]=1,t[1]=0,t[2]=0;return t},g.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var v={};v.create=function(e){var t=new a(2);return e?(t[0]=e[0],t[1]=e[1]):(t[0]=0,t[1]=0),t},v.createFrom=function(e,t){var i=new a(2);return i[0]=e,i[1]=t,i},v.add=function(e,t,i){return i||(i=t),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i},v.subtract=function(e,t,i){return i||(i=t),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i},v.multiply=function(e,t,i){return i||(i=t),i[0]=e[0]*t[0],i[1]=e[1]*t[1],i},v.divide=function(e,t,i){return i||(i=t),i[0]=e[0]/t[0],i[1]=e[1]/t[1],i},v.scale=function(e,t,i){return i||(i=e),i[0]=e[0]*t,i[1]=e[1]*t,i},v.dist=function(e,t){var i=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(i*i+n*n)},v.set=function(e,t){return t[0]=e[0],t[1]=e[1],t},v.equal=function(e,t){return e===t||Math.abs(e[0]-t[0])<n&&Math.abs(e[1]-t[1])<n},v.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t},v.normalize=function(e,t){t||(t=e);var i=e[0]*e[0]+e[1]*e[1];return i>0?(i=Math.sqrt(i),t[0]=e[0]/i,t[1]=e[1]/i):t[0]=t[1]=0,t},v.cross=function(e,t,i){var n=e[0]*t[1]-e[1]*t[0];return i?(i[0]=i[1]=0,i[2]=n,i):n},v.length=function(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)},v.squaredLength=function(e){var t=e[0],i=e[1];return t*t+i*i},v.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},v.direction=function(e,t,i){i||(i=e);var n=e[0]-t[0],r=e[1]-t[1],a=n*n+r*r;return a?(a=1/Math.sqrt(a),i[0]=n*a,i[1]=r*a,i):(i[0]=0,i[1]=0,i[2]=0,i)},v.lerp=function(e,t,i,n){return n||(n=e),n[0]=e[0]+i*(t[0]-e[0]),n[1]=e[1]+i*(t[1]-e[1]),n},v.str=function(e){return"["+e[0]+", "+e[1]+"]"};var _={};_.create=function(e){var t=new a(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},_.createFrom=function(e,t,i,n){var r=new a(4);return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r},_.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},_.equal=function(e,t){return e===t||Math.abs(e[0]-t[0])<n&&Math.abs(e[1]-t[1])<n&&Math.abs(e[2]-t[2])<n&&Math.abs(e[3]-t[3])<n},_.identity=function(e){return e||(e=_.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},_.transpose=function(e,t){if(!t||e===t){var i=e[1];return e[1]=e[2],e[2]=i,e}return t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t},_.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},_.inverse=function(e,t){t||(t=e);var i=e[0],n=e[1],r=e[2],a=e[3],s=i*a-r*n;return s?(s=1/s,t[0]=a*s,t[1]=-n*s,t[2]=-r*s,t[3]=i*s,t):null},_.multiply=function(e,t,i){i||(i=e);var n=e[0],r=e[1],a=e[2],s=e[3];return i[0]=n*t[0]+r*t[2],i[1]=n*t[1]+r*t[3],i[2]=a*t[0]+s*t[2],i[3]=a*t[1]+s*t[3],i},_.rotate=function(e,t,i){i||(i=e);var n=e[0],r=e[1],a=e[2],s=e[3],o=Math.sin(t),l=Math.cos(t);return i[0]=n*l+r*o,i[1]=n*-o+r*l,i[2]=a*l+s*o,i[3]=a*-o+s*l,i},_.multiplyVec2=function(e,t,i){i||(i=t);var n=t[0],r=t[1];return i[0]=n*e[0]+r*e[1],i[1]=n*e[2]+r*e[3],i},_.scale=function(e,t,i){i||(i=e);var n=e[0],r=e[1],a=e[2],s=e[3],o=t[0],l=t[1];return i[0]=n*o,i[1]=r*l,i[2]=a*o,i[3]=s*l,i},_.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var b={};return b.create=function(e){var t=new a(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t},b.createFrom=function(e,t,i,n){var r=new a(4);return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r},b.add=function(e,t,i){return i||(i=t),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i},b.subtract=function(e,t,i){return i||(i=t),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i},b.multiply=function(e,t,i){return i||(i=t),i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i[3]=e[3]*t[3],i},b.divide=function(e,t,i){return i||(i=t),i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i[3]=e[3]/t[3],i},b.scale=function(e,t,i){return i||(i=e),i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i},b.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},b.equal=function(e,t){return e===t||Math.abs(e[0]-t[0])<n&&Math.abs(e[1]-t[1])<n&&Math.abs(e[2]-t[2])<n&&Math.abs(e[3]-t[3])<n},b.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},b.length=function(e){var t=e[0],i=e[1],n=e[2],r=e[3];return Math.sqrt(t*t+i*i+n*n+r*r)},b.squaredLength=function(e){var t=e[0],i=e[1],n=e[2],r=e[3];return t*t+i*i+n*n+r*r},b.lerp=function(e,t,i,n){return n||(n=e),n[0]=e[0]+i*(t[0]-e[0]),n[1]=e[1]+i*(t[1]-e[1]),n[2]=e[2]+i*(t[2]-e[2]),n[3]=e[3]+i*(t[3]-e[3]),n},b.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},e&&(e.glMatrixArrayType=a,e.MatrixArray=a,e.setMatrixArrayType=t,e.determineMatrixArrayType=i,e.glMath=r,e.vec2=v,e.vec3=s,e.vec4=b,e.mat2=_,e.mat3=m,e.mat4=p,e.quat4=g),{glMatrixArrayType:a,MatrixArray:a,setMatrixArrayType:t,determineMatrixArrayType:i,glMath:r,vec2:v,vec3:s,vec4:b,mat2:_,mat3:m,mat4:p,quat4:g}})}}),montageDefine("c50fb48","ui/view.reel/view",{dependencies:["runtime/dependencies/gl-matrix","montage","montage/ui/component","runtime/glsl-program","runtime/helpers/resource-manager","runtime/glTF-scene","runtime/glTF-node","runtime/scene","runtime/node","runtime/scene-renderer","runtime/glTF-material","runtime/utilities","montage/core/dom","montage/core/geometry/point","runtime/dependencies/camera","runtime/dependencies/camera","montage/composer/translate-composer","runtime/builtin-assets","runtime/webgl-renderer","url","runtime/projection","runtime/camera"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix");var n=e("montage").Montage,r=e("montage/ui/component").Component,a=e("runtime/glsl-program").GLSLProgram,s=(e("runtime/helpers/resource-manager").ResourceManager,e("runtime/glTF-scene").glTFScene,e("runtime/glTF-node").glTFNode),o=e("runtime/scene").Scene,l=e("runtime/node").Node,u=e("runtime/scene-renderer").SceneRenderer,c=(e("runtime/glTF-material").glTFMaterial,e("runtime/utilities").Utilities),h=e("montage/core/dom"),d=e("montage/core/geometry/point").Point,m=e("runtime/dependencies/camera").OrbitCamera,p=e("runtime/dependencies/camera").FlyingCamera,g=e("montage/composer/translate-composer").TranslateComposer,f=e("runtime/builtin-assets").BuiltInAssets,v=e("runtime/webgl-renderer").WebGLRenderer,_=e("url"),b=e("runtime/projection").Projection,w=e("runtime/camera").Camera;t.View=r.specialize({_firstFrameDidRender:{value:!1,writable:!0},_sceneResourcesLoaded:{value:!1,writable:!0},_scene:{value:null,writable:!0},allowsProgressiveSceneLoading:{value:!1,writable:!0},sceneWillChange:{value:function(e){this.viewPointModifierMatrix=mat4.identity(),this.interpolatingViewPoint=null,this._firstFrameDidRender=!1,this.delegate&&this.delegate.sceneWillChange&&this.delegate.sceneWillChange(),this._scene&&(this._scene.removeEventListener("materialUpdate",this),this._scene.removeEventListener("textureUpdate",this))}},sceneDidChange:{value:function(){this._scene&&(this._sceneResourcesLoaded=!1,this._scene.addEventListener("textureUpdate",this),this._scene.addEventListener("materialUpdate",this),this.applyScene(),this.delegate&&this.delegate.sceneDidChange&&this.delegate.sceneDidChange())}},scene:{get:function(){return this._scene},set:function(e){return e&&e.isLoaded()===!1?void e.addOwnPropertyChangeListener("status",this):void(this.scene!=e&&(this.sceneWillChange(e),this._scene=e,this.sceneDidChange()))}},constructor:{value:function(){this["super"]()}},resourceAvailable:{value:function(e){if(0==this.allowsProgressiveSceneLoading){var t=this.getResourceManager();t&&0==t.hasPendingRequests()&&(this.needsDraw=!0)}}},handleTextureUpdate:{value:function(e){var t=this.getResourceManager();if(t&&this.sceneRenderer&&this.sceneRenderer.webGLRenderer){var i=this.sceneRenderer.webGLRenderer.webGLContext,n=t.getResource(e.detail.value,this.sceneRenderer.webGLRenderer.textureDelegate,i);n&&(this.needsDraw=!0)}}},handleMaterialUpdate:{value:function(e){this.needsDraw=!0}},_sceneTime:{value:0,writable:!0},_lastTime:{value:0,writable:!0
},play:{value:function(){switch(this._state){case this.PAUSE:case this.STOP:this._lastTime=Date.now(),this._state=this.PLAY,this.needsDraw=!0}this._state=this.PLAY}},pause:{value:function(){this._state=this.PAUSE}},_viewPointIndex:{value:0,writable:!0},automaticallyCycleThroughViewPoints:{value:!0,writable:!0},loops:{value:!0,writable:!0},stop:{value:function(){this._sceneTime=0,this._state=this.STOP,this.needsDraw=!0}},STOP:{value:0,writable:!0},PLAY:{value:1,writable:!0},PAUSE:{value:2,writable:!0},_state:{value:0,writable:!0},_viewPoint:{value:null,writable:!0},viewPointWillChange:{value:function(e,t){var i=null;if(this.sceneRenderer&&t){if(this.scene&&this.scene.glTFElement){var n=this.scene.glTFElement.animationManager,r=0==n.nodeHasAnimatedAncestor(t.glTFElement);if(0==r&&null!=e&&(r|=0==n.nodeHasAnimatedAncestor(e.glTFElement)),r){var a=null==this.orbitCamera?null:[this.orbitCamera.orbitX,this.orbitCamera.orbitY];i={previous:e?e.glTFElement:null,step:0,start:Date.now(),duration:1e3,orbitXY:a,orbitDistance:this.orbitCamera?this.orbitCamera.getDistance():0}}}this.interpolatingViewPoint=i}}},viewPointDidChange:{value:function(){this.sceneRenderer&&this._viewPoint&&this.scene&&this.scene.glTFElement&&(this.sceneRenderer.technique.rootPass.viewPoint=this._viewPoint?this._viewPoint.glTFElement:null,this._viewPointIndex=this._getViewPointIndex(this.viewPoint),this.needsDraw=!0)}},viewPoint:{get:function(){return this._viewPoint},set:function(e){if(this._viewPoint!=e){var t=null;this._viewPoint&&e&&this._viewPoint.scene==e.scene&&(t=this._viewPoint),this.viewPointWillChange(t,e),this._viewPoint=e,this._sceneTime=0,e&&this.scene&&null==this._viewPoint.scene&&(this._viewPoint.scene=this.scene),this.viewPointDidChange()}}},translateComposer:{value:null},modelController:{value:null},update:{value:function(){this.needsDraw=!0}},scaleFactor:{value:window.devicePixelRatio||1,writable:!0},canvas:{get:function(){return this.templateObjects?this.templateObjects.canvas:null}},_orbitCamera:{value:null,writable:!0},orbitCamera:{get:function(){return this._orbitCamera},set:function(e){this._orbitCamera=e}},_sceneRenderer:{value:null,writable:!0},sceneRenderer:{get:function(){return this._sceneRenderer},set:function(e){e!=this._sceneRenderer&&(this._sceneRenderer=e)}},handleStatusChange:{value:function(e,t,i){"loaded"===e&&(this.scene=i,this.needsDraw=!0,this.interpolatingViewPoint=null)}},scenePath:{set:function(t){if(t){var i=_.parse(t);if(!i.scheme){var r=Object.keys(e.packages);t=_.resolve(r[0],t)}}if(!this.scene||t!=this.scene.path){var a=n.create(o).init();a.addOwnPropertyChangeListener("status",this),a.path=t}},get:function(){return this.scene?this.scene.path:null}},_getGLTFViewPoints:{value:function(e){var t=[],i=e.glTFElement.rootNode;return i.apply(function(e,i,n){return e.cameras&&e.cameras.length&&(t=t.concat(e)),null},!0,null),t}},_getViewPoints:{value:function(e){var t=this._getGLTFViewPoints(e),i=[];return t.forEach(function(t){var n=new l;n.scene=e,n.id=t.baseId,i.push(n)},this),i}},_getViewPointIndex:{value:function(e){for(var t=this._getGLTFViewPoints(e.scene),i=0;i<t.length;i++)if(t[i].baseId===e.id)return i;return 0}},applyScene:{value:function(){var e=this.scene,t=null,i=e.glTFElement,r=this;if(this.sceneRenderer&&this.sceneRenderer.technique.rootPass){if(i){this.orbitCamera=null;var a=this._getViewPoints(e),o=a.length>0,u=mat4.identity(),h=i.rootNode,d=null;if(h.apply(function(e,t,i){var n=mat4.create();if(mat4.multiply(i,e.transform.matrix,n),e.boundingBox){var r=c.transformBBox(e.boundingBox,n);d?e.meshes&&e.meshes.length>0&&(d=c.mergeBBox(r,d)):d=r}return n},!0,u),a.length){var m=!1;this.viewPoint&&this.viewPoint.scene&&(m=this.viewPoint.scenePath===e.scenePath),m===!1&&(this.viewPoint=a[0])}else{var p=Object.create(b);p.initWithDescription({projection:"perspective",yfov:45,aspectRatio:1,znear:.1,zfar:100});var g=Object.create(w).init();g.projection=p;var f=Object.create(s).init();g.name=f.name="camera01",f.id="__default_camera",f.baseId=f.id,i.ids[f.baseId]=f,f.cameras.push(g);var v=n.create(l);v.scene=e,v.id=f.baseId,this.viewPoint=v}if(d&&!o){var _=[d[1][0]-d[0][0],d[1][1]-d[0][1],d[1][2]-d[0][2]],C=_[0]>_[1]?_[0]:_[1];C=_[2]>C?_[2]:C,C=1/C;var x=mat4.scale(mat4.identity(),[C,C,C]);t=vec3.createFrom(0,0,_[2]*C/2);var T=vec3.createFrom(-(_[0]/2+d[0][0]),-(_[1]/2+d[0][1]),-d[0][2]),S=mat4.translate(x,[T[0],T[1],T[2]]);mat4.set(S,i.rootNode.transform.matrix),i.rootNode.transform._updateDirtyFlag(!1)}}if(this.sceneRenderer.scene=i,i?(this.orbitCamera=new y(this.canvas),this.orbitCamera.translateComposer=this.translateComposer,this.orbitCamera._hookEvents(this.canvas),this.orbitCamera.constrainDistance=!!o,this.orbitCamera.maxDistance=o?15:200,this.orbitCamera.minDistance=o?-45:0,this.orbitCamera.setDistance(o?0:1.3),this.orbitCamera.distanceStep=o?.015:1e-4,this.orbitCamera.setRideMode(o),this.orbitCamera.setYUp(!0),o&&(this.orbitCamera.minOrbitX=-.4,this.orbitCamera.maxOrbitX=.4,this.orbitCamera.minOrbitY=-.4,this.orbitCamera.maxOrbitY=.4),this.orbitCamera.constrainXOrbit=o,this.orbitCamera.constrainYOrbit=o,t&&this.orbitCamera.setCenter(t)):this.flyingCamera=new E(this.canvas),this.viewPoint&&(null==this.viewPoint.scene&&(this.viewPoint.scene=e),this.sceneRenderer&&(this.interpolatingViewPoint=null,this.viewPointDidChange())),this.allowsProgressiveSceneLoading===!1){var P=this.scene.prepareToRender(this.sceneRenderer.webGLRenderer);P.then(function(){r.sceneRenderer.webGLRenderer.webGLContext.finish(),r._sceneResourcesLoaded=!0,r.needsDraw=!0},function(e){},function(e){})}else this.needsDraw=!0}}},getRelativePositionToCanvas:{value:function(e){return h.convertPointFromPageToNode(this.canvas,(new d).init(e.pageX,e.pageY))}},_disableRendering:{value:!1,writable:!0},_contextAttributes:{value:null,writable:!0},_shouldForceClear:{value:!1,writable:!0},enterDocument:{value:function(e){var t=!1,i=this;t&&(this.canvas=WebGLDebugUtils.makeLostContextSimulatingCanvas(this.canvas));var n={premultipliedAlpha:!1,antialias:!0,preserveDrawingBuffer:!1},r=this.canvas.getContext("experimental-webgl",n)||this.canvas.getContext("webgl",n);if(null==r)return void console.log("Please check that your browser enables & supports WebGL");this._contextAttributes=r.getContextAttributes();var a=!1;if(this._contextAttributes&&(a=this._contextAttributes.antialias),0==a&&console.log("WARNING: anti-aliasing is not supported/enabled"),navigator){var s=null!=navigator.userAgent.match(/iPad/i);if(0==s){var o=navigator.userAgent;s=/iPad/i.test(o)||/iPhone OS 3_1_2/i.test(o)||/iPhone OS 3_2_2/i.test(o)}s&&(this._shouldForceClear=!0)}var l=Object.create(v).initWithWebGLContext(r);r.enable(r.DEPTH_TEST);var c=null;this.sceneRenderer=Object.create(u),this.sceneRenderer.init(l,c);var h=this.getResourceManager();h.isObserving()||(h.observers.push(this),h.startObserving()),this.scene&&this.applyScene(),this.canvas.addEventListener("webglcontextlost",function(e){console.log("context was lost"),e.preventDefault(),i.getResourceManager.stopObserving(),i.sceneRenderer.webGLRenderer.resourceManager.reset(),i.needsDraw=!1,i._disableRendering=!0},!1),this.canvas.addEventListener("webglcontextrestored",function(e){console.log("context was restored"),e.preventDefault(),r.enable(r.DEPTH_TEST),i.needsDraw=!0,i._disableRendering=!1},!1),t&&setTimeout(function(){i.canvas.loseContext()},5e3);var i=this,d=f.assetWithName("gradient");d.then(function(e){i.gradientRenderer=Object.create(u),i.gradientRenderer.init(l,null),i.gradientRenderer.scene=e,i.needsDraw=!0},function(e){},function(e){}),this.needsDraw=!0,this.canvas.addEventListener("touchstart",this.start.bind(this),!0),document.addEventListener("touchend",this.end.bind(this),!0),document.addEventListener("touchcancel",this.end.bind(this),!0),document.addEventListener("touchmove",this.move.bind(this),!0),document.addEventListener("gesturechange",this,!0),this.canvas.addEventListener("mousedown",this.start.bind(this),!0),document.addEventListener("mouseup",this.end.bind(this),!0),document.addEventListener("mousemove",this.move.bind(this),!0),document.addEventListener("mousewheel",this,!0)}},captureMousewheel:{value:function(){this.needsDraw=!0}},captureGesturechange:{value:function(){this.needsDraw=!0}},move:{value:function(e){this._mousePosition=null}},start:{value:function(e){e.preventDefault(),this._consideringPointerForPicking=!0;var t=this.getRelativePositionToCanvas(e);this._mousePosition=[t.x*this.scaleFactor,this.height-t.y*this.scaleFactor],this._state==this.PLAY&&this.pause()}},end:{value:function(e){if(this._consideringPointerForPicking&&e.target===this.canvas&&e.preventDefault(),this._state==this.PAUSE&&this.scene&&this.viewPoint&&this.scene.glTFElement&&this.scene.glTFElement.animationManager){var t=this.scene.glTFElement.animationManager;t.nodeHasAnimatedAncestor(this.viewPoint.glTFElement)&&this.play()}this._consideringPointerForPicking=!1,this._mousePosition=null}},hitTest:{value:function(e,t){if(this.sceneRenderer&&this.sceneRenderer.technique.rootPass&&this.canvas){var i=[0,0,parseInt(this.canvas.getAttribute("width")),parseInt(this.canvas.getAttribute("height"))];return this.sceneRenderer.technique.rootPass.hitTest(e,i,t)}return null}},getWebGLRenderer:{value:function(){return this.sceneRenderer?this.sceneRenderer.webGLRenderer:null}},getWebGLContext:{value:function(){var e=this.getWebGLRenderer();return e?e.webGLContext:null}},getResourceManager:{value:function(){var e=this.getWebGLRenderer();return e?e.resourceManager:null}},_consideringPointerForPicking:{writable:!0,value:!1},_mousePosition:{writable:!0,value:null},_floorTextureLoaded:{writable:!0,value:!1},_showGradient:{value:!1,writable:!0},_showReflection:{value:!1,writable:!0},showBBOX:{value:!1,writable:!0},showGradient:{get:function(){return this._showGradient},set:function(e){e!=this._showGradient&&(this._showGradient=e,this.needsDraw=!0)}},showReflection:{get:function(){return this._showReflection},set:function(e){this._showReflection=e}},drawGradient:{value:function(){this.showGradient&&this.gradientRenderer&&this.gradientRenderer.render()}},displayBBOX:{value:function(e,t,i){if(this.sceneRenderer&&this.scene&&this.sceneRenderer.technique.rootPass.viewPoint){var n=this.getWebGLContext();this.sceneRenderer.webGLRenderer.bindedProgram=null;var r=this.viewPoint,s=r.cameras[0].projection.matrix;if(n.disable(n.CULL_FACE),!this._BBOXProgram){this._BBOXProgram=Object.create(a);var o="precision highp float;attribute vec3 vert;uniform mat4 u_projMatrix; uniform mat4 u_vMatrix; uniform mat4 u_mMatrix; void main(void) { gl_Position = u_projMatrix * u_vMatrix * u_mMatrix * vec4(vert,1.0); }",l="precision highp float;uniform float u_transparency;  void main(void) {  gl_FragColor = vec4(vec3(1.,1.,1.) , u_transparency);}";this._BBOXProgram.initWithShaders({"x-shader/x-vertex":o,"x-shader/x-fragment":l}),this._BBOXProgram.build(n)||console.log(this._BBOXProgram.errorLogs)}var u=[e[0][0],e[0][1],e[0][2]],c=[e[1][0],e[1][1],e[1][2]],h=0,d=1,m=2;if(!this._BBOXIndices){var p=[0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,3,7,2,6,0,4,1,5];this._BBOXIndices=n.createBuffer(),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this._BBOXIndices),n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array(p),n.STATIC_DRAW)}n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this._BBOXIndices),this._BBOXVertexBuffer||(this._BBOXVertexBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this._BBOXVertexBuffer)),n.bindBuffer(n.ARRAY_BUFFER,this._BBOXVertexBuffer);var g=[c[h],u[d],u[m],c[h],c[d],u[m],u[h],c[d],u[m],u[h],u[d],u[m],c[h],u[d],c[m],c[h],c[d],c[m],u[h],c[d],c[m],u[h],u[d],c[m]];n.bufferData(n.ARRAY_BUFFER,new Float32Array(g),n.STATIC_DRAW);var f=this._BBOXProgram.getLocationForSymbol("vert");"undefined"!=typeof f&&(n.enableVertexAttribArray(f),n.vertexAttribPointer(f,3,n.FLOAT,!1,12,0)),this.sceneRenderer.webGLRenderer.bindedProgram=this._BBOXProgram;var v=this._BBOXProgram.getLocationForSymbol("u_projMatrix");v&&this._BBOXProgram.setValueForSymbol("u_projMatrix",s);var _=this._BBOXProgram.getLocationForSymbol("u_mMatrix");_&&this._BBOXProgram.setValueForSymbol("u_mMatrix",i);var b=this._BBOXProgram.getLocationForSymbol("u_vMatrix");b&&this._BBOXProgram.setValueForSymbol("u_vMatrix",t);var w=this._BBOXProgram.getLocationForSymbol("u_transparency");w&&this._BBOXProgram.setValueForSymbol("u_transparency",1),this._BBOXProgram.commit(n),n.drawElements(n.LINES,24,n.UNSIGNED_SHORT,0),n.disableVertexAttribArray(f),n.disable(n.BLEND),n.enable(n.CULL_FACE)}}},selectedNode:{value:null,writable:!0},handleSelectedNode:{value:function(e){}},displayAllBBOX:{value:function(e,t){if(this.scene&&this.showBBOX&&this.scene.glTFElement){var i=mat4.identity(),n=this.scene.glTFElement.rootNode,r=this;n.apply(function(i,n,a){var s=mat4.create();return mat4.multiply(a,i.transform.matrix,s),i.boundingBox&&i.id==t&&r.displayBBOX(i.boundingBox,e,s),s},!0,i)}}},_width:{value:null},width:{get:function(){return this._width},set:function(e){e!=this._width&&(this._width=e*this.scaleFactor,this.needsDraw=!0)}},_height:{value:null},height:{get:function(){return this._height},set:function(e){e!=this._height&&(this._height=e*this.scaleFactor,this.needsDraw=!0)}},interpolatingViewPoint:{value:null,writable:!0},draw:{value:function(){if(this.allowsProgressiveSceneLoading!==!1||this._sceneResourcesLoaded!==!1){var e,t,i=this.getWebGLContext();if(null!=i&&!this._disableRendering&&((this._shouldForceClear||null==this._contextAttributes.preserveDrawingBuffer||1==this._contextAttributes.preserveDrawingBuffer)&&(i.clearColor(0,0,0,0),i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT)),e=this._width,t=this._height,e==this.canvas.width&&t==this.canvas.height||(this.canvas.style.width=this._width/this.scaleFactor+"px",this.canvas.style.height=this._height/this.scaleFactor+"px",this.canvas.width=this._width,this.canvas.height=this._height,i.viewport(0,0,this._width,this._height)),this.viewPoint&&this.viewPoint.glTFElement&&(this.viewPoint.glTFElement.cameras[0].projection.aspectRatio=this._width/this._height),null!=this._scene&&null!=this.viewPoint&&!this._disableRendering)){var n=(this.viewPoint,Date.now());if(this.interpolatingViewPoint){if(n-this.interpolatingViewPoint.start<this.interpolatingViewPoint.duration){if(this.orbitCamera){this.orbitCamera.ignoreEvents=!0;var r=(n-this.interpolatingViewPoint.start)/this.interpolatingViewPoint.duration;r=c.easeOut(Math.min(r,1));var a=[0,0];c.interpolateVec(this.interpolatingViewPoint.orbitXY,[0,0],r,a),this.orbitCamera.orbitX=a[0],this.orbitCamera.orbitY=a[1];var s=this.interpolatingViewPoint.orbitDistance;this.orbitCamera.setDistance(s+(0-s)*r),this.orbitCamera._dirty=!0}}else this.orbitCamera&&(this.orbitCamera.ignoreEvents=!1,this.orbitCamera.orbitX=0,this.orbitCamera.orbitY=0,this.orbitCamera.setDistance(0),this.interpolatingViewPoint=null);this.needsDraw=!0}if(this.sceneRenderer&&this.scene){var o=this.scene.glTFElement.animationManager;if(this._state==this.PLAY&&o){if(this._sceneTime+=n-this._lastTime,this.scene.glTFElement.duration!==-1&&this._sceneTime/1e3>this.scene.glTFElement.duration){if(1==this.automaticallyCycleThroughViewPoints){var l=this._viewPointIndex,u=this._getViewPoints(this.scene);if(u.length>0){var h,d=0;do this._sceneTime=0,d++,l=++l%u.length,h=u[l];while(d<u.length&&0==o.nodeHasAnimatedAncestor(h.glTFElement));this.viewPoint=h}}this.loops?this._sceneTime=this._sceneTime%this.scene.glTFElement.duration:this.stop()}this.scene.glTFElement.animationManager.updateTargetsAtTime(this._sceneTime,this.sceneRenderer.webGLRenderer.resourceManager)}}if(this._lastTime=n,this.orbitCamera){var m=this.orbitCamera.getViewMat();mat4.set(m,this.viewPointModifierMatrix),this.viewPoint&&null==this.viewPoint.glTFElement.parent&&mat4.inverse(this.viewPointModifierMatrix)}else if(this.flyingCamera){var m=this.flyingCamera.getViewMat();mat4.set(m,this.viewPointModifierMatrix),this.viewPoint&&null==this.viewPoint.glTFElement.parent&&mat4.inverse(this.viewPointModifierMatrix)}var p;if(this._state==this.PLAY&&(this.needsDraw=!0),this.scene&&(p=this.sceneRenderer.webGLRenderer,i)){if(this.showReflection&&this.orbitCamera){i.depthFunc(i.LESS),i.enable(i.DEPTH_TEST),i.frontFace(i.CW);var g=mat4.create(),f=this.scene.glTFElement.rootNode,v=f;mat4.set(f.transform.matrix,g),i.depthMask(!0);var _=mat4.translate(mat4.identity(),[0,0,0]),b=mat4.scale(_,[1,1,-1]);mat4.multiply(b,v.transform.matrix),f.transform.matrix=b,this.sceneRenderer.technique.rootPass.viewPoint.flipped=!0,this.sceneRenderer.render(n),i.depthMask(!0),this.sceneRenderer.technique.rootPass.viewPoint.flipped=!1,f.transform.matrix=g}null==this.__renderOptions&&(this.__renderOptions={}),this.__renderOptions.viewPointModifierMatrix=this.viewPointModifierMatrix,this.__renderOptions.interpolatingViewPoint=this.interpolatingViewPoint,this.__renderOptions.picking=!1,this.__renderOptions.coords=null,this.__renderOptions.delegate=null,this.sceneRenderer.render(n,this.__renderOptions),i.flush(),this._firstFrameDidRender===!1&&(this._firstFrameDidRender=!0,this.dispatchEventNamed("firstFrameDidRender",!0,!1,this))}}}}},willDraw:{value:function(){}},templateDidLoad:{value:function(){self=this,window.addEventListener("resize",this,!0);var e=(this.parentComponent,null),t=new g;t.animateMomentum=!0,t.hasMomentum=!0,t.allowFloats=!0,t.pointerSpeedMultiplier=.15,this.addComposerForElement(t,this.canvas),t.addPathChangeListener("translateY",function(e){self._consideringPointerForPicking=!1,self.needsDraw=!0}),t.addPathChangeListener("translateX",function(e){self._consideringPointerForPicking=!1,self.needsDraw=!0}),t.addEventListener("translateStart",function(t){e&&clearTimeout(e)},!1),t.addEventListener("translateEnd",function(){e=setTimeout(function(){self.needsDraw=!0},3e3)},!1),this.translateComposer=t}}});var y=m;y.prototype=Object.create(m.prototype);var E=p;E.prototype=Object.create(p.prototype),y.prototype._hookEvents=function(e){var t=this,i=!1,n=0,r=0;this.translateComposer&&(this.translateComposer.addEventListener("translateStart",function(e){i=!0,n=e.translateX,r=e.translateY},!1),this.translateComposer.addEventListener("translate",function(e){if(i){var a=e.translateX-n,s=e.translateY-r;n=e.translateX,r=e.translateY,t.orbit(.013*a,.013*s)}},!1),this.translateComposer.addEventListener("translateEnd",function(){i=!1},!1),e.addEventListener("mousewheel",function(e){t.setDistance(-t._distance[2]+e.wheelDeltaY*t.distanceStep),e.preventDefault()},!1),e.addEventListener("gesturestart",function(e){t.initialDistance=t._distance[2],e.preventDefault()},!1),e.addEventListener("gesturechange",function(e){t.setDistance(-1*t.initialDistance/e.scale),e.preventDefault()},!1))}}}),montageDefine("b0111a3","composer/translate-composer",{dependencies:["./composer","../core/event/event-manager"],factory:function(e,t,i){var n=e("./composer").Composer,r=e("../core/event/event-manager").defaultEventManager,a=t.TranslateComposer=n.specialize({_NATIVE_ELEMENTS:{value:["A","IFRAME","EMBED","OBJECT","VIDEO","AUDIO","CANVAS","LABEL","INPUT","BUTTON","SELECT","TEXTAREA","KEYGEN","DETAILS","COMMAND"]},_WHEEL_POINTER:{value:"wheel",writable:!1},_MOUSE_POINTER:{value:"mouse",writable:!1},_TOUCH_POINTER:{value:"touch",writable:!1},CLAIM_POINTER_POLICIES:{value:{DEFAULT:"default",MOVE:"move"}},enabled:{value:!0},_externalUpdate:{value:!0},isAnimating:{value:!1},isMoving:{value:!1},frame:{value:function(){this.isAnimating&&this._animationInterval(),this._externalUpdate=!1}},_pointerSpeedMultiplier:{value:1},pointerSpeedMultiplier:{get:function(){return this._pointerSpeedMultiplier},set:function(e){this._pointerSpeedMultiplier=e}},pointerStartEventPosition:{value:null},_shouldDispatchTranslate:{value:!1},_isSelfUpdate:{value:!1},_allowFloats:{value:!1},allowFloats:{get:function(){return this._allowFloats},set:function(e){this._allowFloats!==e&&(this._allowFloats=e,this.translateX=this._translateX,this.translateY=this._translateY)}},allowTranslateOuterExtreme:{value:!1},_translateX:{value:0},translateX:{get:function(){return this._translateX},set:function(e){if("vertical"===this._axis)this._translateX=this._minTranslateX||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;null!==this._minTranslateX&&t<this._minTranslateX&&(t=this._minTranslateX),null!==this._maxTranslateX&&t>this._maxTranslateX&&(t=this._maxTranslateX),this._isSelfUpdate||(this.isAnimating=!1),this._translateX=t}}},_translateY:{value:0},translateY:{get:function(){return this._translateY},set:function(e){if("horizontal"===this._axis)this._translateY=this._minTranslateY||0;else{var t=isNaN(e)?0:this._allowFloats?parseFloat(e):e>>0;null!==this._minTranslateY&&t<this._minTranslateY&&(t=this._minTranslateY),null!==this._maxTranslateY&&t>this._maxTranslateY&&(t=this._maxTranslateY),this._isSelfUpdate||(this.isAnimating=!1),this._translateY=t}}},_minTranslateX:{value:null},minTranslateX:{get:function(){return this._minTranslateX},set:function(e){null!==e&&(e=parseFloat(e)),this._minTranslateX!==e&&(null!==e&&this._translateX<e&&(this.translateX=e),this._minTranslateX=e)}},_maxTranslateX:{value:null},maxTranslateX:{get:function(){return this._maxTranslateX},set:function(e){null!==e&&(e=parseFloat(e)),this._maxTranslateX!==e&&(null!==e&&this._translateX>e&&(this.translateX=e),this._maxTranslateX=e)}},_minTranslateY:{value:null},minTranslateY:{get:function(){return this._minTranslateY},set:function(e){null!==e&&(e=parseFloat(e)),this._minTranslateY!==e&&(null!==e&&this._translateY<e&&(this.translateY=e),this._minTranslateY=e)}},_maxTranslateY:{value:null},maxTranslateY:{get:function(){return this._maxTranslateY},set:function(e){null!==e&&(e=parseFloat(e)),this._maxTranslateY!==e&&(null!==e&&this._translateY>e&&(this.translateY=e),this._maxTranslateY=e)}},_axis:{value:"both"},axis:{get:function(){return this._axis},set:function(e){switch(e){case"vertical":case"horizontal":this._axis=e,this.translateX=this._translateX,this.translateY=this._translateY;break;default:this._axis="both"}}},invertAxis:{depends:["invertXAxis","invertYAxis"],get:function(){return this._invertXAxis===this._invertYAxis?this._invertXAxis:null},set:function(e){this.invertXAxis=e,this.invertYAxis=e}},_invertXAxis:{value:!1},invertXAxis:{get:function(){return this._invertXAxis},set:function(e){this._invertXAxis=!!e}},_invertYAxis:{value:!1},invertYAxis:{get:function(){return this._invertYAxis},set:function(e){this._invertYAxis=!!e}},_hasMomentum:{value:!0},hasMomentum:{get:function(){return this._hasMomentum},set:function(e){this._hasMomentum=!!e}},__momentumDuration:{value:650},_momentumDuration:{get:function(){return this.__momentumDuration},set:function(e){this.__momentumDuration=isNaN(e)?1:e>>0,this.__momentumDuration<1&&(this.__momentumDuration=1)}},_pointerX:{value:null},_pointerY:{value:null},_touchIdentifier:{value:null},_isFirstMove:{value:!1},_observedPointer:{value:null},eventManager:{get:function(){return r}},_mouseRadiusThreshold:{value:2},_touchRadiusThreshold:{value:8},_listenToWheelEvent:{value:!1},listenToWheelEvent:{set:function(e){e=!!e,this._listenToWheelEvent!==e&&(this._listenToWheelEvent=e,this._isLoaded&&(e?this._addWheelEventListener():this._removeWheelEventListener()))},get:function(){return this._listenToWheelEvent}},_claimPointerPolicy:{value:null},load:{value:function(){window.PointerEvent?this._element.addEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.addEventListener("MSPointerDown",this,!0):(this._element.addEventListener("touchstart",this,!0),this._element.addEventListener("mousedown",this,!0)),this._listenToWheelEvent&&this._addWheelEventListener(),this.eventManager.isStoringPointerEvents=!0}},unload:{value:function(){window.PointerEvent?this._element.removeEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.removeEventListener("MSPointerDown",this,!0):(this._element.removeEventListener("touchstart",this,!0),this._element.removeEventListener("mousedown",this,!0)),this._listenToWheelEvent&&this._removeWheelEventListener()}},surrenderPointer:{value:function(e,t){var i=this.callDelegateMethod("surrenderPointer",e,t);return("undefined"==typeof i||i!==!1)&&(this._cancel(),!0)}},addEventListener:{value:function(e,t,i){n.prototype.addEventListener.call(this,e,t,i),"translate"===e&&(this._shouldDispatchTranslate=!0)}},capturePointerdown:{value:function(e){e.pointerType===this._MOUSE_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.captureMousedown(e):(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.captureTouchstart(e)}},capturePointermove:{value:function(e){e.pointerType===this._MOUSE_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.captureMousemove(e):(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.captureTouchmove(e)}},handlePointerup:{value:function(e){e.pointerType===this._MOUSE_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE?this.handleMouseup(e):(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchend(e)}},handlePointercancel:{value:function(e){(e.pointerType===this._TOUCH_POINTER||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchcancel(e)}},captureMousedown:{value:function(e){this.enabled&&0===e.button&&(this._observedPointer=this._MOUSE_POINTER,this._start(e.clientX,e.clientY,e.target,e.timeStamp))}},captureMousemove:{value:function(e){this.enabled&&this._handleMove(e)}},handleMouseup:{value:function(e){this.enabled&&this._end(e)}},captureTouchstart:{value:function(e){if(this.enabled&&null===this._observedPointer)if(void 0!==e.pointerId)this._observedPointer=e.pointerId,this._start(e.clientX,e.clientY,e.target,e.timeStamp),this._preventDefaultIfNeeded(e);else{var t=e.targetTouches;if(t&&1===t.length){var i=t[0];this._preventDefaultIfNeeded(e),this._observedPointer=i.identifier,this._start(i.clientX,i.clientY,i.target,e.timeStamp)}}}},captureTouchmove:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._handleMove(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._handleMove(e,t)}}},handleTouchend:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._end(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._end(t)}}},handleTouchcancel:{value:function(e){if(this.enabled)if(void 0!==e.pointerId)this._cancel(e);else{var t=this._findObservedTouch(e.changedTouches);t&&this._cancel(t)}}},captureScroll:{value:function(e){e.target.contains(this.element)&&this._cancel(e)}},_shouldPreventDefault:{value:function(e){return!!e.target.tagName&&this._NATIVE_ELEMENTS.indexOf(e.target.tagName)===-1&&!e.target.isContentEditable}},_preventDefaultIfNeeded:{value:function(e){!e.defaultPrevented&&this._shouldPreventDefault(e)&&e.preventDefault()}},_addWheelEventListener:{value:function(){if(this._element){var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";this._element.addEventListener(e,this,!1),this._element.addEventListener(e,this,!0)}}},_removeWheelEventListener:{value:function(){if(this._element){var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";this._element.removeEventListener(e,this,!1),this._element.removeEventListener(e,this,!0)}}},_start:{value:function(e,t,i,n){this.pointerStartEventPosition={pageX:e,pageY:t,target:i,timeStamp:n},this._pointerX=e,this._pointerY=t,window.PointerEvent?(this._element.addEventListener("pointerdown",this,!1),document.addEventListener("pointermove",this,!0),document.addEventListener("pointerup",this,!1),document.addEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(this._element.addEventListener("MSPointerDown",this,!1),document.addEventListener("MSPointerMove",this,!0),document.addEventListener("MSPointerUp",this,!1),document.addEventListener("MSPointerCancel",this,!1)):this._observedPointer===this._MOUSE_POINTER?(this._element.addEventListener("mousedown",this,!1),document.addEventListener("mousemove",this,!0),document.addEventListener("mouseup",this,!1)):(this._element.addEventListener("touchstart",this,!1),this._element.addEventListener("touchmove",this,!0),this._element.addEventListener("touchend",this,!1),this._element.addEventListener("touchcancel",this,!1)),document.addEventListener("scroll",this,!0),this.isAnimating&&(this.isAnimating=!1,this._dispatchTranslateEnd()),this._isFirstMove=!0}},_handleStart:{value:function(e){this._claimPointerPolicy=this.eventManager.componentClaimingPointer(this._observedPointer)?this.CLAIM_POINTER_POLICIES.MOVE:this.CLAIM_POINTER_POLICIES.DEFAULT}},_findObservedTouch:{value:function(e){for(var t,i=null,n=0;(t=e[n])&&null===i;n++)t.identifier===this._observedPointer&&(i=t);return i}},_handleMove:{value:function(e,t){var i=this.eventManager,r=this.pointerStartEventPosition;if(t||(t=e),this._isFirstMove){var a=i.componentClaimingPointer(this._observedPointer);if(a){var s=!0;if(this._claimPointerPolicy===this.CLAIM_POINTER_POLICIES.MOVE){var o=this._observedPointer===this._MOUSE_POINTER?this._mouseRadiusThreshold:this._touchRadiusThreshold,l=r.pageX-t.clientX,u=r.pageY-t.clientY;s=n.isCoordinateOutsideRadius(l,u,o),s&&(r.pageX=t.clientX,r.pageY=t.clientY,r.target=t.target,r.timeStamp=e.timeStamp,this._pointerX=t.clientX,this._pointerY=t.clientY)}if(!s)return void this._preventDefaultIfNeeded(e)}i.claimPointer(this._observedPointer,this)}i.isPointerClaimedByComponent(this._observedPointer,this)?(this._preventDefaultIfNeeded(e),(this.allowTranslateOuterExtreme||this._shouldMove(e,t.clientX,t.clientY))&&(this._isFirstMove?this._firstMove():this._move(t.clientX,t.clientY))):this._releaseInterest()}},_shouldMove:{value:function(e,t,i){var n,r,a,s,o=this._translateY,l=this._translateX,u=this._minTranslateY,c=this._maxTranslateY,h=this._minTranslateX,d=this._maxTranslateX,m=!0;return"wheel"===e.type||"mousewheel"===e.type?("vertical"!==this._axis&&(a=20*(e.wheelDeltaX||-e.deltaX||0)/120),"horizontal"!==this._axis&&(s=20*(e.wheelDeltaY||-e.deltaY||0)/120),m=!("horizontal"===this._axis&&0===a||"vertical"===this._axis&&0===s||0===a&&0===s)):("vertical"!==this._axis&&(a=-(this._invertXAxis?this._pointerX-t:t-this._pointerX)),"horizontal"!==this._axis&&(s=-(this._invertYAxis?this._pointerY-i:i-this._pointerY))),m&&(s&&(n=this._isNegativeNumber(s),null!==u&&(m=o!==u||o===u&&n),null!==c&&m&&(m=o!==c||o===c&&!n)),a&&(r=this._isNegativeNumber(a),null!==h&&m&&(m=l!==h||l===h&&r),null!==d&&m&&(m=l!==d||l===d&&!r))),m}},_firstMove:{value:function(){this._isFirstMove&&(this._dispatchTranslateStart(this._translateX,this._translateY),this._isFirstMove=!1,this.isMoving=!0)}},_move:{value:function(e,t){var i;this._isSelfUpdate=!0,"vertical"!==this._axis&&(i=this._invertXAxis?this._pointerX-e:e-this._pointerX,this.translateX+=i*this._pointerSpeedMultiplier),"horizontal"!==this._axis&&(i=this._invertYAxis?this._pointerY-t:t-this._pointerY,this.translateY+=i*this._pointerSpeedMultiplier),this._isSelfUpdate=!1,this._pointerX=e,this._pointerY=t,this._shouldDispatchTranslate&&this._dispatchTranslate()}},_end:{value:function(e){this.startTime=Date.now(),this.endX=this.posX=this.startX=this._translateX,this.endY=this.posY=this.startY=this._translateY;var t=e.velocity;this._hasMomentum&&(t.speed>40||this.translateStrideX||this.translateStrideY)?("vertical"!==this._axis?this.momentumX=t.x*this._pointerSpeedMultiplier*(this._invertXAxis?1:-1):this.momentumX=0,"horizontal"!==this._axis?this.momentumY=t.y*this._pointerSpeedMultiplier*(this._invertYAxis?1:-1):this.momentumY=0,this.endX=this.startX-this.momentumX*this.__momentumDuration/2e3,this.endY=this.startY-this.momentumY*this.__momentumDuration/2e3,
this.startStrideXTime=null,this.startStrideYTime=null,this.animateMomentum=!0):this.animateMomentum=!1,this.animateMomentum?this._animationInterval():this._isFirstMove||(this.isMoving=!1,this._dispatchTranslateEnd()),this._releaseInterest()}},_cancel:{value:function(e){this.startTime=Date.now(),this.endX=this.posX=this.startX=this._translateX,this.endY=this.posY=this.startY=this._translateY,this.animateMomentum=!1,this._isFirstMove||(this.isMoving=!1,this._dispatchTranslateCancel()),this._releaseInterest()}},_releaseInterest:{value:function(){window.PointerEvent?(this._element.removeEventListener("pointerdown",this,!1),document.removeEventListener("pointermove",this,!0),document.removeEventListener("pointerup",this,!1),document.removeEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(this._element.removeEventListener("MSPointerDown",this,!1),document.removeEventListener("MSPointerMove",this,!0),document.removeEventListener("MSPointerUp",this,!1),document.removeEventListener("MSPointerCancel",this,!1)):this._observedPointer===this._MOUSE_POINTER?(this._element.removeEventListener("mousedown",this,!1),document.removeEventListener("mousemove",this,!0),document.removeEventListener("mouseup",this,!1)):(this._element.removeEventListener("touchstart",this,!1),this._element.removeEventListener("touchmove",this,!0),this._element.removeEventListener("touchend",this,!1),this._element.removeEventListener("touchcancel",this,!1)),document.removeEventListener("scroll",this,!0),this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null,this._isFirstMove=!1,this.isMoving=!1}},_isAxisMovement:{value:function(e){var t,i,n,r,a,s,o,l=e.velocity,u=.7853981633974483,c=2.356194490192345,h=-2.356194490192345,d=-.7853981633974483;if("both"===this.axis)return!0;if(!l||0===l.speed||isNaN(l.speed)?(s=this.pointerStartEventPosition.pageX-e.clientX,o=this.pointerStartEventPosition.pageY-e.clientY,a=Math.atan2(o,s)):a=l.angle,"horizontal"===this.axis){if(n=a<=u&&a>=d,r=a>=c||a<=h,n||r)return!0}else if("vertical"===this.axis&&(t=a<=d&&a>=h,i=a>=u&&a<=c,t||i))return!0;return!1}},_translateEndTimeout:{value:null},_handleWheelTimeout:{value:null},_isNegativeNumber:{value:function(e){return e=+e,isNaN(e)||(e=1/e),e<0}},captureWheel:{value:function(e){this._shouldMove(e)?this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)||this.eventManager.claimPointer(this._WHEEL_POINTER,this):this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)&&this.eventManager.forfeitPointer(this._WHEEL_POINTER,this)}},handleWheel:{value:function(e){if(this.enabled&&this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)){if(this._observedPointer=this._WHEEL_POINTER,this._translateEndTimeout?clearTimeout(this._translateEndTimeout):this._dispatchTranslateStart(),"vertical"!==this.axis&&(this.translateX=this._translateX-20*(e.wheelDeltaX||-e.deltaX||0)/120),"horizontal"!==this.axis&&(this.translateY=this._translateY-20*(e.wheelDeltaY||-e.deltaY||0)/120),this.isMoving=!0,this._dispatchTranslate(),"function"!=typeof this._handleWheelTimeout){var t=function(){this._translateEndTimeout=null,this._dispatchTranslateEnd(),this.isMoving=!1,this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this)&&this.eventManager.forfeitPointer(this._WHEEL_POINTER,this)};this._handleWheelTimeout=t.bind(this)}this._translateEndTimeout=setTimeout(this._handleWheelTimeout,400),e.preventDefault()}}},_bezierTValue:{value:function(e,t,i,n,r){var a,s,o,l,u=1-3*n+3*t,c=3*n-6*t,h=3*t,d=.5;for(s=0;s<10;s++)l=d*d,a=3*u*l+2*c*d+h,o=1-d,d-=(3*(o*o*d*t+o*l*n)+l*d-e)/a;return l=d*d,o=1-d,3*(o*o*d*i+o*l*r)+l*d}},_dispatchTranslateStart:{value:function(e,t){var i=document.createEvent("CustomEvent");i.initCustomEvent("translateStart",!0,!0,null),i.translateX=e,i.translateY=t,i.scroll=0,i.pointer=this._observedPointer,this.dispatchEvent(i)}},_dispatchTranslateEnd:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateEnd",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_dispatchTranslateCancel:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateCancel",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_dispatchTranslate:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translate",!0,!0,null),e.translateX=this._translateX,e.translateY=this._translateY,e.scroll=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},animateBouncingX:{value:!1,enumerable:!1},startTimeBounceX:{value:!1,enumerable:!1},animateBouncingY:{value:!1,enumerable:!1},startTimeBounceY:{value:!1,enumerable:!1},animateMomentum:{value:!1,enumerable:!1},startTime:{value:null,enumerable:!1},startX:{value:null,enumerable:!1},posX:{value:null,enumerable:!1},endX:{value:null,enumerable:!1},startY:{value:null,enumerable:!1},posY:{value:null,enumerable:!1},endY:{value:null,enumerable:!1},translateStrideX:{value:null},translateStrideY:{value:null},translateStrideDuration:{value:330},_animationInterval:{value:function(){var e,t,i,n,r=Date.now(),a=!1;this.animateMomentum&&(e=r-this.startTime,e<this.__momentumDuration?(this.posX=this.startX-(this.momentumX+this.momentumX*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this.posY=this.startY-(this.momentumY+this.momentumY*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this.translateStrideX&&null===this.startStrideXTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.posX-this.endX)<.75*this.translateStrideX)&&(this.startStrideXTime=r),this.translateStrideY&&null===this.startStrideYTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.posY-this.endY)<.75*this.translateStrideY)&&(this.startStrideYTime=r)):this.animateMomentum=!1),t=Math.round(this.endX/this.translateStrideX),this.startStrideXTime&&r-this.startStrideXTime>0&&(r-this.startStrideXTime<this.translateStrideDuration?(e=this._bezierTValue((r-this.startStrideXTime)/this.translateStrideDuration,.275,0,.275,1),this.posX=this.posX*(1-e)+t*this.translateStrideX*e,a=!0):this.posX=t*this.translateStrideX),t=Math.round(this.endY/this.translateStrideY),this.startStrideYTime&&r-this.startStrideYTime>0&&(r-this.startStrideYTime<this.translateStrideDuration?(e=this._bezierTValue((r-this.startStrideYTime)/this.translateStrideDuration,.275,0,.275,1),this.posY=this.posY*(1-e)+t*this.translateStrideY*e,a=!0):this.posY=t*this.translateStrideY),i=this.posX,n=this.posY,this._isSelfUpdate=!0,this.translateX=i,this.translateY=n,this._shouldDispatchTranslate&&this._dispatchTranslate(),this._isSelfUpdate=!1,this.isAnimating=this.animateMomentum||a,this.isAnimating?this.needsFrame=!0:this._dispatchTranslateEnd()}}});a.prototype.captureMSPointerDown=a.prototype.capturePointerdown,a.prototype.captureMSPointerMove=a.prototype.capturePointermove,a.prototype.handleMSPointerUp=a.prototype.handlePointerup,a.prototype.handleMSPointerCancel=a.prototype.handlePointercancel,a.prototype.handleMousewheel=a.prototype.handleWheel,a.prototype.handleMSPointerDown=a.prototype._handleStart,a.prototype.handlePointerdown=a.prototype._handleStart,a.prototype.handleMousedown=a.prototype._handleStart,a.prototype.handleTouchstart=a.prototype._handleStart,void 0!==Math.sign&&(a.prototype._isNegativeNumber=function(e){return Math.sign(e)===-1})}}),montageDefine("b0111a3","ui/repetition.reel/repetition",{dependencies:["../../core/core","../component","../../core/range-controller","../../core/promise","../../composer/press-composer","collections/map","collections/set","../../core/logger"],factory:function(e,t,i){var n=e("../../core/core").Montage,r=e("../component").Component,a=e("../../core/range-controller").RangeController,s=e("../../core/promise").Promise,o=e("../../composer/press-composer").PressComposer,l=e("collections/map"),u=e("collections/set"),c=e("../../core/logger").logger("repetition").color.magenta(),h=60,d=t.Iteration=n.specialize({repetition:{value:null},controller:{value:null},_object:{value:null},object:{get:function(){return this._object},set:function(e){var t;this._object!==e&&(this._object=e,t=this.repetition.contentController.selection.indexOf(e)!==-1,this._selected!==t&&(this.selected=t))}},_fragment:{value:null},_childComponents:{value:null},index:{value:null},_drawnIndex:{value:null},active:{value:null},_noTransition:{value:null},_templateDocumentPart:{value:null},isDirty:{value:!1},_selected:{value:null},selected:{get:function(){return this._selected},set:function(e){e=!!e,this.object&&this.repetition&&this.repetition.contentController&&(e?this.repetition.contentController.selection.add(this.object):this.repetition.contentController.selection["delete"](this.object)),this._selected!==e&&(this._selected=e,this.repetition._addDirtyClassListIteration(this),this.repetition.needsDraw=!0)}},constructor:{value:function(){c.isDebug&&c.debug("Iteration:%s create iteration %O",Object.hash(this),this),this.repetition=null,this.controller=null,this.object=null,this._fragment=null,this._childComponents=null,this.index=null,this._drawnIndex=null,this.active=!1,this.defineBinding("active",{"<->":"repetition.activeIterations.has(())"}),this._noTransition=!1,this.addOwnPropertyChangeListener("active",this),this.addOwnPropertyChangeListener("_noTransition",this),this.addPathChangeListener("index.defined() && _childComponents.defined()",this,"handleComponentModelChange"),this.cachedFirstElement=null}},_timeoutBecomeActiveID:{value:null},_shouldBecomeActive:{value:!1},shouldBecomeActive:{set:function(e){if(this._timeoutBecomeActiveID&&(clearTimeout(this._timeoutBecomeActiveID),this._timeoutBecomeActiveID=null),e){var t=this;this._shouldBecomeActive=!0,this._timeoutBecomeActiveID=setTimeout(function(){t._shouldBecomeActive&&(t.active=!0),t._shouldBecomeActive=!1},h)}else this._shouldBecomeActive=!1},get:function(){return this._shouldBecomeActive}},initWithRepetition:{value:function(e){return this.repetition=e,this}},recycle:{value:function(){this.index=null,this.object=null,this._noTransition=!0}},injectIntoDocument:{value:function(e){null!==this._drawnIndex?(c.isDebug&&c.debug("Iteration:%s retracting from index %s and injecting at %s",Object.hash(this),this._drawnIndex,e),this.retractFromDocument()):c.isDebug&&c.debug("Iteration:%s injecting at index %s",Object.hash(this),e);var t=this,i=this.repetition,n=i.element,r=i._boundaries,a=n.ownerDocument.createTextNode(""),s=r[e];if(r.splice(e,0,a),n.insertBefore(a,s),n.insertBefore(this._fragment,s),i._drawnIterations.splice(e,0,this),i._updateDrawnIndexes(e),i._addDirtyClassListIteration(this),!this._elementsWillBeAddedToMap){var o=this._childComponents.length,l=function(e){e.target.removeEventListener("firstDraw",l,!1),o--,o||t.forEachElement(function(e){i._iterationForElement.set(e,t)})};if(this._childComponents.length>0)for(var u=0;u<this._childComponents.length;u++){var h=this._childComponents[u];h.addEventListener("firstDraw",l,!1),h.needsDraw=!0,h._completedFirstDraw===!0&&console.error("Repetiton:%s child component %O has already drawn.",Object.hash(this),h)}else this.forEachElement(function(e){i._iterationForElement.set(e,t)});this._elementsWillBeAddedToMap=!0}}},_elementsWillBeAddedToMap:{value:!1},retractFromDocument:{value:function(){c.isDebug&&c.debug("Iteration:%s retractFromDocument drawnIndex: %s",Object.hash(this),this._drawnIndex);var e=this._drawnIndex,t=this.repetition,i=t.element,n=t._boundaries[e],r=t._boundaries[e+1];t._boundaries.splice(e,1);for(var a=this._fragment,s=n.nextSibling;s!=r;){var o=s.nextSibling;i.removeChild(s),a.appendChild(s),s=o}i.removeChild(n),this._drawnIndex=null,t._drawnIterations.splice(e,1),t._updateDrawnIndexes(e)}},handleComponentModelChange:{value:function(e){e?this._childComponents.forEach(this.repetition.addChildComponent,this.repetition):this._childComponents&&this._childComponents.forEach(this.repetition.removeChildComponent,this.repetition)}},handlePropertyChange:{value:function(){this.repetition&&(this.repetition._addDirtyClassListIteration(this),this.repetition.needsDraw=!0)}},forEachElement:{value:function(e,t){var i=this.repetition,n=this._drawnIndex;if(null!=n)for(var r=i._boundaries[n];r!==i._boundaries[n+1];r=r.nextSibling)1===r.nodeType&&e.call(t,r)}},firstElement:{get:function(){var e=this.repetition,t=this._drawnIndex;if(null!=t)for(var i=e._boundaries[t];i!==e._boundaries[t+1];i=i.nextSibling)if(1===i.nodeType)return this.cachedFirstElement=i,i}},isComponentTreeLoaded:{value:function(){return null!==this._fragment}},cachedFirstElement:{value:null}});t.Repetition=r.specialize({initWithContent:{value:function(e){return this.object=e,this}},initWithContentController:{value:function(e){return this.contentController=e,this}},content:{get:function(){return this.contentController?this.contentController.content:null},set:function(e){this.contentController.content=e}},_contentController:{value:null},contentController:{set:function(e){this._contentController!==e&&(this._contentController=e)},get:function(){return this._contentController||(this._contentController=new a),this._contentController}},isSelectionEnabled:{value:null},allowsMultipleSelection:{set:function(e){e=!!e,this.contentController.allowsMultipleSelection!==e&&(this.contentController.allowsMultipleSelection=e),e&&!this.isSelectionEnabled&&(this.isSelectionEnabled=!0)},get:function(){return void 0!==this.contentController&&null!==this.contentController&&this.contentController.allowsMultipleSelection}},selectedIterations:{value:null},selectedIndexes:{value:null},activeIterations:{value:null},iterations:{value:null},hasTemplate:{value:!1},_iterationTemplate:{value:null},clonesChildComponents:{value:!0},__pressComposer:{value:null},_pressComposer:{get:function(){return this.__pressComposer||(this.__pressComposer=new o,this.__pressComposer.lazyLoad=!0,this.addComposerForElement(this.__pressComposer,this.element)),this.__pressComposer}},_cancelSelectionRangeChangeListener:{value:null},_selection:{value:null},selection:{get:function(){return this._selection},set:function(e){this.contentController?(this.contentController.selection!==e&&(this.contentController.selection=e),this._selection!==this.contentController.selection&&(this._selection=this.contentController.selection),this._cancelSelectionRangeChangeListener&&this._cancelSelectionRangeChangeListener(),e?(this._cancelSelectionRangeChangeListener=this.contentController.selection.addRangeChangeListener(this,"selection"),this.handleSelectionRangeChange(e,[])):this._cancelSelectionRangeChangeListener=null):this._selection=e}},handleSelectionRangeChange:{value:function(e,t){if(this.iterations){var i,n,r,a,s,o,u=this.iterations.length;if(e.length<=1&&t.length<=1){if(t.length)for(r=t[0],s=0;s<u;s++)this.iterations[s].object===r&&(this.iterations[s].selected=!1);if(e.length)for(r=e[0],s=0;s<u;s++)this.iterations[s].object===r&&(this.iterations[s].selected=!0)}else{for(i=new l,s=0;s<u;s++)a=this.iterations[s],r=a.object,(n=i.get(r))||(n=[],i.set(r,n)),n.push(a);for(s=0;s<t.length;s++)if(n=i.get(t[s]))for(o=0;o<n.length;o++)n[o].selected=!1;for(s=0;s<e.length;s++)if(n=i.get(e[s]))for(o=0;o<n.length;o++)n[o].selected=!0}}}},_visibleIndexes:{value:null},visibleIndexes:{get:function(){return this._visibleIndexes},set:function(e){this._visibleIndexes!==e&&(this._visibleIndexes&&this._visibleIndexes.removeRangeChangeListener&&this._visibleIndexes.removeRangeChangeListener(this,"visibleIndexes"),this._visibleIndexes=e,this._visibleIndexes&&this._visibleIndexes.addRangeChangeListener&&this._visibleIndexes.addRangeChangeListener(this,"visibleIndexes"),this._updateOrganizedContent())}},handleVisibleIndexesRangeChange:{value:function(e,t,i){var n,r;if(this.__controllerOrganizedContent){for(n=[],r=0;r<e.length;r++)n.push(this.__controllerOrganizedContent[e[r]]);this.organizedContent.swap(i,t.length,n),this._isListeningToOrganizedContentChanges&&(this.handleOrganizedContentRangeChange(n.length,t.length,i),this.needsDraw=!0)}}},__controllerOrganizedContent:{value:null},_controllerOrganizedContent:{get:function(){return this.__controllerOrganizedContent},set:function(e){this.__controllerOrganizedContent!==e&&(this.__controllerOrganizedContent&&this.__controllerOrganizedContent.removeRangeChangeListener&&this.__controllerOrganizedContent.removeRangeChangeListener(this,"controllerOrganizedContent"),this.__controllerOrganizedContent=e,this.__controllerOrganizedContent&&this.__controllerOrganizedContent.addRangeChangeListener&&this.__controllerOrganizedContent.addRangeChangeListener(this,"controllerOrganizedContent"),this._updateOrganizedContent())}},handleControllerOrganizedContentRangeChange:{value:function(e,t,i){this._visibleIndexes?this._updateOrganizedContent():(this.organizedContent.swap(i,t.length,e),this._isListeningToOrganizedContentChanges&&(this.handleOrganizedContentRangeChange(e.length,t.length,i),this.needsDraw=!0))}},_updateOrganizedContent:{value:function(){var e,t;if(this.__controllerOrganizedContent)if(this._visibleIndexes){for(this.organizedContent.length>this._visibleIndexes.length&&(this.organizedContent.length=this._visibleIndexes.length,this._isListeningToOrganizedContentChanges&&this.handleOrganizedContentRangeChange(0,this.organizedContent.length-this._visibleIndexes.length,this._visibleIndexes.length)),e=this.organizedContent.length,t=0;t<this._visibleIndexes.length;t++)this.organizedContent[t]!==this.__controllerOrganizedContent[this._visibleIndexes[t]]&&(this.organizedContent[t]=this.__controllerOrganizedContent[this._visibleIndexes[t]],this._isListeningToOrganizedContentChanges&&this.handleOrganizedContentRangeChange(1,e>t?1:0,t));this._isListeningToOrganizedContentChanges&&(this.needsDraw=!0)}else e=this.organizedContent.length,this.organizedContent.swap(0,e,this.__controllerOrganizedContent),this._isListeningToOrganizedContentChanges&&(this.handleOrganizedContentRangeChange(this.__controllerOrganizedContent.length,e,0),this.needsDraw=!0);else e=this.organizedContent.length,this.organizedContent=[],this._isListeningToOrganizedContentChanges&&(this.handleOrganizedContentRangeChange(0,e,0),this.needsDraw=!0)}},constructor:{value:function(){this.contentController=null,this.organizedContent=[],this.defineBinding("_controllerOrganizedContent",{"<-":"contentController.organizedContent"}),this.isSelectionEnabled=!1,this.defineBinding("selection",{"<-":"contentController.selection"}),this.defineBinding("selectedIterations",{"<-":"iterations.filter{selected}"}),this.defineBinding("selectedIndexes",{"<-":"selectedIterations.map{index}"}),this.defineBinding("allowsMultipleSelection",{"<-":"contentController.allowsMultipleSelection"}),this._iterationTemplate=null,this.addPathChangeListener(this._setupRequirements,this,"_handleSetupRequirementsChange"),this.addPathChangeListener("innerTemplate",this,"_handleInnerTemplateChange"),this.iterations=[],this._drawnIterations=[],this._freeIterations=[],this._iterationForElement=new l,this._iterationCreationPromise=s.resolve(),this._boundaries=[],this._dirtyClassListIterations=new u,this._requestedIterations=0,this._createdIterations=0,this._canDrawInitialContent=!1,this._initialContentDrawn=!1,this.addOwnPropertyChangeListener("isSelectionEnabled",this),this._selectionPointer=null,this.activeIterations=[]}},_setupRequirements:{value:"[!_iterationTemplate.defined(),!_newDomContent.defined(),!_shouldClearDomContentOnNextDraw,_isComponentExpanded,_ownerDocumentPart.defined()].every{}"},_handleSetupRequirementsChange:{value:function(e){e&&this._setupIterationTemplate()}},_handleInnerTemplateChange:{value:function(e){this._iterationTemplate&&this._teardownIterationTemplate(),e&&this.getPath(this._setupRequirements)&&this._setupIterationTemplate()}},cleanupDeletedComponentTree:{value:function(e){var t=this._innerTemplate;this._innerTemplate=null,t&&this._teardownIterationTemplate(),e&&this.cancelBindings()}},expandComponent:{value:function(){return this._isComponentExpanded=!0,s.resolve()}},_buildIterationTemplate:{value:function(){var e,t,i,r;return e=this.innerTemplate.clone(),t=e.getSerialization(),i=t.getSerializationObject(),r=n.getInfoForObject(this).label,this._iterationLabel=r+":iteration",i[this._iterationLabel]={},e.setObjects(i),this.innerTemplate.hasParameters()&&this._expandIterationTemplateParameters(e),window._montage_le_flag&&(e.refresher=this,this._leTagIterationTemplate(e)),e}},_rebuildIterationTemplate:{value:function(){var e,t=this._iterationTemplate,i=this.iterations;this._purgeFreeIterations();for(var n,r=0;n=i[r];r++)n.isDirty=!0;this._innerTemplate=null,e=this._buildIterationTemplate(),t.replaceContentsWithTemplate(e)}},refreshTemplate:{value:function(){this._rebuildIterationTemplate()}},_isListeningToOrganizedContentChanges:{value:!1},_setupIterationTemplate:{value:function(){this._iterationTemplate=this._buildIterationTemplate();for(var e,t=this.childComponents,i=t.length-1;e=t[i--];)e.detachFromParentComponent(),e.needsDraw=!1,e.cleanupDeletedComponentTree(!0);this.handleOrganizedContentRangeChange(this.organizedContent.length,0,0),this._isListeningToOrganizedContentChanges=!0,this._canDrawInitialContent=!0,this.needsDraw=!0}},_leTagIterationTemplate:{value:function(e){var t=e.document.body;if(t.children.length>0){var i=this.ownerComponent._montage_metadata.moduleId,n=this._montage_metadata.label;this._leTagStarArgument(i,n,t)}}},_teardownIterationTemplate:{value:function(){this._isListeningToOrganizedContentChanges=!1,this.handleOrganizedContentRangeChange(0,this.organizedContent.length,0),this._purgeFreeIterations(),this._iterationTemplate=null,this._iterationForElement.clear(),this._requestedIterations=0,this._createdIterations=0,this._canDrawInitialContent=!1,this._selectionPointer=null,this.activeIterations.clear(),this._dirtyClassListIterations.clear()}},_purgeFreeIterations:{value:function(){for(var e=0;e<this._freeIterations.length;e++)for(var t=this._freeIterations[e],i=0;i<t._childComponents.length;i++){var n=t._childComponents[i];this.removeChildComponent(n),n.cleanupDeletedComponentTree(!0)}this._freeIterations.clear()}},_expandIterationTemplateParameters:{value:function(e){for(var t,i,n,r,a,s,o,l,u,c=this;e.hasParameters();){c=c.ownerComponent,t=c._ownerDocumentPart.template,r=c._ownerDocumentPart.objects,s=e.expandParameters(c),n=e.getSerialization().getExternalObjectLabels(),a=e.getInstances(),l=s.labels,i=s.labelsCollisions;for(var h,d=0;h=l[d];d++)o=i&&h in i?i[h]:h,n.indexOf(o)>=0?a[o]=r[h]:(u=t.getObjectMetadata(h),u.owner||(u.owner=r.owner),e.setObjectMetadata(o,u.require,u.label,u.owner))}}},_iterationLabel:{value:null},_iterationCreationPromise:{value:null},_createIteration:{value:function(){var e=this,t=(new this.Iteration).initWithRepetition(this);return this._iterationCreationPromise=this._iterationCreationPromise.then(function(){var i,n,r=e.element.ownerDocument;return i=e._iterationTemplate.getInstances(),i=Object.create(i),i[e._iterationLabel]=t,n=e._iterationTemplate.instantiateWithInstances(i,r).then(function(i){return i.parentDocumentPart=e._ownerDocumentPart,t._templateDocumentPart=i,i.loadComponentTree().then(function(){c.isDebug&&c.debug("Iteration:%s component tree loaded.",Object.hash(t)),t._fragment=i.fragment,t._childComponents=i.childComponents,e.constructIteration(t)}),t}),n.then(null,function(){})}),this._requestedIterations++,t}},constructIteration:{value:function(e){this._createdIterations++,this._createdIterations>=this._requestedIterations&&(this.needsDraw=!0,this._canDraw=!0)}},_controllerIterations:{value:null},_drawnIterations:{value:null},_freeIterations:{value:null},handleOrganizedContentRangeChange:{value:function(e,t,i){var n,r,a,s,o=i,l=this.iterations,u=Math.min(e,t),h=t-u,d=e-u,m=this.organizedContent;for(c.isDebug&&(c.debug("Repetition:%s content changed +%s@%s %O -%s %O ",Object.hash(this),e?e:0,i,t?t:0),c.debug("Repetition:%s +%s -%s iterations",Object.hash(this),d,h)),this._iterationTemplate.isDirty&&this._iterationTemplate.refresh(),a=0;a<u;a++,i++)l[i].object=m[i];if(h>0)for(n=l.splice(i,h),a=0;a<h;a++)r=n[a],r.recycle(),r.isDirty||this._freeIterations.push(r);if(d>0){if(c.isDebug)var p=[];for(;this._freeIterations.length<d;)this._freeIterations.push(this._createIteration()),c.isDebug&&p.push(this._freeIterations[this._freeIterations.length-1]);var g=new Array(d);for(a=u,s=0;a<e;a++,s++){var f=this._freeIterations.pop();c.isDebug&&(p.has(f)||c.debug("Repetition:%s reusing %s",Object.hash(this),Object.hash(f)));var v=m[o+a];f.object=v,g[s]=f}l.swap(i,0,g)}(h>0||d>0)&&this._updateIndexes(i)}},_updateIndexes:{value:function(e){for(var t=this.iterations;e<t.length;e++)t[e].index=e}},_addDirtyClassListIteration:{value:function(e){e.forEachElement(function(t){var i;t&&(i=t.component)?(i.classList[e.active?"add":"remove"]("active"),i.classList[e.selected?"add":"remove"]("selected"),i.classList.remove("no-transition")):this._dirtyClassListIterations.add(e)},this)}},canDraw:{value:function(){var e=this.canDrawGate.value;return e=e&&this._requestedIterations<=this._createdIterations,e=e&&(this._initialContentDrawn||this._canDrawInitialContent)}},_boundaries:{value:null},_dirtyClassListIterations:{value:null},_requestedIterations:{value:null},_createdIterations:{value:null},_canDrawInitialContent:{value:null},_initialContentDrawn:{value:null},draw:{value:function(){this._initialContentDrawn||(this._drawInitialContent(),this._initialContentDrawn=!0);for(var e=this._drawnIterations.length-1;e>=0;e--)null===this._drawnIterations[e].index&&this._drawnIterations[e].retractFromDocument();for(var e=0;e<this.iterations.length;e++){var t=this.iterations[e];t._drawnIndex!==t.index&&t.isComponentTreeLoaded()&&t.injectIntoDocument(e)}var i=this._dirtyClassListIterations.toArray();this._dirtyClassListIterations.clear(),i.forEach(function(e){e.isComponentTreeLoaded()&&e.forEachElement(function(t){t.component||(t.classList[e.active?"add":"remove"]("active"),t.classList[e.selected?"add":"remove"]("selected"),t.classList.remove("no-transition"))},this)},this)}},_drawInitialContent:{value:function(){for(var e=this.element,t=e.childNodes.length,i=0;i<t;i++)e.removeChild(e.firstChild);var n=e.ownerDocument.createTextNode("");e.appendChild(n),this._boundaries.push(n)}},_updateDrawnIndexes:{value:function(e){for(var t=this._drawnIterations;e<t.length;e++)t[e]._drawnIndex=e}},_selectionPointer:{value:null},_startX:{value:0},_startY:{value:0},_currentActiveIteration:{value:null},handleIsSelectionEnabledChange:{value:function(e){e?this._enableSelectionTracking():this._disableSelectionTracking()}},_enableSelectionTracking:{value:function(){this._pressComposer.addEventListener("pressStart",this,!1)}},_disableSelectionTracking:{value:function(){this._pressComposer.removeEventListener("pressStart",this,!1)}},handlePressStart:{value:function(e){var t=this._findIterationContainingElement(e.targetElement);t&&(this._startX=e.clientX,this._startY=e.clientY,this.__pressComposer.addEventListener("press",this,!1),this.__pressComposer.addEventListener("pressCancel",this,!1),t.shouldBecomeActive=!0,this._currentActiveIteration=t)}},_ignoreSelection:{value:function(){this._currentActiveIteration&&(this._currentActiveIteration.shouldBecomeActive=!1,this._currentActiveIteration=null),this.activeIterations.clear(),this._startX=0,this._startY=0,this.__pressComposer.removeEventListener("press",this,!1),this.__pressComposer.removeEventListener("pressCancel",this,!1)}},handlePressCancel:{value:function(){this._ignoreSelection()}},handlePress:{value:function(e){var t=this._findIterationContainingElement(e.targetElement);t&&this._currentActiveIteration===t&&(t.active=!1,t.selected?this.allowsMultipleSelection&&(t.selected=!1):t.selected=!0),this._ignoreSelection()}},_findIterationContainingElement:{value:function(e){for(var t;e;){if(e===this.element)return this._iterationForElement.get(t);t=e,e=e.parentNode}}},Iteration:{value:d,serializable:!1}})}}),montageDefine("b0111a3","core/template",{dependencies:["./core","core/serialization/deserializer/montage-deserializer","./document-part","./document-resources","./serialization/serialization","./serialization/serializer/montage-labeler","./promise","./mini-url","./logger","./event/event-manager","./application"],factory:function(e,t,i){function n(e,t,i){var n,r,a=new m,s=e.documentElement.outerHTML,l=new o,u=e.documentElement;return n=a.createHtmlDocumentWithHtml(s,e.location.href),a.initWithDocument(n,t).then(function(){return a.setBaseUrl(e.location.href),r=a._createTemplateObjects(i),l.initWithTemplateAndFragment(a),a._instantiateObjects(r,u).then(function(e){return l.objects=e,a._invokeDelegates(l),l})})}var r,a=e("./core").Montage,s=e("core/serialization/deserializer/montage-deserializer").MontageDeserializer,o=e("./document-part").DocumentPart,l=e("./document-resources").DocumentResources,u=e("./serialization/serialization").Serialization,c=e("./serialization/serializer/montage-labeler").MontageLabeler,h=e("./promise").Promise,d=e("./mini-url"),m=(e("./logger").logger("template"),e("./event/event-manager").defaultEventManager,a.specialize({_SERIALIZATION_SCRIPT_TYPE:{value:"text/montage-serialization"},_ELEMENT_ID_ATTRIBUTE:{value:"data-montage-id"},PARAM_ATTRIBUTE:{value:"data-param"},_require:{value:null},_resources:{value:null},_baseUrl:{value:null},_instances:{value:null},_metadata:{value:null},_objectsString:{value:null},objectsString:{get:function(){return this._objectsString},set:function(e){this._objectsString=e,this._serialization&&this._serialization.initWithString(e),this.__deserializer=null}},__deserializer:{value:null},_deserializer:{get:function(){var e,t,i=this.__deserializer;if(!i){if(e=this._metadata){t=Object.create(null);for(var n in e)t[n]=e[n].require}i=(new s).init(this.objectsString,this._require,t),this.__deserializer=i}return i}},getDeserializer:{value:function(){return this._deserializer}},_serialization:{value:null},getSerialization:{value:function(){var e=this._serialization;return e||(e=this._serialization=new u,e.initWithString(this.objectsString)),e}},_isDirty:{value:!1},isDirty:{get:function(){return this._isDirty},set:function(e){this._isDirty!==e&&(this._isDirty=e,this.clearTemplateFromElementContentsCache())}},refresher:{value:null},_document:{value:null},document:{get:function(){return this._isDirty&&this.refresh(),this._document},set:function(e){this._document=e}},initWithRequire:{value:function(e){return this._require=e,this.document=this.createHtmlDocumentWithHtml(""),this.objectsString="",this}},initWithDocument:{value:function(e,t){var i=this;return this._require=t,this.setDocument(e),this.getObjectsString(e).then(function(e){return i.objectsString=e,i})}},initWithHtml:{value:function(e,t){var i=this;return this._require=t,this.document=this.createHtmlDocumentWithHtml(e),this.getObjectsString(this.document).then(function(e){return i.objectsString=e,i})}},initWithObjectsAndDocumentFragment:{value:function(e,t,i){return this._require=i,this.document=this.createHtmlDocumentWithHtml(""),this.document.body.appendChild(this.document.importNode(t,!0)),this.setObjects(e),this}},initWithModuleId:{value:function(e,t){var i=this;return this._require=t,this.createHtmlDocumentWithModuleId(e,t).then(function(n){var r=t(e).directory;return i.document=n,i.setBaseUrl(r),i.getObjectsString(n).then(function(e){return i.objectsString=e,i})})}},clone:{value:function(){var e=new m;return e._require=this._require,e._baseUrl=this._baseUrl,e.setDocument(this.document),e.objectsString=this.objectsString,e._instances=Object.clone(this._instances,1),e}},instantiate:{value:function(e){return this.instantiateWithInstances(null,e)}},instantiateWithInstances:{value:function(e,t){var i,n,r,a=this,s=new o;
return e=e||this._instances,i=this._createMarkupDocumentFragment(t),r=this._getParameters(i),s.initWithTemplateAndFragment(this,i),s.startActingAsTopComponent(),s.parameters=r,n=this._createTemplateObjects(e),this._instantiateObjects(n,i).then(function(i){var n;return s.objects=i,a._invokeDelegates(s,e),s.stopActingAsTopComponent(),n=a.getResources(),!n.resourcesLoaded()&&n.hasResources()&&n.loadResources(t),s})}},_objectsInstantiationOptimized:{value:!1},_optimizeObjectsInstantiationPromise:{value:null},_optimizeObjectsInstantiation:{value:function(){var e,t=this;if(!this._objectsInstantiationOptimized)return this._optimizeObjectsInstantiationPromise||(e=this._deserializer.preloadModules(),e?this._optimizeObjectsInstantiationPromise=e.then(function(){t._objectsInstantiationOptimized=!0}):this._objectsInstantiationOptimized=!0),this._optimizeObjectsInstantiationPromise}},setBaseUrl:{value:function(e){this._baseUrl=e}},getBaseUrl:{value:function(){return this._baseUrl}},getResources:{value:function(){var e=this._resources;return e||(e=this._resources=new p,e.initWithTemplate(this)),e}},_createTemplateObjects:{value:function(t){var i=Object.create(t||null);return"undefined"==typeof r&&(r=e("./application").application),i.application=r,i.template=this,i}},_instantiateObjects:{value:function(e,t){var i,n=this._deserializer;return h.is(n)?n:(i=this._optimizeObjectsInstantiation(),i?i.then(function(){return n.deserialize(e,t)}):n.deserialize(e,t))}},_createMarkupDocumentFragment:{value:function(e){for(var t=e.createDocumentFragment(),i=this.document.body.childNodes,n=0,r=i.length;n<r;n++)t.appendChild(e.importNode(i[n],!0));return t}},getParameterName:{value:function(e){return e.getAttribute(this.PARAM_ATTRIBUTE)}},getParameters:{value:function(){return this._getParameters(this.document.body)}},_getParameters:{value:function(e){for(var t,i,n=e.querySelectorAll("*["+this.PARAM_ATTRIBUTE+"]"),r=n.length,a={},s=0;s<r;s++){if(t=n[s],i=this.getParameterName(t),i in a)throw new Error('The parameter "'+i+'" is declared more than once in '+this.getBaseUrl()+".");a[i]=t}return a}},hasParameters:{value:function(){return!!this.document.querySelector("*["+this.PARAM_ATTRIBUTE+"]")}},_invokeDelegates:{value:function(e,t){var i,n,r,a=e.objects,s=a.owner||t&&t.owner;for(var o in a)t&&o in t||(i=a[o],n=this._getObjectOwner(o,s),r=this._getObjectLabel(o),i&&("function"==typeof i._deserializedFromTemplate&&i._deserializedFromTemplate(n,r,e),"function"==typeof i.deserializedFromTemplate&&i.deserializedFromTemplate(n,r,e)));if(s){var l=this.getSerialization();l.isExternalObject("owner")||("function"==typeof s._templateDidLoad&&s._templateDidLoad(e),"function"==typeof s.templateDidLoad&&s.templateDidLoad(e))}}},setInstances:{value:function(e){this._instances=e}},getInstances:{value:function(){return this._instances}},setObjects:{value:function(e){this.objectsString=JSON.stringify(e,null,4)}},setObjectMetadata:{value:function(e,t,i,n){var r=this._metadata;r||(this._metadata=r=Object.create(null)),r[e]={require:t,label:i,owner:n},this.__deserializer=null}},getObjectMetadata:{value:function(e){var t=this._metadata;return t&&e in t?t[e]:{require:this._require,label:e}}},_getObjectOwner:{value:function(e,t){var i,n=this._metadata;return i=n&&e in n?n[e].owner:t}},_getObjectLabel:{value:function(e){var t,i=this._metadata;return t=i&&e in i?i[e].label:e}},setDocument:{value:function(e){this.document=this.cloneHtmlDocument(e),this.clearTemplateFromElementContentsCache()}},getObjectsString:{value:function(e){var t;return t=this.getInlineObjectsString(e),null===t?this.getExternalObjectsString(e):h.resolve(t)}},getInlineObjectsString:{value:function(e){var t="script[type='"+this._SERIALIZATION_SCRIPT_TYPE+"']",i=e.querySelector(t);return i?i.textContent:null}},getExternalObjectsString:{value:function(e){var t,i=e.querySelector('link[rel="serialization"]');return i?t=new h(function(e,t){var n=new XMLHttpRequest,r=i.getAttribute("href");n.open("GET",r),n.addEventListener("load",function(i){var n=i.target;200==n.status?e(n.responseText):t(new Error("Unable to retrive '"+r+"', code status: "+n.status))},!1),n.addEventListener("error",function(e){t(new Error("Unable to retrive '"+r+"' with error: "+e.error+"."))},!1),n.send()}):h.resolve(null)}},createHtmlDocumentWithHtml:{value:function(e,t){var i=document.implementation.createHTMLDocument("");return e&&(i.documentElement.innerHTML=e,t&&this.normalizeRelativeUrls(i,t)),i}},cloneHtmlDocument:{value:function(e){var t=document.implementation.createHTMLDocument(""),i=e.baseURI||e.URL;return t.replaceChild(t.importNode(e.documentElement,!0),t.documentElement),this.normalizeRelativeUrls(t,i),t}},createHtmlDocumentWithModuleId:{value:function(e,t){var i=this;return"function"!=typeof t?h.reject(new Error("Missing 'require' function to load module '"+e+"'.")):t.async(e).then(function(e){return i.createHtmlDocumentWithHtml(e.content,e.directory)})}},_removeObjects:{value:function(e){var t="script[type='"+this._SERIALIZATION_SCRIPT_TYPE+"'], link[rel='serialization']";Array.prototype.forEach.call(e.querySelectorAll(t),function(e){e.parentNode.removeChild(e)})}},_addObjects:{value:function(e,t){if(t){var i=e.createElement("script");i.setAttribute("type",this._SERIALIZATION_SCRIPT_TYPE),i.textContent=JSON.stringify(JSON.parse(t),null,4),e.head.appendChild(i)}}},_templateFromElementContentsCache:{value:null},clearTemplateFromElementContentsCache:{value:function(){this._templateFromElementContentsCache=null}},createTemplateFromElementContents:{value:function(e){var t,i,n,r=this._templateFromElementContentsCache;return r||(r=Object.create(null),this._templateFromElementContentsCache=r),e in r?Object.create(r[e]):(t=this.getElementById(e),n=this.document.createRange(),n.selectNodeContents(t),i=this.createTemplateFromRange(n),r[e]=i,Object.create(i))}},createTemplateFromElement:{value:function(e){var t,i;return t=this.getElementById(e),i=this.document.createRange(),i.selectNode(t),this.createTemplateFromRange(i)}},createTemplateFromRange:{value:function(e){var t,i,n,r,a,s=new u;return t=e.cloneContents(),i=this._getChildrenElementIds(t),s.initWithString(this.objectsString),n=s.getSerializationLabelsWithElements(i),a=s.extractSerialization(n,["owner"]),r=new m,r.initWithObjectsAndDocumentFragment(null,t,this._require),r.objectsString=a.getSerializationString(),r._resources=this.getResources(),r}},_createSerializationWithElementIds:{value:function(e){var t,i,n=new u;return n.initWithString(this.objectsString),t=n.getSerializationLabelsWithElements(e),i=n.extractSerialization(t,["owner"])}},expandParameters:{value:function(e){var t,i,n,r,a,s,o,l=[],u={},c=this.getSerialization(),h={};t=this.getParameters();for(var d in t)if(r=t[d],a=e.getTemplateArgumentElement(d),l.push.apply(l,this._getElementIds(a)),i=this.replaceNode(a,r))for(var m in i)u[m]=i[m];return h.elementIds=l,h.elementIdsCollisions=u,s=e.getTemplateArgumentSerialization(l),s.renameElementReferences(u),o=function(t){if(t.indexOf(":")>0)return e.resolveTemplateArgumentTemplateProperty(t)},n=c.mergeSerialization(s,{willMergeObjectWithLabel:o}),this.objectsString=c.getSerializationString(),h.labels=s.getSerializationLabels(),h.labelsCollisions=n,h}},_resolveElementIdCollisions:{value:function(e,t){var i,n,r,a,s;t=t||new c,r=this.getElementIds();for(var o,l=0;o=r[l];l++)t.addLabel(o);n=this._getElements(e);for(var o in n)this.getElementById(o)&&(a=n[o],s=t.generateLabel(t.getLabelBaseName(o)),this.setElementId(a,s),i||(i=Object.create(null)),i[o]=s);return i}},replaceNode:{value:function(e,t,i){var n;return n=this._resolveElementIdCollisions(e,i),this.normalizeRelativeUrls(e,this.getBaseUrl()),t.parentNode.replaceChild(e,t),n}},insertNodeBefore:{value:function(e,t,i){var n;return n=this._resolveElementIdCollisions(e,i),this.normalizeRelativeUrls(e,this.getBaseUrl()),t.parentNode.insertBefore(e,t),n}},appendNode:{value:function(e,t,i){var n;return n=this._resolveElementIdCollisions(e,i),this.normalizeRelativeUrls(e,this.getBaseUrl()),t.appendChild(e),n}},getElementId:{value:function(e){if(e.getAttribute)return e.getAttribute(this._ELEMENT_ID_ATTRIBUTE)}},setElementId:{value:function(e,t){e.setAttribute(this._ELEMENT_ID_ATTRIBUTE,t)}},getElementIds:{value:function(){return this._getElementIds(this.document.body)}},_getElements:{value:function(e){var t,i,n="*["+this._ELEMENT_ID_ATTRIBUTE+"]",r={};t=e.querySelectorAll(n);for(var a,s=0;a=t[s];s++)i=this.getElementId(a),r[i]=a;return i=this.getElementId(e),i&&(r[i]=e),r}},_getChildrenElementIds:{value:function(e){var t,i="*["+this._ELEMENT_ID_ATTRIBUTE+"]",n=[];t=e.querySelectorAll(i);for(var r,a=0;r=t[a];a++)n.push(this.getElementId(r));return n}},_getElementIds:{value:function(e){var t,i=this._getChildrenElementIds(e);return t=this.getElementId(e),t&&i.push(t),i}},getElementById:{value:function(e){var t="*["+this._ELEMENT_ID_ATTRIBUTE+"='"+e+"']";return this.document.querySelector(t)}},html:{get:function(){var e=this.document;return this._removeObjects(e),this._addObjects(e,this.objectsString),this._getDoctypeString(e.doctype)+"\n"+e.documentElement.outerHTML}},_getDoctypeString:{value:function(e){return"<!DOCTYPE "+e.name+(e.publicId?' PUBLIC "'+e.publicId+'"':"")+(!e.publicId&&e.systemId?" SYSTEM":"")+(e.systemId?' "'+e.systemId+'"':"")+">"}},normalizeRelativeUrls:{value:function(e,t){if("string"==typeof t&&""!==t&&"about:blank"!==t)for(var i="http://www.w3.org/1999/xlink",n=/^[\w\-]+:|^\//,r=m._NORMALIZED_TAG_NAMES.indexOf(e.tagName)!==-1?[e]:e.querySelectorAll(m._NORMALIZED_TAG_NAMES_SELECTOR),a=0,s=r.length;a<s;a++){var o,l=r[a];"image"===l.tagName?(o=l.getAttributeNS(i,"href"),n.test(o)||l.setAttributeNS(i,"href",d.resolve(t,o))):l.hasAttribute("src")?(o=l.getAttribute("src"),""===o||n.test(o)||l.setAttribute("src",d.resolve(t,o))):l.hasAttribute("href")&&(o=l.getAttribute("href"),""===o||n.test(o)||l.setAttribute("href",d.resolve(t,o)))}}},replaceContentsWithTemplate:{value:function(e){this._require=e._require,this._baseUrl=e._baseUrl,this._document=e._document,this.objectsString=e.objectsString,this._instances=e._instances,this._templateFromElementContentsCache=e._templateFromElementContentsCache,this._metadata=e._metadata}},refresh:{value:function(){this.isDirty&&(this.refresher&&"function"==typeof this.refresher.refreshTemplate?(this.refresher.refreshTemplate(this),this.isDirty=!1):console.warn("Not able to refresh without a refresher.refreshTemplate."))}}},{_templateCache:{value:{moduleId:Object.create(null)}},_getTemplateCacheKey:{value:function(e,t){return e=t.resolve(e),t.location+"#"+e}},getTemplateWithModuleId:{value:function(e,t){var i,n;return i=this._getTemplateCacheKey(e,t),n=this._templateCache.moduleId[i],n||(n=(new m).initWithModuleId(e,t),this._templateCache.moduleId[i]=n),n}},_NORMALIZED_TAG_NAMES:{value:["IMG","image","IFRAME","link","script"]},__NORMALIZED_TAG_NAMES_SELECTOR:{value:null},_NORMALIZED_TAG_NAMES_SELECTOR:{get:function(){return this.__NORMALIZED_TAG_NAMES_SELECTOR||(this.__NORMALIZED_TAG_NAMES_SELECTOR=this._NORMALIZED_TAG_NAMES.join(",")),this.__NORMALIZED_TAG_NAMES_SELECTOR}}})),p=a.specialize({_resources:{value:null},_resourcesLoaded:{value:!1},template:{value:null},rootUrl:{value:""},constructor:{value:function(){this._resources=Object.create(null)}},initWithTemplate:{value:function(e){this.template=e}},hasResources:{value:function(){return this.getStyles().length>0||this.getScripts().length>0}},resourcesLoaded:{value:function(){return this._resourcesLoaded}},loadResources:{value:function(e){return this._resourcesLoaded=!0,h.all([this.loadScripts(e),this.loadStyles(e)])}},getScripts:{value:function(){var e,t,i,n=this._resources.scripts;if(!n){t=this.template,n=this._resources.scripts=[],i=t.document.querySelectorAll("script");for(var r=0,a=i.length;r<a;r++)e=i[r],e.type!==this.template._SERIALIZATION_SCRIPT_TYPE&&n.push(e)}return n}},loadScripts:{value:function(e){var t=this.getScripts(),i=t.length;if(i){for(var n=[],r=0;r<i;r++)n.push(this.loadScript(t[r],e));return h.all(n)}return h.resolve()}},loadScript:{value:function(e,t){var i,n;return i=l.getInstanceForDocument(t),n=this._cloneScriptElement(e,t),i.addScript(n)}},_cloneScriptElement:{value:function(e,t){for(var i,n=t.createElement("script"),r=e.attributes,a=0,s=r.length;a<s;a++)i=r[a],n.setAttribute(i.name,i.value);return n.textContent=e.textContent,n}},getStyles:{value:function(){var e,t,i,n=this._resources.styles;return n||(i='link[rel="stylesheet"], style',e=this.template,t=e.document.querySelectorAll(i),n=Array.prototype.slice.call(t,0),this._resources.styles=n),n}},loadStyles:{value:function(e){var t,i=[];t=this.getStyles();for(var n=0,r=t.length;n<r;n++)i.push(this.loadStyle(t[n],e));return h.all(i)}},loadStyle:{value:function(e,t){var i,n;return i=e.getAttribute("href"),i?(n=l.getInstanceForDocument(t),n.preloadResource(i)):h.resolve()}},createStylesForDocument:{value:function(e){for(var t,i,n=this.getStyles(),r=[],a=0;i=n[a];a++)t=e.importNode(i,!0),r.push(t);return r}}}),g=a.specialize({getTemplateArgumentElement:{value:Function.noop},getTemplateArgumentSerialization:{value:Function.noop},resolveTemplateArgumentTemplateProperty:{value:Function.noop}});t.Template=m,t.TemplateArgumentProvider=g,t.TemplateResources=p,t.instantiateDocument=n}}),montageDefine("8987d1b","q",{dependencies:[],factory:function(e,t,i){!function(e){"use strict";if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof t&&"object"==typeof i)i.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var n="undefined"!=typeof window?window:self,r=n.Q;n.Q=e(),n.Q.noConflict=function(){return n.Q=r,this}}}(function(){"use strict";function e(e){return function(){return H.apply(e,arguments)}}function t(e){return e===Object(e)}function i(e){return"[object StopIteration]"===ne(e)||e instanceof q}function n(e,t){if(V&&t.stack&&"object"==typeof e&&null!==e&&e.stack){for(var i=[],n=t;n;n=n.source)n.stack&&(!e.__minimumStackCounter__||e.__minimumStackCounter__>n.stackCounter)&&(ee(e,"__minimumStackCounter__",{value:n.stackCounter,configurable:!0}),i.unshift(n.stack));i.unshift(e.stack);var a=i.join("\n"+re+"\n"),s=r(a);ee(e,"stack",{value:s,configurable:!0})}}function r(e){for(var t=e.split("\n"),i=[],n=0;n<t.length;++n){var r=t[n];o(r)||a(r)||!r||i.push(r)}return i.join("\n")}function a(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function s(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var i=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(i)return[i[1],Number(i[2])];var n=/.*@(.+):(\d+)$/.exec(e);return n?[n[1],Number(n[2])]:void 0}function o(e){var t=s(e);if(!t)return!1;var i=t[0],n=t[1];return i===U&&n>=X&&n<=ce}function l(){if(V)try{throw new Error}catch(e){var t=e.stack.split("\n"),i=t[0].indexOf("@")>0?t[1]:t[2],n=s(i);if(!n)return;return U=n[0],n[1]}}function u(e,t,i){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+i+" instead.",new Error("").stack),e.apply(e,arguments)}}function c(e){return e instanceof p?e:_(e)?P(e):S(e)}function h(){function e(e){t=e,c.longStackSupport&&V&&(a.source=e),Z(i,function(t,i){c.nextTick(function(){e.promiseDispatch.apply(e,i)})},void 0),i=void 0,n=void 0}var t,i=[],n=[],r=$(h.prototype),a=$(p.prototype);if(a.promiseDispatch=function(e,r,a){var s=K(arguments);i?(i.push(s),"when"===r&&a[1]&&n.push(a[1])):c.nextTick(function(){t.promiseDispatch.apply(t,s)})},a.valueOf=function(){if(i)return a;var e=f(t);return v(e)&&(t=e),e},a.inspect=function(){return t?t.inspect():{state:"pending"}},c.longStackSupport&&V)try{throw new Error}catch(s){a.stack=s.stack.substring(s.stack.indexOf("\n")+1),a.stackCounter=ae++}return r.promise=a,r.resolve=function(i){t||e(c(i))},r.fulfill=function(i){t||e(S(i))},r.reject=function(i){t||e(T(i))},r.notify=function(e){t||Z(n,function(t,i){c.nextTick(function(){i(e)})},void 0)},r}function d(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=h();try{e(t.resolve,t.reject,t.notify)}catch(i){t.reject(i)}return t.promise}function m(e){return d(function(t,i){for(var n=0,r=e.length;n<r;n++)c(e[n]).then(t,i)})}function p(e,t,i){void 0===t&&(t=function(e){return T(new Error("Promise does not support operation: "+e))}),void 0===i&&(i=function(){return{state:"unknown"}});var n=$(p.prototype);if(n.promiseDispatch=function(i,r,a){var s;try{s=e[r]?e[r].apply(n,a):t.call(n,r,a)}catch(o){s=T(o)}i&&i(s)},n.inspect=i,i){var r=i();"rejected"===r.state&&(n.exception=r.reason),n.valueOf=function(){var e=i();return"pending"===e.state||"rejected"===e.state?n:e.value}}return n}function g(e,t,i,n){return c(e).then(t,i,n)}function f(e){if(v(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function v(e){return e instanceof p}function _(e){return t(e)&&"function"==typeof e.then}function b(e){return v(e)&&"pending"===e.inspect().state}function w(e){return!v(e)||"fulfilled"===e.inspect().state}function y(e){return v(e)&&"rejected"===e.inspect().state}function E(){se.length=0,oe.length=0,ue||(ue=!0)}function C(e,t){ue&&("object"==typeof process&&"function"==typeof process.emit&&c.nextTick.runAfter(function(){J(oe,e)!==-1&&(process.emit("unhandledRejection",t,e),le.push(e))}),oe.push(e),t&&"undefined"!=typeof t.stack?se.push(t.stack):se.push("(no stack) "+t))}function x(e){if(ue){var t=J(oe,e);t!==-1&&("object"==typeof process&&"function"==typeof process.emit&&c.nextTick.runAfter(function(){var i=J(le,e);i!==-1&&(process.emit("rejectionHandled",se[t],e),le.splice(i,1))}),oe.splice(t,1),se.splice(t,1))}}function T(e){var t=p({when:function(t){return t&&x(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return C(t,e),t}function S(e){return p({when:function(){return e},get:function(t){return e[t]},set:function(t,i){e[t]=i},"delete":function(t){delete e[t]},post:function(t,i){return null===t||void 0===t?e.apply(void 0,i):e[t].apply(e,i)},apply:function(t,i){return e.apply(t,i)},keys:function(){return ie(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function P(e){var t=h();return c.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(i){t.reject(i)}}),t.promise}function A(e){return p({isDef:function(){}},function(t,i){return M(e,t,i)},function(){return c(e).inspect()})}function R(e,t,i){return c(e).spread(t,i)}function D(e){return function(){function t(e,t){var s;if("undefined"==typeof StopIteration){try{s=n[e](t)}catch(o){return T(o)}return s.done?c(s.value):g(s.value,r,a)}try{s=n[e](t)}catch(o){return i(o)?c(o.value):T(o)}return g(s,r,a)}var n=e.apply(this,arguments),r=t.bind(t,"next"),a=t.bind(t,"throw");return r()}}function L(e){c.done(c.async(e)())}function O(e){throw new q(e)}function I(e){return function(){return R([this,k(arguments)],function(t,i){return e.apply(t,i)})}}function M(e,t,i){return c(e).dispatch(t,i)}function k(e){return g(e,function(e){var t=0,i=h();return Z(e,function(n,r,a){var s;v(r)&&"fulfilled"===(s=r.inspect()).state?e[a]=s.value:(++t,g(r,function(n){e[a]=n,0===--t&&i.resolve(e)},i.reject,function(e){i.notify({index:a,value:e})}))},void 0),0===t&&i.resolve(e),i.promise})}function F(e){if(0===e.length)return c.resolve();var t=c.defer(),i=0;return Z(e,function(n,r,a){function s(e){t.resolve(e)}function o(e){if(i--,0===i){var n=e||new Error(""+e);n.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+n.message,t.reject(n)}}function l(e){t.notify({index:a,value:e})}var u=e[a];i++,g(u,s,o,l)},void 0),t.promise}function N(e){return g(e,function(e){return e=Q(e,c),g(k(Q(e,function(e){return g(e,W,W)})),function(){return e})})}function B(e){return c(e).allSettled()}function j(e,t){return c(e).then(void 0,void 0,t)}function z(e,t){return c(e).nodeify(t)}var V=!1;try{throw new Error}catch(G){V=!!G.stack}var U,q,X=l(),W=function(){},Y=function(){function e(){for(var e,n;i.next;)i=i.next,e=i.task,i.task=void 0,n=i.domain,n&&(i.domain=void 0,n.enter()),t(e,n);for(;o.length;)e=o.pop(),t(e);r=!1}function t(t,i){try{t()}catch(n){if(s)throw i&&i.exit(),setTimeout(e,0),i&&i.enter(),n;setTimeout(function(){throw n},0)}i&&i.exit()}var i={task:void 0,next:null},n=i,r=!1,a=void 0,s=!1,o=[];if(Y=function(e){n=n.next={task:e,domain:s&&process.domain,next:null},r||(r=!0,a())},"object"==typeof process&&"[object process]"===process.toString()&&process.nextTick)s=!0,a=function(){process.nextTick(e)};else if("function"==typeof setImmediate)a="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var l=new MessageChannel;l.port1.onmessage=function(){a=u,l.port1.onmessage=e,e()};var u=function(){l.port2.postMessage(0)};a=function(){setTimeout(e,0),u()}}else a=function(){setTimeout(e,0)};return Y.runAfter=function(e){o.push(e),r||(r=!0,a())},Y}(),H=Function.call,K=e(Array.prototype.slice),Z=e(Array.prototype.reduce||function(e,t){var i=0,n=this.length;if(1===arguments.length)for(;;){if(i in this){t=this[i++];break}if(++i>=n)throw new TypeError}for(;i<n;i++)i in this&&(t=e(t,this[i],i));return t}),J=e(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Q=e(Array.prototype.map||function(e,t){var i=this,n=[];return Z(i,function(r,a,s){n.push(e.call(t,a,s,i))},void 0),n}),$=Object.create||function(e){function t(){}return t.prototype=e,new t},ee=Object.defineProperty||function(e,t,i){return e[t]=i.value,e},te=e(Object.prototype.hasOwnProperty),ie=Object.keys||function(e){var t=[];for(var i in e)te(e,i)&&t.push(i);return t},ne=e(Object.prototype.toString);q="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var re="From previous event:";c.resolve=c,c.nextTick=Y,c.longStackSupport=!1;var ae=1;"object"==typeof process&&process&&process.env&&process.env.Q_DEBUG&&(c.longStackSupport=!0),c.defer=h,h.prototype.makeNodeResolver=function(){var e=this;return function(t,i){t?e.reject(t):arguments.length>2?e.resolve(K(arguments,1)):e.resolve(i)}},c.Promise=d,c.promise=d,d.race=m,d.all=k,d.reject=T,d.resolve=c,c.passByCopy=function(e){return e},p.prototype.passByCopy=function(){return this},c.join=function(e,t){return c(e).join(t)},p.prototype.join=function(e){return c([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Q can't join: not the same: "+e+" "+t)})},c.race=m,p.prototype.race=function(){return this.then(c.race)},c.makePromise=p,p.prototype.toString=function(){return"[object Promise]"},p.prototype.then=function(e,t,i){function r(t){try{return"function"==typeof e?e(t):t}catch(i){return T(i)}}function a(e){if("function"==typeof t){n(e,o);try{return t(e)}catch(i){return T(i)}}return T(e)}function s(e){return"function"==typeof i?i(e):e}var o=this,l=h(),u=!1;return c.nextTick(function(){o.promiseDispatch(function(e){u||(u=!0,l.resolve(r(e)))},"when",[function(e){u||(u=!0,l.resolve(a(e)))}])}),o.promiseDispatch(void 0,"when",[void 0,function(e){var t,i=!1;try{t=s(e)}catch(n){if(i=!0,!c.onerror)throw n;c.onerror(n)}i||l.notify(t)}]),l.promise},c.tap=function(e,t){return c(e).tap(t)},p.prototype.tap=function(e){return e=c(e),this.then(function(t){return e.fcall(t).thenResolve(t)})},c.when=g,p.prototype.thenResolve=function(e){return this.then(function(){return e})},c.thenResolve=function(e,t){return c(e).thenResolve(t)},p.prototype.thenReject=function(e){return this.then(function(){throw e})},c.thenReject=function(e,t){return c(e).thenReject(t)},c.nearer=f,c.isPromise=v,c.isPromiseAlike=_,c.isPending=b,p.prototype.isPending=function(){return"pending"===this.inspect().state},c.isFulfilled=w,p.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},c.isRejected=y,p.prototype.isRejected=function(){return"rejected"===this.inspect().state};var se=[],oe=[],le=[],ue=!0;c.resetUnhandledRejections=E,c.getUnhandledReasons=function(){return se.slice()},c.stopUnhandledRejectionTracking=function(){E(),ue=!1},E(),c.reject=T,c.fulfill=S,c.master=A,c.spread=R,p.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},c.async=D,c.spawn=L,c["return"]=O,c.promised=I,c.dispatch=M,p.prototype.dispatch=function(e,t){var i=this,n=h();return c.nextTick(function(){i.promiseDispatch(n.resolve,e,t)}),n.promise},c.get=function(e,t){return c(e).dispatch("get",[t])},p.prototype.get=function(e){return this.dispatch("get",[e])},c.set=function(e,t,i){return c(e).dispatch("set",[t,i])},p.prototype.set=function(e,t){return this.dispatch("set",[e,t])},c.del=c["delete"]=function(e,t){return c(e).dispatch("delete",[t])},p.prototype.del=p.prototype["delete"]=function(e){return this.dispatch("delete",[e])},c.mapply=c.post=function(e,t,i){return c(e).dispatch("post",[t,i])},p.prototype.mapply=p.prototype.post=function(e,t){return this.dispatch("post",[e,t])},c.send=c.mcall=c.invoke=function(e,t){return c(e).dispatch("post",[t,K(arguments,2)])},p.prototype.send=p.prototype.mcall=p.prototype.invoke=function(e){return this.dispatch("post",[e,K(arguments,1)])},c.fapply=function(e,t){return c(e).dispatch("apply",[void 0,t])},p.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},c["try"]=c.fcall=function(e){return c(e).dispatch("apply",[void 0,K(arguments,1)])},p.prototype.fcall=function(){return this.dispatch("apply",[void 0,K(arguments)])},c.fbind=function(e){var t=c(e),i=K(arguments,1);return function(){return t.dispatch("apply",[this,i.concat(K(arguments))])}},p.prototype.fbind=function(){var e=this,t=K(arguments);return function(){return e.dispatch("apply",[this,t.concat(K(arguments))])}},c.keys=function(e){return c(e).dispatch("keys",[])},p.prototype.keys=function(){return this.dispatch("keys",[])},c.all=k,p.prototype.all=function(){return k(this)},c.any=F,p.prototype.any=function(){return F(this)},c.allResolved=u(N,"allResolved","allSettled"),p.prototype.allResolved=function(){return N(this)},c.allSettled=B,p.prototype.allSettled=function(){return this.then(function(e){return k(Q(e,function(e){function t(){return e.inspect()}return e=c(e),e.then(t,t)}))})},c.fail=c["catch"]=function(e,t){return c(e).then(void 0,t)},p.prototype.fail=p.prototype["catch"]=function(e){return this.then(void 0,e)},c.progress=j,p.prototype.progress=function(e){return this.then(void 0,void 0,e)},c.fin=c["finally"]=function(e,t){return c(e)["finally"](t)},p.prototype.fin=p.prototype["finally"]=function(e){if(!e||"function"!=typeof e.apply)throw new Error("Q can't apply finally callback");return e=c(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},c.done=function(e,t,i,n){return c(e).done(t,i,n)},p.prototype.done=function(e,t,i){var r=function(e){c.nextTick(function(){if(n(e,a),!c.onerror)throw e;c.onerror(e)})},a=e||t||i?this.then(e,t,i):this;"object"==typeof process&&process&&process.domain&&(r=process.domain.bind(r)),a.then(void 0,r)},c.timeout=function(e,t,i){return c(e).timeout(t,i)},p.prototype.timeout=function(e,t){var i=h(),n=setTimeout(function(){t&&"string"!=typeof t||(t=new Error(t||"Timed out after "+e+" ms"),t.code="ETIMEDOUT"),i.reject(t)},e);return this.then(function(e){clearTimeout(n),i.resolve(e)},function(e){clearTimeout(n),i.reject(e)},i.notify),i.promise},c.delay=function(e,t){return void 0===t&&(t=e,e=void 0),c(e).delay(t)},p.prototype.delay=function(e){return this.then(function(t){var i=h();return setTimeout(function(){i.resolve(t)},e),i.promise})},c.nfapply=function(e,t){return c(e).nfapply(t)},p.prototype.nfapply=function(e){var t=h(),i=K(e);return i.push(t.makeNodeResolver()),this.fapply(i).fail(t.reject),t.promise},c.nfcall=function(e){var t=K(arguments,1);return c(e).nfapply(t)},p.prototype.nfcall=function(){var e=K(arguments),t=h();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},c.nfbind=c.denodeify=function(e){if(void 0===e)throw new Error("Q can't wrap an undefined function");var t=K(arguments,1);return function(){var i=t.concat(K(arguments)),n=h();return i.push(n.makeNodeResolver()),c(e).fapply(i).fail(n.reject),n.promise}},p.prototype.nfbind=p.prototype.denodeify=function(){var e=K(arguments);return e.unshift(this),c.denodeify.apply(void 0,e)},c.nbind=function(e,t){var i=K(arguments,2);return function(){function n(){return e.apply(t,arguments)}var r=i.concat(K(arguments)),a=h();return r.push(a.makeNodeResolver()),c(n).fapply(r).fail(a.reject),a.promise}},p.prototype.nbind=function(){var e=K(arguments,0);return e.unshift(this),c.nbind.apply(void 0,e)},c.nmapply=c.npost=function(e,t,i){return c(e).npost(t,i)},p.prototype.nmapply=p.prototype.npost=function(e,t){var i=K(t||[]),n=h();return i.push(n.makeNodeResolver()),this.dispatch("post",[e,i]).fail(n.reject),n.promise},c.nsend=c.nmcall=c.ninvoke=function(e,t){var i=K(arguments,2),n=h();return i.push(n.makeNodeResolver()),c(e).dispatch("post",[t,i]).fail(n.reject),n.promise},p.prototype.nsend=p.prototype.nmcall=p.prototype.ninvoke=function(e){var t=K(arguments,1),i=h();return t.push(i.makeNodeResolver()),this.dispatch("post",[e,t]).fail(i.reject),i.promise},c.nodeify=z,p.prototype.nodeify=function(e){return e?void this.then(function(t){c.nextTick(function(){e(null,t)})},function(t){c.nextTick(function(){e(t)})}):this},c.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var ce=l();return c})}}),montageDefine("c50fb48","runtime/helpers/resource-manager",{dependencies:[],factory:function(e,t,i){var n=window;!function(e,r){"object"==typeof t?(i.exports=r(n),i.exports.ResourceManager=i.exports):"function"==typeof define&&define.amd?define([],function(){return r(e)}):r(e)}(this,function(e){"use strict";var t=Object.create(Object,{kind:{value:"multi-parts",writable:!0},range:{value:null,writable:!0},_requests:{value:null,writable:!0},requests:{get:function(){return this._requests},set:function(e){this._requests=e}},canMergeRequest:{value:function(e,t){var i=e.range[1]-e.range[0],n=this.range[1]-this.range[0];return!(i+n>t||e.range[0]!==this.range[1]&&e.range[1]!==this.range[0]||e.type!==this.type)}},mergeRequest:{value:function(e){0===this.requests.length?(this.requests.push(e),this.range=[e.range[0],e.range[1]]):e.range[0]===this.range[1]?(this.requests.push(e),this.range[1]=e.range[1]):e.range[1]===this.range[0]?(this.requests.unshift(e),this.range[0]=e.range[0]):console.log("ERROR: should not reach")}},mergeRequests:{value:function(e){if(this.range)if(e[0].range[1]<this.range[0])for(var t=e.length-1;t>=0;t--)this.mergeRequest(e[t]);else for(var t=0;t<e.length;t++)this.mergeRequest(e[t]);else e.forEach(function(e){this.mergeRequest(e)},this)}},id:{value:null,writable:!0},initWithRequests:{value:function(e){return this.requests=[],this.mergeRequests(e),this.id=e[0].id,this}}}),i=Object.create(Object,{_content:{value:null,writable:!0},content:{get:function(){return this._content},set:function(e){this._content=e}},_parent:{value:null,writable:!0},parent:{get:function(){return this._parent},set:function(e){this._parent=e}},_left:{value:null,writable:!0},left:{get:function(){return this._left},set:function(e){this._left=e}},_right:{value:null,writable:!0},right:{get:function(){return this._right},set:function(e){this._right=e}},_checkConsistency:{value:function(e){e.length>=50||(this.left&&this.left._checkConsistency(e),e.push(this.content.range),this.right&&this.right._checkConsistency(e))}},checkConsistency:{value:function(){var e=[];if(this._checkConsistency(e),e.length>1)for(var t=0;t<e.length-1;t++){var i=e[0],n=e[1];i[1]<=n[0]||console("ERROR: INCONSISTENCY CHECK Failed, ranges are not ordered in btree")}}},_collect:{value:function(e,t){this.left&&this.left._collect(e,t),e.length>=t||(e.push(this),
this.right&&this.right._collect(e,t))}},collect:{value:function(e){var t=[];return this._collect(t,e),t}},insert:{value:function(e,t){if(e.range[1]<=this.content.range[0]){if(e.range[1]===this.content.range[0])return"multi-parts"===e.kind?this.content.mergeRequests(e.requests):this.content.mergeRequests(e),this.left&&this.content.canMergeRequest(this.left.content,t)&&(this.content.mergeRequests(this.left.content._requests),this.left.remove(this.left.content)),this.parent&&this.parent.content.canMergeRequest(this.content,t)&&(this.parent.content.mergeRequests(this.content._requests),this.remove(this.content)),null;if(this.left)return this.left.insert(e,t);var n=Object.create(i);return n.parent=this,n.content=e,this.left=n,n}if(e.range[0]>=this.content.range[1]){if(e.range[0]===this.content.range[1])return"multi-parts"===e.kind?this.content.mergeRequests(e.requests):this.content.mergeRequests(e),this.right&&this.content.canMergeRequest(this.right.content,t)&&(this.content.mergeRequests(this.right.content._requests),this.right.remove(this.right.content)),this.parent&&this.parent.content.canMergeRequest(this.content,t)&&(this.parent.content.mergeRequests(this.content._requests),this.remove(this.content)),null;if(this.right)return this.right.insert(e,t);var n=Object.create(i);return n.parent=this,n.content=e,this.right=n,n}console.log("ERROR: should not reach")}},contains:{value:function(e){return this.node===e||!(!this.left||!this.left.contains(e))||!(!this.right||!this.right.contains(e))}},min:{value:function(){for(var e=this;e.left;)e=e.left;return e}},_updateParentWithNode:{value:function(e){this.parent&&(this===this.parent.left?this.parent.left=e:this.parent.right=e),e&&(e.parent=this.parent)}},removeMin:{value:function(){this.parent;for(var e=this;e.left||e.right;)e.left&&(e=e.min()),e.right&&(e=e.right.min());return e._updateParentWithNode(null),e}},remove:{value:function(e){if(e.range[1]<=this.content.range[0])this.left.remove(e);else if(e.range[0]>=this.content.range[1])this.right.remove(e);else if(e===this.content)if(this.left&&this.right){var t=this.right.min();this.content=t.content,t._updateParentWithNode(t.right)}else this.left||this.right?this.left?this._updateParentWithNode(this.left):this._updateParentWithNode(this.right):this._updateParentWithNode(null)}}}),n=Object.create(Object,{MISSING_DESCRIPTION:{value:"MISSING_DESCRIPTION"},INVALID_PATH:{value:"INVALID_PATH"},INVALID_TYPE:{value:"INVALID_TYPE"},XMLHTTPREQUEST_STATUS_ERROR:{value:"XMLHTTPREQUEST_STATUS_ERROR"},NOT_FOUND:{value:"NOT_FOUND"},ARRAY_BUFFER:{value:"arraybuffer"},_resources:{value:null,writable:!0},_requestTrees:{value:null,writable:!0},requestTrees:{get:function(){return this._requestTrees}},_resourcesStatus:{value:null,writable:!0},_resourcesBeingProcessedCount:{value:0,writable:!0},_observers:{value:null,writable:!0},_maxConcurrentRequests:{value:1,writable:!0},observers:{get:function(){return this._observers},set:function(e){this._observers=e}},maxConcurrentRequests:{get:function(){return this._maxConcurrentRequests},set:function(e){this._maxConcurrentRequests=e}},reset:{value:function(){if(this._resourcesStatus){var e=Object.keys(this._resourcesStatus);e.forEach(function(e){var t=this._resourcesStatus[e];t&&t.xhr&&t.xhr.abort()},this)}var t=Object.keys(this._resources);t.forEach(function(e){var t=this._resources[e];t&&"VIDEO"===t.nodeName&&t.pause()},this),this._resources={},this._requestTrees={},this._resourcesStatus={},this._resourcesBeingProcessedCount=0,this._wholeBuffers={}}},_bytesLimit:{value:5e5,writable:!0},bytesLimit:{get:function(){return this._bytesLimit},set:function(e){this._bytesLimit!==e&&(this._bytesLimit=e)}},_containsResource:{enumerable:!1,value:function(e){return!!this._resources[e]}},init:{value:function(){this._requestTrees={},this._resources={},this._resourcesStatus={},this._observers=[],this._resourcesBeingProcessedCount=0}},_storeResource:{enumerable:!1,value:function(e,t){return e?(this._containsResource[e]&&console.log("WARNING: resource:"+e+" is already stored, overriding"),void(this._resources[e]=t)):void console.log("ERROR: entry does not contain id, cannot store")}},_getResource:{enumerable:!1,value:function(e){return this._resources[e]}},_loadResource:{value:function(e,t){var i,r=this,a=e.path;if("multi-parts"===e.kind?(i=e.requests[0].type,a=e.requests[0].path):(i=e.type,a=e.path),!i)return void t.handleError(n.INVALID_TYPE,null);if(!a)return void t.handleError(n.INVALID_PATH);var s=new XMLHttpRequest;if(s.open("GET",a,!0),s.responseType=i===this.ARRAY_BUFFER?"arraybuffer":"text",e.range){var o="bytes="+e.range[0]+"-"+(e.range[1]-1);s.setRequestHeader("Range",o)}s.setRequestHeader("If-Modified-Since","Sat, 01 Jan 1970 00:00:00 GMT"),s.onload=function(i){200==this.status||206==this.status?(r._resourcesBeingProcessedCount--,"multi-parts"===e.kind?e.requests.forEach(function(i){var n=this.response.slice(i.range[0]-e.range[0],i.range[1]-e.range[0]);t.resourceAvailable(r,i,n)},this):t.resourceAvailable(r,e,this.response)):t.handleError(n.XMLHTTPREQUEST_STATUS_ERROR,this.status)},s.send(null);var l=this._resourcesStatus[e.id];l&&(l.xhr=s)}},_processNextResource:{value:function(e){if(e){var t=!e.left&&!e.right;if(t)return this._handleRequest(e.content),!1;var i=e.removeMin();this._handleRequest(i.content)}return!0}},_observingEnabled:{value:!1,writable:!0},isObserving:{value:function(){return this._observingEnabled}},startObserving:{value:function(){this._observingEnabled=!0}},stopObserving:{value:function(){this._observingEnabled=!1}},fireResourceAvailable:{value:function(e){this._observingEnabled&&this.observers&&this.observers.forEach(function(t){t.resourceAvailable&&t.resourceAvailable(e)},this)}},send:{value:0,writable:!0},requested:{value:0,writable:!0},_handleRequest:{value:function(e){var n=this._resourcesStatus[e.id],r=null,a=null,s=this.requestTrees?this.requestTrees[e.path]:null;if(n){if("loading"===n.status)return;r=n.node,a=n.status}if(this.wholeBuffer>=this.maxConcurrentRequests&&"arraybuffer"===e.type){if(!a){var o,l=null;if(o="multi-parts"===e.kind?Object.create(t).initWithRequests(e.requests):Object.create(t).initWithRequests([e]),s)l=s.insert(o,this.bytesLimit);else{var u=Object.create(i);u.content=o,this._requestTrees[e.path]=u,s=u,l=u}"multi-parts"===e.kind?e.requests.forEach(function(e){this._resourcesStatus[e.id]={status:"queued",node:l}},this):this._resourcesStatus[e.id]={status:"queued",node:l}}}else{var c=this,h={};"multi-parts"===e.kind?e.requests.forEach(function(e){this._resourcesStatus[e.id]={status:"loading"}},this):this._resourcesStatus[e.id]={status:"loading"},h.resourceAvailable=function(e,t,i){var n=t.delegate.convert(i,t.ctx);if(c._storeResource(t.id,n),t.delegate.resourceAvailable(n,t.ctx),delete c._resourcesStatus[t.id],c.fireResourceAvailable.call(c,t.id),c._resourcesBeingProcessedCount<c.maxConcurrentRequests){var r=e.requestTrees?e.requestTrees[t.path]:null;c._processNextResource(r)||r&&delete e.requestTrees[t.path]}},h.handleError=function(t,i){e.delegate.handleError(t,i)},c._resourcesBeingProcessedCount++,this._loadResource(e,h)}}},_elementSizeForGLType:{value:function(e){switch(e){case"FLOAT":return Float32Array.BYTES_PER_ELEMENT;case"UNSIGNED_BYTE":return Uint8Array.BYTES_PER_ELEMENT;case"UNSIGNED_SHORT":return Uint16Array.BYTES_PER_ELEMENT;case"FLOAT_VEC2":return 2*Float32Array.BYTES_PER_ELEMENT;case"FLOAT_VEC3":return 3*Float32Array.BYTES_PER_ELEMENT;case"FLOAT_VEC4":return 4*Float32Array.BYTES_PER_ELEMENT;case"FLOAT_MAT4":return 16*Float32Array.BYTES_PER_ELEMENT;case"FLOAT_MAT3":return 9*Float32Array.BYTES_PER_ELEMENT;default:return null}}},_allowRangedRequests:{value:!1,writable:!1},_wholeBuffers:{value:null,writable:!0},_handleWrappedBufferViewResourceLoading:{value:function(e,t,i){var n=e.bufferView;if(n)var r=n.buffer,a=e.byteOffset+n.description.byteOffset,s=[a,this._elementSizeForGLType(e.type)*e.count+a],o={id:e.id,range:s,type:e.requestType?e.requestType:r.description.type,path:r.description.path,delegate:t,ctx:i,kind:"single-part"};if(this._allowRangedRequests)this._handleRequest(o,null);else{this._wholeBuffers||(this._wholeBuffers={});var n=e.bufferView;if(n){var l=this,r=n.buffer,u=this._wholeBuffers[r.id];if(null==u){var c={};c.resourceAvailable=function(e,t,i){var n=l._wholeBuffers[t.id];e._storeResource(t.id,i),n.pendingRequests&&(n.pendingRequests.forEach(function(t){delete l._resourcesStatus[t.id];var n=i.slice(t.range[0],t.range[1]),r=t.delegate,a=r.convert(n,t.ctx);e._storeResource(t.id,a),r.resourceAvailable(a,t.ctx),l.fireResourceAvailable.call(l,t.id)},l),n.pendingRequests=[])},c.handleError=function(e,t){};var h={id:r.id,type:"arraybuffer",path:r.description.path,delegate:t,ctx:i,kind:"single-part"};l._resourcesBeingProcessedCount++,this._loadResource(h,c),u={activeRequest:"bufferRequest",pendingRequests:[]},this._wholeBuffers[r.id]=u}else{var d=this._getResource(r.id);if(d){var m=d.slice(o.range[0],o.range[1]),t=o.delegate,p=t.convert(m,o.ctx);return l._storeResource(o.id,p),t.resourceAvailable(p,o.ctx),void l.fireResourceAvailable.call(l,o.id)}}var g=this._resourcesStatus[o.id];if(g&&"loading"===g.status)return;u.pendingRequests.push(o),this._resourcesStatus[o.id]={status:"loading"}}}}},shaderDelegate:{value:{handleError:function(e,t){console.log("ERROR:shaderDelegate:"+e+" :"+t)},convert:function(e,t){return e},resourceAvailable:function(e,t){if(t.sources[t.stage]=e,t.sources["x-shader/x-fragment"]&&t.sources["x-shader/x-vertex"]){var i=t.programCtx.delegate,n=i.convert(t.sources,t.programCtx.ctx);t.programCtx.resourceManager._storeResource(t.programCtx.id,n),i.resourceAvailable(n,t.programCtx.ctx),t.programCtx.resourceManager.fireResourceAvailable.call(t.programCtx.resourceManager,t.programCtx.id)}}}},_handleProgramLoading:{value:function(e,t,i){var n={delegate:t,ctx:i,resourceManager:this,id:e.id},r={},a={stage:"x-shader/x-fragment",sources:r,programCtx:n},s={stage:"x-shader/x-vertex",sources:r,programCtx:n};this.getResource(e["x-shader/x-fragment"],this.shaderDelegate,a),this.getResource(e["x-shader/x-vertex"],this.shaderDelegate,s)}},_handleShaderLoading:{value:function(e,t,i){this._handleRequest({id:e.id,type:"text",path:e.description.path,delegate:t,ctx:i,kind:"single-part"},null)}},_handleVideoLoading:{value:function(e,t,i){var n=this._resourcesStatus[e.id];if(!n||"loading"!==n.status){this._resourcesStatus[e.id]={status:"loading"};var r=this;if(e.description.path){this._resourcesBeingProcessedCount++;var a=document.createElement("video");a.preload="auto",a.loop="loop",a.addEventListener("canplaythrough",function(){r._resourcesBeingProcessedCount--,a.play(),delete r._resourcesStatus[e.id],r._storeResource(e.id,a),t(a,e.id,i)}),a.src=e.description.path}}}},_handleImageLoading:{value:function(e,t,i,n){var r=this._resourcesStatus[e.id];if(!r||"loading"!==r.status){this._resourcesStatus[e.id]={status:"loading"};var a=this;if(e.description.path){this._resourcesBeingProcessedCount++;var s=new Image;s.onload=function(){a._resourcesBeingProcessedCount--,delete a._resourcesStatus[e.id],a._storeResource(e.id,s),t(s,e.id,i,n)},s.src=e.description.path}else e.description.image&&t(e.description.image,e.id,i,n)}}},_handleTextureLoading:{value:function(e,t,i){var n=this._resourcesStatus[e.id];if(!n||"loading"!==n.status){this._resourcesStatus[e.id]={status:"loading"};var r=this;if(e.source)"image"===e.source.type&&this._handleImageLoading(e.source,function(i,n,a){var s=a,o=t.convert(e,i);delete r._resourcesStatus[e.id],r._storeResource(e.id,o),t.resourceAvailable(o,s),r.fireResourceAvailable.call(r,e.id)},i),"video"===e.source.type&&this._handleVideoLoading(e.source,function(i,n,a){var s=a,o=t.convert(e,i);delete r._resourcesStatus[e.id],r._storeResource(e.id,o),t.resourceAvailable(o,s),r.fireResourceAvailable.call(r,e.id)},i);else if(e.sources){var a=0,s=[null,null,null,null,null,null],o=0;e.sources.forEach(function(n){"image"===n.type&&this._handleImageLoading(n,function(i,n,o,l){if(a++,s[l]=i,a==e.sources.length){var u=o,c=t.convert(e,s);delete r._resourcesStatus[e.id],r._storeResource(e.id,c),t.resourceAvailable(c,u),r.fireResourceAvailable.call(r,e.id)}},i,o++),"video"===n.type&&this._handleVideoLoading(n,function(i,n,l){if(a++,s[o]=i,a==e.sources.length){var u=l,c=t.convert(e,s);delete r._resourcesStatus[e.id],r._storeResource(e.id,c),t.resourceAvailable(c,u),r.fireResourceAvailable.call(r,e.id)}},i,o++)},this)}}}},setResource:{value:function(e,t){this._resources[e]=t}},getResource:{value:function(e,t,i){var n=this._getResource(e.id);return n?n:("program"===e.type?this._handleProgramLoading(e,t,i):"shader"===e.type?this._handleShaderLoading(e,t,i):"image"===e.type?this._handleImageLoading(e,t,i):"texture"===e.type?this._handleTextureLoading(e,t,i):this._handleWrappedBufferViewResourceLoading(e,t,i),null)}},hasPendingRequests:{value:function(){return this._resourcesBeingProcessedCount>0}},removeAllResources:{value:function(){this._resources={}}}});return e&&(e.ResourceManager=n),ResourceManager})}}),montageDefine("b0111a3","composer/press-composer",{dependencies:["../core/core","./composer","../core/event/mutable-event"],factory:function(e,t,i){var n=e("../core/core").Montage,r=e("./composer").Composer,a=e("../core/event/mutable-event").MutableEvent,s=t.PressComposer=r.specialize({load:{value:function(){window.PointerEvent?this._element.addEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.addEventListener("MSPointerDown",this,!0):(this._element.addEventListener("touchstart",this,!0),this._element.addEventListener("mousedown",this,!0))}},unload:{value:function(){window.PointerEvent?this._element.removeEventListener("pointerdown",this,!0):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.removeEventListener("MSPointerDown",this,!0):(this._element.removeEventListener("touchstart",this,!0),this._element.removeEventListener("mousedown",this,!0))}},delegate:{value:null},cancelPress:{value:function(){return this._state===s.PRESSED&&(this._cancelPress(),!0)}},_cancelPress:{value:function(e){this._dispatchPressCancel(e),this._endInteraction()}},addEventListener:{value:function(e,t,i){r.prototype.addEventListener.call(this,e,t,i),"longPress"===e&&(this._shouldDispatchLongPress=!0)}},_state:{value:0},state:{get:function(){return this._state}},_shouldDispatchLongPress:{value:!1},_longPressThreshold:{value:1e3},longPressThreshold:{get:function(){return this._longPressThreshold},set:function(e){this._longPressThreshold!==e&&(this._longPressThreshold=e)}},_needDispatchSafePress:{value:!1},_longPressTimeout:{value:null},_observedPointer:{value:null},_initialCenterPositionX:{value:0},_initialCenterPositionY:{value:0},_shouldSaveInitialCenterPosition:{value:!1},_targetElementOnLastTouchMove:{value:null},_endInteraction:{value:function(){this._element&&(this._removeEventListeners(),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this.component.eventManager.forfeitPointer(this._observedPointer,this),this._observedPointer=null,this._targetElementOnLastTouchMove=null,this._state=s.UNPRESSED,this._initialCenterPositionX=0,this._initialCenterPositionY=0,this._shouldSaveInitialCenterPosition=!1)}},_changedTouchisObserved:{value:function(e){if(null===this._observedPointer)return!1;for(var t=0,i=e.length;t<i;t++)if(e[t].identifier===this._observedPointer)return t;return!1}},surrenderPointer:{value:function(e,t){var i=this.callDelegateMethod("shouldComposerSurrenderPointerToComponent",this,e,t);return("undefined"==typeof i||i!==!1)&&(this.cancelPress(),!0)}},_shouldPerformPress:{value:function(){return!(this.component.disabled||null!==this._observedPointer)}},capturePointerdown:{value:function(e){"touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH?this.captureTouchstart(e):("mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE)&&this.captureMousedown(e)}},handlePointerup:{value:function(e){"touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH?this.handleTouchend(e):("mouse"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_MOUSE)&&this.handleMouseup(e)}},handlePointercancel:{value:function(e){("touch"===e.pointerType||window.MSPointerEvent&&e.pointerType===window.MSPointerEvent.MSPOINTER_TYPE_TOUCH)&&this.handleTouchcancel(e)}},captureTouchstart:{value:function(e){this._shouldPerformPress()&&(void 0!==e.pointerId?this._observedPointer=e.pointerId:e.changedTouches&&1===e.changedTouches.length&&(this._observedPointer=e.changedTouches[0].identifier),null!==this._observedPointer&&this.component.eventManager.claimPointer(this._observedPointer,this)?this._addPointerDownListener():this._observedPointer=null)}},handleTouchend:{value:function(e){if(null===this._observedPointer)return void this._endInteraction(e);var t;e.pointerId===this._observedPointer?t=e.target:this._changedTouchisObserved(e.changedTouches)!==!1&&(t=this._targetElementOnLastTouchMove||e.target),t&&this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&(this.element===t||this.element.contains(t)?this._dispatchPress(e,"undefined"==typeof e.pointerId?t:null):this._dispatchPressCancel(e),this._endInteraction(e))}},_saveInitialCenterPositionIfNeeded:{value:function(){this._shouldSaveInitialCenterPosition&&(this._saveInitialCenterPosition(),this._shouldSaveInitialCenterPosition=!1)}},_cancelPressIfCenterPositionChange:{value:function(e){return this._saveInitialCenterPositionIfNeeded(),!!this._isPositionChanged(e)&&(this._cancelPress(e),!0)}},_handleMove:{value:function(e){if(null===this._observedPointer)return void this._endInteraction(e);if(this._needDispatchSafePress=!1,("mouse"===this._observedPointer||e.pointerId===this._observedPointer||e.changedTouches&&this._changedTouchisObserved(e.changedTouches)!==!1)&&this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&!this._cancelPressIfCenterPositionChange(e)&&"touchmove"===e.type){var t=e.changedTouches[0];this._targetElementOnLastTouchMove=document.elementFromPoint(t.clientX,t.clientY)}}},captureWheel:{value:function(e){return null===this._observedPointer?void this._endInteraction(e):void((e.target===this.element||e.target===window||"function"==typeof e.target.contains&&e.target.contains(this.element)||this.element.contains(e.target))&&this._cancelPressIfCenterPositionChange(e))}},handleTouchcancel:{value:function(e){null!==this._observedPointer&&e.pointerId!==this._observedPointer&&this._changedTouchisObserved(e.changedTouches)===!1||(this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)&&this._dispatchPressCancel(e),this._endInteraction(e))}},captureMousedown:{value:function(e){0===e.button&&this._shouldPerformPress()&&(this._observedPointer="mouse",this.component.eventManager.claimPointer(this._observedPointer,this),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)?this._addPointerDownListener():this._observedPointer=null)}},_handlePointerDown:{value:function(e){if(this._removePointerDownListener(),this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)){if(this._needDispatchSafePress=!1,"touchstart"===e.type){var t=this;window.nativeAddEventListener("touchstart",function i(e){window.nativeRemoveEventListener("touchstart",i,!1),t._needDispatchSafePress=!e.defaultPrevented},!1)}this._shouldSaveInitialCenterPosition=!0,this._addEventListeners(),this._dispatchPressStart(e)}else this._observedPointer=null}},captureScroll:{value:function(e){(e.target===this.element||e.target===window||"function"==typeof e.target.contains&&e.target.contains(this.element)||this.element.contains(e.target))&&this._cancelPressIfCenterPositionChange(e)}},handleMouseup:{value:function(e){if(null===this._observedPointer)return void this._endInteraction(e);if(this.component.eventManager.isPointerClaimedByComponent(this._observedPointer,this)){for(var t=e.target;t!==this._element&&t&&t.parentNode;)t=t.parentNode;if(t===this._element)return this._dispatchPress(e),void this._endInteraction(e)}this._cancelPress(e)}},handleDragstart:{value:function(e){this._cancelPress(e)}},_saveInitialCenterPosition:{value:function(){if(this.element instanceof HTMLElement){var e=this.element.getBoundingClientRect();this._initialCenterPositionX=e.left+e.width/2,this._initialCenterPositionY=e.top+e.height/2}}},_isPositionChanged:{value:function(e){if(this.element instanceof HTMLElement){var t=this.element.getBoundingClientRect(),i=t.left+t.width/2,n=t.top+t.height/2;if(this._initialCenterPositionX!==i||this._initialCenterPositionY!==n){var a=e.type,s=Math.abs(this._initialCenterPositionX-i),o=Math.abs(this._initialCenterPositionY-n),l="mouse"===this._observedPointer||"wheel"===a||"mousewheel"===a||"scroll"===a?this._mouseRadiusThreshold:this._touchRadiusThreshold;return r.isCoordinateOutsideRadius(s,o,l)}}return!1}},_mouseRadiusThreshold:{value:2},_touchRadiusThreshold:{value:4},_addPointerDownListener:{value:function(){window.PointerEvent?this._element.addEventListener("pointerdown",this,!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.addEventListener("MSPointerDown",this,!1):"mouse"===this._observedPointer?this._element.addEventListener("mousedown",this,!1):this._element.addEventListener("touchstart",this,!1)}},_removePointerDownListener:{value:function(){window.PointerEvent?this._element.removeEventListener("pointerdown",this,!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?this._element.removeEventListener("MSPointerDown",this,!1):"mouse"===this._observedPointer?this._element.removeEventListener("mousedown",this,!1):this._element.removeEventListener("touchstart",this,!1)}},_addEventListeners:{value:function(){window.PointerEvent?(document.addEventListener("pointerup",this,!1),document.addEventListener("pointermove",this,!1),document.addEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(document.addEventListener("MSPointerUp",this,!1),document.addEventListener("MSPointerMove",this,!1),document.addEventListener("MSPointerCancel",this,!1)):"mouse"===this._observedPointer?(document.addEventListener("mouseup",this,!1),document.addEventListener("mousemove",this,!1),this._element.addEventListener("dragstart",this,!1)):(document.addEventListener("touchend",this,!1),document.addEventListener("touchcancel",this,!1),document.addEventListener("touchmove",this,!1));var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";document.addEventListener(e,this,!0),document.addEventListener("scroll",this,!0)}},_removeEventListeners:{value:function(){window.PointerEvent?(document.removeEventListener("pointerup",this,!1),document.removeEventListener("pointermove",this,!1),document.removeEventListener("pointercancel",this,!1)):window.MSPointerEvent&&window.navigator.msPointerEnabled?(document.removeEventListener("MSPointerUp",this,!1),document.removeEventListener("MSPointerMove",this,!1),document.removeEventListener("MSPointerCancel",this,!1)):"mouse"===this._observedPointer?(document.removeEventListener("mouseup",this,!1),document.removeEventListener("mousemove",this,!1),this._element.removeEventListener("dragstart",this,!1)):(document.removeEventListener("touchend",this,!1),document.removeEventListener("touchcancel",this,!1),document.removeEventListener("touchmove",this,!1));var e="undefined"!=typeof window.onwheel||"undefined"!=typeof window.WheelEvent?"wheel":"mousewheel";document.removeEventListener(e,this,!0),document.removeEventListener("scroll",this,!0)}},_createPressEvent:{enumerable:!1,value:function(e,t){var i,n,r=t;return t||(t=document.createEvent("CustomEvent"),t.initCustomEvent(e,!0,!0,null)),i=new o,i.event=t,i.type=e,i.pointer=this._observedPointer,i.targetElement=t.target,t.changedTouches&&(n=this._changedTouchisObserved(t.changedTouches))!==!1&&(r=i.touch=t.changedTouches[n]),r&&(i.clientX=r.clientX,i.clientY=r.clientY,i.pageX=r.pageX,i.pageY=r.pageY),i}},_dispatchPressStart:{enumerable:!1,value:function(e){if(this._state=s.PRESSED,this.dispatchEvent(this._createPressEvent("pressStart",e)),this._shouldDispatchLongPress){var t=this;this._longPressTimeout=setTimeout(function(){t._dispatchLongPress()},this._longPressThreshold)}}},_dispatchPress:{enumerable:!1,value:function(e,t){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null);var i=this._createPressEvent("press",e);if(t&&(i.targetElement=t,this._needDispatchSafePress||e.defaultPrevented)){var n=this,r=document.defaultView.defaultEventManager,a=function(s){(t===s.target||r._couldEmulatedEventHaveWrongTarget(e.changedTouches[0],s,r._emulatedEventRadiusThreshold,r._emulatedEventTimestampThreshold))&&n._dispatchSafePress(i,a)};return window.nativeAddEventListener("mousedown",a,!0),void(a.timeoutID=setTimeout(function(){n._dispatchSafePress(i,a)},300))}this.dispatchEvent(i),this._state=s.UNPRESSED}},_dispatchSafePress:{value:function(e,t){clearTimeout(t.timeoutID),t.timeoutID=null,window.nativeRemoveEventListener("mousedown",t,!0),this.dispatchEvent(e),this._state=s.UNPRESSED}},_dispatchLongPress:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(this.dispatchEvent(this._createPressEvent("longPress",e)),this._longPressTimeout=null)}},_dispatchPressCancel:{enumerable:!1,value:function(e){this._shouldDispatchLongPress&&(clearTimeout(this._longPressTimeout),this._longPressTimeout=null),this._state=s.CANCELLED,this.dispatchEvent(this._createPressEvent("pressCancel",e))}}},{UNPRESSED:{value:0},PRESSED:{value:1},CANCELLED:{value:2}});s.prototype.captureMSPointerDown=s.prototype.capturePointerdown,s.prototype.handleMSPointerUp=s.prototype.handlePointerup,s.prototype.handleMSPointerCancel=s.prototype.handlePointercancel,s.prototype.handleMSPointerMove=s.prototype._handleMove,s.prototype.handlePointermove=s.prototype._handleMove,s.prototype.handleTouchmove=s.prototype._handleMove,s.prototype.handleMousemove=s.prototype._handleMove,s.prototype.handleMousewheel=s.prototype.handleWheel,s.prototype.handleMSPointerDown=s.prototype._handlePointerDown,s.prototype.handlePointerdown=s.prototype._handlePointerDown,s.prototype.handleMousedown=s.prototype._handlePointerDown,s.prototype.handleTouchstart=s.prototype._handlePointerDown;var o=function(){var e,t,i,r,s,o;for(e=a.specialize({type:{value:"press"},_event:{enumerable:!1,value:null},event:{get:function(){return this._event},set:function(e){this._event=e}},_touch:{enumerable:!1,value:null},touch:{get:function(){return this._touch},set:function(e){this._touch=e}}}),t=["altKey","ctrlKey","metaKey","shiftKey","cancelBubble","currentTarget","defaultPrevented","eventPhase","timeStamp","preventDefault","stopImmediatePropagation","stopPropagation"],i=["clientX","clientY","pageX","pageY","screenX","screenY","target"],r=function(e){return{get:function(){return this._event[e]}}},s=function(e){return{get:function(){return this._touch?this._touch[e]:this._event[e]}}},o=t.length-1;o>=0;o--)n.defineProperty(e,t[o],r(t[o]));for(o=i.length-1;o>=0;o--)n.defineProperty(e,i[o],s(i[o]));return e}()}}),montageDefine("22a41ee","ui/main.reel/main.html",{text:'<!DOCTYPE html><html><head><meta http-equiv=content-type content="text/html; charset=utf-8"><title>Main</title><style>.Custom.digit-RadioButton,.Custom.digit-Checkbox{border-color:hsla(0,0%,0%,.12);background-color:hsl(0,0%,94%);box-shadow:inset 0 1px 3px hsla(0,0%,0%,.1)}.Custom.digit-RadioButton.montage--active,.Custom.digit-Checkbox.montage--active,.Custom.digit-RadioButton.montage-RadioButton--checked,.Custom.digit-Checkbox.montage-Checkbox--checked{background-color:hsl(74,65%,65%)}.Custom--hasSwatches .Custom.digit-RadioButton{font-size:20px;border:3px solid #fff;box-shadow:inset 0 1px 4px 1px hsla(0,0%,0%,.15);background-repeat:repeat;background-position:center;background-size:auto 100%}.Custom--hasSwatches .Custom.digit-RadioButton.montage-RadioButton--checked{box-shadow:inset 0 1px 4px 1px hsla(0,0%,0%,.15),0 0 0 2px hsl(74,65%,65%)}.Custom.digit-RadioButton:after,.Custom.digit-Checkbox:after,.Custom--swatch.digit-RadioButton:after{top:-6px;left:-6px;right:-6px;bottom:-6px}.Custom.digit-Slider{border-color:hsl(74,55%,60%);background-color:#fff;background-image:-webkit-linear-gradient(left,hsla(74,65%,35%,.3)2px,hsla(74,65%,65%,0)2px),-webkit-linear-gradient(left,hsla(74,65%,65%,0),hsla(74,65%,65%,1));background-image:linear-gradient(to right,hsla(74,65%,35%,.3)2px,hsla(74,65%,65%,0)2px),linear-gradient(to right,hsla(74,65%,65%,0),hsla(74,65%,65%,1));background-size:-webkit-calc(10% - 2px)100%,auto auto;background-size:calc(10% - 2px)100%,auto auto;background-position:12px top,left top;box-shadow:inset 0 1px 2px hsla(0,0%,0%,.1);width:100%}.Custom .digit-Slider-thumb{-moz-box-sizing:border-box;border-color:hsl(71,30%,74%);background:hsl(0,0%,90%) -webkit-linear-gradient(top,hsla(0,0%,100%,1),hsla(0,0%,100%,0));background:hsl(0,0%,90%) linear-gradient(to bottom,hsla(0,0%,100%,1),hsla(0,0%,100%,0));box-shadow:inset 0 1px 0 hsla(0,0%,100%,.5),0 2px 3px hsla(0,0%,0%,.15)}.Custom.montage-Slider--active .digit-Slider-thumb{border-color:hsl(71,30%,64%);background:hsl(74,40%,92%);box-shadow:none}.Custom.digit-TextField{height:2.2em;padding:0;border-radius:6px;font-size:18px;text-align:center;border-color:hsl(0,0%,82%);background-color:hsl(0,0%,95%);box-shadow:inset 0 1px 4px hsla(0,0%,0%,.08)}.Custom.digit-TextField:focus{border-color:hsl(74,65%,65%);background-color:hsl(74,65%,96%);box-shadow:inset 0 1px 1px hsla(0,0%,0%,.08)}.Custom.digit-Button{height:2.2em;border-radius:6px;color:hsl(0,0%,50%);font-size:18px;font-weight:700;text-shadow:0 1px 1px hsla(0,0%,100%,.4);border-color:hsl(0,0%,82%);background:hsl(0,0%,96%) -webkit-linear-gradient(top,hsla(0,0%,100%,.06),hsla(0,0%,0%,.06));background:hsl(0,0%,96%) linear-gradient(to bottom,hsla(0,0%,100%,.06),hsla(0,0%,0%,.06));box-shadow:inset 0 1px 1px 1px hsla(0,0%,100%,.2),0 2px 4px hsla(0,0%,0%,.1)}.Custom.digit-Button.montage--active{background-color:hsl(0,0%,98%);box-shadow:inset 0 1px 2px 1px hsla(0,0%,100%,.2);-webkit-transform:translateY(1px);transform:translateY(1px)}.Custom--action.digit-Button{color:hsl(74,40%,30%);border-color:hsl(74,55%,55%);background-color:hsl(74,65%,65%)}.Custom--action.digit-Button.montage--active{background-color:hsl(74,65%,70%)}.Custom--cancel.digit-Button{color:hsl(10,100%,93%);text-shadow:0 1px 2px hsla(0,0%,0%,.2);border-color:hsl(0,76%,60%);background-color:hsl(10,90%,66%)}.Custom--cancel.digit-Button.montage--active{background-color:hsl(10,100%,69%)}</style><style>.Main{width:100%;height:100%;overflow:hidden}.Main,.Main-viewport{display:-webkit-box;display:-webkit-flex;display:flex;position:relative}.Main-viewport{-webkit-box-flex:1;-webkit-flex:1;flex:1;-webkit-box-orient:vertical;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;z-index:2;background-color:hsl(0,0%,95%)}.Main-room{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.Main-colladaView canvas{display:block}.Main-overview{position:absolute;bottom:0;left:0;right:0}.Main-loader{text-align:center;padding-bottom:45px}.Main-loader-dot{position:relative;display:inline-block;width:12px;height:12px;border-radius:6px;-moz-box-sizing:border-box;box-sizing:border-box;border:1px solid hsla(0,0%,0%,.12);background-color:hsl(0,0%,94%);box-shadow:inset 0 1px 3px hsla(0,0%,0%,.1);-webkit-animation:Main-loader .9s 0s steps(1)10;animation:Main-loader .9s 0s steps(1)10}.Main-loader-dot:nth-child(2){-webkit-animation-delay:.3s;animation-delay:.3s}.Main-loader-dot:nth-child(3){-webkit-animation-delay:.6s;animation-delay:.6s}@-webkit-keyframes Main-loader{66.667%{background-color:hsl(74,65%,65%)}}@keyframes Main-loader{66.667%{background-color:hsl(74,65%,65%)}}.Main-configuration{position:relative;height:100%;width:400px;min-height:100px}.Main-panel{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.Main-cards{list-style:none}.Main .PanelFlow.scrolling{background-color:hsl(0,0%,27%);background-image:-webkit-linear-gradient(top,hsla(0,0%,20%,.4)0%,hsla(0,0%,20%,.1)7%,hsla(0,0%,20%,0)14%);background-image:linear-gradient(top,hsla(0,0%,20%,.4)0%,hsla(0,0%,20%,.1)7%,hsla(0,0%,20%,0)14%)}.Main-ribbon{position:absolute;z-index:2;top:0;left:30px;width:56px;height:78px;overflow:hidden;font-size:0;color:hsla(0,0%,0%,0);background:url(assets/images/montage-made.svg) no-repeat center top;background-size:100% auto}@media (orientation:portrait){.Main{-webkit-box-orient:vertical;-webkit-flex-direction:column;flex-direction:column}.Main-viewport{height:auto}.Main-configuration{width:100%;height:400px;min-width:0;min-height:0}.Main-ribbon{left:20px}}@media (orientation:portrait) and (max-width:560px){.Main-configuration{height:300px}.Main-ribbon{width:40px}}@media (orientation:landscape) and (max-height:299px){.Card-content:nth-child(2){display:none}}@media (orientation:landscape) and (max-width:420px){.Main-configuration{display:none}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/main.reel","properties":{"element":{"#":"main"},"panelDescriptors":[{"panelKey":"introduction","label":"Welcome"},{"panelKey":"thermostat","label":"Thermostat"},{"panelKey":"solarPanels","label":"Solar Panels"},{"panelKey":"counters","label":"Countertop"},{"panelKey":"kitchen","label":"Kitchen"},{"panelKey":"laundry","label":"Laundry"},{"panelKey":"window","label":"Windows"},{"panelKey":"staircase","label":"Staircase"},{"panelKey":"callBack","label":"Contact Us"}],"viewPortElement":{"#":"viewPort"}},"bindings":{"currentPanel":{"<-":"panelDescriptors[@panelFlow.currentPanelIndex]"},"sceneView":{"<-":"@viewSubstitution.childComponents.0"}}},"application":{"prototype":"montage/core/application"},"callBack":{"prototype":"ui/cards/call-back.reel","properties":{"element":{"#":"callBack"}},"bindings":{"configuration":{"<-":"@application.configuration"},"orderedPanelKeys":{"<-":"@owner.panelDescriptors.map{panelKey}"}}},"configurationPanels":{"prototype":"montage/ui/substitution.reel","properties":{"element":{"#":"configurationPanels"}},"bindings":{"switchValue":{"<-":"@panelFlow:iteration.object.panelKey"}}},"countersPanel":{"prototype":"ui/cards/countertops.reel","properties":{"element":{"#":"countersPanel"}},"bindings":{"configurationSet":{"<-":"@application.configuration.configurationMap.get(\'counters\')"}}},"flowTranslateStartListener":{"prototype":"montage/core/event/action-event-listener","properties":{"action":"pause","handler":{"@":"glView"}}},"glView":{"prototype":"ui/gl-view.reel","properties":{"element":{"#":"glView"}},"bindings":{"configuration":{"<-":"@application.configuration"},"currentPanel":{"<-":"@owner.currentPanel"},"temperatureDelta":{"<-":"@owner.temperatureDelta"}}},"introductionPanel":{"prototype":"ui/cards/introduction.reel","properties":{"element":{"#":"introductionPanel"}}},"kitchenPanel":{"prototype":"ui/cards/kitchen.reel","properties":{"element":{"#":"kitchenPanel"}},"bindings":{"configurationSet":{"<-":"@application.configuration.configurationMap.get(\'kitchen\')"}}},"laundryPanel":{"prototype":"ui/cards/laundry.reel","properties":{"element":{"#":"laundryPanel"}},"bindings":{"configurationSet":{"<-":"@application.configuration.configurationMap.get(\'laundry\')"}}},"navigation":{"prototype":"ui/navigation.reel","properties":{"element":{"#":"navigation"}},"bindings":{"configuration":{"<-":"@application.configuration"},"currentPanelIndex":{"<-":"@panelFlow.currentPanelIndex"},"panelDescriptors":{"<-":"@owner.panelDescriptors"}},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"overview":{"prototype":"ui/overview.reel","properties":{"element":{"#":"overview"}},"bindings":{"configuration":{"<-":"@application.configuration"}}},"panelFlow":{"prototype":"ui/panel-flow.reel","properties":{"element":{"#":"panelFlow"}},"bindings":{"content":{"<-":"@owner.panelDescriptors"}},"listeners":[{"type":"flowTranslateStart","listener":{"@":"flowTranslateStartListener"}}]},"solarPanels":{"prototype":"ui/cards/solar-panels.reel","properties":{"element":{"#":"solarPanels"}},"bindings":{"configurationSet":{"<-":"@application.configuration.configurationMap.get(\'solarPanels\')"}}},"staircasePanel":{"prototype":"ui/cards/staircase.reel","properties":{"element":{"#":"staircasePanel"}},"bindings":{"configurationSet":{"<-":"@application.configuration.configurationMap.get(\'staircase\')"}}},"staticView":{"prototype":"ui/static-view.reel","properties":{"element":{"#":"staticView"}},"bindings":{"configuration":{"<-":"@application.configuration"},"currentPanel":{"<-":"@owner.currentPanel"}}},"substitutionDelay":{"prototype":"core/substitution-delay","properties":{"delay":500,"enabled":true,"excluded":["introduction"]},"bindings":{"switchValues":{"<-":"@owner.panelDescriptors.map{panelKey}"}}},"thermostatPanel":{"prototype":"ui/cards/thermostat.reel","properties":{"element":{"#":"thermostatPanel"}},"bindings":{"configurationSet":{"<-":"@application.configuration.configurationMap.get(\'thermostat\')"}}},"viewSubstitution":{"prototype":"montage/ui/substitution.reel","properties":{"element":{"#":"viewSubstitution"}},"bindings":{"switchValue":{"<-":"@owner.viewKey"}}},"windowPanel":{"prototype":"ui/cards/window.reel","properties":{"element":{"#":"windowPanel"}},"bindings":{"configurationSet":{"<-":"@application.configuration.configurationMap.get(\'window\')"}}}}</script></head><body><div data-montage-id=main class=Main><section class=Main-viewport data-montage-skin=light data-montage-id=viewPort><div class=Main-loader><span class=Main-loader-dot></span> <span class=Main-loader-dot></span> <span class=Main-loader-dot></span></div><div class=Main-room><div data-montage-id=viewSubstitution><div data-arg=static data-montage-id=staticView></div><div data-arg=webgl data-montage-id=glView></div></div><div data-montage-id=overview class=Main-overview></div></div></section><section class=Main-configuration><ul data-montage-id=panelFlow class=Main-panel><li data-montage-id=configurationPanels class=Main-cards><div data-arg=introduction data-montage-id=introductionPanel></div><div data-arg=staircase data-montage-id=staircasePanel></div><div data-arg=thermostat data-montage-id=thermostatPanel></div><div data-arg=kitchen data-montage-id=kitchenPanel></div><div data-arg=laundry data-montage-id=laundryPanel></div><div data-arg=solarPanels data-montage-id=solarPanels></div><div data-arg=window data-montage-id=windowPanel></div><div data-arg=counters data-montage-id=countersPanel></div><div data-arg=callBack data-montage-id=callBack></div></li></ul></section><section class=Main-navigation data-montage-id=navigation></section><a class=Main-ribbon href=http://montagestudio.com>Made with Montage Studio</a></div></body></html>'
}),montageDefine("b0111a3","ui/flow.reel/flow-translate-composer",{dependencies:["../../composer/translate-composer","../../core/geometry/point"],factory:function(e,t,i){var n=e("../../composer/translate-composer").TranslateComposer,r=e("../../core/geometry/point").Point,a=r.convertPointFromPageToNode;t.FlowTranslateComposer=n.specialize({constructor:{value:function(){this.handleMousewheel=this.handleWheel}},stealChildrenPointer:{value:!0},_linearScrollingVector:{value:[-300,0]},linearScrollingVector:{get:function(){return this._linearScrollingVector},set:function(e){this._linearScrollingVector=e}},startTranslateSpeed:{value:500},startTranslateRadius:{value:8},_startPageX:{value:null},_startPageY:{value:null},_pageX:{value:null},_pageY:{value:null},_pointerStartX:{value:null},_pointerStartY:{value:null},_contentOffsetX:{value:null},_contentOffsetY:{value:null},_superStart:{value:n.prototype._start},_start:{value:function(e,t,i,n){this._superStart(e,t,i,n);var s=window.getComputedStyle(this._element,null),o=this.convertCssPixelsPropertyStringToNumber(s.getPropertyValue("border-left-width")),l=this.convertCssPixelsPropertyStringToNumber(s.getPropertyValue("border-top-width")),u=this.convertCssPixelsPropertyStringToNumber(s.getPropertyValue("padding-left")),c=this.convertCssPixelsPropertyStringToNumber(s.getPropertyValue("padding-top")),h=a(this._element,(new r).init(e,t));this._pointerStartX=this._pointerX=h.x-o-u,this._pointerStartY=this._pointerY=h.y-l-c,this._contentOffsetX=this._startPageX-this._pointerStartX,this._contentOffsetY=this._startPageY-this._pointerStartY,this._computePointedElement(),this._startPageX=this._pageX=e,this._startPageY=this._pageY=t,this._startScroll=this._scroll,this._previousScrollDelta=0,this._scrollEnd=null}},_analyzeMovement:{value:function(e){var t,i,n,r=e.velocity;r&&(t=r.speed,t>=this.startTranslateSpeed?this._stealPointer():(i=this.startPageX-e.pageX,n=this.startPageY-e.pageY,i*i+n*n>this.startTranslateRadius*this.startTranslateRadius&&this._stealPointer()))}},_dispatchTranslateStart:{value:function(e,t){var i=document.createEvent("CustomEvent");i.initCustomEvent("translateStart",!0,!0,null),i.scroll=this._scroll,i.translateX=0,i.translateY=0,i.pointer=this._observedPointer,this.dispatchEvent(i)}},_dispatchTranslateEnd:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateEnd",!0,!0,null),e.scroll=this._scroll,e.translateX=0,e.translateY=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_dispatchTranslateCancel:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translateCancel",!0,!0,null),e.scroll=this._scroll,e.translateX=0,e.translateY=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_dispatchTranslate:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("translate",!0,!0,null),e.scroll=this._scroll,e.translateX=0,e.translateY=0,e.pointer=this._observedPointer,this.dispatchEvent(e)}},_move:{value:function(e,t){this._isFirstMove&&(this._dispatchTranslateStart(),this._isFirstMove=!1),this._pageX=e,this._pageY=t,this._updateLinearScroll(),this._shouldDispatchTranslate&&this._dispatchTranslate()}},_end:{value:function(e){if(this.eventManager.isPointerClaimedByComponent(this._observedPointer,this)){this.startTime=Date.now(),this.endX=this.startX=this._pageX,this.endY=this.startY=this._pageY;var t=e.velocity;this._hasMomentum&&(t.speed>40||this.translateStrideX)?("vertical"!=this._axis?this.momentumX=t.x*this._pointerSpeedMultiplier*(this._invertXAxis?1:-1):this.momentumX=0,"horizontal"!=this._axis?this.momentumY=t.y*this._pointerSpeedMultiplier*(this._invertYAxis?1:-1):this.momentumY=0,this.endX=this.startX+this.momentumX*this.__momentumDuration/2e3,this.endY=this.startY+this.momentumY*this.__momentumDuration/2e3,this.startStrideXTime=null,this.startStrideYTime=null,this.animateMomentum=!0):this.animateMomentum=!1,this.animateMomentum?this._animationInterval():this._isFirstMove||this._dispatchTranslateEnd()}this._releaseInterest()}},_translateEndTimeout:{value:null},_mousewheelStrideTimeout:{value:null},_previousDelta:{value:0},_listenToWheelEvent:{value:!0},captureWheel:{value:function(){this.eventManager.componentClaimingPointer(this._WHEEL_POINTER)||this.eventManager.claimPointer(this._WHEEL_POINTER,this.component)}},handleWheel:{value:function(e){var t=this;if(this.eventManager.isPointerClaimedByComponent(this._WHEEL_POINTER,this.component)){var i,n=this._scroll,r=e.wheelDeltaX||-e.deltaX||0,a=e.wheelDeltaY||-e.deltaY||0;this.translateStrideX?(clearTimeout(this._mousewheelStrideTimeout),i=Math.abs(this._linearScrollingVector[0])>Math.abs(this._linearScrollingVector[1])?Math.abs(r)>Math.abs(a)?this._linearScrollingVector[0]*-r/Math.abs(this._linearScrollingVector[0]):0:Math.abs(r)>Math.abs(a)?0:this._linearScrollingVector[1]*-a/Math.abs(this._linearScrollingVector[1]),(null===this._mousewheelStrideTimeout||Math.abs(i)>Math.abs(this._previousDelta*(null===this._mousewheelStrideTimeout?2:4)))&&(i>1?this.callDelegateMethod("previousStride",this):i<-1&&this.callDelegateMethod("nextStride",this)),this._mousewheelStrideTimeout=setTimeout(function(){t._mousewheelStrideTimeout=null,t._previousDelta=0},70),t._previousDelta=i,0!==i&&this._shouldPreventDefault(e)&&e.preventDefault()):(null===this._translateEndTimeout&&this._dispatchTranslateStart(),this._pageX=this._pageX+20*r/100,this._pageY=this._pageY+20*a/100,this._updateScroll(),this._dispatchTranslate(),clearTimeout(this._translateEndTimeout),this._translateEndTimeout=setTimeout(function(){t._dispatchTranslateEnd(),t._translateEndTimeout=null},400),n!==this._scroll&&this._shouldPreventDefault(e)&&e.preventDefault()),this.eventManager.forfeitPointer(this._WHEEL_POINTER,this.component)}}},_scroll:{value:0},scroll:{get:function(){return this._scroll},set:function(e){null!==this.minScroll&&e<this.minScroll&&(e=this.minScroll),null!==this.maxScroll&&e>this.maxScroll&&(e=this.maxScroll),this._scroll=e}},minScroll:{value:null},maxScroll:{value:null},_flow:{value:null},flow:{get:function(){return this._flow},set:function(e){this._flow=e,this.component=e}},_updateScroll:{value:function(){this._updateLinearScroll()}},_updateLinearScroll:{value:function(){var e=this._flow,t=e.isCameraEnabled?500/e._height:1,i=(this._pageX-this._startPageX)*this._linearScrollingVector[0]*t*e._sceneScaleX.denominator/e._sceneScaleX.numerator,n=(this._pageY-this._startPageY)*this._linearScrollingVector[1]*t*e._sceneScaleY.denominator/e._sceneScaleY.numerator,r=this._linearScrollingVector[0]*this._linearScrollingVector[0]+this._linearScrollingVector[1]*this._linearScrollingVector[1],a=(i+n)/r;this.scroll+=a-this._previousScrollDelta,this._previousScrollDelta=a}},frame:{value:function(e){this.isAnimating&&this._animationInterval()}},convertCssPixelsPropertyStringToNumber:{value:function(e){return"string"==typeof e&&"px"===e.substr(-2)?1*e.substr(0,e.length-2):0}},_rayPointDistance:{value:function(e,t){var i,n,r,a,s;return i=e[0]*t[0]+e[1]*t[1]+e[2]*t[2],i>=0&&(n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i/=n,r=e[0]*i-t[0],a=e[1]*i-t[1],s=e[2]*i-t[2],Math.sqrt(r*r+a*a+s*s))}},_closerIndex:{value:null},_computePointedElement_spline:{value:[]},_computePointedElement:{value:function(){var e=this._flow._splinePaths,t=e.length;if(t){var i,n,r,a,s,o,l,u,c,h=this._flow,d=h._viewpointTargetPoint[0]-h._viewpointPosition[0],m=h._viewpointTargetPoint[2]-h._viewpointPosition[2],p=Math.atan2(d,m),g=m*Math.cos(-p)-d*Math.sin(-p),f=Math.atan2(h._viewpointTargetPoint[1]-h._viewpointPosition[1],g),v=.5*this._element.clientWidth-this._pointerX,_=this._pointerY-.5*this._element.clientHeight,b=.5*this._element.offsetHeight/Math.tan(h._viewpointFov*h._doublePI*(1/720)),w=this._computePointedElement_spline,y=h._visibleIndexes,E=y.length,C=h._sceneScale,x=null,T=1e100;for(n=b*Math.cos(f)-_*Math.sin(f),_=b*Math.sin(f)+_*Math.cos(f),i=n*Math.cos(p)-v*Math.sin(p),v=n*Math.sin(p)+v*Math.cos(p),l=[v,_,i],c=0;c<e.length;c++)for(c=0;c<e.length;c++)w[c]=e[c].transform([C.x.numerator/C.x.denominator,0,0,0,0,C.y.numerator/C.y.denominator,0,0,0,0,C.z.numerator/C.z.denominator,0,-h._viewpointPosition[0]+.5*h._firstIterationWidth+h._firstIterationOffsetLeft,-h._viewpointPosition[1]+.5*h._firstIterationHeight+h._firstIterationOffsetTop,-h._viewpointPosition[2],1]);for(c=0;c<E;c++)u=this._flow.offset(y[c]),r=u.pathIndex,a=u.slideTime,o=w[r]._convertSplineTimeToBezierIndexTime(a),null!==o&&(pos=w[r].getPositionAtIndexTime(o),s=this._rayPointDistance(l,pos),s!==!1&&s<T&&(T=s,x=y[c]));this._closerIndex=x,w.length=0}}},_previousScrollDelta:{value:0},_startScroll:{value:0},_translateStride:{value:null},translateStride:{get:function(){return this._translateStride},set:function(e){this._translateStride=e,this.translateStrideX=e}},_scrollEnd:{value:null},_scrollStart:{value:null},_hasMomentum:{value:!0},isLimitedToSingleStride:{value:!1},_animationInterval:{value:function(){var e,t,i,n,r,a,s=Date.now(),o=!1;r=this.minScroll,a=this.maxScroll,this.minScroll=null,this.maxScroll=null,null===this._scrollEnd&&(this._scrollStart=this.scroll,this._pageX=this.endX,this._pageY=this.endY,this._updateScroll(),this._scrollEnd=this.scroll,this.isLimitedToSingleStride&&this.translateStrideX&&(this._scrollEnd>Math.floor(this._scrollStart)+this.translateStrideX&&(this._scrollEnd=Math.floor(this._scrollStart)+this.translateStrideX),this._scrollEnd<Math.ceil(this._scrollStart)-this.translateStrideX&&(this._scrollEnd=Math.ceil(this._scrollStart)-this.translateStrideX)),this._pageX=this.startX,this._pageY=this.startY,this._updateScroll()),this.animateMomentum?(e=s-this.startTime,e<this.__momentumDuration?(this._pageX=this.startX+(this.momentumX+this.momentumX*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this._pageY=this.startY+(this.momentumY+this.momentumY*(this.__momentumDuration-e)/this.__momentumDuration)*e/1e3/2,this._updateScroll(),this.translateStrideX&&null===this.startStrideXTime&&(this.__momentumDuration-e<this.translateStrideDuration||Math.abs(this.scroll-this._scrollEnd)<.75*this.translateStrideX)&&(this.startStrideXTime=s,this._strideStartScroll=this._scroll)):this.animateMomentum=!1):null===this.startStrideXTime&&(this.startStrideXTime=this.startTime,this._strideStartScroll=this._scrollStart),n=this.scroll,this.startStrideXTime&&s-this.startStrideXTime>0&&(i=Math.round(this._scrollEnd/this.translateStrideX),s-this.startStrideXTime<this.translateStrideDuration?(e=this._bezierTValue((s-this.startStrideXTime)/this.translateStrideDuration,.275,0,.275,1),t=(s-this.startStrideXTime)/this.translateStrideDuration,n=n*(1-t)+(i*this.translateStrideX*e+this._strideStartScroll*(1-e))*t,o=!0):(n=i*this.translateStrideX,this.animateMomentum=!1)),this.minScroll=r,this.maxScroll=a,n<r&&(n=r,this.animateMomentum=!1,o=!1),n>a&&(n=a,this.animateMomentum=!1,o=!1),this.scroll=n,this.isAnimating=this.animateMomentum||o,this.isAnimating?this.needsFrame=!0:(this._dispatchTranslateEnd(),this._scrollEnd=null)}}})}}),montageDefine("c50fb48","runtime/runtime-tf-loader",{dependencies:["runtime/dependencies/gl-matrix","runtime/glTF-parser","runtime/resource-description","runtime/technique","runtime/pass","runtime/pass","runtime/pass","runtime/glsl-program","runtime/glTF-material","runtime/mesh","runtime/glTF-node","runtime/primitive","runtime/projection","runtime/camera","runtime/skin","runtime/glTF-scene","runtime/transform","runtime/animation","runtime/animation-manager"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix");var n=e("runtime/glTF-parser").glTFParser,r=e("runtime/resource-description").ResourceDescription,a=e("runtime/technique").Technique,s=e("runtime/pass").ProgramPass,o=(e("runtime/pass").Pass,e("runtime/pass").ScenePass,e("runtime/glsl-program").GLSLProgram),l=e("runtime/glTF-material").glTFMaterial,u=e("runtime/mesh").Mesh,c=e("runtime/glTF-node").glTFNode,h=e("runtime/primitive").Primitive,d=e("runtime/projection").Projection,m=e("runtime/camera").Camera,p=e("runtime/skin").Skin,g=e("runtime/glTF-scene").glTFScene,f=e("runtime/transform").Transform,v=e("runtime/animation").Animation,_=e("runtime/animation-manager").AnimationManager;t.RuntimeTFLoader=Object.create(n,{_materials:{writable:!0,value:null},_scenes:{writable:!0,value:null},_animations:{writable:!0,value:null},totalBufferSize:{value:0,writable:!0},handleBuffer:{value:function(e,t,i){var n=Object.create(r).init(e,t);return n.id=e,this.storeEntry(e,n,t),this.totalBufferSize+=t.byteLength,t.type="arraybuffer",!0}},handleBufferView:{value:function(e,t,i){var n=Object.create(r).init(e,t);n.id=e;var a=this.getEntry(n.description.buffer);return t.type="ArrayBufferView",n.buffer=a,this.storeEntry(e,n,t),!0}},handleShader:{value:function(e,t,i){var n=Object.create(r).init(e,t);return n.id=e,n.type="shader",this.storeEntry(e,n,t),!0}},handleProgram:{value:function(e,t,i){var n=Object.create(r).init(e,t);n.id=e,n.type="program";var a=this.getEntry(n.description.vertexShader),s=this.getEntry(n.description.fragmentShader);return n[o.VERTEX_SHADER]=a.entry,n[o.FRAGMENT_SHADER]=s.entry,this.storeEntry(e,n,t),!0}},handleImage:{value:function(e,t,i){var n=t.path,a=Object.create(r).init(n,{path:n});return a.type="image",this.storeEntry(e,a,t),!0}},handleVideo:{value:function(e,t,i){var n=t.path,a=Object.create(r).init(n,{path:n});return a.type="video",this.storeEntry(e,a,t),!0}},handleTechnique:{value:function(e,t,i){var n=Object.create(a);n.id=e;var r=this.storeEntry(e,n,t),o=t.pass;n.passName=o;var l=t.passes;if(!l)return console.log("ERROR: technique does not contain pass"),!1;var u={},c=Object.keys(t.passes);return c.forEach(function(e){var t=l[e],i=t.instanceProgram;if(!i)return console.log("ERROR: A Pass with type=program must have a program property"),!1;var n=(new s).init();n.id=r+"_"+o,n.instanceProgram=t.instanceProgram,n.instanceProgram.program=this.getEntry(i.program).entry,n.states=t.states,u[e]=n},this),n.parameters=t.parameters,n.passes=u,!0}},handleMaterial:{value:function(e,t,i){var n=Object.create(l).init(e);this.storeEntry(e,n,t);var r=t.instanceTechnique,a=r.values;n.name=t.name;var s=this.getEntry(r.technique);if(!s)return console.log("ERROR: invalid file, cannot find referenced technique:"+t.technique),!1;n.technique=s.entry;var o=n.technique.parameters;return n.parameters=JSON.parse(JSON.stringify(o)),a&&a.forEach(function(e){var t=o[e.parameter];if(t){var i=null;switch(t.type){case"SAMPLER_CUBE":case"SAMPLER_2D":var r=this.getEntry(e.value);r?(e.value=r.entry,i=e):console.log("ERROR: can't find texture:"+e.value);break;default:i=e}}n.parameters[e.parameter]=i},this),this._materials||(this._materials=[]),this._materials.push(n),!0}},handleLight:{value:function(e,t,i){return!0}},handleAttribute:{value:function(e,t,i){var n=this.getEntry(t.bufferView);t.bufferView=n.entry,t.byteOffset||(t.byteOffset=0),this.storeEntry(e,t,t)}},handleIndices:{value:function(e,t,i){t.id=e;var n=this.getEntry(t.bufferView);t.bufferView=n.entry,this.storeEntry(e,t,t)}},handleMesh:{value:function(e,t,i){var n=Object.create(u).init();n.id=e,n.name=t.name;var r=!1,a=t.extensions;a&&(a["won-compression"]&&(r=!0,n.compression=a["won-compression"],n.compression.type="won-compression",n.compression.compressedData.bufferView=this.getEntry(n.compression.compressedData.bufferView).entry,n.compression.compressedData.id=e+"_compressedData"),a["Open3DGC-compression"]&&(r=!0,n.compression=a["Open3DGC-compression"],n.compression.type="Open3DGC-compression",n.compression.compressedData.bufferView=this.getEntry(n.compression.compressedData.bufferView).entry,n.compression.compressedData.id=e+"_compressedData")),this.storeEntry(e,n,t);var s=t[u.PRIMITIVES];if(!s)return console.log("MISSING_PRIMITIVES for mesh:"+e),!1;for(var o=0;o<s.length;o++){var l=s[o];if("TRIANGLES"===l.primitive){var c=Object.create(h).init(),d=this.getEntry(l.material);c.material=d.entry,n.primitives.push(c);var m=l.semantics,p=Object.keys(m);p.forEach(function(e){var t=m[e],i=this.getEntry(t);c.addVertexAttribute({semantic:e,attribute:i.entry})},this);var g=l.indices,f=this.getEntry(g);c.indices=f.entry}}return!0}},handleCamera:{value:function(e,t,i){var n=Object.create(m).init();n.id=e,this.storeEntry(e,n,t);var r=Object.create(d);return r.initWithDescription(t),n.projection=r,!0}},handleLight:{value:function(e,t,i){return!0}},buildNodeHirerachy:{value:function(e){var t=e.entry,i=e.description.children;i&&i.forEach(function(e){var i=this.getEntry(e),n=i.entry;null==n.parent?t.children.push(n):t.children.push(n.copy()),this.buildNodeHirerachy(i)},this)}},resolveParameterSources:{value:function(){this._materials&&this._materials.forEach(function(e){if(e.parameters){var t=Object.keys(e.parameters);t.forEach(function(t){var i=e.parameters[t];i&&i.source&&(i.source=this.getEntry(i.source).entry)},this)}},this)}},buildSkeletons:{value:function(e){if(e.instanceSkin){var t=e.instanceSkin.skin;if(t){e.instanceSkin.skeletons.forEach(function(e){var i=this.getEntry(e);if(i){var n=i.entry,r=t.jointsIds,a=[];r.forEach(function(t){var i=n.nodeWithJointID(t);i?a.push(i):console.log("WARNING: jointId:"+t+" cannot be found in skeleton:"+e)},this),t.nodesForSkeleton[e]=a}},this);var i=[];e.instanceSkin.sources.forEach(function(e){var t=this.getEntry(e);t&&i.push(t.entry)},this),t.sources=i}}var n=e.children;n&&n.forEach(function(e){this.buildSkeletons(e)},this)}},handleScene:{value:function(e,t,i){if(this._scenes||(this._scenes=[]),!t.nodes)return console.log("ERROR: invalid file required nodes property is missing from scene"),!1;var n=Object.create(g).init();n.ids=this._ids,n.id=e,n.name=t.name,n.baseURL=this.baseURL,this.storeEntry(e,n,t);var r=Object.create(c).init();return t.nodes&&t.nodes.forEach(function(e){var t=this.getEntry(e);r.children.push(t.entry),this.buildNodeHirerachy(t)},this),this.resolveParameterSources(),this.buildSkeletons(r),n.rootNode=r,this._scenes.push(n),!0}},handleSkin:{value:function(e,t,i){var n=Object.create(p).init();n.bindShapeMatrix=mat4.create(t.bindShapeMatrix),n.jointsIds=t.joints,n.inverseBindMatricesDescription=t.inverseBindMatrices,n.inverseBindMatricesDescription.id=e+"_inverseBindMatrices",n.inverseBindMatricesDescription.bufferView=this.getEntry(n.inverseBindMatricesDescription.bufferView).entry,this.storeEntry(e,n,t)}},handleNode:{value:function(e,t,i){var n=Object.create(c).init();n.id=e,n.jointId=t.jointId,n.name=t.name,this.storeEntry(e,n,t),n.transform=Object.create(f).initWithDescription(t);var r;if(t.mesh&&(r=this.getEntry(t.mesh),n.meshes.push(r.entry)),t.meshes&&t.meshes.forEach(function(e){r=this.getEntry(e),r&&n.meshes.push(r.entry)},this),t.camera){var a=this.getEntry(t.camera);a&&n.cameras.push(a.entry)}if(t.instanceSkin){t.instanceSkin.skin=this.getEntry(t.instanceSkin.skin).entry,n.instanceSkin=t.instanceSkin;var s=n.instanceSkin.sources;s&&s.forEach(function(e){r=this.getEntry(e),r&&n.meshes.push(r.entry)},this)}return!0}},handleLoadCompleted:{value:function(e){if(this.delegate){var t=null;if(this._state.options&&(t=this._state.options.ids),t)t.forEach(function(e){var t=this.getEntry(e);t&&this.delegate.loadCompleted(t.entry)},this);else if(this._scenes&&this.delegate&&this._scenes.length>0){var i=Object.create(_).init();i.animations=this._animations,this._scenes[0].animationManager=i,this.delegate.loadCompleted(this._scenes[0])}}}},handleAnimation:{value:function(e,t,i){this._animations||(this._animations=[]);var n=Object.create(v).initWithDescription(t);n.id=e,this.storeEntry(e,n,t);var r={};Object.keys(t.parameters).forEach(function(e){var i=t.parameters[e];switch(i.type){case"FLOAT_VEC4":componentsPerAttribute=4;break;case"FLOAT_VEC3":componentsPerAttribute=3;break;case"FLOAT_VEC2":componentsPerAttribute=2;break;case"FLOAT":componentsPerAttribute=1;break;default:console.log("type:"+i.type+" byteStride not handled")}i.byteStride=4*componentsPerAttribute,i.componentsPerAttribute=componentsPerAttribute,i.bufferView=this.getEntry(i.bufferView).entry,i.id=n.id+e,r[e]=i},this),n.parameters=r,n.channels.forEach(function(e){var t=e.target.id;e.path=e.target.path,e.target=this.getEntry(t).entry},this),Object.keys(n.samplers).forEach(function(e){var i=t.samplers[e],a=n.samplers[e],s=i.input,o=i.output;a.input=r[s],a.output=r[o]},this),this._animations.push(n)}},handleTexture:{value:function(e,t,i){if(t.source&&t.sampler)t.type="texture",t.source=this.getEntry(t.source).entry,t.sampler=this.getEntry(t.sampler).entry,t.id=e,this.storeEntry(e,t,t);else if(t.sources&&t.sampler){t.type="texture";for(var n=0;n<t.sources.length;n++)t.sources[n]=this.getEntry(t.sources[n]).entry;t.sampler=this.getEntry(t.sampler).entry,t.id=e,this.storeEntry(e,t,t)}else console.log("ERROR: texture"+e+" must contain both source and sampler properties")}},handleSampler:{value:function(e,t,i){t.id=t,this.storeEntry(e,t,t)}},handleError:{value:function(e){}},_delegate:{value:null,writable:!0},delegate:{enumerable:!0,get:function(){return this._delegate},set:function(e){this._delegate=e}},_entries:{enumerable:!1,value:null,writable:!0},removeAllEntries:{value:function(){this._entries={}}},containsEntry:{enumerable:!1,value:function(e){return!!this._entries&&!!this._entries[e]}},storeEntry:{enumerable:!1,value:function(e,t,i){return null==this._entries&&(this._entries={}),null==this._ids&&(this._ids={}),t.baseId=e,this._ids[e]=t,(e+=this.loaderContext())?(t.id=e,this.containsEntry[e]&&console.log("WARNING: entry:"+e+" is already stored, overriding"),this._entries[e]={id:e,entry:t,description:i},e):void console.log("ERROR: not id provided, cannot store")}},getEntry:{enumerable:!1,value:function(e){return e+=this.loaderContext(),this._entries?this._entries[e]:null}}})}}),montageDefine("c50fb48","runtime/pass",{dependencies:["runtime/dependencies/gl-matrix","montage","runtime/glTF-node","runtime/node-wrapper","runtime/projection","runtime/camera","runtime/utilities","runtime/webgl-renderer","runtime/transform","runtime/resource-description"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix");var n=e("montage").Montage,r=(e("runtime/glTF-node").glTFNode,e("runtime/node-wrapper").NodeWrapper),a=(e("runtime/projection").Projection,e("runtime/camera").Camera,e("runtime/utilities").Utilities,e("runtime/webgl-renderer").WebGLRenderer,e("runtime/transform").Transform),s=(e("runtime/resource-description").ResourceDescription,Object.create(Object.prototype,{_content:{value:null,writable:!0},content:{get:function(){return this._content},set:function(e){this._content=e}},_previous:{value:null,writable:!0},previous:{get:function(){return this._previous},set:function(e){this._previous=e}},_next:{value:null,writable:!0},next:{get:function(){return this._next},set:function(e){this._next=e}},init:{value:function(e){this.content=e,this.previous=null,this.next=null}},removeFromList:{value:function(){this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous),this.next=null,this.previous=null}}}),Object.create(Object.prototype,{_tail:{value:null,writable:!0},tail:{get:function(){return this._tail},set:function(e){this._tail=e}},_head:{value:null,writable:!0},head:{get:function(){return this._head},set:function(e){this._head=e}},append:{value:function(e){this.head||(this.head=e),this.tail&&(e.previous=this.tail,this.tail.next=e),this.tail=e}},remove:{value:function(e){var t=(e.content.id,!1),i=!1;this.tail===e&&(t=!0,this.tail=e.previous),this.head===e&&(i=!0,this.head=e.next)}}}),t.RenderTarget=Object.create(Object.prototype,{_extras:{value:null,writable:!0},_width:{value:0,writable:!0},_height:{value:0,writable:!0},_attachments:{value:null,writable:!0},attachments:{get:function(){return this._attachments},set:function(e){this._attachments=e}},init:{value:function(){return this.attachments=[],this.extras={},this}},width:{get:function(){return this._width},set:function(e){this._width=e}},height:{get:function(){return this._height},set:function(e){this._height=e}},extras:{get:function(){return this._extras},set:function(e){this._extras=e}}})),o=Object.create(Object.prototype,{_extras:{value:null,writable:!0},PROGRAM:{value:"program",writable:!1},SCENE:{value:"scene",writable:!1},_type:{value:null,writable:!0},type:{get:function(){return this._type}},extras:{get:function(){return this._extras},set:function(e){this._extras=e}}}),l=(t.ProgramPass=n.specialize({_attributes:{value:null,writable:!0},_uniforms:{value:null,writable:!0},_states:{value:null,writable:!0},_program:{value:null,writable:!0},states:{get:function(){return this._states},set:function(e){this._states=e}},program:{get:function(){return this._program},set:function(e){this._program=e}},init:{value:function(){return this.attributes={},this.uniforms={},this.states={},this._type=o.PROGRAM,this.extras={},this}}}),Object.create(Object.prototype,{_nodeWrappers:{value:null,writable:!0},_pathIDsForNodeID:{value:null,writable:!0},_primitivesPerPass:{value:null,writable:!0},_viewPoint:{value:null,writable:!0},_scene:{value:null,writable:!0},_observers:{value:null,writable:!0},_viewPointMatrix:{value:null,writable:!0},addObserver:{value:function(e){null==this._observers&&(this._observers=[]),this._observers.indexOf(e)===-1?this._observers.push(e):console.log("WARNING attempt to add 2 times the same observer in sceneRenderer")}},removeObserver:{value:function(e){if(this._observers){var t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}}},viewPoint:{get:function(){return this._viewPoint},set:function(e){if(this._observers)for(var t=0;t<this._observers.length;t++)this._observers[t].viewPointWillChange(this,this._viewPoint,e);if(this._viewPoint!=e&&(this._viewPoint=e),this._observers)for(var t=0;t<this._observers.length;t++)this._observers[t].viewPointMatrixDidUpdate(this),this._observers[t].viewPointDidChange(this)}},setupNodeAtPath:{value:function(e,t){var i=this._nodeWrappers[e.id];null==i&&(i=Object.create(r).init(e),this._nodeWrappers[e.id]=i,i.scenePassRenderer=this),e.meshes&&e.meshes.forEach(function(t){t.primitives&&t.primitives.forEach(function(n){if(n.material){var r=n.material.technique;if(r&&r.rootPass){var a,s=r.rootPass.id,o=null;for(a=0;a<this._primitivesPerPass.length;a++)this._primitivesPerPass[a].pass===s&&(o=this._primitivesPerPass[a]);null==o&&(o=this._primitivesPerPass[s]={pass:r.rootPass,primitives:[]},this._primitivesPerPass.push(o));var l={};t.compression&&(l.compressed=!0),l.primitive=n,l.node=e,l.nodeWrapper=i,o.primitives.push(l)}}},this)},this)}},sceneWillChange:{value:function(e,t){this._viewPointMatrix=mat4.identity()}},sceneDidChange:{value:function(){this._primitivesPerPass=[],this._nodeWrappers={};var e=this;this.scene&&this.scene.rootNode.apply(function(t,i,n){return e.setupNodeAtPath(t),null},!0,null)}},render:{value:function(e,t,i){if(this.scene&&this.viewPoint){null==this.__matrix&&(this.__matrix=mat4.create()),null==this.__transform&&(this.__transform=Object.create(a).init());var n=i.viewPointModifierMatrix;if(this.viewPoint){mat4.set(this.viewPoint.worldMatrix,this.__matrix);var r=i.interpolatingViewPoint;if(r){var s=(t-r.start)/1e3;if(null!=r.previous&&s<1){var o=r.previous.transform,l=this.viewPoint.transform;o.interpolateToTransform(l,s,this.__transform),mat4.multiply(this.viewPoint.parent.worldMatrix,this.__transform.matrix,this.__matrix)}}if(mat4.multiply(this.__matrix,n),mat4.inverse(this.__matrix),mat4.equal(this._viewPointMatrix,this.__matrix)===!1&&(mat4.set(this.__matrix,this._viewPointMatrix),this._observers))for(var u=0;u<this._observers.length;u++)this._observers[u].viewPointMatrixDidUpdate(this)}var c=!!i&&1==i.picking&&i.coords;c&&(this.pickingRenderTarget.extras.coords=i.coords,e.bindRenderTarget(this.pickingRenderTarget));var h=this.scene.rootNode.nodeWithPropertyNamed("instanceSkin");h&&h.instanceSkin.skin.process(h,e.resourceManager),e.projectionMatrix=this.viewPoint.cameras[0].projection.matrix,null==this.__nonOpaquePassesWithPrimitives&&(this.__nonOpaquePassesWithPrimitives=[]),this.__nonOpaquePassesWithPrimitives.length=0;var d;for(d=0;d<this._primitivesPerPass.length;d++){var m=this._primitivesPerPass[d],p=c?this.pickingPass:m.pass,g=p.states;g.blendEnable&&!c?this.__nonOpaquePassesWithPrimitives.push(m):c&&this.pickingTechnique?e.renderPrimitivesWithPass(m.primitives,p,this.pickingTechnique.parameters,t):e.renderPrimitivesWithPass(m.primitives,p,null,t)}if(c){e.unbindRenderTarget(this.pickingRenderTarget);var f=this.pickingRenderTarget.extras.pickedPixel,v=null,_=Object.keys(this.pickingPass.extras.nodeIDToColor);_.forEach(function(e){var t=this.pickingPass.extras.nodeIDToColor[e];Math.abs(Math.round(255*t[0])-f[0])<=1&&Math.abs(Math.round(255*t[1])-f[1])<=1&&Math.abs(Math.round(255*t[2])-f[2])<=1&&(v=e)},this),i.delegate.handleSelectedNode(v)}else for(d=0;d<this.__nonOpaquePassesWithPrimitives.length;d++){var m=this.__nonOpaquePassesWithPrimitives[d];e.renderPrimitivesWithPass(m.primitives,m.pass,null,t)}}}},scene:{get:function(){return this._scene},set:function(e){this._scene!=e&&(this.sceneWillChange(this._scene,e),this._scene=e,this.sceneDidChange())}},_pickingPass:{value:null,writable:!0},pickingPass:{get:function(){return this._pickingPass},set:function(e){this._pickingPass=e,this._pickingPass.id="__PickingPass",this._pickingPass.extras.nodeIDToColor={}}},_pickingTechnique:{value:null,writable:!0},pickingTechnique:{get:function(){return this._pickingTechnique},set:function(e){this._pickingTechnique=e,this.pickingPass=this._pickingTechnique.rootPass}},_pickingRenderTarget:{value:null,writable:!0},pickingRenderTarget:{get:function(){return this._pickingRenderTarget},set:function(e){this._pickingRenderTarget=e}},createPickingRenderTargetIfNeeded:{value:function(){return this._pickingRenderTarget||(this._pickingRenderTarget=Object.create(s).init(),this._pickingRenderTarget.attachments.push({semantic:"COLOR_ATTACHMENT0",parameter:"__pickingTexture"}),this._pickingRenderTarget.attachments.push({semantic:"DEPTH_ATTACHMENT",parameter:"__pickingRenderBuffer"}),this.pickingRenderTarget.extras.picking=!0),this._pickingRenderTarget}},init:{value:function(){return this.pickingRenderTarget=this.createPickingRenderTargetIfNeeded(),this.pickingRenderTarget.width=512,this.pickingRenderTarget.height=512,this._nodeWrappers={},this}}}));t.ScenePass=Object.create(o,{_sceneRenderer:{value:null,writable:!0},createSceneRendererIfNeeded:{value:function(){this._sceneRenderer||(this._sceneRenderer=Object.create(l).init())}},sceneRenderer:{get:function(){return this.createSceneRendererIfNeeded(),this._sceneRenderer},set:function(e){this.createSceneRendererIfNeeded(),this._sceneRenderer!=e&&(this._sceneRenderer=e)}},viewPoint:{get:function(){return this.sceneRenderer?this.sceneRenderer.viewPoint:null},set:function(e){this.sceneRenderer&&(this.sceneRenderer.viewPoint=e)}},scene:{get:function(){return this.sceneRenderer.scene},set:function(e){this.sceneRenderer.scene=e}},execute:{value:function(e,t,i){this.sceneRenderer.render(e,t,i)}},init:{value:function(){return this._type=o.SCENE,this.extras={},this}}})}}),montageDefine("b0111a3","core/serialization/serialization",{dependencies:["../core","./serializer/montage-labeler","./deserializer/montage-reviver","frb/parse","frb/stringify"],factory:function(e,t,i){var n=e("../core").Montage,r=e("./serializer/montage-labeler").MontageLabeler,a=e("./deserializer/montage-reviver").MontageReviver,s=e("frb/parse"),o=e("frb/stringify"),l=n.specialize({_serializationString:{value:null},_serializationObject:{value:null},_serializationLabels:{value:null},initWithString:{value:function(e){return this._serializationString=e,this._serializationObject=null,this._serializationLabels=null,this}},initWithObject:{value:function(e){return this._serializationString=null,this._serializationObject=e,this._serializationLabels=null,this}},clone:{value:function(){var e=new l;return e.initWithString(this.getSerializationString()),e}},getSerializationObject:{value:function(){return this._serializationObject||(this._serializationObject=JSON.parse(this._serializationString)),
this._serializationObject}},getSerializationString:{value:function(){return this._serializationString||(this._serializationString=JSON.stringify(this._serializationObject)),this._serializationString}},getSerializationLabels:{value:function(){var e;return this._serializationLabels||(e=this.getSerializationObject())&&(this._serializationLabels=Object.keys(e)),this._serializationLabels}},getExternalObjectLabels:{value:function(){var e=this.getSerializationObject(),t=[];for(var i in e)0===Object.keys(e[i]).length&&t.push(i);return t}},hasSerializationLabel:{value:function(e){return e in this.getSerializationObject()}},isExternalObject:{value:function(e){var t=this.getSerializationObject();return!!(t&&e in t)&&0===Object.keys(t[e]).length}},isAlias:{value:function(e){var t=this.getSerializationObject();return!!(t&&e in t)&&"alias"in t[e]}},getElementId:{value:function(e){var t=this.getSerializationObject(),i=n.getPath.call(t,e+".properties.element");if(i)return i["#"]}},getSerializationLabelsWithElements:{value:function(e){var t=new c,i=[];return t.initWithSerialization(this),t.visitSerialization(function(t){"Element"===t.type&&e.indexOf(t.data)>=0&&(t=t.parent,t&&"properties"===t.name&&(t=t.parent,t&&"montageObject"===t.type&&i.push(t.label)))}),i}},renameElementReferences:{value:function(e){var t=new c;t.initWithSerialization(this),t.visitSerialization(function(t){"Element"===t.type&&t.data in e&&(t.data=e[t.data])})}},renameSerializationLabels:{value:function(e){var t=new c;t.initWithSerialization(this),t.visitSerialization(function(t){if(t.label){var i=t.label;i in e&&(t.label=e[i])}if("reference"===t.type){var n=t.data;n in e&&(t.data=e[n])}})}},mergeSerialization:{value:function(e,t){return u.mergeSerializations(this,e,t)}},extractSerialization:{value:function(e,t){var i=new h;return i.initWithSerialization(this),i.extractSerialization(e,t)}}}),u=n.specialize(null,{mergeSerializations:{value:function(e,t,i){var n,r,a,s,o,l,u={};a=e.getSerializationLabels(),s=t.getSerializationLabels(),o=this._createCollisionTable(a,s,u,i&&i.labeler),i&&i.willMergeObjectWithLabel&&(l=this._willMergeObjectWithLabel(i,e,t,u),o=o||l),o&&(t=t.clone(),t.renameSerializationLabels(u),s=t.getSerializationLabels()),n=e.getSerializationObject(),r=t.getSerializationObject();for(var c,h=0;c=s[h];h++)a.indexOf(c)===-1&&(n[c]=r[c]);return e.initWithObject(n),u}},_willMergeObjectWithLabel:{value:function(e,t,i,n){var r,a,s,o,l,u=!1,c=i.getSerializationLabels();n&&(s=[],Object.keys(n).forEach(function(e){s.push(n[e])}));for(var h,d=0;h=c[d];d++)if(a=n&&n[h],r=e.willMergeObjectWithLabel(h,a),"string"==typeof r){if(o=this._isLabelValidInSerialization(r,t),o||(l=!this._isLabelValidInSerialization(r,i)&&s.indexOf(r)===-1),!o&&!l)throw new Error("willMergeObjectWithLabel either needs to return a label that exists in the destination serialization to indicate it's the same object or return a completely new label to rename the object being merged. \""+r+'"  destination: '+t.getSerializationString()+"\n source: "+i.getSerializationString()+"\n collision table: "+JSON.stringify(n,null,4));u=!0,n[h]=r}return u}},_isLabelValidInSerialization:{value:function(e,t){var i,n;return!!t.hasSerializationLabel(e)||(n=e.indexOf(":"),!!(n>0&&(i=e.slice(0,n),t.hasSerializationLabel(i))))}},_createCollisionTable:{value:function(e,t,i,n){for(var a,s,o,l,n=n||new r,u=!1,c=Object.create(null),h=0;h<e.length;h++)o=e[h],l=o.indexOf(":"),l>0&&(a=o.slice(0,l),n.addLabel(a),c[a]=1),n.addLabel(o),c[o]=1;for(var h=0;o=t[h];h++)l=o.indexOf(":"),l>0?(a=o.slice(0,l),s=i[a],s?(i[o]=s+":"+o.slice(l+1),u=!0):a in c?(s=n.generateLabel(n.getLabelBaseName(a)),t.indexOf(a)>=0&&(i[a]=s),i[o]=s+o.slice(l),u=!0):n.addLabel(a)):o in c&&!(o in i)?(i[o]=n.generateLabel(n.getLabelBaseName(o)),u=!0):n.addLabel(o);return u}}}),c=n.specialize({initWithSerialization:{value:function(e){this._serialization=e}},visitSerialization:{value:function(e){var t=this._serialization.getSerializationObject();this._walkRootObjects(e,t),this._serialization.initWithObject(t)}},visitSerializationObject:{value:function(e,t){var i=this._serialization.getSerializationObject();if(!(e in i))throw new Error('Object "'+e+'" does not exist in '+this._serialization.getSerializationString());this._walkRootObject(t,i,e),this._serialization.initWithObject(i)}},changeLabel:{value:function(e,t){var i,n=this._serialization.getSerializationObject();i=n[e],delete n[e],n[t]=i}},_walkRootObjects:{value:function(e,t){for(var i in t)this._walkRootObject(e,t,i)}},_walkRootObject:{value:function(e,t,i){var n=t[i];"value"in n?this._walkObject(e,n,"value",i):this._walkCustomObject(e,t,i)}},_walkObject:{value:function(e,t,i,n,r){var s,o=t[i],l=a.getTypeOf(o);if(s={type:l},n?s.label=n:s.name=i,r&&(s.parent=r),"number"===l||"string"===l||"null"===l)s.data=o,e(s),t[i]=s.data;else if("regexp"===l)s.data=o["/"],e(s),o["/"]=s.data;else if("reference"===l)s.data=o["@"],e(s),o["@"]=s.data;else if("Element"===l)s.data=o["#"],e(s),o["#"]=s.data;else if("array"===l){s.data=o,e(s),t[i]=o=s.data;for(var u=0,c=o.length;u<c;u++)this._walkObject(e,o,""+u,null,s)}else if("object"===l){s.data=o,e(s),t[i]=o=s.data;for(var i in o)this._walkObject(e,o,i,null,s)}s.label!=n&&this.changeLabel(n,s.label)}},_walkCustomObject:{value:function(e,t,i){var n,r=t[i];n={type:"montageObject",label:i,data:r},e(n),t[i]=r=n.data,n.label!=i&&this.changeLabel(i,n.label),r.properties&&this._walkObject(e,r,"properties",null,n),r.listeners&&this._walkObject(e,r,"listeners",null,n),r.bindings&&this._walkBindings(e,r,null,n),r.localizations&&this._walkLocalizations(e,r,null,n)}},_walkBindings:{value:function(e,t,i){var n,r=t.bindings;n={type:"bindings",data:r,parent:i},e(n),t.bindings=r=n.data;for(var a in r)this._walkBinding(e,r,a,n)}},_walkBinding:{value:function(e,t,i,n){var r,a=t[i];r={type:"binding",name:i,data:a,parent:n},e(r),t[i]=a=r.data,this._walkBindingData(e,a,r)}},_walkBindingData:{value:function(e,t,i){var n,r,a=!1;n=t["<-"]||t["<->"],r=Object.clone(s(n)),this._walksBindingReferences(r,function(t){var i={type:"reference",data:t.label};e(i),t.label!==i.data&&(t.label=i.data,a=!0)}),a&&("<-"in t?t["<-"]=o(r):t["<->"]=o(r)),t.converter&&this._walkObject(e,t,"converter",null,i)}},_walkLocalizations:{value:function(e,t,i){var n,r=t.localizations;n={type:"localizations",data:r,parent:i},e(n),t.localizations=r=n.data;for(var a in r)this._walkLocalization(e,r,a,n)}},_walkLocalization:{value:function(e,t,i,n){var r,a,s=t[i];if(r={type:"localization",name:i,data:s,parent:n},e(r),t[i]=s=r.data,"object"==typeof s.key&&this._walkBindingData(e,s.key,r),"object"==typeof s["default"]&&this._walkBindingData(e,s["default"],r),"object"==typeof s.data){a=s.data;for(var i in a)this._walkBindingData(e,a[i],r)}}},_walksBindingReferences:{value:function(e,t){var i=e.args;if("component"===e.type&&t(e),i)for(var n=0,r=i.length;n<r;n++)this._walksBindingReferences(i[n],t)}}}),h=n.specialize({_serialization:{value:null},initWithSerialization:{value:function(e){this._serialization=e}},extractSerialization:{value:function(e,t){var i,n=new c,r={},a=[];i=this._serialization.getSerializationObject(),n.initWithSerialization(this._serialization);for(var s,o=0;s=e[o];o++)r[s]=i[s],n.visitSerializationObject(s,function(t){var i;"reference"===t.type&&(i=t.data,a.indexOf(i)===-1&&e.indexOf(i)===-1&&a.push(i))});if(t)for(var s,o=0;s=t[o];o++)s in i&&!(s in r)&&(r[s]={});for(var s,o=0;s=a[o];o++)r[s]={};return(new l).initWithObject(r)}}});t.Serialization=l,t.SerializationMerger=u,t.SerializationInspector=c,t.SerializationExtractor=h}}),montageDefine("b0111a3","core/mini-url",{dependencies:[],factory:function(e,t,i){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function a(e,t,i,n){t=t||"&",i=i||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var o=1e3;n&&"number"==typeof n.maxKeys&&(o=n.maxKeys);var l=e.length;o>0&&l>o&&(l=o);for(var u=0;u<l;++u){var c,h,d,m,p=e[u].replace(s,"%20"),g=p.indexOf(i);g>=0?(c=p.substr(0,g),h=p.substr(g+1)):(c=p,h=""),d=decodeURIComponent(c),m=decodeURIComponent(h),r(a,d)?Array.isArray(a[d])?a[d].push(m):a[d]=[a[d],m]:a[d]=m}return a}function s(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function o(e,t,i,n){return t=t||"&",i=i||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map(function(n){var r=encodeURIComponent(s(n))+i;return Array.isArray(e[n])?e[n].map(function(e){return r+encodeURIComponent(s(e))}).join(t):r+encodeURIComponent(s(e[n]))}).join(t):n?encodeURIComponent(s(n))+i+encodeURIComponent(s(e)):""}function l(e){return null===e}function u(e){return null===e||void 0===e}function c(e){return"string"==typeof e}function h(e){return"object"==typeof e}function d(e,t,i){if(e&&h(e)&&e instanceof n)return e;var r=new n;return r.parse(e,t,i),r}var m=/^([a-z0-9.+-]+:)/i,p=/:[0-9]*$/,g=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,f=["<",">",'"',"`"," ","\r","\n","\t"],v=["{","}","|","\\","^","`"].concat(f),_=["'"].concat(v),b=["%","/","?",";","#"].concat(_),w=["/","?","#"],y=255,E=/^[+a-z0-9A-Z_-]{0,63}$/,C=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},T={javascript:!0,"javascript:":!0},S={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};n.prototype.parse=function(e,t,i){if(!c(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e.indexOf("?"),r=n!==-1&&n<e.indexOf("#")?"?":"#",s=e.split(r),o=/\\/g;s[0]=s[0].replace(o,"/"),e=s.join(r);var l=e;if(l=l.trim(),!i&&1===e.split("#").length){var u=g.exec(l);if(u)return this.path=l,this.href=l,this.pathname=u[1],u[2]?(this.search=u[2],t?this.query=decodeDuerystring(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=m.exec(l);if(h){h=h[0];var d=h.toLowerCase();this.protocol=d,l=l.substr(h.length)}if(i||h||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var p="//"===l.substr(0,2);!p||h&&T[h]||(l=l.substr(2),this.slashes=!0)}if(!T[h]&&(p||h&&!S[h])){for(var f=-1,v=0;v<w.length;v++){var P=l.indexOf(w[v]);P!==-1&&(f===-1||P<f)&&(f=P)}var A,R;R=f===-1?l.lastIndexOf("@"):l.lastIndexOf("@",f),R!==-1&&(A=l.slice(0,R),l=l.slice(R+1),this.auth=decodeURIComponent(A)),f=-1;for(var v=0;v<b.length;v++){var P=l.indexOf(b[v]);P!==-1&&(f===-1||P<f)&&(f=P)}f===-1&&(f=l.length),this.host=l.slice(0,f),l=l.slice(f),this.parseHost(),this.hostname=this.hostname||"";var D="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!D)for(var L=this.hostname.split(/\./),v=0,O=L.length;v<O;v++){var I=L[v];if(I&&!I.match(E)){for(var M="",k=0,F=I.length;k<F;k++)M+=I.charCodeAt(k)>127?"x":I[k];if(!M.match(E)){var N=L.slice(0,v),B=L.slice(v+1),j=I.match(C);j&&(N.push(j[1]),B.unshift(j[2])),B.length&&(l="/"+B.join(".")+l),this.hostname=N.join(".");break}}}this.hostname.length>y?this.hostname="":this.hostname=this.hostname.toLowerCase();var z=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+z,this.href+=this.host,D&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==l[0]&&(l="/"+l))}if(!x[d])for(var v=0,O=_.length;v<O;v++){var G=_[v];if(l.indexOf(G)!==-1){var U=encodeURIComponent(G);U===G&&(U=escape(G)),l=l.split(G).join(U)}}var q=l.indexOf("#");q!==-1&&(this.hash=l.substr(q),l=l.slice(0,q));var X=l.indexOf("?");if(X!==-1?(this.search=l.substr(X),this.query=l.substr(X+1),t&&(this.query=a(this.query)),l=l.slice(0,X)):t&&(this.search="",this.query={}),l&&(this.pathname=l),S[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var z=this.pathname||"",W=this.search||"";this.path=z+W}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",i=this.pathname||"",n=this.hash||"",r=!1,a="";this.host?r=e+this.host:this.hostname&&(r=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&h(this.query)&&Object.keys(this.query).length&&(a=o(this.query));var s=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||S[t])&&r!==!1?(r="//"+(r||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):r||(r=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),i=i.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+r+i+s+n},n.prototype.resolve=function(e){return this.resolveObject(d(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if(c(e)){var t=new n;t.parse(e,!1,!0),e=t}for(var i=new n,r=Object.keys(this),a=0;a<r.length;a++){var s=r[a];i[s]=this[s]}if(i.hash=e.hash,""===e.href)return i.href=i.format(),i;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),h=0;h<o.length;h++){var d=o[h];"protocol"!==d&&(i[d]=e[d])}return S[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(e.protocol&&e.protocol!==i.protocol){if(!S[e.protocol]){for(var m=Object.keys(e),p=0;p<m.length;p++){var g=m[p];i[g]=e[g]}return i.href=i.format(),i}if(i.protocol=e.protocol,e.host||T[e.protocol])i.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),i.pathname=f.join("/")}if(i.search=e.search,i.query=e.query,i.host=e.host||"",i.auth=e.auth,i.hostname=e.hostname||e.host,i.port=e.port,i.pathname||i.search){var v=i.pathname||"",_=i.search||"";i.path=v+_}return i.slashes=i.slashes||e.slashes,i.href=i.format(),i}var b=i.pathname&&"/"===i.pathname.charAt(0),w=e.host||e.pathname&&"/"===e.pathname.charAt(0),y=w||b||i.host&&e.pathname,E=y,C=i.pathname&&i.pathname.split("/")||[],f=e.pathname&&e.pathname.split("/")||[],x=i.protocol&&!S[i.protocol];if(x&&(i.hostname="",i.port=null,i.host&&(""===C[0]?C[0]=i.host:C.unshift(i.host)),i.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),y=y&&(""===f[0]||""===C[0])),w)i.host=e.host||""===e.host?e.host:i.host,i.hostname=e.hostname||""===e.hostname?e.hostname:i.hostname,i.search=e.search,i.query=e.query,C=f;else if(f.length)C||(C=[]),C.pop(),C=C.concat(f),i.search=e.search,i.query=e.query;else if(!u(e.search)){if(x){i.hostname=i.host=C.shift();var P=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@");P&&(i.auth=P.shift(),i.host=i.hostname=P.shift())}return i.search=e.search,i.query=e.query,l(i.pathname)&&l(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!C.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var A=C.slice(-1)[0],R=(i.host||e.host||C.length>1)&&("."===A||".."===A)||""===A,D=0,L=C.length;L>=0;L--)A=C[L],"."===A?C.splice(L,1):".."===A?(C.splice(L,1),D++):D&&(C.splice(L,1),D--);if(!y&&!E)for(;D--;D)C.unshift("..");!y||""===C[0]||C[0]&&"/"===C[0].charAt(0)||C.unshift(""),R&&"/"!==C.join("/").substr(-1)&&C.push("");var O=""===C[0]||C[0]&&"/"===C[0].charAt(0);if(x){i.hostname=i.host=O?"":C.length?C.shift():"";var P=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@");P&&(i.auth=P.shift(),i.host=i.hostname=P.shift())}return y=y||i.host&&C.length,y&&!O&&C.unshift(""),C.length?i.pathname=C.join("/"):(i.pathname=null,i.path=null),l(i.pathname)&&l(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=e.auth||i.auth,i.slashes=i.slashes||e.slashes,i.href=i.format(),i},n.prototype.parseHost=function(){var e=this.host,t=p.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},i.exports.resolve=function(e,t){return d(e,!1,!0).resolve(t)}}}),montageDefine("b0111a3","ui/base/abstract-slider",{dependencies:["./abstract-control","../../composer/translate-composer","../../composer/key-composer"],factory:function(e,t,i){var n=e("./abstract-control").AbstractControl,r=e("../../composer/translate-composer").TranslateComposer,a=e("../../composer/key-composer").KeyComposer;t.AbstractSlider=n.specialize({constructor:{value:function s(){if(this.constructor===s)throw new Error("AbstractSlider cannot be instantiated.");this._propertyNamesUsed={},this.addOwnPropertyChangeListener("_sliderMagnitude",this),this.addOwnPropertyChangeListener("_min",this),this.addOwnPropertyChangeListener("_max",this),this.addOwnPropertyChangeListener("_value",this),this.addOwnPropertyChangeListener("_step",this),this.addOwnPropertyChangeListener("axis",this),this.axis="horizontal",this.defineBinding("classList.has('montage--disabled')",{"<-":"!enabled"}),this.defineBinding("classList.has('montage-Slider--active')",{"<-":"active"})}},enterDocument:{value:function(e){if(e){this._translateComposer=new r,this._translateComposer.identifier="thumb",this._translateComposer.axis=this.axis,this._translateComposer.hasMomentum=!1,this.addComposerForElement(this._translateComposer,this._sliderThumbElement),"webkitTransform"in this.element.style?this._transform="webkitTransform":"MozTransform"in this.element.style?this._transform="MozTransform":"oTransform"in this.element.style?this._transform="oTransform":this._transform="transform";var t=this._propertyNamesUsed;t._min||(this.min=this.element.getAttribute("min")||this._min),t._max||(this.max=this.element.getAttribute("max")||this._max),t._step||(this.step=this.element.getAttribute("step")||this._step),t._value||(this.value=this.element.getAttribute("value")||this._value),delete this._propertyNamesUsed,this.element.setAttribute("role","slider"),this.element.tabIndex="-1",this._upKeyComposer=a.createKey(this,"up","increase"),this._downKeyComposer=a.createKey(this,"down","decrease"),this._rightKeyComposer=a.createKey(this,"right","increase"),this._leftKeyComposer=a.createKey(this,"left","decrease")}}},prepareForActivationEvents:{value:function(){this._translateComposer.addEventListener("translateStart",this,!1),this._translateComposer.addEventListener("translate",this,!1),this._translateComposer.addEventListener("translateEnd",this,!1),this._sliderThumbElement.addEventListener("touchstart",this,!1),document.addEventListener("touchend",this,!1),this._sliderThumbElement.addEventListener("mousedown",this,!1),document.addEventListener("mouseup",this,!1),this._upKeyComposer.addEventListener("keyPress",this,!1),this._downKeyComposer.addEventListener("keyPress",this,!1),this._leftKeyComposer.addEventListener("keyPress",this,!1),this._rightKeyComposer.addEventListener("keyPress",this,!1)}},willDraw:{value:function(){this._sliderMagnitude=this._calculateSliderMagnitude()}},_previousPercentage:{value:null},draw:{value:function(){"vertical"===this.axis?this._isUpdatingTranslate?(this._sliderThumbElement.style[this._transform]="translate3d(0,"+(this._previousPercentage-this._valuePercentage)*this._sliderMagnitude*.01+"px,0)",this._isUpdatingTranslate=!1):(this._sliderThumbElement.style.top=100-this._valuePercentage+"%",this._sliderThumbElement.style.left=0,this._sliderThumbElement.style[this._transform]="translate3d(0,0,0)",this._previousPercentage=this._valuePercentage):this._isUpdatingTranslate?(this._sliderThumbElement.style[this._transform]="translate3d("+(this._valuePercentage-this._previousPercentage)*this._sliderMagnitude*.01+"px,0,0)",this._isUpdatingTranslate=!1):(this._sliderThumbElement.style.left=this._valuePercentage+"%",this._sliderThumbElement.style.top=0,this._sliderThumbElement.style[this._transform]="translate3d(0,0,0)",this._previousPercentage=this._valuePercentage),this.element.setAttribute("aria-valuemax",this.max),this.element.setAttribute("aria-valuemin",this.min),this.element.setAttribute("aria-valuenow",this.value)}},acceptsActiveTarget:{value:!0},handleTouchstart:{value:function(e){this.active=!0,this.element.focus(),this._isUpdatingTranslate=!0}},handleTouchend:{value:function(e){this.active=!1}},handleMousedown:{value:function(e){this.active=!0,this.element.focus(),e.preventDefault(),this._isUpdatingTranslate=!0}},handleMouseup:{value:function(e){this.active=!1}},_isUpdatingTranslate:{value:!1},handleThumbTranslateStart:{value:function(e){"vertical"===this.axis?this._startTranslate=e.translateY:this._startTranslate=e.translateX,this._startValue=this.value}},handleThumbTranslate:{value:function(e){"vertical"===this.axis?this.value=this._startValue+(this._startTranslate-e.translateY)/this._sliderMagnitude*(this._max-this._min):this.value=this._startValue+(e.translateX-this._startTranslate)/this._sliderMagnitude*(this._max-this._min),this._isUpdatingTranslate=!0}},handleThumbTranslateEnd:{value:function(e){this.active=!1,this._isUpdatingTranslate=!1}},_increase:{value:function(){var e="number"==typeof this.min?this.min:0,t=this.value-e,i=this.step|(this.max-this.min)/100;t%i?t<0?t-=t%i:t+=i-t%i:t+=i,this.value=t+e}},_decrease:{value:function(){var e="number"==typeof this.min?this.min:0,t=this.value-e,i=this.step|(this.max-this.min)/100;t-=t%i?t>0?t%i:i+t%i:i,this.value=t+e}},handleKeyPress:{value:function(e){this.enabled&&("increase"===e.identifier?this._increase():"decrease"===e.identifier&&this._decrease())}},surrenderPointer:{value:function(e,t){return!1}},active:{value:!1},_min:{value:0},_max:{value:100},_step:{value:"any"},min:{get:function(){return this._min},set:function(e){isNaN(e=parseFloat(e))||this._min!==e&&(this._min=e)}},max:{get:function(){return this._max},set:function(e){isNaN(e=parseFloat(e))||this._max!==e&&(this._max=e)}},step:{get:function(){return this._step},set:function(e){!isNaN(e=parseFloat(e))&&e>=0&&this._step!==e&&(this._step=e)}},_value:{value:50},value:{get:function(){return this._value},set:function(e){isNaN(e=parseFloat(e))||(e>this._max?e=this._max:e<this._min&&(e=this._min),this._value!==e&&(this._value=e))}},enabled:{value:!0},axis:{value:null},_sliderThumbElement:{value:null},_translateComposer:{value:null},_transform:{value:null},_transition:{value:null},_sliderMagnitude:{value:null},_startTranslate:{value:null},_startValue:{value:null},_valuePercentage:{value:null},_calculateSliderMagnitude:{value:function(){var e=window.getComputedStyle(this._element);return"vertical"===this.axis?this._element.clientHeight-parseFloat(e.getPropertyValue("padding-top"))-parseFloat(e.getPropertyValue("padding-bottom")):this._element.clientWidth-parseFloat(e.getPropertyValue("padding-left"))-parseFloat(e.getPropertyValue("padding-right"))}},handleAxisChange:{value:function(){this._translateComposer&&(this._translateComposer.axis=this.axis),"vertical"===this.axis?(this.classList.add("montage-Slider--vertical"),this.classList.remove("montage-Slider--horizontal")):(this.classList.remove("montage-Slider--vertical"),this.classList.add("montage-Slider--horizontal"))}},_propertyRegex:{value:/_sliderMagnitude|_min|_max|_value|_step/},handlePropertyChange:{value:function(e,t,i){if(null!==t.match(this._propertyRegex)){if(this._propertyNamesUsed&&(this._propertyNamesUsed[t]=!0),this._value<=this._min)this._value=this._min;else{var n=this._value-this._min,r=n%this._step;if(r){var a=r>=.5*this._step&&this._value-r+this._step<=this._max;a?this._value=this._value-r+this._step:this._value=this._value-r}}this._value>this._max&&(this._value=this._max),this._valuePercentage=100*(this._value-this._min)/(this._max-this._min),this.needsDraw=!0}}}})}}),montageDefine("b0111a3","core/range-controller",{dependencies:["./core","collections/generic-collection","collections/listen/array-changes","core/deprecate","./core","./core"],factory:function(e,t,i){var n=e("./core").Montage,r=e("collections/generic-collection"),a=e("collections/listen/array-changes").observableArrayProperties,s=e("core/deprecate"),o=Object.freeze([]),l=function(e,t){var i=e;return i.__proto__=l.prototype,i.rangeController=t,i.contentEquals=e&&e.contentEquals||Object.is,i};l.prototype=Object.create(Array.prototype,a),Object.defineProperty(l.prototype,"clone",{value:function(){return this.slice()}}),self.swap,Object.defineProperty(l.prototype,"oldSwap",{configurable:!1,value:a.swap.value}),Object.defineProperty(l.prototype,"swap",{configurable:!1,value:function(e,t,i){return this.swap_or_push(e,t,i)}}),l.prototype.oldPush=a.push.value,Object.defineProperty(l.prototype,"push",{configurable:!1,value:function(){for(var e=-1,t=arguments.length,i=Array(t);++e<t;)i[e]=arguments[e];this.swap_or_push(this.length,0,i)}}),Object.defineProperty(l.prototype,"swap_or_push",{configurable:!1,value:function(e,t,i){var n=this.rangeController.content;this.contentEquals=n&&n.contentEquals||Object.is,e=e>=0?e:this.length+e;var r=this.length,a=Math.min(t,r-e);if(i){i.contentEquals=this.contentEquals;var s=i.filter(function(t,r){if(n&&!n.has(t))return!1;if(i.findLast(t)>r)return!1;var s=this.find(t);return s<0||s>=e&&s<e+a},this)}else s=o;var l;l=0===a?o:Array.prototype.slice.call(this,e,e+a);var u=s.length-l.length,c=Math.max(this.length+u,e+s.length);if(!this.rangeController.allowsMultipleSelection&&c>1){var h=s.length?s[s.length-1]:this.one();return 0===r?(this.oldPush(h),o):this.oldSwap(0,r,[h])}return this.rangeController.avoidsEmptySelection&&0===c?n.has(this[0])?this.length-1===0?o:this.oldSwap(1,this.length-1):0===this.length?(this.oldPush(n.one()),o):this.oldSwap(0,this.length,[n.one()]):this.oldSwap(e,t,s)}}),t.RangeController=n.specialize({constructor:{value:function(e){this.content=null,this._selection=new l([],this),this.sortPath=null,this.filterPath=null,this.reversed=!1,this.selectAddedContent=!1,this.deselectInvisibleContent=!1,this.clearSelectionOnOrderChange=!1,this.avoidsEmptySelection=!1,this.organizedContent=[],this.organizedContent.addRangeChangeListener(this,"organizedContent"),this.defineBinding("_filteredContent",{"<-":"$filterPath.defined() ? content.filter{path($filterPath)} : content"}),this.defineBinding("_sortedContent",{"<-":"$sortPath.defined() ? _filteredContent.sorted{path($sortPath)} : _filteredContent"}),this.defineBinding("organizedContent.rangeContent()",{"<-":"$reversed ?? 0 ? _sortedContent.reversed() : _sortedContent"}),this.addRangeAtPathChangeListener("content",this,"handleContentRangeChange"),this.addPathChangeListener("sortPath",this,"handleOrderChange"),this.addPathChangeListener("reversed",this,"handleOrderChange"),this.addOwnPropertyChangeListener("allowsMultipleSelection",this),this.iterations=[],e&&this.initWithContent(e)}},initWithContent:{value:function(e){return this.content=e,this}},sortPath:{value:null},reversed:{value:null},filterPath:{value:null},selectAddedContent:{value:!1},deselectInvisibleContent:{value:!1},clearSelectionOnOrderChange:{value:!1},avoidsEmptySelection:{value:!1},allowsMultipleSelection:{value:!1},multiSelect:{set:function(e){s.deprecationWarning("multiSelect","allowsMultipleSelection"),this.allowsMultipleSelection=!!e},get:function(){return s.deprecationWarning("multiSelect","allowsMultipleSelection"),this.allowsMultipleSelection}},organizedContent:{value:null},iterations:{value:null},_selection:{value:null},selection:{get:function(){return this._selection},set:function(e){var t=[0,this._selection.length];e&&e.toArray&&(t=t.concat(e.toArray())),this._selection.splice.apply(this._selection,t)}},select:{value:function(e){!this.allowsMultipleSelection&&this.selection.length>=1&&this.selection.clear(),this.selection.add(e)}},deselect:{value:function(e){(!this.avoidsEmptySelection||this.selection.length>1)&&this.selection["delete"](e)}},clearSelection:{value:function(){(!this.avoidsEmptySelection||this.selection.length>1)&&this.selection.clear()}},add:{value:function(e){var t;return this.content||(this.content=[]),t=this.content.add(e),t&&this.handleAdd(e),t}},push:{value:function(){for(var e=this.content.push.apply(this.content,arguments),t=0;t<arguments.length;t++)this.handleAdd(arguments[t]);return e}},pop:{value:function(){return this.content.pop()}},shift:{value:function(){return this.content.shift()}},unshift:{value:function(){for(var e=this.content.unshift.apply(this.content,arguments),t=0;t<arguments.length;t++)this.handleAdd(arguments[t]);return e}},splice:{value:function(){for(var e=this.content.splice.apply(this.content,arguments),t=2;t<arguments.length;t++)this.handleAdd(arguments[t]);return e}},swap:{value:function(e,t,i){var n=this.content.swap.apply(this.content,arguments);if(i)for(var e=2;e<i.length;e++)this.handleAdd(i[e]);return n}},"delete":{value:function(e){return this.content["delete"](e)}},has:{value:function(e){return!!this.content&&this.content.has(e)}},addEach:{value:r.prototype.addEach},deleteEach:{value:r.prototype.deleteEach},clear:{value:function(){this.content.clear()}},addContent:{value:function(){var e=new this.contentConstructor;return this.add(e),e}},_contentConstructor:{value:null},contentConstructor:{get:function(){return this._contentConstructor?this._contentConstructor:this.content&&this.content.contentConstructor?this.content.contentConstructor:Object},set:function(e){this._contentConstructor=e}},handleContentRangeChange:{value:function(e,t,i){if(this.selection.length>0){var n=this.content&&this.content.contentEquals||Object.is;t.deleteEach(e,n),this.selection.length&&(this.selection.deleteEach(t),0===this.selection.length&&this.content&&this.content.length&&this.avoidsEmptySelection&&!this.allowsMultipleSelection&&this.selection.add(this.content[this.content.length-1]))}}},handleSelectionRangeChange:{value:function(e,t,i){if(this.selection)if(this.content){for(var n=[],r=0;r<e.length;r++)this.content.has(e[r])||n.push(e[r]);if(this._selection.deleteEach(n),!this.allowsMultipleSelection&&this._selection.length>1){var a=this._selection.pop();this._selection.clear(),this._selection.add(a)}this.avoidsEmptySelection&&0==this._selection.length&&this._selection.add(t[0])}else this._selection.clear()}},handleOrganizedContentRangeChange:{value:function(e,t,i){if(this.deselectInvisibleContent&&this.selection){var n=t.clone(1);n.deleteEach(e),this.selection.deleteEach(t)}}},handleOrderChange:{value:function(){this.clearSelectionOnOrderChange&&this.selection&&this.selection.clear()}},handleAdd:{value:function(e){this.selectAddedContent&&this.selection&&(!this.allowsMultipleSelection&&this.selection.length?this.selection.swap(0,this.selection.length,[e]):this.selection.add(e))}},handleAllowsMultipleSelectionChange:{value:function(){if(this.selection){var e=this.selection.length;if(!this.allowsMultipleSelection&&e>1){var t=this._selection.pop();this._selection.clear(),this._selection.add(t)}}}}},{blueprintModuleId:e("./core")._blueprintModuleIdDescriptor,blueprint:e("./core")._blueprintDescriptor})}}),montageDefine("c50fb48","runtime/dependencies/camera",{dependencies:[],factory:function(e,t,i){var n=window;!function(e,r){"object"==typeof t?(i.exports=r(n),i.exports.OrbitCamera=i.exports.OrbitCamera,i.exports.FlyingCamera=i.exports.FlyingCamera):"function"==typeof define&&define.amd?define([],function(){return r(e)}):r(e)}(this,function(e){"use strict";function t(e){return Math.abs(e)>.35?e:0}var i,n;return i=function(e){this._distance=vec3.createFrom(0,0,-32),this._center=vec3.create(),this._viewMat=mat4.create(),this._yUp=!0,this._rideMode=!1,this.orbitX=0,this.orbitY=0,this.maxOrbitX=.5*Math.PI,this.minOrbitX=.5*-Math.PI,this.maxOrbitY=Math.PI,this.minOrbitY=-Math.PI,this.constrainXOrbit=!0,this.constrainYOrbit=!1,this.maxDistance=512,this.minDistance=16,this.distanceStep=1,this.constrainDistance=!0,this.ignoreEvents=!1,this._dirty=!0,this._hookEvents(e)},i.prototype._hookEvents=function(e){var t,i,n=this,r=!1;e.addEventListener("mousedown",function(e){1===e.which&&(r=!0),t=e.pageX,i=e.pageY},!1),e.addEventListener("mousemove",function(e){if(r){var a=e.pageX-t,s=e.pageY-i;t=e.pageX,i=e.pageY,n.orbit(.013*a,.013*s)}},!1),e.addEventListener("mouseup",function(){r=!1},!1),e.addEventListener("mousewheel",function(e){n.setDistance(-n._distance[2]+e.wheelDeltaY*n.distanceStep),
e.preventDefault()},!1),e.addEventListener("touchstart",function(e){var n=e.touches;switch(n.length){case 1:r=!0,t=n[0].pageX,i=n[0].pageY;break;case 2:break;default:return}e.stopPropagation(),e.preventDefault()},!1),e.addEventListener("touchmove",function(e){var a=e.touches;if(r&&!ignoreEvents){var s=a[0].pageX-t,o=a[0].pageY-i;t=a[0].pageX,i=a[0].pageY,n.orbit(.005*s,.005*o)}e.stopPropagation(),e.preventDefault()},!1),e.addEventListener("touchend",function(e){r=!1,e.stopPropagation(),e.preventDefault()},!1),e.addEventListener("gesturestart",function(e){r=!1,n.initialDistance=n._distance[2],e.preventDefault()},!1),e.addEventListener("gesturechange",function(e){document.getElementsByTagName("header")[0].innerHTML=e.scale+" "+n.initialDistance+" "+n.initialDistance*e.scale,n.setDistance(n.initialDistance*(100*e.scale)),e.preventDefault()},!1),e.addEventListener("gestureend",function(e){e.preventDefault()},!1)},i.prototype.orbit=function(e,t){if(e||t){if(this.orbitY+=e,this.constrainYOrbit)this.orbitY=Math.min(Math.max(this.orbitY,this.minOrbitY),this.maxOrbitY);else{for(;this.orbitY<-Math.PI;)this.orbitY+=2*Math.PI;for(;this.orbitY>=Math.PI;)this.orbitY-=2*Math.PI}if(this.orbitX+=t,this.constrainXOrbit)this.orbitX=Math.min(Math.max(this.orbitX,this.minOrbitX),this.maxOrbitX);else{for(;this.orbitX<-Math.PI;)this.orbitX+=2*Math.PI;for(;this.orbitX>=Math.PI;)this.orbitX-=2*Math.PI}this._dirty=!0}},i.prototype.getCenter=function(){return[-this._center[0],-this._center[1],-this._center[2]]},i.prototype.setCenter=function(e){this._center[0]=-e[0],this._center[1]=-e[1],this._center[2]=-e[2],this._dirty=!0},i.prototype.getDistance=function(){return-this._distance[2]},i.prototype.setDistance=function(e){this._distance[2]=-e,this.constrainDistance&&(this._distance[2]=Math.min(Math.max(-this._distance[2],this.minDistance),this.maxDistance)*-1),this._dirty=!0},i.prototype.getYUp=function(){return this._yUp},i.prototype.setYUp=function(e){this._yUp=e,this._dirty=!0},i.prototype.getRideMode=function(){return this._rideMode},i.prototype.setRideMode=function(e){this._rideMode=e,this._dirty=!0},i.prototype.setCenter=function(e){this._center[0]=-e[0],this._center[1]=-e[1],this._center[2]=-e[2],this._dirty=!0},i.prototype.getViewMat=function(){if(this._dirty){var e=this._viewMat;mat4.identity(e),mat4.translate(e,this._distance),0==this._rideMode?(mat4.rotateX(e,this.orbitX),mat4.rotateY(e,this.orbitY)):(mat4.rotateY(e,this.orbitY),mat4.rotateX(e,this.orbitX)),0==this._rideMode&&mat4.rotateX(e,.5*-Math.PI),mat4.translate(e,this._center),this._yUp||mat4.rotateX(e,.5*Math.PI),this._dirty=!1}return this._viewMat},i.prototype.update=function(){var e,i;for(i=0;i<navigator.gamepads.length;++i)e=navigator.gamepads[i],e&&(e.id.indexOf("Space Navigator")!=-1?this.orbit(t(e.axes[4])*-.05,t(e.axes[3])*-.05):(this.orbit(.05*t(e.axes[0]),.05*t(e.axes[1])),this.orbit(.05*t(e.axes[2]),.05*t(e.axes[3]))))},n=function(e){this._angles=vec2.create(),this._position=vec3.create(),this.speed=100,this._pressedKeys=new Array(128),this._viewMat=mat4.create(),this._rotMat=mat4.create(),this._dirty=!0,this._hookEvents(e)},n.prototype._hookEvents=function(e){var t,i,n=this,r=!1;e.tabIndex=0,e.addEventListener("keydown",function(e){if(n._pressedKeys[e.keyCode]=!0,32==e.keyCode)return e.preventDefault(),!1},!0),e.addEventListener("keyup",function(e){n._pressedKeys[e.keyCode]=!1},!1),e.addEventListener("mousedown",function(e){1===e.which&&(r=!0),t=e.pageX,i=e.pageY},!1),e.addEventListener("mousemove",function(e){var a,s;document.pointerLockEnabled?(a=e.movementX,s=e.movementY,n.rotateView(.025*a,.025*s)):r&&(a=e.pageX-t,s=e.pageY-i,t=e.pageX,i=e.pageY,n.rotateView(.025*a,.025*s))},!1),e.addEventListener("mouseup",function(){r=!1},!1)},n.prototype.rotateView=function(e,t){var i=this._rotMat;if(e||t){for(this._angles[1]+=e,this.constrainYRotation&&(this._angles[1]=Math.min(Math.max(this._angles[1],this.minYRotation),this.maxYRotation));this._angles[1]<0;)this._angles[1]+=2*Math.PI;for(;this._angles[1]>=2*Math.PI;)this._angles[1]-=2*Math.PI;this._angles[0]+=t,this._angles[0]<.5*-Math.PI&&(this._angles[0]=.5*-Math.PI),this._angles[0]>.5*Math.PI&&(this._angles[0]=.5*Math.PI),mat4.identity(i),mat4.rotateZ(i,-this._angles[1]),mat4.rotateX(i,-this._angles[0]),this._dirty=!0}},n.prototype.getAngles=function(){return[this._angles[0],this._angles[1]]},n.prototype.setAngles=function(e){this._angles[0]=e[0],this._angles[1]=e[1],this._dirty=!0},n.prototype.getPosition=function(){return[this._position[0],this._position[1],this._position[2]]},n.prototype.setPosition=function(e){this._position[0]=e[0],this._position[1]=e[1],this._position[2]=e[2],this._dirty=!0},n.prototype.getViewMat=function(){if(this._dirty){var e=this._viewMat;mat4.identity(e),mat4.rotateY(e,this._angles[1]),mat4.rotateX(e,this._angles[0]),mat4.translate(e,[-this._position[0],-this._position[1],-this._position[2]]),this._dirty=!1}return this._viewMat},n.prototype.update=function(e){var i,n,r=vec3.create(),a=this.speed/1e3*e;for(this._pressedKeys["W".charCodeAt(0)]&&(r[1]+=a),this._pressedKeys["S".charCodeAt(0)]&&(r[1]-=a),this._pressedKeys["A".charCodeAt(0)]&&(r[0]-=a),this._pressedKeys["D".charCodeAt(0)]&&(r[0]+=a),this._pressedKeys[32]&&(r[2]+=a),this._pressedKeys[17]&&(r[2]-=a),n=0;n<navigator.gamepads.length;++n)i=navigator.gamepads[n],i&&(i.id.indexOf("Space Navigator")!=-1?(r[0]+=t(i.axes[0])*a,r[1]+=t(i.axes[1])*-a,r[2]+=t(i.axes[2])*-a,this.rotateView(.05*t(i.axes[4]),t(i.axes[3])*-.05)):(r[0]+=t(i.axes[0])*a,r[1]+=t(i.axes[1])*a,this.rotateView(.05*t(i.axes[2]),.05*t(i.axes[3]))));0===r[0]&&0===r[1]&&0===r[2]||(mat4.multiplyVec3(this._rotMat,r),vec3.add(this._position,r),this._dirty=!0)},e&&(e.OrbitCamera=i,e.FlyingCamera=n),{OrbitCamera:i,FlyingCamera:n}})}}),montageDefine("c50fb48","runtime/glsl-program",{dependencies:["runtime/dependencies/gl-matrix"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix");var n=t.GLSLProgram=Object.create(Object.prototype,{VERTEX_SHADER:{value:"x-shader/x-vertex"},FRAGMENT_SHADER:{value:"x-shader/x-fragment"},_GLTypes:{enumerable:!1,value:null,writable:!0},_shaders:{enumerable:!1,value:null,writable:!0},shaders:{enumerable:!1,get:function(){return this._shaders},set:function(e){this._shaders=e}},_errorLogs:{enumerable:!1,value:null,writable:!0},errorLogs:{enumerable:!1,get:function(){return this._errorLogs},set:function(e){this._errorLogs=e}},_pendingCommits:{value:null,writable:!0},pendingCommits:{get:function(){return this._pendingCommits},set:function(e){this._pendingCommits=e}},_symbolToLocation:{value:null,writable:!0},symbolToLocation:{enumerable:!1,get:function(){return this._symbolToLocation},set:function(e){this._symbolToLocation=e}},_symbolToActiveInfo:{enumerable:!1,value:null,writable:!0},symbolToActiveInfo:{get:function(){return this._symbolToActiveInfo},set:function(e){this._symbolToActiveInfo=e}},_semanticToSymbol:{value:null,writable:!0},semanticToSymbol:{enumerable:!1,get:function(){return this._semanticToSymbol},set:function(e){this._semanticToSymbol=e}},_symbolToSemantic:{value:null,writable:!0},symbolToSemantic:{get:function(){return this._symbolToSemantic},set:function(e){this._symbolToSemantic=e}},_symbolToValue:{value:null,writable:!0},symbolToValue:{get:function(){return this._symbolToValue},set:function(e){this._symbolToValue=e}},_uniformSymbols:{value:null,writable:!0},uniformSymbols:{enumerable:!1,get:function(){return this._uniformSymbols},set:function(e){this._uniformSymbols=e}},_attributeSymbols:{value:null,writable:!0},attributeSymbols:{enumerable:!1,get:function(){return this._attributeSymbols},set:function(e){this._attributeSymbols=e}},_GLProgram:{enumerable:!1,value:null,writable:!0},GLProgram:{enumerable:!1,get:function(){return this._GLProgram},set:function(e){this._GLProgram=e}},getTypeForSymbol:{value:function(e){var t=null,i=this.symbolToActiveInfo[e];return i&&(t=i.type),t}},getLocationForSymbol:{value:function(e){return this.symbolToLocation[e]}},getSymbolForSemantic:{value:function(e){return this.semanticToSymbol[e]}},setSymbolForSemantic:{value:function(e,t){if("none"===e&&(e=null),"none"===t&&(t=null),!this.symbolToActiveInfo[e])return!1;if(t&&this.semanticToSymbol[t])return!1;if(e){var i=this.symbolToSemantic[e];i&&i!==t&&(this.semanticToSymbol[i]=null),this.symbolToSemantic[e]=t}return t&&(this.semanticToSymbol[t]=e),!0}},setSemanticForSymbol:{value:function(e,t){this.setSymbolForSemantic(e,t)}},getSemanticForSymbol:{value:function(e){return this.symbolToSemantic[e]}},setValueForSymbol:{value:function(e,t){var i=this.symbolToValue[e],n=this.getTypeForSymbol(e),r=this._GLTypes;if(null!=t&&null!=i){if(n===r.FLOAT&&t===i)return;if(n===r.FLOAT_MAT4){if(16==t.length&&mat4.equal(i,t))return}else if(n===r.FLOAT_MAT3){if(9==t.length&&mat3.equal(i,t))return}else if(n===r.FLOAT_VEC3){if(3==t.length&&vec3.equal(i,t))return}else if(n===r.FLOAT_VEC4){if(4==t.length&&vec4.equal(i,t))return}else if(n===r.FLOAT_VEC2&&2==t.length&&vec4.equal(i,t))return}else n===r.FLOAT_MAT4?i=mat4.create():n===r.FLOAT_MAT3?i=mat3.create():n===r.FLOAT_VEC3?i=vec3.create():n===r.FLOAT_VEC4?i=vec4.create():n===r.FLOAT_VEC2&&(i=vec2.create());null!==this.symbolToActiveInfo[e]&&this.pendingCommits.indexOf(e)===-1&&this.pendingCommits.push(e),null!=t&&(n===r.FLOAT_MAT4?t=mat4.set(t,i):n===r.FLOAT_MAT3?t=mat3.set(t,i):n===r.FLOAT_VEC3?t=vec3.set(t,i):n===r.FLOAT_VEC4?t=vec4.set(t,i):n===r.FLOAT_VEC2&&(t=vec2.set(t,i))),this.symbolToValue[e]=t}},getValueForSymbol:{value:function(e){return this.symbolToValue[e]}},_commitSwitch:{value:function(){var e=[];return e[WebGLRenderingContext.prototype.FLOAT_MAT2]=function(e,t,i,n){e.uniformMatrix2fv(t,i,n)},e[WebGLRenderingContext.prototype.FLOAT_MAT3]=function(e,t,i,n){e.uniformMatrix3fv(t,i,n)},e[WebGLRenderingContext.prototype.FLOAT_MAT4]=function(e,t,i,n){e.uniformMatrix4fv(t,i,n)},e[WebGLRenderingContext.prototype.FLOAT]=function(e,t,i,n){e.uniform1f(t,n)},e[WebGLRenderingContext.prototype.FLOAT_VEC2]=function(e,t,i,n){e.uniform2fv(t,n)},e[WebGLRenderingContext.prototype.FLOAT_VEC3]=function(e,t,i,n){e.uniform3fv(t,n)},e[WebGLRenderingContext.prototype.FLOAT_VEC4]=function(e,t,i,n){e.uniform4fv(t,n)},e[WebGLRenderingContext.prototype.INT]=function(e,t,i,n){e.uniform1i(t,n)},e[WebGLRenderingContext.prototype.SAMPLER_2D]=function(e,t,i,n){e.uniform1i(t,n)},e[WebGLRenderingContext.prototype.SAMPLER_CUBE]=function(e,t,i,n){e.uniform1i(t,n)},e}()},commit:{value:function(e){if(this.pendingCommits.length){for(var t,i=this.pendingCommits.length-1;t=this.pendingCommits[i--];)this._commitSwitch[this.getTypeForSymbol(t)](e,this.symbolToLocation[t],!1,this.getValueForSymbol(t));this.pendingCommits.length=0}}},use:{value:function(e,t){e.useProgram(this.GLProgram),t&&this.commit(e)}},createShaderWithSourceAndType:{value:function(e,t,i){var n;if("x-shader/x-fragment"===i)n=e.createShader(e.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!==i)return null;n=e.createShader(e.VERTEX_SHADER)}return e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(this.errorLogs=e.getShaderInfoLog(n),null)}},build:{value:function(e){var t,i,r=this.shaders[n.VERTEX_SHADER],a=this.shaders[n.FRAGMENT_SHADER],s=!1,o=this.createShaderWithSourceAndType(e,r,n.VERTEX_SHADER);if(null==o)return!1;var l=this.createShaderWithSourceAndType(e,a,n.FRAGMENT_SHADER);if(null==l)return!1;if(this.GLProgram=e.createProgram(),e.attachShader(this.GLProgram,o),e.attachShader(this.GLProgram,l),e.linkProgram(this.GLProgram),e.getProgramParameter(this.GLProgram,e.LINK_STATUS)){this.pendingCommits=[],this.symbolToActiveInfo={},this.symbolToValue={},this.symbolToLocation={},this.uniformSymbols=[],this.attributeSymbols=[],this.symbolToSemantic={},this.semanticToSymbol={},this._GLTypes={FLOAT:e.FLOAT,FLOAT_MAT4:e.FLOAT_MAT4,FLOAT_MAT3:e.FLOAT_MAT3,FLOAT_VEC3:e.FLOAT_VEC3,FLOAT_VEC2:e.FLOAT_VEC2,FLOAT_VEC4:e.FLOAT_VEC4};var u=e.getParameter(e.CURRENT_PROGRAM);e.useProgram(this.GLProgram);var c=e.getProgramParameter(this.GLProgram,e.ACTIVE_UNIFORMS);for(t=0;t<c;t++){i=e.getActiveUniform(this.GLProgram,t);var h=i.name,d=h.indexOf("[0]");d!=-1&&(h=h.substring(0,d)),this.symbolToActiveInfo[h]=i,this.symbolToLocation[h]=e.getUniformLocation(this.GLProgram,h),this.uniformSymbols.push(h)}var m=e.getProgramParameter(this.GLProgram,e.ACTIVE_ATTRIBUTES);for(t=0;t<m;t++)i=e.getActiveAttrib(this.GLProgram,t),this.symbolToActiveInfo[i.name]=i,this.symbolToLocation[i.name]=e.getAttribLocation(this.GLProgram,i.name),this.attributeSymbols.push(i.name);s=!0,e.useProgram(u)}return this.errorLogs=e.getProgramInfoLog(this.GLProgram),s}},initWithShaders:{value:function(e){this.shaders=e}},initWithProgram:{value:function(e){this.shaders=e.shaders,this.semanticToSymbol=e.semanticToSymbol,this.symbolToSemantic=e.symbolToSemantic}}})}}),montageDefine("b0111a3","ui/flow.reel/flow-bezier-spline",{dependencies:["../../core/core"],factory:function(e,t,i){var n=e("../../core/core").Montage,r=t.FlowBezierSpline=n.specialize({constructor:{value:function(){this._knots=[],this._densities=[],this._getStyleAtIndexTimeBuffer=[]}},_parameterKeys:{value:void 0},knots:{get:function(){return this._knots},set:function(e){this._knots=e}},previousHandlers:{get:function(){return this._previousHandlers||(this._previousHandlers=[]),this._previousHandlers},set:function(e){this._previousHandlers=e}},nextHandlers:{get:function(){return this._nextHandlers||(this._nextHandlers=[]),this._nextHandlers},set:function(e){this._nextHandlers=e}},densities:{get:function(){return this._densities},set:function(e){this._densities=e,this._densitiesLength=this._densities.length,this._maxTime=null}},_parameters:{value:{}},parameters:{get:function(){return this._parameters||(this._parameters={}),this._parameters},set:function(e){this._parameters=e}},_maxTime:{enumerable:!1,value:null},computeMaxTime:{value:function(){return this._computeDensitySummation(),this._densitySummation.length?this._maxTime=this._densitySummation[this._densitySummation.length-1]:this._maxTime=0,this._maxTime}},_densitySummation:{enumerable:!1,value:null},_computeDensitySummation:{enumerable:!1,value:function(){var e,t=this.densities,i=t.length-1,n=0;for(this._densitySummation=[],e=0;e<i;e++)n+=(t[e]+t[e+1])/2,this._densitySummation[e]=n;this._maxTime=null}},_convertSplineTimeToBezierIndexTime:{enumerable:!1,value:function(e){if(e<0)return null;if(null===this._maxTime&&this.computeMaxTime(),e>=this._maxTime)return null;for(var t,i,n,r,a,s=this._densitySummation,o=s.length,l=o-1,u=o>>1;u;)l-u>=0&&s[l-u]>e?l-=u:u>>=1;return t=e-(l?s[l-1]:0),n=this._densities[l],r=this._densities[l+1],a=n-r,i=a<-1e-10||a>1e-10?(n-Math.sqrt(n*n+2*(r-n)*t))/a:t/n,[l,i]}},getPositionAtIndexTime:{value:function(e,t){var i=e[0],n=e[1],r=this._knots[i],a=this._nextHandlers[i],s=this._previousHandlers[i+1],o=this._knots[i+1],l=1-n,u=l*l*l,c=l*l*n*3,h=l*n*n*3,d=n*n*n;return t?[t.x.numerator*(r[0]*u+a[0]*c+s[0]*h+o[0]*d)/t.x.denominator,t.y.numerator*(r[1]*u+a[1]*c+s[1]*h+o[1]*d)/t.y.denominator,t.z.numerator*(r[2]*u+a[2]*c+s[2]*h+o[2]*d)/t.z.denominator]:[r[0]*u+a[0]*c+s[0]*h+o[0]*d,r[1]*u+a[1]*c+s[1]*h+o[1]*d,r[2]*u+a[2]*c+s[2]*h+o[2]*d]}},getRotationAtIndexTime:{value:function(e){var t,i,n,r=e[0],a=e[1],s=1-a,o=this._parameters;return t="undefined"!=typeof o.rotateX?o.rotateX.data[r]*s+o.rotateX.data[r+1]*a:0,i="undefined"!=typeof o.rotateY?o.rotateY.data[r]*s+o.rotateY.data[r+1]*a:0,n="undefined"!=typeof o.rotateZ?o.rotateZ.data[r]*s+o.rotateZ.data[r+1]*a:0,[t,i,n]}},_getStyleAtIndexTimeBuffer:{value:null},getStyleAtIndexTime:{value:function(e){var t,i,n,r,a,s,o,l=e[0],u=e[1],c=this._parameters,h=1-u,d=this._getStyleAtIndexTimeBuffer;if(d.length=0,r=this._parameterKeys)for(a=r.length,t=0;t<a;t++)i=r[t],s=c[i],o=s.data,"rotateX"!==i&&"rotateY"!==i&&"rotateZ"!==i&&void 0!==o[l]&&void 0!==o[l+1]&&(n=i,n+=":",n+=1e-5*(1e5*(o[l]*h+o[l+1]*u)>>0),n+=s.units,n+=";",d.push(n));return d.join("")}},transformVectorArray:{value:function(e,t){var i,n,r=e.length,a=[];for(n=0;n<r;n++)i=e[n],i&&(a[n]=[i[0]*t[0]+i[1]*t[4]+i[2]*t[8]+t[12],i[0]*t[1]+i[1]*t[5]+i[2]*t[9]+t[13],i[0]*t[2]+i[1]*t[6]+i[2]*t[10]+t[14]]);return a}},transform:{value:function(e){var t=new r;return t._densities=this._densities,t._densitySummation=this._densitySummation,t._knots=this.transformVectorArray(this.knots,e),t._previousHandlers=this.transformVectorArray(this.previousHandlers,e),t._nextHandlers=this.transformVectorArray(this.nextHandlers,e),t}},deCasteljau:{value:function(e,t,i,n,r){var a=1-r,s=a*e[0]+r*t[0],o=a*t[0]+r*i[0],l=a*i[0]+r*n[0],u=a*s+r*o,c=a*o+r*l,h=a*u+r*c,d=a*e[1]+r*t[1],m=a*t[1]+r*i[1],p=a*i[1]+r*n[1],g=a*d+r*m,f=a*m+r*p,v=a*g+r*f,_=a*e[2]+r*t[2],b=a*t[2]+r*i[2],w=a*i[2]+r*n[2],y=a*_+r*b,E=a*b+r*w,C=a*y+r*E;return[[e,[s,d,_],[u,g,y],[h,v,C]],[[h,v,C],[c,f,E],[l,p,w],n]]}},cubic:{enumerable:!1,value:function(e,t,i,n,r){return((e*r+t)*r+i)*r+n}},cubeRoot:{enumerable:!1,value:function(e){return e>0?Math.pow(e,1/3):-Math.pow(-e,1/3)}},cubicRealRoots:{enumerable:!1,value:function(e,t,i,n){var r=1e-10,a=Math;if(e<-r||e>r){var s=1/e,o=t*s,l=i*s,u=(3*l-o*o)*(1/9),c=(4.5*o*l-13.5*n*s-o*o*o)*(1/27),h=u*u*u+c*c;if(h>r){var d=a.sqrt(h);return[this.cubeRoot(c+d)+this.cubeRoot(c-d)+o*(-1/3)]}if(h>-r){if(c<-r||c>r){var m=this.cubeRoot(c),p=2*m+o*(-1/3),g=o*(-1/3)-m;return p<g?[p,g]:[g,p]}return[o*(-1/3)]}var f=a.acos(c/a.sqrt(-u*u*u))*(1/3),v=a.sqrt(-u),_=v*a.sin(f)*1.7320508075688772,b=o*(-1/3);return v*=a.cos(f),[b-v-_,b-v+_,b+2*v]}if(t<-r||t>r){var w=i*i-4*t*n;return w>=0?(w=a.sqrt(w),[(-i-w)/(2*t),(w-i)/(2*t)]):[]}return i<-r||i>r?[-n/i]:[]}},_halfPI:{enumerable:!1,value:.5*Math.PI},reflectionMatrix:{enumerable:!1,value:function(e,t,i){var n=Math,r=this._halfPI-n.atan2(t,e),a=n.sin(r),s=n.cos(r),o=this._halfPI-n.atan2(i,e*a+t*s),l=n.sin(o);return[l*a,s*l,n.cos(o)]}},reflectedY:{enumerable:!1,value:function(e,t,i,n){return e*n[0]+t*n[1]+i*n[2]}},getScaledKnots:{value:function(e){var t,i=[];for(t=0;t<this._knots.length;t++)this._knots[t]&&(i[t]=[e.x.numerator*this._knots[t][0]/e.x.denominator,e.y.numerator*this._knots[t][1]/e.y.denominator,e.z.numerator*this._knots[t][2]/e.z.denominator]);return i}},getScaledPreviousHandlers:{value:function(e){var t,i=[];for(t=0;t<this._previousHandlers.length;t++)this._previousHandlers[t]&&(i[t]=[e.x.numerator*this._previousHandlers[t][0]/e.x.denominator,e.y.numerator*this._previousHandlers[t][1]/e.y.denominator,e.z.numerator*this._previousHandlers[t][2]/e.z.denominator]);return i}},getScaledNextHandlers:{value:function(e){var t,i=[];for(t=0;t<this._nextHandlers.length;t++)this._nextHandlers[t]&&(i[t]=[e.x.numerator*this._nextHandlers[t][0]/e.x.denominator,e.y.numerator*this._nextHandlers[t][1]/e.y.denominator,e.z.numerator*this._nextHandlers[t][2]/e.z.denominator]);return i}},directedPlaneBezierIntersection:{enumerable:!1,value:function(e,t,i,n,r,a,s,o){for(var l,u,c=this.reflectionMatrix(n[0],n[1],n[2]),h=this.reflectedY(r[0]-e,r[1]-t,r[2]-i,c),d=this.reflectedY(a[0]-e,a[1]-t,a[2]-i,c),m=this.reflectedY(s[0]-e,s[1]-t,s[2]-i,c),p=this.reflectedY(o[0]-e,o[1]-t,o[2]-i,c),g=3*(d-m)+p-h,f=3*(h+m)-6*d,v=3*(d-h),_=this.cubicRealRoots(g,f,v,h),b=0,w=0,y=[];w<_.length&&_[w]<=0;)w++;for(;w<_.length&&_[w]<1;)l=b,b=_[w],u=.5*(l+b),this.cubic(g,f,v,h,u)>=0&&y.push([l,b]),w++;return u=.5*(b+1),this.cubic(g,f,v,h,u)>=0&&y.push([b,1]),y}}})}}),montageDefine("22a41ee","ui/navigation.reel/navigation.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Navigation{position:absolute;top:0;right:0;bottom:0;width:90px;z-index:10;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;background-color:#f2f2f2;-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0);-webkit-transition:-webkit-transform .2s;transition:transform .2s;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.Navigation.Navigation--show{box-shadow:inset 0 0 1px 1px hsla(0,0%,100%,.75),0 0 3px 0 hsla(0,0%,0%,.25);-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.Navigation-list{max-height:720px;list-style:none}.Navigation-list,.Navigation-listItem{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-flex-direction:column;flex-direction:column;padding:0;margin:0}.Navigation-button.digit-Button{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:block;position:relative;width:100%;height:100%;margin:0;padding:0 10px;border:none;border-radius:0;font-family:inherit;font-size:12px;text-align:center;color:#b2b2b2;text-shadow:0 1px 0 #fff;background-color:inherit}.Navigation-button.digit-Button.montage--active{background-color:hsla(0,0%,0%,.1);text-shadow:none}.Navigation-button--selected.Navigation-button{color:#000}.Navigation-toggle.digit-Checkbox{display:block;position:absolute;-moz-box-sizing:border-box;box-sizing:border-box;z-index:11;margin:0;top:30px;left:-40px;width:40px;height:34px;border-radius:17px 0 0 17px;border:none;box-shadow:inset 0 0 1px 1px hsla(0,0%,100%,.75),0 0 3px 0 hsla(0,0%,0%,.25);background-color:#f2f2f2;-webkit-transform:translateZ(0)}.Navigation-toggle.digit-Checkbox.montage-Checkbox--checked{background-image:none}.Navigation-toggle.montage--active:after,.Navigation-toggle.montage--active.montage-Checkbox--checked:after{opacity:.6}.Navigation-toggle:after{content:"";pointer-events:none;position:absolute;-moz-box-sizing:border-box;box-sizing:border-box;width:40px;height:34px;top:0;left:0;border-radius:inherit;background:url(assets/images/toggle-icons.png) no-repeat;background-size:50px auto;background-position:-8px -8px}.Navigation--show .Navigation-toggle:after{background-position:-8px -58px}.Navigation-toggle:before{content:"";pointer-events:none;position:absolute;-moz-box-sizing:border-box;box-sizing:border-box;width:10px;height:34px;top:0;right:-5px;background-color:inherit}@media (min-width:1200px) and (orientation:landscape){.Navigation{position:relative;top:auto;right:auto;bottom:auto;height:100%;-webkit-transition:none;transition:none;-webkit-transform:none;transform:none}.Navigation-toggle.digit-Checkbox{display:none}}@media (min-height:720px){.Navigation-button.digit-Button{padding:32px 4px 0}.Navigation-button:before{content:"";pointer-events:none;position:absolute;top:14px;left:25px;width:40px;height:40px;background:url(assets/images/nav-icons.png) no-repeat;background-size:80px auto;background-position:0 40px}.NavItem--introduction .Navigation-button:before{background-position:0 0}.NavItem--thermostat .Navigation-button:before{background-position:0 -40px}.NavItem--solarPanels .Navigation-button:before{background-position:0 -80px}.NavItem--counters .Navigation-button:before{background-position:0 -120px}.NavItem--kitchen .Navigation-button:before{background-position:0 -160px}.NavItem--laundry .Navigation-button:before{background-position:0 -200px}.NavItem--window .Navigation-button:before{background-position:0 -240px}.NavItem--staircase .Navigation-button:before{background-position:0 -280px}.NavItem--callBack .Navigation-button:before{background-position:0 -320px}.NavItem--introduction .Navigation-button--selected:before{background-position:-40px 0}.NavItem--thermostat .Navigation-button--selected:before{background-position:-40px -40px}.NavItem--solarPanels .Navigation-button--selected:before{background-position:-40px -80px}.NavItem--counters .Navigation-button--selected:before{background-position:-40px -120px}.NavItem--kitchen .Navigation-button--selected:before{background-position:-40px -160px}.NavItem--laundry .Navigation-button--selected:before{background-position:-40px -200px}.NavItem--window .Navigation-button--selected:before{background-position:-40px -240px}.NavItem--staircase .Navigation-button--selected:before{background-position:-40px -280px}.NavItem--callBack .Navigation-button--selected:before{background-position:-40px -320px}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/navigation.reel","properties":{"element":{"#":"Navigation"}},"bindings":{"classList.has(\'Navigation--show\')":{"<-":"isShown"}}},"navItem":{"prototype":"ui/navigation.reel/nav-item.reel","properties":{"element":{"#":"navItem1"}},"bindings":{"panelKey":{"<-":"@panelList:iteration.object.panelKey"}}},"navToggle":{"prototype":"digit/ui/checkbox.reel","properties":{"element":{"#":"navToggle"}},"bindings":{"checked":{"<->":"@owner.isShown"}}},"panelList":{"prototype":"montage/ui/repetition.reel","properties":{"element":{"#":"repetition"}},"bindings":{"content":{"<-":"@owner.panelDescriptors"}}},"panelName":{"prototype":"digit/ui/button.reel","properties":{"element":{"#":"panelName"}},"bindings":{"classList.has(\'Navigation-button--selected\')":{"<-":"@panelList:iteration.index == @owner.currentPanelIndex"},"detail.get(\'index\')":{"<-":"@panelList:iteration.index"},"detail.get(\'panelKey\')":{"<-":"@panelList:iteration.object.panelKey"},"label":{"<-":"@panelList:iteration.object.label"}},"listeners":[{"type":"action","useCapture":false,"listener":{"@":"owner"}}]}}</script></head><body><div data-montage-id=Navigation class=Navigation><ul data-montage-id=repetition class=Navigation-list><li class=Navigation-listItem data-montage-id=navItem1><button data-montage-id=panelName class=Navigation-button></button></li></ul><button data-montage-id=navToggle class=Navigation-toggle></button></div></body></html>'}),montageDefine("d73ac5e","url",{dependencies:["punycode","querystring"],factory:function(e,t,i){!function(){"use strict";function i(e,t,i){if(e&&"object"==typeof e&&e.href)return e;if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r={},a=e;a=a.trim();var u=l.exec(a);if(u){u=u[0];var c=u.toLowerCase();r.protocol=c,a=a.substr(u.length)}if(i||u||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var h="//"===a.substr(0,2);!h||u&&b[u]||(a=a.substr(2),r.slashes=!0)}if(!b[u]&&(h||u&&!w[u])){var E=a.indexOf("@");if(E!==-1){for(var C=a.slice(0,E),x=!0,T=0,S=p.length;T<S;T++)if(C.indexOf(p[T])!==-1){x=!1;break}x&&(r.auth=decodeURIComponent(C),a=a.substr(E+1))}for(var P=-1,T=0,S=m.length;T<S;T++){var A=a.indexOf(m[T]);A!==-1&&(P<0||A<P)&&(P=A)}P!==-1?(r.host=a.substr(0,P),a=a.substr(P)):(r.host=a,a="");for(var R=s(r.host),D=Object.keys(R),T=0,S=D.length;T<S;T++){var L=D[T];r[L]=R[L]}r.hostname=r.hostname||"";var O="["===r.hostname[0]&&"]"===r.hostname[r.hostname.length-1];if(r.hostname.length>g)r.hostname="";else if(!O)for(var I=r.hostname.split(/\./),T=0,S=I.length;T<S;T++){var M=I[T];if(M&&!M.match(f)){for(var k="",F=0,N=M.length;F<N;F++)k+=M.charCodeAt(F)>127?"x":M[F];if(!k.match(f)){var B=I.slice(0,T),j=I.slice(T+1),z=M.match(v);z&&(B.push(z[1]),j.unshift(z[2])),j.length&&(a="/"+j.join(".")+a),r.hostname=B.join(".");break}}}if(r.hostname=r.hostname.toLowerCase(),!O){for(var V=r.hostname.split("."),G=[],T=0;T<V.length;++T){var U=V[T];G.push(U.match(/[^A-Za-z0-9_-]/)?"xn--"+o.encode(U):U)}r.hostname=G.join(".")}r.host=(r.hostname||"")+(r.port?":"+r.port:""),r.href+=r.host,O&&(r.hostname=r.hostname.substr(1,r.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!_[c])for(var T=0,S=d.length;T<S;T++){var q=d[T],X=encodeURIComponent(q);X===q&&(X=escape(q)),a=a.split(q).join(X)}var W=a.indexOf("#");W!==-1&&(r.hash=a.substr(W),a=a.slice(0,W));var Y=a.indexOf("?");return Y!==-1?(r.search=a.substr(Y),r.query=a.substr(Y+1),t&&(r.query=y.parse(r.query)),a=a.slice(0,Y)):t&&(r.search="",r.query={}),a&&(r.pathname=a),w[u]&&r.hostname&&!r.pathname&&(r.pathname="/"),(r.pathname||r.search)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=n(r),r}function n(e){"string"==typeof e&&(e=i(e));var t=e.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var n=e.protocol||"",r=e.pathname||"",a=e.hash||"",s=!1,o="";void 0!==e.host?s=t+e.host:void 0!==e.hostname&&(s=t+(e.hostname.indexOf(":")===-1?e.hostname:"["+e.hostname+"]"),e.port&&(s+=":"+e.port)),e.query&&"object"==typeof e.query&&Object.keys(e.query).length&&(o=y.stringify(e.query));var l=e.search||o&&"?"+o||"";return n&&":"!==n.substr(-1)&&(n+=":"),e.slashes||(!n||w[n])&&s!==!1?(s="//"+(s||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):s||(s=""),a&&"#"!==a.charAt(0)&&(a="#"+a),l&&"?"!==l.charAt(0)&&(l="?"+l),n+s+r+l+a}function r(e,t){return n(a(e,t))}function a(e,t){if(!e)return t;if(e=i(n(e),!1,!0),t=i(n(t),!1,!0),e.hash=t.hash,""===t.href)return e.href=n(e),e;if(t.slashes&&!t.protocol)return t.protocol=e.protocol,w[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=n(t),t;if(t.protocol&&t.protocol!==e.protocol){if(!w[t.protocol])return t.href=n(t),t;if(e.protocol=t.protocol,!t.host&&!b[t.protocol]){for(var r=(t.pathname||"").split("/");r.length&&!(t.host=r.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==r[0]&&r.unshift(""),r.length<2&&r.unshift(""),t.pathname=r.join("/")}return e.pathname=t.pathname,e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,void 0===e.pathname&&void 0===e.search||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.slashes=e.slashes||t.slashes,e.href=n(e),e}var a=e.pathname&&"/"===e.pathname.charAt(0),s=void 0!==t.host||t.pathname&&"/"===t.pathname.charAt(0),o=s||a||e.host&&t.pathname,l=o,u=e.pathname&&e.pathname.split("/")||[],r=t.pathname&&t.pathname.split("/")||[],c=e.protocol&&!w[e.protocol];if(c&&(delete e.hostname,delete e.port,e.host&&(""===u[0]?u[0]=e.host:u.unshift(e.host)),delete e.host,t.protocol&&(delete t.hostname,delete t.port,t.host&&(""===r[0]?r[0]=t.host:r.unshift(t.host)),delete t.host),o=o&&(""===r[0]||""===u[0])),s)e.host=t.host||""===t.host?t.host:e.host,e.hostname=t.hostname||""===t.hostname?t.hostname:e.hostname,e.search=t.search,e.query=t.query,u=r;else if(r.length)u||(u=[]),u.pop(),u=u.concat(r),e.search=t.search,e.query=t.query;else if("search"in t){if(c){e.hostname=e.host=u.shift();var h=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@");h&&(e.auth=h.shift(),e.host=e.hostname=h.shift())}return e.search=t.search,e.query=t.query,void 0===e.pathname&&void 0===e.search||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=n(e),e}if(!u.length)return delete e.pathname,e.search?delete e.path:e.path="/"+e.search,e.href=n(e),e;for(var d=u.slice(-1)[0],m=(e.host||t.host)&&("."===d||".."===d)||""===d,p=0,g=u.length;g>=0;g--)d=u[g],"."==d?u.splice(g,1):".."===d?(u.splice(g,1),p++):p&&(u.splice(g,1),p--);if(!o&&!l)for(;p--;p)u.unshift("..");!o||""===u[0]||u[0]&&"/"===u[0].charAt(0)||u.unshift(""),m&&"/"!==u.join("/").substr(-1)&&u.push("");var f=""===u[0]||u[0]&&"/"===u[0].charAt(0);if(c){e.hostname=e.host=f?"":u.length?u.shift():"";var h=!!(e.host&&e.host.indexOf("@")>0)&&e.host.split("@");h&&(e.auth=h.shift(),e.host=e.hostname=h.shift())}return o=o||e.host&&u.length,o&&!f&&u.unshift(""),e.pathname=u.join("/"),void 0===e.pathname&&void 0===e.search||(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes,e.href=n(e),e}function s(e){var t={},i=u.exec(e);return i&&(i=i[0],":"!==i&&(t.port=i.substr(1)),e=e.substr(0,e.length-i.length)),e&&(t.hostname=e),t}var o=e("punycode");t.parse=i,t.resolve=r,t.resolveObject=a,t.format=n;var l=/^([a-z0-9.+-]+:)/i,u=/:[0-9]*$/,c=["<",">",'"',"`"," ","\r","\n","\t"],h=["{","}","|","\\","^","~","`"].concat(c),d=["'"].concat(c),m=["%","/","?",";","#"].concat(h).concat(d),p=["/","@","?","#"].concat(c),g=255,f=/^[a-zA-Z0-9][a-z0-9A-Z_-]{0,62}$/,v=/^([a-zA-Z0-9][a-z0-9A-Z_-]{0,62})(.*)$/,_={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},w={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=e("querystring")}()}}),montageDefine("22a41ee","ui/panel-flow.reel/panel-flow.html",{text:'<!DOCTYPE html><html><head><title></title><style>.PanelFlow-flow,.PanelFlow-flow .montage-Flow-Repetition>div{position:absolute;top:0;left:0;right:0;bottom:0}.PanelFlow-flow .montage-Flow-Repetition>div{width:auto;height:auto}@-webkit-keyframes nextPage{0%{opacity:0;-webkit-transform:translate3d(-50%,40px,0) rotate3d(0,0,1,180deg)}20%,40%,80%{opacity:.1}40%,80%,100%{-webkit-transform:translate3d(-50%,0,0) rotate3d(0,0,1,180deg)}100%{opacity:0}}@keyframes nextPage{0%{opacity:0;transform:translate3d(-50%,40px,0) rotate3d(0,0,1,180deg)}20%,40%,80%{opacity:.1}40%,80%,100%{transform:translate3d(-50%,0,0) rotate3d(0,0,1,180deg)}100%{opacity:0}}.PanelFlow .PanelFlow-nextPage{position:absolute;bottom:30px;left:50%;background-image:url(ui/panel-flow.reel/downarrow.png);width:70px;height:18px;background-size:70px 17.1px;background-repeat:no-repeat;-webkit-animation:nextPage 4s infinite;animation:nextPage 4s infinite;opacity:0;pointer-events:none}.PanelFlow .PanelFlow-nextPage.hidden{display:none}.Card{position:absolute;top:0;bottom:0;right:0;left:0;-moz-box-sizing:border-box;box-sizing:border-box;padding:0 30px;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;font-size:18px;line-height:22px;color:gray;background-color:#fff;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.Card-hero{display:block;margin:0 auto 22px;max-width:100%;max-height:300px;-webkit-user-drag:none;-ms-user-drag:none;user-drag:none}.Card-title{margin:0 0 8px;font-size:36px;line-height:34px;font-weight:700;color:#000;letter-spacing:-2px}.Card-title--sub{display:block;font-size:24px;font-weight:400;letter-spacing:-1px}.Card-description{margin:0}.Card-strong{display:block}.Card-content{position:relative;-moz-box-sizing:border-box;box-sizing:border-box;-webkit-margin-collapse:separate}.Card--hasOptions{margin-top:18px;border-top:1px solid hsl(0,0%,90%)}.Card-optionThumbnail{display:inline-block;border:2px solid #fff;box-shadow:0 2px 2px hsla(0,0%,0%,.2);width:60px;height:40px;margin-right:10px}.Card-option--booleanField,.Card-option--choiceField{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex:1 0 50%;flex:1 0 50%;padding:6px 0}.Card-option--rangeField{display:block;margin-top:20px;-webkit-flex:1 0 50%;flex:1 0 50%;padding:6px 0}.Card-option-labelArea{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;padding-left:10px;cursor:pointer;-webkit-tap-highlight-color:transparent}.Card-option-label{-webkit-box-flex:1;-webkit-flex:1;flex:1;display:block;font-weight:400;line-height:24px;margin-right:10px}.Card-option-price{display:block;font-size:16px;line-height:24px;color:hsl(0,0%,15%);white-space:nowrap}.Card--disclaimer{font-size:9px;line-height:14px;color:#b2b2b2}.Card.Card--hasSwatches .Card-option--choiceField{padding:4px 10px}.Card-featured{position:absolute;left:0;right:0;bottom:90px;text-align:center}.Card-featured-caption{font-size:9px;line-height:18px;color:#b2b2b2}.Card-featured-img{height:22px;vertical-align:bottom}@media (orientation:landscape) and (max-height:600px){.Card .Card-hero{position:absolute;margin:0}}@media (orientation:landscape) and (max-height:400px){.Card{padding:0 20px;font-size:14px;line-height:18px}.Card-hero{display:none}.Card-title{margin-bottom:.2em;font-size:1.6em}.Card-description{padding-right:60px}}@media (orientation:portrait) and (min-width:560px){.Card{-webkit-box-orient:horizontal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.Card .Card-hero{margin:0 0 1em;max-height:120px;height:auto}.Card-content{width:50%}.Card-content:nth-child(1){padding-right:15px}.Card-content:nth-child(2){padding-left:15px}.Card--hasOptions{margin-top:0;border-top:none;border-left:1px solid hsl(0,0%,90%)}}@media (orientation:portrait) and (max-width:561px){.Card{padding:0 20px;font-size:14px;line-height:18px}.Card-title{margin-bottom:.2em;font-size:1.6em}.Card-hero{display:none}.Card-option--booleanField,.Card-option--choiceField{padding:4px 0}}</style><script type=text/montage-serialization>{":iteration":{"alias":"@flow:iteration"},"owner":{"properties":{"element":{"#":"panel-flow"},"flow":{"@":"flow"},"nextPageElement":{"#":"nextPageIndicator"}},"bindings":{"scroll":{"<->":"@flow.scroll"},"_numberOfIterations":{"<->":"@flow._numberOfIterations"},"_firstIteration":{"<-":"@flow._repetition._drawnIterations.0"}}},"flow":{"prototype":"montage/ui/flow.reel","properties":{"element":{"#":"flow"},"stride":1,"linearScrollingVector":[0,-200],"isLimitedToSingleStride":true,"isListeningToResize":false,"delegate":{"@":"owner"},"paths":[{"knots":[{"knotPosition":[0,-9000,-100],"nextHandlerPosition":[0,-6000,-100],"nextDensity":40,"previousDensity":40,"opacity":0},{"knotPosition":[0,0,-40],"previousHandlerPosition":[0,-3000,-40],"nextHandlerPosition":[0,100,-40],"nextDensity":1,"previousDensity":1,"opacity":0},{"knotPosition":[0,300,0],"previousHandlerPosition":[0,200,0],"nextHandlerPosition":[0,400,0],"nextDensity":1,"previousDensity":1,"opacity":5},{"knotPosition":[0,600,-40],"previousHandlerPosition":[0,500,-40],"nextHandlerPosition":[0,3600,-100],"nextDensity":1,"previousDensity":1,"opacity":0},{"knotPosition":[0,9600,-100],"previousHandlerPosition":[0,6600,-100],"nextDensity":40,"previousDensity":40,"opacity":0}],"units":{"opacity":""},"headOffset":21.5,"tailOffset":21.5}]}}}</script></head><body><div data-montage-id=panel-flow class=PanelFlow><div data-montage-id=flow class=PanelFlow-flow><div data-param=*></div></div><div data-montage-id=nextPageIndicator class=PanelFlow-nextPage></div></div></body></html>'
}),montageDefine("b0111a3","core/state-chart",{dependencies:["./core"],factory:function(e,t,i){var n=e("./core").Montage,r=t.State=n.specialize({_stateChart:{enumerable:!1,value:null},init:{value:function(e){this.substates={},this.enterState=null,this.exitState=null;for(var t,i,n=Object.keys(e),a=0;t=n[a];a++)i=e[t],"object"==typeof i&&r.prototype.isPrototypeOf(i)&&(i.name=t,i.parentState=this,this.substates[t]=i),"string"==typeof i&&"initialSubstate"!==t?this[t]=this._encloseGotoState(i):this[t]=i;return this}},name:{enumerable:!1,value:null},_initialSubstate:{enumerable:!1,value:null},initialSubstate:{get:function(){return"string"==typeof this._initialSubstate&&(this._initialSubstate=this[this._initialSubstate]),this._initialSubstate},set:function(e){this._initialSubstate=e}},substates:{enumerable:!1,value:null},parentState:{enumerable:!1,value:null},_path:{enumerable:!1,value:null},path:{enumerable:!1,get:function(){return this._path||(this.parentState&&this.parentState.path?this._path=this.parentState.path+"."+this.name:this._path=this.name),this._path}},enterState:{enumerable:!1,value:null},exitState:{enumerable:!1,value:null},isInState:{enumerable:!1,value:function(e){return"string"!=typeof e&&(e=e.name),!!this.path.match(new RegExp(".?"+e+".?"))}},_encloseGotoState:{value:function(e){return function(t,i){return this._stateChart._gotoState(e,i)}}},gotoState:{value:function(e,t){return this._stateChart._gotoState(e,t)}},_performAction:{enumerable:null,value:function(e,t,i){if(this[e])this[e](t,i);else{if(!this.parentState)throw"Action '"+e+"' not available";this.parentState._performAction(e,t,i)}}},toString:{enumerable:!1,value:function(){return"[State "+this.path+" ]"}}});t.StateChart=n.specialize({delegate:{enumerable:!1,value:null},ownerStateProperty:{enumerable:!1,value:null},rootState:{enumerable:!1,value:null},_currentState:{enumerable:!1,value:null},currentState:{get:function(){return this.ownerStateProperty?null:this._currentState}},initWithState:{value:function(e){return this._states={},this.rootState=e,this.rootState._stateChart=this,this._prepareState(this.rootState),this.enterDefaultState(),this}},_defaultState:{enumerable:!1,value:null},defaultState:{enumerable:!1,get:function(){if(!this._defaultState){var e,t;for(e=t=this.rootState;t=t.initialSubstate;)e=t;this._defaultState=e}return this._defaultState}},enterDefaultState:{enumerable:!1,value:function(){if(this.ownerStateProperty&&!this.owner)throw"This stateChart has been configured to require an owner to execute this function";var e=this.ownerStateProperty?this.owner:this,t=this.ownerStateProperty?e["_"+this.ownerStateProperty]:e.currentState;if(t)throw"Cannot enter default state from '"+t.name+"'";var i,n;for(i=n=this.rootState;n=n.initialSubstate;)i.enterState&&i.enterState(this,e),i=n,n.initialSubstate&&i.exitState&&i.exitState(this,e);return this.ownerStateProperty?e["_"+this.ownerStateProperty]=this.defaultState:this._currentState=this.defaultState,this.defaultState}},_prepareState:{enumerable:!1,value:function(e){e._stateChart=this,e.name&&(this._states[e.name]=e);var t;for(t in e.substates)this._prepareState(e.substates[t])}},_states:{enumerable:!1,value:null},stateWithName:{enumerable:!1,value:function(e){return this._states[e]}},performAction:{value:function(e,t){if(this.ownerStateProperty&&!t)throw"This stateChart has been configured to require an owner to execute this function";t=this.ownerStateProperty?t:this;var i=this.ownerStateProperty?t[this.ownerStateProperty]:t.currentState;if(!i)throw"Cannot perform action '"+e+"' without a currentState";i._performAction(e,this,t),this.owner=null}},_gotoState:{value:function(e,t){if(this.ownerStateProperty&&!t)throw"This stateChart has been configured to require an owner to execute this function";t=this.ownerStateProperty?t:this;var i,n,r,a,s,o,l,u,c,h,d,m=this.ownerStateProperty?t[this.ownerStateProperty]:t.currentState,p=m.name,g=e,f=!1,v=!1,_=!1,b=!1;if("string"==typeof g?e=this._states[e]:g=e.name,g!==p&&(this.delegate&&(f="function"==typeof this.delegate.stateChartWillExitState,v="function"==typeof this.delegate.stateChartWillEnterState,_="function"==typeof this.delegate.stateChartDidExitState,b="function"==typeof this.delegate.stateChartDidEnterState),!this.delegate||"function"!=typeof this.delegate.stateChartShouldGoFromStateToState||this.delegate.stateChartShouldGoFromStateToState(this,m,e))){if(this.delegate&&"function"==typeof this.delegate.stateChartWillGoFromStateToState&&this.delegate.stateChartWillGoFromStateToState(this,m,e),i=m.path,n=e.path,new RegExp(i).test(n))for(a=n.replace(new RegExp(i+".?"),"").split("."),s=a.length,r=0;r<s;r++)h=this._states[a[r]],v&&this.delegate.stateChartWillEnterState(this,h),"function"==typeof h.enterState&&h.enterState(this,t),b&&this.delegate.stateChartDidEnterState(this,h);else{for(i=i.split("."),n=n.split("."),o=-1,u=n.length,c=Math.min(i.length,u);o<c&&(l=o+1,i[l]===n[l]);)o++;for(r=i.length-1;r>o;r--)h=this._states[i[r]],f&&this.delegate.stateChartWillExitState(this,h),"function"==typeof h.exitState&&h.exitState(this,t),_&&this.delegate.stateChartDidExitState(this,h);for(o=o<0?0:o,r=o;r<u;r++)h=this._states[n[r]],v&&this.delegate.stateChartWillEnterState(this,h),this.ownerStateProperty?t["_"+this.ownerStateProperty]=h:this._currentState=h,"function"==typeof h.enterState&&h.enterState(this,t),b&&this.delegate.stateChartDidEnterState(this,h)}d=m,this.delegate&&"function"==typeof this.delegate.stateChartDidGoFromStateToState&&this.delegate.stateChartDidGoFromStateToState(this,d,e),"function"==typeof t.transitionedFromStateToState&&t.transitionedFromStateToState(this,d,e)}}}})}}),montageDefine("b0111a3","core/application",{dependencies:["./target","../window-loader/montage-window","./dom","./template"],factory:function(e,t,i){var n,r=e("./target").Target,a=e("../window-loader/montage-window").MontageWindow;e("./dom");var s="-is-first-load";t.Application=r.specialize({eventManager:{value:null},parentApplication:{value:null},name:{value:null},_isFirstLoad:{value:null},isFirstLoad:{get:function(){return this._isFirstLoad}},mainApplication:{get:function(){for(var e=this;e.parentApplication;)e=e.parentApplication;return e}},_windowsSortOrder:{value:"reverse-z-order"},windowsSortOrder:{get:function(){return null==this.parentApplication?this._windowsSortOrder:this.mainApplication.windowsSortOrder},set:function(e){null==this.parentApplication?["z-order","reverse-z-order","z-order","reverse-open-order"].indexOf(e)!==-1&&(this._windowsSortOrder=e):this.mainApplication.windowsSortOrder=e}},windows:{get:function(){if(null==this.parentApplication){if(!this._windows){var e=new a;e.application=this,e.window=window,this.window=e,this._windows=[this.window],this._multipleWindow=!0}return this._windows}return this.mainApplication.windows}},_window:{value:null},window:{get:function(){if(!this._window&&this==this.mainApplication){var e=new a;e.application=this,e.window=window,this._window=e}return this._window},set:function(e){this._window||(this._window=e)}},attachedWindows:{value:[]},eventManagerForWindow:{value:function(e){return e.defaultEventMananger}},focusWindow:{get:function(){var e=this.windows,t=this.windowsSortOrder;if("z-order"==t)return e[0];if("reverse-z-order"==t)return e[e.length-1];for(var i in e)if(e[i].focused)return e[i]}},delegate:{value:null},nextTarget:{get:function(){return this.delegate}},openWindow:{value:function(e,t,i){var n,r,s=this,o=new a,l={location:!1,menubar:!1,resizable:!0,scrollbars:!0,status:!1,titlebar:!0,toolbar:!1},u={module:e,name:t,parent:window,callback:function(e,t){var i;n=e.document.application,o.window=e,o.application=n,o.component=t,n.window=o,s.attachedWindows.push(o),i=s.mainApplication.windowsSortOrder,"z-order"==i||"reverse-open-order"==i?s.windows.unshift(o):s.windows.push(o),r=document.createEvent("CustomEvent"),r.initCustomEvent("load",!0,!0,null),o.dispatchEvent(r)}};if(this!==this.mainApplication||this._multipleWindow||this.window,"object"==typeof i){var c,h,d="",m="";for(c in i)i.hasOwnProperty(c)&&(l[c]=i[c])}var p=["name"];for(c in l)p.indexOf(c)==-1&&(h=l[c],"boolean"==typeof h?h=h?"yes":"no":(h=String(h),h.match(/[ ,"]/)&&(h='"'+h.replace(/"/g,'\\"')+'"')),m+=d+c+"="+h,d=",");return global.require.loadPackage({name:"montage"}).then(function(e){var t=window.open(e.location+"window-loader/index.html","_blank",m);t.loadInfo=u}),o}},attachWindow:{value:function(e){var t,i=e.application.parentApplication;return i!==this&&(i&&i.detachWindow(e),e.parentApplication=this,this.attachedWindows.push(e),t=this.mainApplication.windowsSortOrder,"z-order"==t||"reverse-open-order"==t?this.windows.unshift(e):this.windows.push(e),e.focus()),e}},detachWindow:{value:function(e){var t,i,n=this.windows;return void 0===e&&(e=this.window),i=e.application.parentApplication,i==this?(t=this.attachedWindows.indexOf(e),t!==-1&&this.attachedWindows.splice(t,1),t=n.indexOf(e),t!==-1&&n.splice(t,1),e.application.parentApplication=null):i&&i.detachWindow(e),e}},constructor:{value:function(){window.loadInfo&&!this.parentApplication&&(this.parentApplication=window.loadInfo.parent.document.application)}},_load:{value:function(i,n){var r,a=this;return this.name=i.packageDescription.name,this._loadApplicationContext(),t.application=a,e.async("ui/component").then(function(t){return r=t.__root__,r.element=document,e("./template").instantiateDocument(window.document,i).then(function(e){return a.callDelegateMethod("willFinishLoading",a),r.needsDraw=!0,n&&n(a),a})})}},_loadApplicationContext:{value:function(){if(null===this._isFirstLoad){var e=this.name+s,t=localStorage.getItem(e);if(null===t)try{localStorage.setItem(e,!0)}catch(i){console.log("In private mode you are")}this._isFirstLoad=!t}}},_alertPopup:{value:null,enumerable:!1},_confirmPopup:{value:null,enumerable:!1},_notifyPopup:{value:null,enumerable:!1},_zIndex:{value:null},_isSystemPopup:{value:function(e){return"alert"===e||"confirm"===e||"notify"===e}},_createPopupSlot:{value:function(e){var t=document.createElement("div");document.body.appendChild(t),t.style.zIndex=e,t.style.position="absolute";var i=new n;return i.element=t,i.attachToParentComponent(),i}},getPopupSlot:{value:function(t,i,r){var a=this;e.async("ui/slot.reel/slot").then(function(e){n=n||e.Slot,t=t||"custom";var s,o,l=a._isSystemPopup(t);if(a.popupSlots=a.popupSlots||{},l)switch(t){case"alert":s=19004;break;case"confirm":s=19003;break;case"notify":s=19002}else a._zIndex?a._zIndex=a._zIndex+1:a._zIndex=17e3,s=a._zIndex;o=a.popupSlots[t],o||(o=a.popupSlots[t]=a._createPopupSlot(s)),l||(o.element.style.zIndex=s),o.content=i,r.call(this,o)})}},returnPopupSlot:{value:function(e){var t=this;if(t.popupSlots&&t.popupSlots[e]){var i=t.popupSlots[e];i.content=null}}},_getActivePopupSlots:{value:function(){var e=[];if(this.popupSlots){var t=Object.keys(this.popupSlots);if(t&&t.length>0){var i,n,r=t.length;for(i=0;i<r;i++)n=this.popupSlots[t[i]],n&&null!==n.content&&e.push(n)}}return e}}})}}),montageDefine("7f00df0","ui/den.reel/den",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Den=n.specialize({_icon:{value:null},_needsUpdateIcon:{value:!1},icon:{get:function(){return this._icon},set:function(e){switch(e){case"am":this._icon="ui/den.reel/day.png";break;case"pm":this._icon="ui/den.reel/night.png";break;default:this._icon=null}this._needsUpdateIcon=!0,this.needsDraw=!0}},_desiredTemperature:{value:72.5},desiredTemperature:{get:function(){return this._desiredTemperature},set:function(e){this._desiredTemperature=e,this.needsDraw=!0}},_ambientTemperature:{value:72.5},ambientTemperature:{get:function(){return this._ambientTemperature},set:function(e){this._ambientTemperature=e,this.needsDraw=!0}},temperatureDelta:{value:0},_temperatureOffset:{value:51},_previousTimestamp:{value:null},enterDocument:{value:function(e){e&&(this.activationArea.addEventListener("touchstart",this,!1),this.activationArea.addEventListener("mousedown",this,!1),"webkitTransform"in this.element.style?this._transform="webkitTransform":"MozTransform"in this.element.style?this._transform="MozTransform":"msTransform"in this.element.style?this._transform="msTransform":this._transform="transform")}},handleTouchstart:{value:function(){var e=this.element.getBoundingClientRect(),t={pageX:.5*(e.left+e.right),pageY:.55*e.top+.45*e.bottom};this._rotateComposer.center=t,this.activationArea.removeEventListener("touchstart",this,!1)}},handleMousedown:{value:function(){var e=this.element.getBoundingClientRect(),t={pageX:.5*(e.left+e.right),pageY:.55*e.top+.45*e.bottom};this._rotateComposer.center=t,this.activationArea.removeEventListener("mousedown",this,!1)}},willDraw:{value:function(){var e=this.element.getBoundingClientRect(),t={pageX:.5*(e.left+e.right),pageY:.55*e.top+.45*e.bottom};this._rotateComposer.center=t}},_isRotating:{value:!1},handleRotate:{value:function(e){this.desiredTemperature+=e.deltaRotation/6,this.desiredTemperature<51&&(this.desiredTemperature=51),this.desiredTemperature>93&&(this.desiredTemperature=93),this._isRotating=!0,this.needsDraw=!0}},handleRotateEnd:{value:function(e){this.desiredTemperature=Math.floor(this.desiredTemperature)+.5,this._isRotating=!1,this.needsDraw=!0}},heatingRate:{value:1},coolingRate:{value:1},handlePress:{value:function(){console.log("press!")}},draw:{value:function(e){var t,i,n=this.ambientTemperature-this._temperatureOffset|0,r=this.desiredTemperature-this._temperatureOffset|0;this.temperatureDelta=(this.desiredTemperature-this.ambientTemperature)/42,this.rightDigit.style[this._transform]="translate3d("+-50*((0|this.desiredTemperature)%10)+"px, 0, 0)",this.leftDigit.style[this._transform]="translate3d("+-50*(this.desiredTemperature/10|0)+"px, 0, 0)",null===this._previousTimestamp&&(this._previousTimestamp=e),i=e-this._previousTimestamp,this._previousTimestamp=e,this.whiteBar.style[this._transform]="rotate3d(0, 0, 1, "+(6*r-126)+"deg)",this.leftRedBar.style.opacity=0,this.rightRedBar.style.opacity=0,this.leftBlueBar.style.opacity=0,this.rightBlueBar.style.opacity=0,this.redFadingBar.style.opacity=0,this.blueFadingBar.style.opacity=0,this.blackBar.style.opacity=0,n<r?(t=r-n-1,t<=30?(this.leftRedBar.style.opacity=1,this.blackBar.style.opacity=1,this.leftRedBar.style[this._transform]="rotate3d(0, 0, 1, "+(6*(1+n)-39)+"deg)",this.blackBar.style[this._transform]="rotate3d(0, 0, 1, "+(6*(1+n+t)-39)+"deg)"):(this.leftRedBar.style.opacity=1,this.rightRedBar.style.opacity=1,this.leftRedBar.style[this._transform]="rotate3d(0, 0, 1, "+(6*(1+n)-39)+"deg)",this.rightRedBar.style[this._transform]="rotate3d(0, 0, 1, "+(6*(1+n-(30-t))-39)+"deg)"),this.redFadingBar.style.opacity=1-(this.ambientTemperature-this._temperatureOffset-n),this.redFadingBar.style[this._transform]="rotate3d(0, 0, 1, "+(6*n-126)+"deg)"):n>r&&(t=n-r-1,t<=30?(this.leftBlueBar.style.opacity=1,this.blackBar.style.opacity=1,this.leftBlueBar.style[this._transform]="rotate3d(0, 0, 1, "+(6*(1+r)-39)+"deg)",this.blackBar.style[this._transform]="rotate3d(0, 0, 1, "+(6*(1+r+t)-39)+"deg)"):(this.leftBlueBar.style.opacity=1,this.rightBlueBar.style.opacity=1,this.leftBlueBar.style[this._transform]="rotate3d(0, 0, 1, "+(6*(1+r)-39)+"deg)",this.rightBlueBar.style[this._transform]="rotate3d(0, 0, 1, "+(6*(1+r-(30-t))-39)+"deg)"),this.blueFadingBar.style.opacity=this.ambientTemperature-this._temperatureOffset-n,this.blueFadingBar.style[this._transform]="rotate3d(0, 0, 1, "+(6*n-126)+"deg)"),this._isRotating||(this.ambientTemperature<this.desiredTemperature?(this.ambientTemperature+=.001*i*this.heatingRate,this.ambientTemperature>this.desiredTemperature&&(this.ambientTemperature=this.desiredTemperature),this.needsDraw=!0):this.desiredTemperature<this.ambientTemperature&&(this.ambientTemperature-=.001*i*this.coolingRate,this.ambientTemperature<this.desiredTemperature&&(this.ambientTemperature=this.desiredTemperature),this.needsDraw=!0)),this._needsUpdateIcon&&(this.iconElement.style.backgroundImage="url("+this._icon+")",this._needsUpdateIcon=!1)}}})}}),montageDefine("22a41ee","ui/gl-view.reel/gl-view",{dependencies:["montage/ui/component","montage/collections/map"],factory:function(e,t,i){var n=e("montage/ui/component").Component,r=e("montage/collections/map");t.GlView=n.specialize({temperatureDelta:{value:0},isHeating:{value:!1},heatingColor:{value:null},isCooling:{value:!1},coolingColor:{value:null},_neutralFloorColor:{value:null},floorColor:{value:null},_panelKeyViewpointMap:{value:null},_rideViewpoints:{value:null},constructor:{value:function(){this["super"](),this._neutralFloorColor=[0,0,0,0],this.defineBinding("isHeating",{"<-":"temperatureDelta > 0"}),this.defineBinding("isCooling",{"<-":"temperatureDelta < 0"}),this.addPathChangeListener("temperatureDelta",this,"handleTemperatureDeltaChange")}},enterDocument:{value:function(e){e&&this.canDrawGate.setField("resourcesLoaded",!1)}},handleResourcesDidLoad:{value:function(e){this.canDrawGate.setField("resourcesLoaded",!0),this.needsDraw=!0}},handleTemperatureDeltaChange:{value:function(){this.temperatureDelta>0?(this.heatingColor=[1,0,0,.7*this.temperatureDelta],this.coolingColor=this._neutralFloorColor,this.floorColor=this.heatingColor):(this.coolingColor=[0,0,1,-.7*this.temperatureDelta],this.heatingColor=this._neutralFloorColor,this.floorColor=this.coolingColor)}},currentPanel:{value:null},configuration:{value:null},templateDidLoad:{value:function(){var e=this.templateObjects;this._panelKeyViewpointMap=r.from({staircase:e.staircaseViewpoint,kitchen:e.kitchenViewpoint,counters:e.counterViewpoint,window:e.windowViewpoint,laundry:e.laundryViewpoint});var t=this._rideViewpoints=new r;t.set(this.templateObjects.rideViewpoint.id,this.templateObjects.rideViewpoint),t.set(this.templateObjects.rideViewpoint2.id,this.templateObjects.rideViewpoint2),t.set(this.templateObjects.rideViewpoint3.id,this.templateObjects.rideViewpoint3),this.addPathChangeListener("configuration.configurationMap.get('staircase').optionMap.get('material')._selectedOption",this,"handleStaircaseMaterialChange"),this.addPathChangeListener("configuration.configurationMap.get('window').optionMap.get('coating').value",this,"handleWindowCoatingChange"),this.addPathChangeListener("configuration.configurationMap.get('kitchen').optionMap.get('appliances')._selectedOption",this,"handleKitchenAppliancesChange"),this.addPathChangeListener("configuration.configurationMap.get('counters').optionMap.get('material')._selectedOption",this,"handleCountertopMaterialChange"),this.addPathChangeListener("configuration.configurationMap.get('laundry').optionMap.get('washer').chosen",this,"handleWasherChange"),this.addPathChangeListener("configuration.configurationMap.get('laundry').optionMap.get('dryer').chosen",this,"handleDryerChange"),this.addPathChangeListener("currentPanel",this,"handleCurrentPanelChange")}},handleWasherChange:{value:function(e){var t=this.templateObjects.washerNode;t.hidden=!e}},handleDryerChange:{value:function(e){var t=this.templateObjects.dryerNode;t.hidden=!e}},handleStaircaseMaterialChange:{value:function(e){var t=this.templateObjects.staircaseMaterial,i="wood-stairs.jpg";if(e)switch(e.name){case"FSC Pine":i="wood-stairs.jpg";break;case"Dark Ash":i="dark-stairs.jpg";break;case"Dark Walnut":i="walnut-stairs.jpg";break;case"Deep Cherry":i="bold-stairs.jpg";break;default:i=""}t.image=i}},handleKitchenAppliancesChange:{value:function(e){var t=this.templateObjects.guterslohAppliancesNode,i=this.templateObjects.norseAppliancesNode,n=this.templateObjects.vortexAppliancesNode,r=!1,a=!1,s=!1;if(e)switch(e.name){case"Gütersloh":r=!0;break;case"Norse":a=!0;break;case"Vortex":s=!0}t.hidden=!r,i.hidden=!a,n.hidden=!s}},handleCountertopMaterialChange:{value:function(e){var t=this.templateObjects.countertopMaterial,i=this.templateObjects.cuisineMaterial,n="bar_dessus_paper.jpg",r="16_cuisineVRayCompleteMap.jpg";if(e)switch(e.name){case"Black Quartz":n="bar_dessus_black.jpg",r="cuisine_black.jpg";break;case"Paper Composite":r="cuisine_paper.jpg";break;case"Bamboo":n="bar_dessus_bamboo.jpg";break;case"Cement and Fly Ash":n="bar_dessus_cement.jpg",r="cuisine_cement.jpg";break;default:n="",r=""}t.image=n,i.image=r}},handleWindowCoatingChange:{value:function(e){e=1-e/2400;var t=this.templateObjects.backgroundMaterial;t.filterColor=[e,1,e,1]}},handleCurrentPanelChange:{value:function(e){var t=this.templateObjects.roomView,i=this.templateObjects.rideViewpoint,n=this._rideViewpoints,r=n.has(t.viewPoint.id),a=!1;if(e){var s=this._panelKeyViewpointMap.get(e.panelKey);s?(this._autoActivateRideTimeout&&(clearTimeout(this._autoActivateRideTimeout),this._autoActivateRideTimeout=null),t.pause(),t.viewPoint=s):a=!0}else a=!0;a&&(r||(t.viewPoint=i),t.play())}},play:{value:function(){this.templateObjects&&this.templateObjects.roomView&&this.templateObjects.roomView.play()}},pause:{value:function(){this.templateObjects&&this.templateObjects.roomView&&this.templateObjects.roomView.pause()}}})}}),montageDefine("b0111a3","core/document-resources",{dependencies:["./core","./promise","./mini-url"],factory:function(e,t,i){var n=e("./core").Montage,r=e("./promise").Promise,a=e("./mini-url"),s=n.specialize({_SCRIPT_TIMEOUT:{value:5e3},_document:{value:null},_resources:{value:null},_preloaded:{value:null},_expectedStyles:{value:null},constructor:{value:function(){this._expectedStyles=[],this._isPollingDocumentStyleSheets=!this._isLinkLoadEventAvailable()}},_webkitVersion:{value:function(){var e=/AppleWebKit\/([\d.]+)/.exec(navigator.userAgent);return e?parseInt(e[1]):null}},_isLinkLoadEventAvailable:{value:function(){var e=document.createElement("link"),t=this._webkitVersion();return"onload"in e&&!(null!==t&&t<535)}},initWithDocument:{value:function(e){return this.clear(),this._document=e,this._populateWithDocument(e),this}},_populateWithDocument:{value:function(e){var t=e.querySelectorAll("script"),i=Array.prototype.forEach;i.call(t,function(e){e.src&&this._addResource(this.normalizeUrl(e.src))},this);var n=e.querySelectorAll("link");i.call(n,function(e){"stylesheet"===e.rel&&this._addResource(this.normalizeUrl(e.href))},this)}},clear:{value:function(){this._resources=Object.create(null),this._preloaded=Object.create(null)}},_addResource:{value:function(e){this._resources[e]=!0}},hasResource:{value:function(e){return e in this._resources}},isResourcePreloaded:{value:function(e){return this._preloaded[e]===!0}},isResourcePreloading:{value:function(e){return r.is(this._preloaded[e])}},setResourcePreloadedPromise:{value:function(e,t){this._preloaded[e]=t}},setResourcePreloaded:{value:function(e){this._preloaded[e]=!0}},getResourcePreloadedPromise:{value:function(e){return this._preloaded[e]}},addScript:{value:function(e){var t=this.normalizeUrl(e.src);return t?this.isResourcePreloaded(t)?r.resolve():this.isResourcePreloading(t)?this.getResourcePreloadedPromise(t):this._importScript(e):this._importScript(e)}},_importScript:{value:function(e){var t,i=this,n=this._document,a=n.head,s=e.src;return s?(i._addResource(s),t=new r(function(t,n){var r=function o(n){i.setResourcePreloaded(s),e.removeEventListener("load",o,!1),e.removeEventListener("error",o,!1),clearTimeout(a),t(n)};e.addEventListener("load",r,!1),e.addEventListener("error",r,!1);var a=setTimeout(function(){i.setResourcePreloaded(s),t()},i._SCRIPT_TIMEOUT)}),this.setResourcePreloadedPromise(s,t)):t=new r(function(e,t){e()}),a.appendChild(n.createComment("Inserted from FIXME")),a.appendChild(e),t}},handleEvent:{value:function(e){var t,i=e.target;"LINK"===i.tagName&&(t=this._expectedStyles.indexOf(i.href),t>=0&&this._expectedStyles.splice(t,1),i.removeEventListener("load",this,!1),i.removeEventListener("error",this,!1))}},addStyle:{value:function(e,t){var i,n=e.getAttribute("href");if(n){if(n=this.normalizeUrl(n),this.hasResource(n))return;this._addResource(n),this._expectedStyles.push(n),this._isPollingDocumentStyleSheets||(e.setAttribute("href",n),e.addEventListener("load",this,!1),e.addEventListener("error",this,!1))}i=t||this._document.head,i.insertBefore(e,i.firstChild)}},normalizeUrl:{value:function(e,t){return t||(t=this._document.location.href),a.resolve(t,e)}},domain:{value:global.location?global.location.protocol+"//"+global.location.host:""},isCrossDomain:{value:function(e){return 0!==e.indexOf(this.domain+"/")||0===e.indexOf("file://")}},preloadResource:{value:function(e,t){var i;return e=this.normalizeUrl(e),!t&&this.isCrossDomain(e)&&(i=!0),i||this.isResourcePreloaded(e)?r.resolve():this.isResourcePreloading(e)?this.getResourcePreloadedPromise(e):this._preloadResource(e)}},_preloadResource:{value:function(e){var t=this,i=new r(function(i,n){var r=new XMLHttpRequest;r.open("GET",e),r.addEventListener("load",i,!1),r.addEventListener("error",i,!1),r.addEventListener("timeout",i,!1),r.timeout=t._SCRIPT_TIMEOUT,r.send(),r.listener=i}).bind(this).then(function(t){this.setResourcePreloaded(e),t.target.removeEventListener("load",t.target.listener),t.target.removeEventListener("error",t.target.listener),t.target.removeEventListener("timeout",t.target.listener)});return this.setResourcePreloadedPromise(e,i),i}},areStylesLoaded:{get:function(){var e,t;if(this._isPollingDocumentStyleSheets&&this._expectedStyles.length>0){e=this._document.styleSheets;for(var i,n=0;i=e[n];n++)t=this._expectedStyles.indexOf(i.href),t>=0&&this._expectedStyles.splice(t,1)}return 0===this._expectedStyles.length}}},{getInstanceForDocument:{value:function(e){var t=e.__montage_resources__;return t||(t=e.__montage_resources__=(new s).initWithDocument(e)),t}}});t.DocumentResources=s}}),montageDefine("c50fb48","runtime/animation",{dependencies:["runtime/dependencies/gl-matrix","runtime/base"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix");var n=e("runtime/base").Base,r=t.Channel=Object.create(n,{duration:{value:-1,writable:!0},_sampler:{value:null,writable:!0},sampler:{get:function(){return this._sampler},set:function(e){this._sampler=e}},_target:{value:null,writable:!0},target:{get:function(){return this._target},set:function(e){this._target=e}},_path:{value:null,writable:!0},path:{get:function(){return this._path},set:function(e){this._path=e}},parameterDelegate:{value:{handleError:function(e,t){console.log("ERROR:parameterDelegate:"+e+" :"+t)},convert:function(e,t){return new Float32Array(e)},resourceAvailable:function(e,t){}}},getParameterArray:{value:function(e,t){return t.getResource(e,this.parameterDelegate,null)}},updateTargetsAtTime:{value:function(e,t){var i=this.sampler.input,n=this.sampler.output,r=this.getParameterArray(i,t),a=this.getParameterArray(n,t);if(r&&a){e/=1e3;var s=i.count;this.duration=r[s-1],e%=this.duration;var o,l=0,u=0,c=0;if(s>0){for(o=l;o<s-1;o++)r[o]<=e&&e<r[o+1]&&(l=o,r[o+1]!=r[o]&&(c=r[o+1]-r[o],u=(e-r[o])/c));null==this.__vec4&&(this.__vec4=vec4.create()),null==this.__vec3&&(this.__vec3=vec3.create()),null==this.__vec2&&(this.__vec2=vec2.create());var h=null;switch(n.componentsPerAttribute){case 4:h=this.__vec4;break;case 3:h=this.__vec3;break;case 2:h=this.__vec2;break;case 1:console.log("float interpolation not handled yet")}this.index=l;var d=l*n.componentsPerAttribute,m=d+n.componentsPerAttribute;if("rotation"==this.path){var p=0,g=1,f=2,v=f;if(v==p){var _=vec4.createFrom(a[d+0],a[d+1],a[d+2],a[d+3]),b=vec4.createFrom(a[m+0],a[m+1],a[m+2],a[m+3]);vec3.normalize(_),vec3.normalize(b);var w=vec3.create();vec3.cross(_,b,w);var y=(Math.sqrt(vec3.dot(_,_)),Math.sqrt(vec3.dot(b,b)),Math.acos(vec3.dot(_,b))),E=mat4.identity();mat4.rotate(E,y*u,w),mat4.multiplyVec3(E,_,w),vec3.normalize(w);var C=_[3]+(b[3]-_[3])*u;quat4.fromAngleAxis(C,w,h)}else if(v==g){var _=vec4.createFrom(a[d+0],a[d+1],a[d+2],a[d+3]),b=vec4.createFrom(a[m+0],a[m+1],a[m+2],a[m+3]);for(o=0;o<h.length;o++){var x=_[o],T=b[o];b[o]=x+(T-x)*u}quat4.fromAngleAxis(b[3],b,h)}else if(v==f){null==this._quats&&(this._quats=[],this._quats.push(quat4.create()),this._quats.push(quat4.create())),null==this._vecs&&(this._vecs=[],this._vecs.push(vec3.create()),this._vecs.push(vec3.create())),this._vecs[0][0]=a[d+0],this._vecs[0][1]=a[d+1],this._vecs[0][2]=a[d+2],this._vecs[1][0]=a[m+0],this._vecs[1][1]=a[m+1],this._vecs[1][2]=a[m+2];var S=this._quats[0],P=this._quats[1];quat4.fromAngleAxis(a[d+3],this._vecs[0],S),quat4.fromAngleAxis(a[m+3],this._vecs[1],P),quat4.slerp(S,P,u,h)}}else for(o=0;o<h.length;o++){var x=a[d+o],T=a[m+o];h[o]=x+(T-x)*u}this.target.transform[this.path]=h}}}},initWithDescription:{value:function(e){return this.init(),this.index=0,this.target=e.target,this}},init:{value:function(){return this.__Base_init(),this}}}),a=Object.create(n,{_input:{value:null,writable:!0},input:{get:function(){return this._input},set:function(e){this._input=e}},_output:{value:null,writable:!0},output:{get:function(){return this._output},set:function(e){this._output=e}},initWithDescription:{value:function(e){return this.init(),this}},init:{value:function(){return this.__Base_init(),this}}});t.Animation=Object.create(n,{_count:{value:0,writable:!0},_parameters:{value:null,writable:!0},_channels:{value:null,writable:!0},_samplers:{value:null,writable:!0},_duration:{value:0,writable:!0},channels:{get:function(){return this._channels},set:function(e){this._channels=e}},samplers:{get:function(){return this._samplers},set:function(e){this._samplers=e}},parameters:{get:function(){return this._parameters},set:function(e){this._parameters=e}},count:{get:function(){return this._count},set:function(e){this._count=e}},duration:{get:function(){if(this.channels&&this.channels.length)return this.channels[0].duration}},updateTargetsAtTime:{value:function(e,t){this.channels.forEach(function(i){i.updateTargetsAtTime(e,t)},this)}},initWithDescription:{value:function(e){return this.init(),this.count=e.count,Object.keys(e.samplers).forEach(function(t){var i=e.samplers[t],n=Object.create(a).initWithDescription(i);this.samplers[t]=n},this),e.channels.forEach(function(e){var t=Object.create(r).initWithDescription(e);t.sampler=this.samplers[e.sampler],t.target=e.target,this.channels.push(t)},this),this}},init:{value:function(){return this.__Base_init(),this.channels=[],this.samplers={},this}}})}}),montageDefine("22a41ee","ui/summary.reel/summary.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Summary{font-size:12px;line-height:22px}.Summary-optionGroup,.Summary-options{list-style:none;margin:0;-webkit-box-flex:1;-webkit-flex:1;flex:1;padding:0}.Summary-optionGroupName{width:120px;font-weight:700;text-align:right;color:gray}.Card-content .Summary-optionGroupName{margin:0 16px 0 0}.Summary-subtotals .Summary-optionPrice{display:block;-webkit-box-flex:1;-webkit-flex:1;flex:1}.Summary-option{display:-webkit-box;display:-webkit-flex;display:flex}.Summary-optionName{display:block;-webkit-box-flex:1;-webkit-flex:1;flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:#b2b2b2;padding-right:12px}.Summary-optionPrice{text-align:right}.Summary-subtotals{margin-top:14px;border:1px solid #E0E0E0;border-width:1px 0}.Summary-total{text-align:right;padding-top:4px}.Summary-optionGroupItem{display:-webkit-box;display:-webkit-flex;display:flex}.Summary--price{display:block;color:#000}.Summary-total.Summary--price{font-weight:700;font-size:18px}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/summary.reel","properties":{"element":{"#":"summary"}},"bindings":{"optionGroups":{"<-":"orderedPanelKeys.map{$configuration.configurationMap.get(this)}.filter{}.filter{this.optionMap.values().filter{chosen && price > 0}.length > 0}"}}},"basePrice":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"basePrice"},"converter":{"@":"numberConverter"},"value":"Text"},"bindings":{"value":{"<-":"@owner.configuration.basePrice"}}},"currencyConverter":{"prototype":"montage/core/converter/currency-converter","properties":{"decimals":0,"shorten":false,"showCurrencyBeforeNumber":true}},"numberConverter":{"prototype":"montage/core/converter/number-converter","properties":{"decimals":0,"shorten":false}},"optionGroup":{"prototype":"montage/ui/repetition.reel","properties":{"element":{"#":"optionGroup"},"content":[]},"bindings":{"content":{"<-":"@owner.optionGroups"}}},"optionGroupName":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"optionGroupName"},"value":"Text"},"bindings":{"value":{"<-":"@optionGroup:iteration.object.name"}}},"optionName":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"optionName"},"value":"Text"},"bindings":{"value":{"<-":"@options:iteration.object.name"}}},"optionPrice":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"optionPrice"},"converter":{"@":"numberConverter"},"value":"Text"},"bindings":{"value":{"<-":"@options:iteration.object.price"}}},"options":{"prototype":"montage/ui/repetition.reel","properties":{"element":{"#":"options"},"content":[]},"bindings":{"content":{"<-":"@optionGroup:iteration.object.optionMap.entries().map{this[1]}.filter{price > 0 && chosen}"}}},"optionsSubtotal":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"optionsSubtotal"},"converter":{"@":"numberConverter"},"value":"Text"},"bindings":{"value":{"<-":"@owner.configuration.optionsPrice"}}},"total":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"total"},"converter":{"@":"currencyConverter"},"value":"Text"},"bindings":{"value":{"<-":"@owner.configuration.totalPrice"}}}}</script></head><body><div data-montage-id=summary class=Summary><ul data-montage-id=optionGroup class=Summary-optionGroup><li class=Summary-optionGroupItem><p data-montage-id=optionGroupName class=Summary-optionGroupName></p><ul data-montage-id=options class=Summary-options><li class=Summary-option><span data-montage-id=optionName class=Summary-optionName></span> <span data-montage-id=optionPrice class="Summary-optionPrice Summary--price"></span></li></ul></li></ul><section class=Summary-subtotals><div class="Summary-option Summary-optionGroupItem"><span class=Summary-optionGroupName>Options</span> <span data-montage-id=optionsSubtotal class="Summary-optionPrice Summary--price"></span></div><div class="Summary-option Summary-optionGroupItem"><span class=Summary-optionGroupName>Base</span> <span data-montage-id=basePrice class="Summary-optionPrice Summary--price"></span></div></section><div data-montage-id=total class="Summary-total Summary--price"></div></div></body></html>'
}),montageDefine("22a41ee","ui/gl-view.reel/gl-view.html",{text:'<!DOCTYPE html><html><head><title></title><script type=text/montage-serialization>{"owner":{"prototype":"ui/gl-view.reel","properties":{"element":{"#":"glView"},"temperatureDelta":""}},"appliancesMaterial":{"prototype":"glTF-webgl-viewer/runtime/material","properties":{"id":"material_0_1_0-effect","scene":{"@":"roomScene"}}},"appliancesNode":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"id":"node-fridge","scene":{"@":"roomScene"}}},"backgroundMaterial":{"prototype":"glTF-webgl-viewer/runtime/material","properties":{"id":"background","scene":{"@":"roomScene"}}},"countertopMaterial":{"prototype":"glTF-webgl-viewer/runtime/material","properties":{"id":"top_cement","scene":{"@":"roomScene"}}},"counterViewpoint":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"id":"node-LookAtBar","scene":{"@":"roomScene"}}},"cuisineMaterial":{"prototype":"glTF-webgl-viewer/runtime/material","properties":{"id":"cuisine","scene":{"@":"roomScene"}}},"dryerNode":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"hidden":true,"id":"node-SecheLinge","scene":{"@":"roomScene"}}},"guterslohAppliancesNode":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"hidden":true,"id":"node-PlaqueFourFridge_02","scene":{"@":"roomScene"}}},"hvacMaterial":{"prototype":"glTF-webgl-viewer/runtime/material","properties":{"filterColor":[0,0,0,0],"id":"option01","opacity":"0","scene":{"@":"roomScene"}},"bindings":{"opacity":{"<-":"@owner.configuration.configurationMap.get(\'thermostat\').optionMap.get(\'thermostat\').chosen ? 1 : 0"}}},"kitchenViewpoint":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"id":"node-LookAtKitchen","scene":{"@":"roomScene"}}},"laundryViewpoint":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"id":"node-LookAtLaundry","scene":{"@":"roomScene"}}},"norseAppliancesNode":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"hidden":true,"id":"node-PlaqueFourFridge_03","scene":{"@":"roomScene"}}},"rideViewpoint":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"id":"node-camera001","scene":{"@":"roomScene"}}},"rideViewpoint2":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"id":"node-camera002","scene":{"@":"roomScene"}}},"rideViewpoint3":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"id":"node-camera003","scene":{"@":"roomScene"}}},"roomScene":{"prototype":"glTF-webgl-viewer/runtime/scene","properties":{"path":"assets/3d/loft/loft8.json"},"listeners":[{"type":"resourcesDidLoad","useCapture":false,"listener":{"@":"owner"}}]},"roomView":{"prototype":"glTF-webgl-viewer/ui/view.reel","properties":{"element":{"#":"roomView"},"height":"768","scene":{"@":"roomScene"},"viewPoint":{"@":"rideViewpoint"},"width":"674"},"bindings":{"height":{"<-":"@owner.height"},"width":{"<-":"@owner.width"}}},"staircaseMaterial":{"prototype":"glTF-webgl-viewer/runtime/material","properties":{"id":"escalier","image":"dark-stairs.jpg","opacity":"1","scene":{"@":"roomScene"}}},"staircaseViewpoint":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"id":"node-LookAtStairs","scene":{"@":"roomScene"}}},"stairsMaterial":{"prototype":"glTF-webgl-viewer/runtime/material","properties":{"id":"escalier","image":"wood-stairs.jpg","opacity":"1","scene":{"@":"roomScene"}}},"vortexAppliancesNode":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"hidden":true,"id":"node-PlaqueFourFridge_01","scene":{"@":"roomScene"}}},"washerNode":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"hidden":true,"id":"node-machineAlaver","scene":{"@":"roomScene"}}},"windowViewpoint":{"prototype":"glTF-webgl-viewer/runtime/node","properties":{"id":"node-LookAtWindow","scene":{"@":"roomScene"}}}}</script></head><body><div data-montage-id=glView class=GlView><div data-montage-id=roomView class=Main-colladaView></div></div></body></html>'}),montageDefine("c50fb48","runtime/utilities",{dependencies:["runtime/dependencies/gl-matrix"],factory:function(e,t,n){e("runtime/dependencies/gl-matrix"),t.Utilities=Object.create(Object.prototype,{vec3Min:{value:function(e,t){t[0]<e[0]&&(e[0]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[2]<e[2]&&(e[2]=t[2])}},vec3Max:{value:function(e,t){t[0]>e[0]&&(e[0]=t[0]),t[1]>e[1]&&(e[1]=t[1]),t[2]>e[2]&&(e[2]=t[2])}},mergeBBox:{value:function(e,t){var i=e[0],n=e[1],r=t[0],a=t[1],s=[i[0]<r[0]?i[0]:r[0],i[1]<r[1]?i[1]:r[1],i[2]<r[2]?i[2]:r[2]],o=[n[0]>a[0]?n[0]:a[0],n[1]>a[1]?n[1]:a[1],n[2]>a[2]?n[2]:a[2]];return[s,o]}},computeBBOXFromVec3Array:{value:function(e){if(0===e.length)return null;for(var t=[e[0][0],e[0][1],e[0][2]],i=[e[0][0],e[0][1],e[0][2]],n=0;n<8;n++)e[n][0]<t[0]&&(t[0]=e[n][0]),e[n][1]<t[1]&&(t[1]=e[n][1]),e[n][2]<t[2]&&(t[2]=e[n][2]),e[n][0]>i[0]&&(i[0]=e[n][0]),e[n][1]>i[1]&&(i[1]=e[n][1]),e[n][2]>i[2]&&(i[2]=e[n][2]);return[t,i]}},transformBBox:{value:function(e,t){var i=e[0],n=e[1],r=0,a=1,s=2,o=mat4.multiplyVec3(t,vec3.createFrom(i[r],i[a],i[s])),l=mat4.multiplyVec3(t,vec3.createFrom(n[r],i[a],i[s])),u=mat4.multiplyVec3(t,vec3.createFrom(i[r],n[a],i[s])),c=mat4.multiplyVec3(t,vec3.createFrom(n[r],n[a],i[s])),h=mat4.multiplyVec3(t,vec3.createFrom(i[r],i[a],n[s])),d=mat4.multiplyVec3(t,vec3.createFrom(n[r],i[a],n[s])),m=mat4.multiplyVec3(t,vec3.createFrom(i[r],n[a],n[s])),p=mat4.multiplyVec3(t,vec3.createFrom(n[r],n[a],n[s]));return this.computeBBOXFromVec3Array([o,l,u,c,h,d,m,p])}},rayIntersectsMesh:{value:function(e,t,i,n,r){var a=t.verticesBuffer;if(null===a)return!1;for(var s=!1,o=t.primitives.length,l=(vec3.create(),vec3.create(),vec3.create(),0);l<o;l++){var u=t.primitives[l];if(r){var c=r.materials;if(c&&c.indexOf(u.material.name)==-1)continue}if(!(null!==u.material.inputs.transparency&&"undefined"!=typeof u.material.inputs.transparency&&u.material.inputs.transparency<1)){var h=u.boundingBox;if(this.intersectsBBOX(h,e))return!0}}return s}},intersectsBBOX:{value:function(e,t){var i,n,r,a,s,o,l=0,u=1,c=2,h=t[1],d=t[0],m=e[0],p=e[1];return h[l]>=0?(i=(m[l]-d[l])/h[l],n=(p[l]-d[l])/h[l]):(i=(p[l]-d[l])/h[l],n=(m[l]-d[l])/h[l]),h[u]>=0?(r=(m[u]-d[u])/h[u],a=(p[u]-d[u])/h[u]):(r=(p[u]-d[u])/h[u],a=(m[u]-d[u])/h[u]),!(i>a||r>n||(r>i&&(i=r),a<n&&(n=a),h[c]>=0?(s=(m[c]-d[c])/h[c],o=(p[c]-d[c])/h[c]):(s=(p[c]-d[c])/h[c],o=(m[c]-d[c])/h[c]),i>o||s>n||(s>i&&(i=s),o<n&&(n=o),0)))}},inverpolateAxisAngle:{value:function(e,t,n,r){var a=0,s=1,o=2,l=o,u=vec4.createFrom(e[0],e[1],e[2],e[3]),c=vec4.createFrom(t[0],t[1],t[2],t[3]);if(l==a){vec3.normalize(u),vec3.normalize(c);var h=vec3.create();vec3.cross(u,c,h);var d=(Math.sqrt(vec3.dot(u,u)),Math.sqrt(vec3.dot(c,c)),Math.acos(vec3.dot(u,c))),m=mat4.identity();mat4.rotate(m,d*n,h),mat4.multiplyVec3(m,u,h),vec3.normalize(h);var p=u[3]+(c[3]-u[3])*n;quat4.fromAngleAxis(p,h,r)}else if(l==s){for(i=0;i<r.length;i++){var g=u[i],f=c[i];c[i]=g+(f-g)*n}quat4.fromAngleAxis(c[3],c,r)}else l==o&&quat4.slerp(e,t,n,r)}},interpolateVec:{value:function(e,t,n,r){for(i=0;i<r.length;i++){var a=e[i],s=t[i];r[i]=a+(s-a)*n}}},idx:{value:function(e,t){return 4*e+t}},decomposeMat4:{value:function(e,t,i,n){var r,a,s=mat4.create(),o=mat4.create(),l=(mat4.create(),mat4.create(),[vec3.create(),vec3.create(),vec3.create()]);mat4.set(e,s);var u,c;for(r=0;r<4;r++)for(a=0;a<4;a++)u=this.idx(r,a),c=this.idx(3,3),s[u]/=s[c];for(mat4.set(s,o),r=0;r<3;r++)u=this.idx(r,3),o[u]=0;for(u=this.idx(3,3),o[u]=1,0==s[this.idx(0,3)]&&0==s[this.idx(1,3)]&&0==s[this.idx(2,3)]||(s[this.idx(0,3)]=0,s[this.idx(1,3)]=0,s[this.idx(2,3)]=0,s[this.idx(3,3)]=1),t[0]=s[this.idx(3,0)],s[this.idx(3,0)]=0,t[1]=s[this.idx(3,1)],s[this.idx(3,1)]=0,t[2]=s[this.idx(3,2)],s[this.idx(3,2)]=0,r=0;r<3;r++)l[r][0]=s[this.idx(r,0)],l[r][1]=s[this.idx(r,1)],l[r][2]=s[this.idx(r,2)];n[0]=vec3.length(l[0]),vec3.normalize(l[0]),n[1]=vec3.length(l[1]),vec3.normalize(l[1]),n[2]=vec3.length(l[2]),vec3.normalize(l[2]);var h=vec3.create();if(vec3.cross(l[1],l[2],h),vec3.dot(l[0],h)<0)for(r=0;r<3;r++)n[r]*=-1,l[r][0]*=-1,l[r][1]*=-1,l[r][2]*=-1;var d=mat3.create();d[0]=l[0][0],d[1]=l[1][0],d[2]=l[2][0],d[3]=l[0][1],d[4]=l[1][1],d[5]=l[2][1],d[6]=l[0][2],d[7]=l[1][2],d[8]=l[2][2],mat3.transpose(d),quat4.fromRotationMatrix(d,i),quat4.normalize(i)}},easeOut:{value:function(e){var t=e,i=0,n=1;return t--,y=n*(t*t*t+1)+i-1,y=-y,y=1-y,y}}})}}),montageDefine("22a41ee","ui/cards/call-back.reel/call-back.html",{text:'<!DOCTYPE html><html><head><title></title><style>.CallBack .Card-hero{display:none}.CallBack .Card-title{margin-bottom:10px}.CallBack .Card-description{font-weight:700;margin:44px 0 33px}.CallBack-steps{text-align:center}.CallBack-label{display:block;margin:0 auto 12px;width:200px;font-size:12px;color:gray;text-align:left}.CallBack-input{display:block;margin:0 auto 16px;width:200px}.CallBack-button.digit-Button{display:block;margin:0 auto;width:200px}.CallBack--activity{font-size:20px;text-align:center;display:block;padding:10px}.CallBack-errors{margin:10px 0 0;padding:0;list-style:none;text-align:center}.CallBack-errors .digit-Text{font-size:16px;color:hsl(0,100%,40%)}@media (orientation:landscape) and (max-height:700px){.CallBack .Card-description{font-size:14px;line-height:18px;margin:20px 0}}@media (orientation:landscape) and (max-height:600px){.CallBack .Card{padding-top:10px;padding-bottom:10px}.CallBack .Card-description{display:none}.Summary-optionGroupItem{margin-bottom:0}}@media (orientation:landscape) and (max-height:500px){.Summary-optionGroup{display:none}}@media (orientation:landscape) and (max-height:299px){.CallBack .CallBack--info{display:none}.CallBack .Card-content:nth-child(2){display:block}}@media (orientation:portrait){.Summary-optionName{display:none}.Summary-optionPrice{-webkit-box-flex:1;-webkit-flex:1;flex:1}}@media (orientation:portrait) and (max-width:560px){.Summary-optionGroup,.CallBack .Card-description{display:none}}.digit-TextField{-moz-box-sizing:border-box}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/cards/call-back.reel","properties":{"element":{"#":"CallBack"}}},"callController":{"prototype":"core/call-controller"},"callingLater":{"prototype":"ui/call-back/calling-later.reel","properties":{"element":{"#":"callingLater"},"controller":{"@":"callController"}}},"callingNow":{"prototype":"ui/call-back/calling-now.reel","properties":{"element":{"#":"callingNow"},"controller":{"@":"callController"}}},"callNow":{"prototype":"ui/call-back/now.reel","properties":{"element":{"#":"callNow"},"controller":{"@":"callController"}}},"errorMessage":{"prototype":"digit/ui/text.reel","properties":{"element":{"#":"errorMessage"},"value":"Text"},"bindings":{"value":{"<-":"@errors:iteration.object.message"}}},"errors":{"prototype":"montage/ui/repetition.reel","properties":{"element":{"#":"errors"},"content":["error"]},"bindings":{"content":{"<-":"@callController.errors"}}},"hero":{"prototype":"digit/ui/image.reel","properties":{"element":{"#":"hero"}}},"later":{"prototype":"ui/call-back/later.reel","properties":{"element":{"#":"callLater"},"controller":{"@":"callController"}}},"steps":{"prototype":"montage/ui/substitution.reel","properties":{"element":{"#":"steps"}},"bindings":{"switchValue":{"<-":"@owner.currentStep"}}},"summary":{"prototype":"ui/summary.reel","properties":{"element":{"#":"summary"}},"bindings":{"configuration":{"<-":"@owner.configuration"},"orderedPanelKeys":{"<-":"@owner.orderedPanelKeys"}}},"title":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"title"},"value":"Contact Us"}}}</script></head><body><div data-montage-id=CallBack class="CallBack Card"><section class="Card-content CallBack--info"><img data-montage-id=hero class=Card-hero src=""><h1 data-montage-id=title class=Card-title></h1><div data-montage-id=summary></div></section><section class="Card-content CallBack--controls"><p class=Card-description>Need help? Answers to your questions are only a click away. Enter your phone number below and we\'ll call you back.</p><div data-montage-id=steps class=CallBack-steps><div data-arg=callNow data-montage-id=callNow></div><div data-arg=callingNow data-montage-id=callingNow></div><div data-arg=callLater data-montage-id=callLater></div><div data-arg=callingLater data-montage-id=callingLater></div><div data-arg=unavailable>Server Unavailable</div></div><ul data-montage-id=errors class=CallBack-errors><li data-montage-id=errorMessage></li></ul></section></div></body></html>'}),montageDefine("c50fb48","runtime/transform",{dependencies:["runtime/dependencies/gl-matrix","runtime/base","runtime/utilities"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix");var n=e("runtime/base").Base,r=e("runtime/utilities").Utilities,a=t.Transform=Object.create(n,{_matrix:{value:null,writable:!0},_dirty:{value:!0,writable:!0},_dirtyAffines:{value:!0,writable:!0},_translation:{value:null,writable:!0},_rotation:{value:null,writable:!0},_scale:{value:null,writable:!0},_id:{value:0,writable:!0},_fireTransformDidUpdate:{value:function(e){if(this._observers)for(var t=0;t<this._observers.length;t++)this._observers[t].transformDidUpdate(this)}},_updateDirtyFlag:{value:function(e){this._dirty=e,this._fireTransformDidUpdate()}},interpolateToTransform:{value:function(e,t,i){t=r.easeOut(t),r.interpolateVec(this._translation,e._translation,t,i._translation),r.interpolateVec(this._scale,e._scale,t,i._scale),r.inverpolateAxisAngle(this._rotation,e._rotation,t,i._rotation),i._updateDirtyFlag(!0)}},matrix:{get:function(){return this._dirty&&(null==this._matrix&&(this._matrix=mat4.create()),null==this._intermediateMatrices&&(this._intermediateMatrices=[],this._intermediateMatrices.push(mat4.identity()),this._intermediateMatrices.push(mat4.identity()),this._intermediateMatrices.push(mat4.identity()),this._intermediateMatrices.push(mat4.identity())),mat4.identity(this._matrix),mat4.identity(this._intermediateMatrices[0]),mat4.set(this._intermediateMatrices[0],this._intermediateMatrices[1]),mat4.set(this._intermediateMatrices[0],this._intermediateMatrices[2]),mat4.set(this._intermediateMatrices[0],this._intermediateMatrices[3]),mat4.translate(this._intermediateMatrices[1],this._translation),mat4.scale(this._intermediateMatrices[2],this._scale),quat4.toMat4(this._rotation,this._intermediateMatrices[3]),mat4.multiply(this._matrix,this._intermediateMatrices[1]),mat4.multiply(this._matrix,this._intermediateMatrices[2]),mat4.multiply(this._matrix,this._intermediateMatrices[3]),this._dirty=!1),this._matrix},set:function(e){null==this._matrix&&(this._matrix=mat4.create()),mat4.set(e,this._matrix),this._dirty=!1,this._dirtyAffines=!0}},_rebuildAffinesIfNeeded:{value:function(){this._dirtyAffines===!0&&(r.decomposeMat4(this.matrix,this._translation,this._rotation,this._scale),this._dirtyAffines=!1)}},translation:{set:function(e){this._translation=e,this._updateDirtyFlag(!0)},get:function(e){return this._rebuildAffinesIfNeeded(),this._translation}},rotation:{set:function(e){this._rotation=e,this._updateDirtyFlag(!0)},get:function(e){return this._rebuildAffinesIfNeeded(),this._rotation}},scale:{set:function(e){this._scale=e,this._updateDirtyFlag(!0)},get:function(e){return this._rebuildAffinesIfNeeded(),this._scale}},_commonInit:{value:function(){this.translation=vec3.createFrom(0,0,0),this.rotation=vec4.createFrom(0,0,0,0),this.scale=vec3.createFrom(1,1,1),this.matrix=mat4.identity(),this._id=a.bumpId()}},initWithDescription:{value:function(e){if(this._commonInit(),e.matrix)this.matrix=mat4.create(e.matrix);else if(e.translation||e.rotation||e.scale){this.translation=e.translation?vec3.create(e.translation):vec3.createFrom(0,0,0);var t=e.rotation;this.rotation=t?quat4.fromAngleAxis(t[3],vec3.createFrom(t[0],t[1],t[2])):vec4.createFrom(0,0,0,0),this.scale=e.scale?vec3.create(e.scale):vec3.createFrom(1,1,1)}else this.matrix=mat4.identity();return this}},init:{value:function(){return this._commonInit(),this}},bumpId:{value:function(){return a._id++,a._id}},copy:{value:function(){var e=Object.create(a).init();return this._translation&&(e.translation=vec3.createFrom(this._translation[0],this._translation[1],this._translation[2])),this._scale&&(e.scale=vec3.createFrom(this._scale[0],this._scale[1],this._scale[2])),this._rotation&&(e.rotation=quat4.create(this._rotation)),e.matrix=mat4.create(this.matrix),e}},_observers:{value:null,writable:!0},addObserver:{value:function(e){null==this._observers&&(this._observers=[]),this._observers.indexOf(e)===-1?this._observers.push(e):console.log("WARNING attempt to add 2 times the same observer in transform")}},removeObserver:{value:function(e){if(this._observers){var t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}}}})}}),montageDefine("3ef65ed","ui/slider.reel/slider.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-Slider{display:inline-block;-moz-box-sizing:border-box;box-sizing:border-box;width:10em;height:.625em;border-radius:.25em;border:1px solid;outline:none;padding-right:-webkit-calc(1.75em - 2px);padding-right:-moz-calc(1.75em - 2px);padding-right:calc(1.75em - 2px)}.digit-Slider.montage-Slider--vertical{width:.625em;height:10em;margin:0 .625em;padding-right:0;padding-bottom:-webkit-calc(1.75em - 2px);padding-bottom:-moz-calc(1.75em - 2px);padding-bottom:calc(1.75em - 2px)}.digit-Slider-thumb{position:relative;font-size:inherit;-moz-box-sizing:border-box;box-sizing:border-box;width:1.75em;height:1.75em;margin:-.625em 0 0 -1px;border-radius:.875em;border:1px solid;background-color:currentColor;cursor:pointer}.montage-Slider--vertical .digit-Slider-thumb{margin:-1px 0 0 -.625em}.digit-Slider-thumb:after{position:absolute;content:"";top:-16px;left:-16px;bottom:-16px;right:-16px}[data-montage-skin="wireframe"] .digit-Slider{border-color:#b3b3b3;background-color:#d9d9d9}[data-montage-skin="wireframe"] .digit-Slider-thumb{border-color:#b3b3b3;background-color:#f2f2f2}[data-montage-skin="wireframe"] .montage-Slider--active .digit-Slider-thumb{background-color:#e5e5e5}[data-montage-skin="light"] .digit-Slider{border-color:hsla(0,0%,70%,1);background-color:hsl(0,0%,86%);box-shadow:inset 0 1px 2px hsla(0,0%,0%,.1),0 1px 0 hsla(0,0%,100%,.6);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="light"] .digit-Slider-thumb{border-color:hsla(0,0%,70%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));background-image:-moz-linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));background-image:-ms-linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));background-image:linear-gradient(top,hsl(0,0%,98%),hsl(0,0%,84%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.8),0 1px 2px 0 hsla(0,0%,0%,.1),0 7px 6px -3px hsla(0,0%,0%,.15)}[data-montage-skin="light"] .montage-Slider--active .digit-Slider-thumb{border-color:hsla(0,0%,65%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));background-image:-moz-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));background-image:-ms-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));background-image:linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,83%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.8),0 1px 2px 0 hsla(0,0%,0%,.2),0 6px 6px -3px hsla(0,0%,0%,.1)}[data-montage-skin="dark"] .digit-Slider{border-color:hsl(0,0%,15%);background-color:hsl(0,0%,22%);box-shadow:inset 0 1px 2px hsla(0,0%,0%,.25),0 1px 0 hsla(0,0%,100%,.1);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="dark"] .digit-Slider-thumb{border-color:hsl(0,0%,16%);background-image:-webkit-linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));background-image:-moz-linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));background-image:-ms-linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));background-image:linear-gradient(top,hsl(0,0%,36%),hsl(0,0%,24%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.1),0 1px 2px 0 hsla(0,0%,0%,.15),0 7px 6px -3px hsla(0,0%,0%,.25)}[data-montage-skin="dark"] .montage-Slider--active .digit-Slider-thumb{border-color:hsl(0,0%,12%);background-image:-webkit-linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));background-image:-moz-linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));background-image:-ms-linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));background-image:linear-gradient(top,hsl(0,0%,34%),hsl(0,0%,23%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.1),0 1px 2px 0 hsla(0,0%,0%,.2),0 7px 6px -3px hsla(0,0%,0%,.15)}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"slider"},"_sliderThumbElement":{"#":"sliderThumb"}}}}</script></head><body><div data-montage-id=slider class=digit-Slider><div data-montage-id=sliderThumb class=digit-Slider-thumb></div></div></body></html>'}),montageDefine("3ef65ed","ui/button.reel/button.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-Button{display:inline-block;-moz-box-sizing:border-box;box-sizing:border-box;height:2.5em;min-width:2.5em;margin:0 2px;padding:.625em 1em;border-radius:1.25em;vertical-align:middle;font-size:100%;color:inherit;border:1px solid;background-color:transparent;outline:none;cursor:pointer;text-decoration:none;-webkit-tap-highlight-color:transparent}.digit-Button.montage--active{background-color:hsla(0,0%,0%,.06)}.digit-Button:focus{box-shadow:inset 0 0 0 1px}[data-montage-skin="wireframe"] .digit-Button{color:#4D4D4D;border-color:#b3b3b3;background-color:#f2f2f2}[data-montage-skin="wireframe"] .digit-Button.montage--active{background-color:#e5e5e5}[data-montage-skin="wireframe"] .digit-Button:focus{border-color:#4D4D4D;box-shadow:none}[data-montage-skin="light"] .digit-Button{color:hsla(0,0%,0%,.7);text-shadow:0 1px 0 hsla(0,0%,100%,.5);border-color:hsl(0,0%,80%);background-image:-webkit-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:-moz-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:-ms-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.8),inset 0 -1px 1px hsla(0,0%,0%,.04),0 1px 0 hsla(0,0%,100%,.6);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="light"] .digit-Button.montage--active{border-color:hsla(0,0%,70%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:-moz-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:-ms-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.2),0 1px 0 hsla(0,0%,100%,.6)}[data-montage-skin="light"] .digit-Button:focus{border-color:hsl(0,0%,50%)}[data-montage-skin="dark"] .digit-Button{color:hsl(0,0%,80%);text-shadow:0 1px 0 hsla(0,0%,0%,.2);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:-moz-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:-ms-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.1),inset 0 -1px 1px hsla(0,0%,0%,.06),0 1px 0 hsla(0,0%,100%,.1)}[data-montage-skin="dark"] .digit-Button.montage--active{color:hsl(0,0%,60%);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));background-image:-moz-linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));background-image:-ms-linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));background-image:linear-gradient(top,hsl(0,0%,24%),hsl(0,0%,18%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.3),0 1px 0 hsla(0,0%,100%,.1)}[data-montage-skin="dark"] .digit-Button:focus{border-color:hsl(0,0%,50%)}.digit-Button--glass,.digit-Button--glass.montage--active,[data-montage-skin="wireframe"] .digit-Button--glass,[data-montage-skin="wireframe"] .digit-Button--glass.montage--active,[data-montage-skin="light"] .digit-Button--glass,[data-montage-skin="light"] .digit-Button--glass.montage--active,[data-montage-skin="dark"] .digit-Button--glass,[data-montage-skin="dark"] .digit-Button--glass.montage--active{margin:0;border-radius:0;border:none;background:0 0;box-shadow:none}[data-montage-skin="dark"] .digit-Button--glass.montage--active{color:hsla(0,0%,100%,.5)}.digit-ButtonGroup{display:inline-block;vertical-align:middle;padding-left:1px;border-radius:1.25em}.digit-ButtonGroup>.digit-Button{float:left;margin:0 0 0 -1px;border-radius:0}.digit-ButtonGroup>.digit-Button:first-child{border-top-left-radius:inherit;border-bottom-left-radius:inherit}.digit-ButtonGroup>.digit-Button:last-child{border-top-right-radius:inherit;border-bottom-right-radius:inherit}</style></head><body></body></html>'}),montageDefine("3ef65ed","ui/checkbox.reel/checkbox.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-Checkbox{position:relative;display:inline-block;-moz-box-sizing:border-box;box-sizing:border-box;vertical-align:middle;width:1.5em;height:1.5em;border-radius:.25em;border:1px solid;fill:#fff;cursor:pointer;-webkit-tap-highlight-color:transparent}.digit-Checkbox:after{position:absolute;content:"";top:-16px;left:-16px;bottom:-16px;right:-16px}.digit-Checkbox.montage--active,.digit-Checkbox.montage-Checkbox--checked{background-color:currentColor}.digit-Checkbox.montage-Checkbox--disabled{opacity:.5;border-style:dashed;pointer-events:none}.digit-Checkbox-icon{fill:transparent}.digit-Checkbox.montage-Checkbox--checked .digit-Checkbox-icon{fill:inherit}.digit-Checkbox.montage--active .digit-Checkbox-icon{fill:transparent}[data-montage-skin="wireframe"] .digit-Checkbox{fill:#4D4D4D;border-color:#b3b3b3;background-color:#f2f2f2}[data-montage-skin="wireframe"] .digit-Checkbox.montage--active{background-color:#e5e5e5}[data-montage-skin="light"] .digit-Checkbox{fill:hsla(0,0%,0%,.7);border-color:hsl(0,0%,80%);background-image:-webkit-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:-moz-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:-ms-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.8),inset 0 -1px 1px hsla(0,0%,0%,.04),0 1px 0 hsla(0,0%,100%,.6)}[data-montage-skin="light"] .digit-Checkbox.montage--active,[data-montage-skin="light"] .digit-Checkbox.montage-Checkbox--checked{border-color:hsla(0,0%,70%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:-moz-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:-ms-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.2),0 1px 0 hsla(0,0%,100%,.6)}[data-montage-skin="dark"] .digit-Checkbox{fill:hsl(0,0%,80%);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:-moz-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:-ms-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.1),inset 0 -1px 1px hsla(0,0%,0%,.06),0 1px 0 hsla(0,0%,100%,.1)}[data-montage-skin="dark"] .digit-Checkbox.montage--active,[data-montage-skin="dark"] .digit-Checkbox.montage-Checkbox--checked{border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,20%),hsl(0,0%,16%));background-image:-moz-linear-gradient(top,hsl(0,0%,20%),hsl(0,0%,16%));background-image:-ms-linear-gradient(top,hsl(0,0%,20%),hsl(0,0%,16%));background-image:linear-gradient(top,hsl(0,0%,20%),hsl(0,0%,16%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.3),0 1px 0 hsla(0,0%,100%,.1)}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"checkbox"}}}}</script></head><body><span data-montage-id=checkbox class=digit-Checkbox><svg viewBox="0 0 22 22"><path class=digit-Checkbox-icon d="M16.7134505,5.23925421 L17.8369808,6.36278454 C18.1579559,6.68375963 18.155261,7.18928629 17.8417994,7.50274785 L9.90369523,15.4408521 C9.58826333,15.756284 9.07985473,15.7521563 8.76373192,15.4360335 L7.6402016,14.3125031 C7.63973757,14.3120391 7.63927421,14.3115747 7.63896013,14.3112519 C7.63816313,14.3104614 7.63736736,14.3096689 7.63657284,14.3088744 L4.23073621,10.9030377 C3.92224924,10.5945508 3.92161045,10.0813757 4.23773325,9.76525291 L5.36126357,8.64172251 C5.68223867,8.32074751 6.18679,8.32246711 6.49904844,8.63472551 L9.33612283,11.4717999 L15.5734872,5.23443561 C15.8889191,4.91900366 16.3973277,4.92313142 16.7134505,5.23925421 C16.7134505,5.23925421 16.3973277,4.92313142 16.7134505,5.23925421 L16.7134505,5.23925421 L16.7134505,5.23925421 Z"></path></svg></span></body></html>'}),montageDefine("7f00df0","ui/den.reel/den.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Den{position:relative;width:346px;height:346px}.Den-activation-area{position:absolute;z-index:3;top:12px;left:36px;width:276px;height:276px;border-radius:138px}.Den:after{top:0;left:0;bottom:0;right:0;background-image:url(packages/den@7f00df0/ui/den.reel/nest-overlay.png);background-size:346px 346px}.Den:after,.Den:before{content:"";position:absolute}.Den:before{left:97px;top:74px;background:#000;width:154px;height:124px}.Den-left-red-bar,.Den-right-red-bar,.Den-left-blue-bar,.Den-right-blue-bar,.Den-black-bar{position:absolute;left:96px;top:73px;width:155.5px;height:77.75px;-webkit-transform-origin:50% 100% 0;-moz-transform-origin:50% 100% 0;-ms-transform-origin:50% 100% 0;transform-origin:50% 100% 0}.Den-left-red-bar,.Den-right-red-bar{background-color:red}.Den-left-blue-bar,.Den-right-blue-bar{background-color:#3af}.Den-black-bar{background-color:#000}.Den-white-bar{width:6.5px;height:19px;position:absolute;background-color:#fff;top:74px;left:170.33px;-webkit-transform-origin:50% 76.75px 0;-moz-transform-origin:50% 76.75px 0;-ms-transform-origin:50% 76.75px 0;transform-origin:50% 76.75px 0}.Den-red-fading-bar{background-color:red}.Den-red-fading-bar,.Den-blue-fading-bar{width:6.5px;height:19px;position:absolute;top:74px;left:170.33px;-webkit-transform-origin:50% 76.75px 0;-moz-transform-origin:50% 76.75px 0;-ms-transform-origin:50% 76.75px 0;transform-origin:50% 76.75px 0}.Den-blue-fading-bar{background-color:#3af}.Den-left-digit-clip{left:128px}.Den-left-digit-clip,.Den-right-digit-clip{position:absolute;pointer-events:none;overflow:hidden;z-index:2;width:50px;height:73px;top:112px}.Den-right-digit-clip{left:168px}.Den-left-digit,.Den-right-digit{pointer-events:none;width:500px;height:73px;background-image:url(packages/den@7f00df0/ui/den.reel/numbers.png);background-size:500px 73px;-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.Den-icon{position:absolute;pointer-events:none;z-index:2;width:64px;height:64px;left:141px;top:173px;background-repeat:no-repeat;background-size:64px 64px}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/den.reel","properties":{"element":{"#":"Den"},"_rotateComposer":{"@":"rotateComposer"},"blackBar":{"#":"blackBar"},"blueFadingBar":{"#":"blueFadingBar"},"iconElement":{"#":"icon"},"leftBlueBar":{"#":"leftBlueBar"},"leftDigit":{"#":"leftDigit"},"leftRedBar":{"#":"leftRedBar"},"redFadingBar":{"#":"redFadingBar"},"rightBlueBar":{"#":"rightBlueBar"},"rightDigit":{"#":"rightDigit"},"rightRedBar":{"#":"rightRedBar"},"whiteBar":{"#":"whiteBar"},"activationArea":{"#":"activationArea"}}},"rotateComposer":{"prototype":"core/rotation-composer","properties":{"component":{"@":"owner"},"element":{"#":"activationArea"},"unit":"degrees"},"listeners":[{"type":"rotate","listener":{"@":"owner"}},{"type":"rotateEnd","listener":{"@":"owner"}}]}}</script></head><body><div data-montage-id=Den class=Den><div data-montage-id=activationArea class=Den-activation-area></div><div data-montage-id=leftRedBar class=Den-left-red-bar></div><div data-montage-id=rightRedBar class=Den-right-red-bar></div><div data-montage-id=leftBlueBar class=Den-left-blue-bar></div><div data-montage-id=rightBlueBar class=Den-right-blue-bar></div><div data-montage-id=blackBar class=Den-black-bar></div><div data-montage-id=icon class=Den-icon></div><div data-montage-id=whiteBar class=Den-white-bar></div><div data-montage-id=redFadingBar class=Den-red-fading-bar></div><div data-montage-id=blueFadingBar class=Den-blue-fading-bar></div><div class=Den-left-digit-clip><div data-montage-id=leftDigit class=Den-left-digit></div></div><div class=Den-right-digit-clip><div data-montage-id=rightDigit class=Den-right-digit></div></div></div></body></html>'
}),montageDefine("22a41ee","ui/static-view.reel/static-view.html",{text:'<!DOCTYPE html><html><head><title></title><style>.StaticView{position:absolute;top:0;right:0;bottom:0;left:0;background-image:url(assets/static/ride-viewpoint.jpg);background-repeat:no-repeat;background-position:center;background-size:cover;-webkit-transition:background-image .6s;transition:background-image .6s}.StaticView-webglNotice{padding:10px;font-size:12px;text-align:center;line-height:1.4;color:#eee;text-shadow:0 1px 2px hsla(0,0%,0%,.5);background-color:hsla(0,0%,20%,.65)}.StaticView-webglNotice-logo{vertical-align:middle;height:30px;margin-right:10px}.StaticView-webglNotice-highlight{color:#c5e265;font-weight:700;text-decoration:none}.StaticView--counters{background-image:url(assets/static/countertop-viewpoint.jpg)}.StaticView--kitchen{background-image:url(assets/static/kitchen-viewpoint.jpg)}.StaticView--laundry{background-image:url(assets/static/laundry-viewpoint.jpg)}.StaticView--staircase{background-image:url(assets/static/staircase-viewpoint.jpg)}.StaticView--windows{background-image:url(assets/static/windows-viewpoint.jpg)}.StaticView .ConfigPreview--staircase-pine{background-image:url(assets/static/staircase-pine.jpg)}.StaticView .ConfigPreview--staircase-ash{background-image:url(assets/static/staircase-ash.jpg)}.StaticView .ConfigPreview--staircase-walnut{background-image:url(assets/static/staircase-walnut.jpg)}.StaticView .ConfigPreview--staircase-bold{background-image:url(assets/static/staircase-bold.jpg)}.StaticView .ConfigPreview--countertop-paper{background-image:url(assets/static/countertop-paper.jpg)}.StaticView .ConfigPreview--countertop-bamboo{background-image:url(assets/static/countertop-bamboo.jpg)}.StaticView .ConfigPreview--countertop-cement{background-image:url(assets/static/countertop-cement.jpg)}.StaticView .ConfigPreview--countertop-quartz{background-image:url(assets/static/countertop-quartz.jpg)}.StaticView .ConfigPreview--kitchen{background-image:none;background-color:hsl(0,0%,80%)}.StaticView .ConfigPreview--kitchen-gutersloh{background-image:url(assets/static/kitchen-gutersloh.jpg)}.StaticView .ConfigPreview--kitchen-norse{background-image:url(assets/static/kitchen-norse.jpg)}.StaticView .ConfigPreview--kitchen-vortex{background-image:url(assets/static/kitchen-vortex.jpg)}@media (orientation:portrait){.StaticView-webglNotice{padding:10px 80px}.StaticView-webglNotice-logo{margin-bottom:5px}.StaticView-webglNotice-highlight{display:block}}@media (orientation:landscape) and (max-width:900px),(orientation:landscape) and (max-height:340px){.StaticView-webglNotice,.StaticView-swatches{display:none}}@media (orientation:portrait) and (max-height:560px){.StaticView-webglNotice,.StaticView-swatches{display:none}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/static-view.reel","properties":{"element":{"#":"staticView"}}},"countertop":{"prototype":"./config-preview.reel","properties":{"element":{"#":"countertop"},"label":"Countertop"}},"kitchen":{"prototype":"./config-preview.reel","properties":{"element":{"#":"kitchen"},"label":"Kitchen"}},"staircase":{"prototype":"./config-preview.reel","properties":{"element":{"#":"staircase"},"label":"Staircase"}},"logo":{"prototype":"digit/ui/image.reel","properties":{"element":{"#":"logo"},"src":"../../assets/images/webgl.png"}}}</script></head><body><div data-montage-id=staticView class=StaticView><div class=StaticView-webglNotice><img data-montage-id=logo class=StaticView-webglNotice-logo src=""> <a class=StaticView-webglNotice-highlight href=http://get.webgl.org target=_blank>This demo highlights WebGL.</a> Please check your browser\'s WebGL support.</div><section class=StaticView-swatches><div data-montage-id=countertop></div><div data-montage-id=kitchen></div><div data-montage-id=staircase></div></section></div></body></html>'}),montageDefine("22a41ee","core/call-controller",{dependencies:["montage","montage/core/promise","montage/core/state-chart","montage/core/state-chart","q-connection","q-connection/adapt"],factory:function(e,t,i){var n=e("montage").Montage,r=e("montage/core/promise").Promise,a=e("montage/core/state-chart").StateChart,s=e("montage/core/state-chart").State,o=e("q-connection"),l=e("q-connection/adapt");t.CallController=n.specialize({constructor:{value:function(){var e,t,i,n,r,o=this;t=(new s).init({call:function(e,t,i){this.gotoState("callingNow")},later:function(e,t,i){this.gotoState("callLater")}}),n=(new s).init({enterState:function(){o.callStatus="",o.makeContactCall().caught(function(){o.errors.push({message:"A server error has occured"})})},cancel:function(e,t,i){o.cancelCall(),this.gotoState("callNow")},end:function(e,t,i){this.gotoState("callNow")}}),i=(new s).init({call:function(e,t,i){this.gotoState("callingLater")},now:function(e,t,i){this.gotoState("callNow")}}),r=(new s).init({cancel:function(e,t,i){this.gotoState("callNow")}}),e=(new s).init({initialSubstate:"callNow",callNow:t,callingNow:n,callLater:i,callingLater:r}),this._stateChart=(new a).initWithState(e),this._stateChart.delegate=this,this.errors=[],this.defineBinding("currentState",{"<-":"_stateChart.currentState.name"})}},server:{value:null},_stateChart:{value:null},stateChartWillGoFromStateToState:{value:function(e,t,i){this.callDelegateMethod("stateDidChange",this,i.name)}},stateChartShouldGoFromStateToState:{value:function(e,t,i){return this.clearErrors(),!("callingNow"===i.name&&!this.validatePhoneNumber()&&(this.errors.push({message:"Phone number not valid"}),1))}},call:{value:function(){this._stateChart.performAction("call")}},later:{value:function(){this._stateChart.performAction("later")}},cancel:{value:function(){this._stateChart.performAction("cancel")}},callEnded:{value:function(){this._stateChart.performAction("end")}},_currentCall:{value:null},makeContactCall:{value:function(){var e=this;return this.backend.get("calls").invoke("makeCall",this._normalizedPhoneNumber,function(e){this.callStatus=e}.bind(this),function(){this.callEnded()}.bind(this)).then(function(t){e._currentCall=t})}},cancelCall:{value:function(){return this._currentCall?this._currentCall.invoke("cancel"):r.reject()}},_post:{value:function(e,t,i){var n,a=r.defer(),s=new XMLHttpRequest;return s.open("POST",e,!0),s.onreadystatechange=function(){4===s.readyState&&(200===s.status?(n&&clearTimeout(n),a.resolve(s.responseText)):a.reject("HTTP "+s.status+" for "+e))},i&&(n=setTimeout(a.reject,i)),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(t.join("&")),a.promise}},clearErrors:{value:function(){this.errors.clear()}},_phoneNumberRegex:{value:/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/},validatePhoneNumber:{value:function(){return null!=this.phoneNumber&&this._phoneNumberRegex.test(this.phoneNumber)?(this._normalizedPhoneNumber=this.phoneNumber.replace(this._phoneNumberRegex,"$1$2$3"),!0):null!=this.phoneNumber&&this._phoneNumberRegex.test(this.phoneNumber)}},errors:{value:null},phoneNumber:{value:null},callStatus:{value:""},_normalizedPhoneNumber:{value:null},identifier:{value:"callController"},alive:{value:function(){if(null===this.server)return r.resolve();var e,t=500,i=new XMLHttpRequest,n="http://"+this.server+"/alive",a=new r(function(r,a){i.open("GET",n,!0),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?(e&&clearTimeout(e),r(i.responseText)):a(new Error("HTTP "+i.status+" for "+n)))},e=setTimeout(a,t-50)});return i.send(),a.timeout(t)}},_backend:{value:null},backend:{get:function(){if(null==this._backend){var e=l(new WebSocket("ws://"+this.server));e.closed.then(function(){this._backend=null}),this._backend=o(e)}return this._backend}}})}}),montageDefine("b0111a3","ui/base/abstract-radio-button",{dependencies:["./abstract-control","../../composer/press-composer","../../composer/key-composer"],factory:function(e,t,i){var n=e("./abstract-control").AbstractControl,r=e("../../composer/press-composer").PressComposer,a=e("../../composer/key-composer").KeyComposer,s="montage--disabled",o="montage--active",l="montage-RadioButton--checked";t.AbstractRadioButton=n.specialize({constructor:{value:function u(){if(this.constructor===u)throw new Error("AbstractRadioButton cannot be instantiated.")}},_active:{value:!1},active:{set:function(e){e=!!e,this._active!==e&&(this._active=e,e?this.classList.add(this.activeClass):this.classList.remove(this.activeClass))},get:function(){return this._active}},_checked:{value:null},checked:{set:function(e){e=!!e,this._checked!==e&&(this._checked=e,e?this.classList.add(this.checkedClass):this.classList.remove(this.checkedClass))},get:function(){return this._checked}},_disabledClass:{value:null},disabledClass:{set:function(e){var t=this.disabledClass;e&&"string"==typeof e&&t!==e&&(this._swapClassNameIfNeeded(t,e),this._disabledClass=e)},get:function(){return this._disabledClass||s}},_activeClass:{value:null},activeClass:{set:function(e){var t=this.activeClass;e&&"string"==typeof e&&t!==e&&(this._swapClassNameIfNeeded(t,e),this._activeClass=e)},get:function(){return this._activeClass||o}},_checkedClass:{value:null},checkedClass:{set:function(e){var t=this.checkedClass;e&&"string"==typeof e&&t!==e&&(this._swapClassNameIfNeeded(t,e),this._checkedClass=e)},get:function(){return this._checkedClass||l}},_swapClassNameIfNeeded:{value:function(e,t){e&&t&&this.classList.has(e)&&(this.classList.remove(e),this.classList.add(t))}},_enabled:{value:!0},enabled:{set:function(e){e=!!e,this._enabled!==e&&(this._enabled=e,e?this.classList.remove(this.disabledClass):this.classList.add(this.disabledClass))},get:function(){return this._enabled}},__keyComposer:{value:null},_keyComposer:{get:function(){return this.__keyComposer||(this.__keyComposer=new a,this.__keyComposer.keys="space",this.addComposer(this.__keyComposer)),this.__keyComposer}},_radioButtonController:{value:null},radioButtonController:{set:function(e){this._radioButtonController&&this._radioButtonController.unregisterRadioButton(this),this._radioButtonController=e,e.registerRadioButton(this)},get:function(){return this._radioButtonController}},__pressComposer:{value:null},_pressComposer:{get:function(){return this.__pressComposer||(this.__pressComposer=new r,this.addComposer(this.__pressComposer)),this.__pressComposer}},enterDocument:{value:function(e){e&&this.element.setAttribute("role","radio")}},draw:{value:function(){this.checked?this.element.setAttribute("aria-checked","true"):this.element.setAttribute("aria-checked","false")}},handlePressStart:{value:function(e){this.active=!0,e.touch&&document.addEventListener("touchmove",this,!1)}},check:{value:function(){this.enabled&&!this.checked&&(this.dispatchActionEvent(),this.checked=!0)}},handlePress:{value:function(){this.active=!1,this.check()}},handlePressCancel:{value:function(){this.active=!1,document.removeEventListener("touchmove",this,!1)}},handleKeyPress:{value:function(){this.active=!0}},handleKeyRelease:{value:function(){this.active=!1,this.check()}},prepareForActivationEvents:{value:function(){this._keyComposer.addEventListener("keyPress",this,!1),this._keyComposer.addEventListener("keyRelease",this,!1),this._pressComposer.addEventListener("pressStart",this,!1),this._pressComposer.addEventListener("press",this,!1),this._pressComposer.addEventListener("pressCancel",this,!1)}},activate:{value:function(){this.check()}}})}}),montageDefine("3ef65ed","ui/text-field.reel/text-field.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-TextField{outline:none;box-sizing:border-box;font-size:100%;width:10em;height:2.5em;padding:0 .5em;vertical-align:middle;color:inherit;border:1px solid;border-radius:.25em;background-color:transparent;-webkit-tap-highlight-color:transparent;-webkit-appearance:none}.digit-TextField:focus{box-shadow:inset 0 0 0 1px}.digit-TextField.montage--disabled{opacity:.5;border-style:dashed;pointer-events:none}.digit-TextField:invalid{color:#E73525}.digit-TextField[readonly]{background-color:#e5e5e5}.digit-TextField::-webkit-input-placeholder{color:inherit;opacity:.5}.digit-TextField::-moz-placeholder{color:inherit;opacity:.5}.digit-TextField:-ms-input-placeholder{color:inherit;opacity:.5}[data-montage-skin="wireframe"] .digit-TextField{color:#4D4D4D;border-color:#b3b3b3;background-color:#fff}[data-montage-skin="wireframe"] .digit-TextField:focus{border-color:#7f7f7f;box-shadow:none}[data-montage-skin="wireframe"] .digit-TextField:invalid{color:#E73525;border-color:#E73525}[data-montage-skin="light"] .digit-TextField{color:hsla(0,0%,0%,.7);text-shadow:0 1px 0 hsla(0,0%,100%,.5);border-color:hsl(0,0%,80%);background-image:-webkit-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));background-image:-moz-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));background-image:-ms-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));background-image:linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,98%));box-shadow:inset 0 1px 2px hsla(0,0%,0%,.05),0 1px 0 hsla(0,0%,100%,.6);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="light"] .digit-TextField:focus{border-color:hsla(0,0%,70%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));background-image:-moz-linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));background-image:-ms-linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));background-image:linear-gradient(top,hsl(0,0%,92%),hsl(0,0%,94%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.1),0 1px 0 hsla(0,0%,100%,.6)}[data-montage-skin="light"] .digit-TextField:invalid{color:#E73525;border-color:#E73525}[data-montage-skin="dark"] .digit-TextField{color:hsl(0,0%,80%);text-shadow:0 1px 0 hsla(0,0%,0%,.2);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));background-image:-moz-linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));background-image:-ms-linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));background-image:linear-gradient(top,hsl(0,0%,28%),hsl(0,0%,30%));box-shadow:inset 0 1px 2px hsla(0,0%,0%,.1),0 1px 0 hsla(0,0%,100%,.1);-webkit-transform:translate3d(0,0,0);-moz-transform:translate3d(0,0,0);-ms-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}[data-montage-skin="dark"] .digit-TextField:focus{color:hsl(0,0%,100%);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));background-image:-moz-linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));background-image:-ms-linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));background-image:linear-gradient(top,hsl(0,0%,26%),hsl(0,0%,28%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.3),0 1px 0 hsla(0,0%,100%,.1)}[data-montage-skin="dark"] .digit-TextField:invalid{color:#FF6052;border-color:#FF6052}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"textField"}}}}</script></head><body><input data-montage-id=textField class=digit-TextField></body></html>'}),montageDefine("3ef65ed","ui/radio-button.reel/radio-button.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.digit-RadioButton{position:relative;display:inline-block;-moz-box-sizing:border-box;box-sizing:border-box;vertical-align:middle;width:1.5em;height:1.5em;border-radius:1.5em;border:1px solid;fill:#fff;cursor:pointer;-webkit-tap-highlight-color:transparent}.digit-RadioButton:after{position:absolute;content:"";top:-16px;left:-16px;right:-16px;bottom:-16px;border-radius:100px}.digit-RadioButton.montage--active,.digit-RadioButton.montage-RadioButton--checked{background-color:currentColor}.digit-RadioButton.montage-RadioButton--disabled{opacity:.5;border-style:dashed;pointer-events:none}.digit-RadioButton-icon{fill:transparent}.digit-RadioButton.montage-RadioButton--checked .digit-RadioButton-icon{fill:inherit}.digit-RadioButton.montage--active .digit-RadioButton-icon{fill:transparent}[data-montage-skin="wireframe"] .digit-RadioButton{fill:#4D4D4D;border-color:#b3b3b3;background-color:#f2f2f2}[data-montage-skin="wireframe"] .digit-RadioButton.montage--active{background-color:#e5e5e5}[data-montage-skin="light"] .digit-RadioButton{fill:hsla(0,0%,0%,.7);border-color:hsl(0,0%,80%);background-image:-webkit-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:-moz-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:-ms-linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));background-image:linear-gradient(top,hsl(0,0%,96%),hsl(0,0%,92%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.8),inset 0 -1px 1px hsla(0,0%,0%,.04),0 1px 0 hsla(0,0%,100%,.6)}[data-montage-skin="light"] .digit-RadioButton.montage--active,[data-montage-skin="light"] .digit-RadioButton.montage-RadioButton--checked{border-color:hsla(0,0%,70%,1);background-image:-webkit-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:-moz-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:-ms-linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));background-image:linear-gradient(top,hsl(0,0%,90%),hsl(0,0%,86%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.2),0 1px 0 hsla(0,0%,100%,.6)}[data-montage-skin="dark"] .digit-RadioButton{fill:hsl(0,0%,80%);border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:-moz-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:-ms-linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));background-image:linear-gradient(top,hsl(0,0%,30%),hsl(0,0%,24%));box-shadow:inset 0 1px 1px hsla(0,0%,100%,.1),inset 0 -1px 1px hsla(0,0%,0%,.06),0 1px 0 hsla(0,0%,100%,.1)}[data-montage-skin="dark"] .digit-RadioButton.montage--active,[data-montage-skin="dark"] .digit-RadioButton.montage-RadioButton--checked{border-color:hsl(0,0%,15%);background-image:-webkit-linear-gradient(top,hsl(0,0%,20%),hsl(0,0%,16%));background-image:-moz-linear-gradient(top,hsl(0,0%,20%),hsl(0,0%,16%));background-image:-ms-linear-gradient(top,hsl(0,0%,20%),hsl(0,0%,16%));background-image:linear-gradient(top,hsl(0,0%,20%),hsl(0,0%,16%));box-shadow:inset 0 1px 3px hsla(0,0%,0%,.3),0 1px 0 hsla(0,0%,100%,.1)}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"radioButton"}}}}</script></head><body><span data-montage-id=radioButton class=digit-RadioButton><svg viewBox="0 0 22 22"><path class=digit-RadioButton-icon d="M11,16 C13.7614239,16 16,13.7614239 16,11 C16,8.23857611 13.7614239,6 11,6 C8.23857611,6 6,8.23857611 6,11 C6,13.7614239 8.23857611,16 11,16 L11,16 Z"></path></svg></span></body></html>'}),montageDefine("b0111a3","ui/base/abstract-button",{dependencies:["./abstract-control","../../composer/press-composer"],factory:function(e,t,i){var n=e("./abstract-control").AbstractControl,r=e("../../composer/press-composer").PressComposer;t.AbstractButton=n.specialize({constructor:{value:function a(){if(this.constructor===a)throw new Error("AbstractButton cannot be instantiated.");this._pressComposer=new r,this.addComposer(this._pressComposer),this._pressComposer.defineBinding("longPressThreshold ",{"<-":"holdThreshold",source:this}),this.defineBinding("classList.has('montage--disabled')",{"<-":"!enabled"}),this.defineBinding("classList.has('montage--active')",{"<-":"active"})}},enabled:{value:!0},_preventFocus:{value:!1},preventFocus:{get:function(){return this._preventFocus},set:function(e){this._preventFocus=!!e,this.needsDraw=!0}},acceptsActiveTarget:{value:function(){return!this._preventFocus}},willBecomeActiveTarget:{value:function(e){}},_labelNode:{value:void 0,enumerable:!1},_label:{value:void 0,enumerable:!1},label:{get:function(){return this._label},set:function(e){if("undefined"!=typeof e&&this.converter)try{e=this.converter.convert(e),this.error&&(this.error=null)}catch(t){this.error=t}this._label=""+e,this.needsDraw=!0}},holdThreshold:{value:1e3},_pressComposer:{value:null},_active:{value:!1},active:{get:function(){return this._active},set:function(e){this._active=e,this.needsDraw=!0}},prepareForActivationEvents:{value:function(){this._pressComposer.addEventListener("pressStart",this,!1),this._pressComposer.addEventListener("press",this,!1),this._pressComposer.addEventListener("pressCancel",this,!1)}},addEventListener:{value:function(e,t,i){n.prototype.addEventListener.call(this,e,t,i),"longAction"===e&&this._pressComposer.addEventListener("longPress",this,!1)}},handlePressStart:{value:function(e){this.active=!0,e.touch&&document.addEventListener("touchmove",this,!1),this._preventFocus||this._element.focus()}},handlePress:{value:function(e){this.active=!1,this.dispatchActionEvent(),document.removeEventListener("touchmove",this,!1)}},handleKeyup:{value:function(e){32===e.keyCode&&(this.active=!1,this.dispatchActionEvent())}},handleLongPress:{value:function(e){this._pressComposer.cancelPress();var t=document.createEvent("CustomEvent");t.initCustomEvent("longAction",!0,!0,null),this.dispatchEvent(t)}},handlePressCancel:{value:function(e){this.active=!1,document.removeEventListener("touchmove",this,!1)}},handleTouchmove:{value:function(e){e.preventDefault()}},isInputElement:{value:!1},enterDocument:{value:function(e){e&&(this.isInputElement="INPUT"===this.originalElement.tagName,this.isInputElement?void 0===this._label&&(this.label=this.originalElement.value):(this.originalElement.firstChild||this.originalElement.appendChild(document.createTextNode("")),this._labelNode=this.originalElement.firstChild,void 0===this._label&&(this.label=this._labelNode.data)),this.element.setAttribute("role","button"),this.element.addEventListener("keyup",this,!1))}},_drawLabel:{enumerable:!1,value:function(e){this.isInputElement?this._element.value=e:this._labelNode&&(this._labelNode.data=e)}},draw:{value:function(){this._elementNeedsTabIndex()&&(this._preventFocus?this.element.removeAttribute("tabindex"):this.element.setAttribute("tabindex","-1")),this.isInputElement&&(this.element.disabled=!this.enabled),this._drawLabel(this.label)}},_elementNeedsTabIndexRegex:{value:/INPUT|TEXTAREA|A|SELECT|BUTTON|LABEL/},_elementNeedsTabIndex:{value:function(){return null===this.element.tagName.match(this._elementNeedsTabIndexRegex)}}})}}),montageDefine("b0111a3","ui/base/abstract-image",{dependencies:["../component","../../core/mini-url","collections/map"],factory:function(e,t,i){var n=e("../component").Component,r=e("../../core/mini-url"),a=e("collections/map");"undefined"!=typeof window&&(a=window.Map||a),t.AbstractImage=n.specialize({constructor:{value:function s(){if(this.constructor===s)throw new Error("AbstractImage cannot be instantiated.");this.addPathChangeListener("_ownerDocumentPart",this,"_rebaseSrc")}},emptyImageSrc:{value:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},_isLoadingImage:{value:!1},_image:{value:null},_src:{value:null},src:{set:function(e){this._src!==e&&(this._src=e,e=this._getRebasedSrc(),e?(this._isInvalidSrc=!1,this._loadImage(e)):this._isInvalidSrc=!0,this.needsDraw=!0)},get:function(){return this._src}},_loadImage:{value:function(e){this._image&&e===this._image.src||(this._image&&this.constructor.checkinImage(this._image),this._image=this.constructor.checkoutImageWithUrl(e,this),this._isLoadingImage=!this._image.complete)}},_isInvalidSrc:{value:!0},width:{value:null},height:{value:null},_textAlternative:{value:null},textAlternative:{set:function(e){this._textAlternative=e,this.needsDraw=!0},get:function(){return this._textAlternative}},_crossOrigin:{value:null},crossOrigin:{set:function(e){e!==this._crossOrigin&&(this._crossOrigin=e,this.needsDraw=!0)},get:function(){return this._crossOrigin}},_rebaseSrc:{value:function(){var e;e=this._getRebasedSrc(),e&&(this._isInvalidSrc=!1,this._loadImage(e),this.needsDraw=!0)}},_getRebasedSrc:{value:function(){return this._getRebasedUrl(this._src)}},_getRebasedEmptySrc:{value:function(){return this._getRebasedUrl(this.emptyImageSrc)}},_getRebasedUrl:{value:function(e){var t,i=/^[\w\-]+:|^\//;if(e){if(i.test(e))return e;if(this._ownerDocumentPart&&(t=this._ownerDocumentPart.template.getBaseUrl()))return r.resolve(t,e)}return null}},enterDocument:{value:function(e){e&&this.element.setAttribute("role","img")}},draw:{value:function(){var e;e=this._isLoadingImage||this._isInvalidSrc?this._getRebasedEmptySrc():this._getRebasedSrc(),null==this._crossOrigin||"data:"===e.slice(0,5)?this.element.removeAttribute("crossorigin"):this.element.setAttribute("crossorigin",this._crossOrigin),this.element.src=e,this.element.setAttribute("aria-label",this._textAlternative)}},handleLoad:{value:function(e){this._isLoadingImage=!1,this.needsDraw=!0,e.target.removeEventListener("load",this,!1)}}},{checkoutImageWithUrl:{value:function(e,t){var i=this._imageCache.get(e);return i?i.complete?t.handleLoad({target:i}):i.addEventListener("load",t,!1):(i=this._imagePool.pop()||new Image,i.addEventListener("load",t,!1),i.src=e,this._imageCache.set(e,i),this._imageCacheSize++),this._imagesToClear["delete"](i),this._imageReferenceCount.set(i,(this._imageReferenceCount.get(i)||0)+1),i}},checkinImage:{value:function(e){var t=this._imageReferenceCount.get(e)-1;0===t?(this._imagesToClear.set(e,Date.now()),this._clearImageInterval||(this._clearImageInterval=setInterval(this._clearImage,this.clearCacheInterval,this))):this._imageReferenceCount.set(e,t)}},_clearImage:{value:function(e){e._imagesToClear.forEach(function(t,i){Date.now()-t>this.maxTimeUnused&&(e._imagePool.push(i),e._imageReferenceCount["delete"](i),e._imageCache["delete"](i.src),i.src=void 0)})}},_imagePool:{value:[]},_imagesToClear:{value:new a},_imageReferenceCount:{value:new a},_imageCache:{value:new a},clearCacheInterval:{value:6e4},maxTimeUnused:{value:6e4},_imageCacheSize:{value:0}})}}),montageDefine("b0111a3","ui/flow.reel/flow.html",{text:'<!DOCTYPE html><html><head><meta charset=utf-8><style>.montage-Flow{overflow:hidden}.montage-Flow,.montage-Flow-camera,.montage-Flow-Repetition{position:absolute;top:0;left:0;bottom:0;right:0;-webkit-transform:translateZ(0);-moz-transform:translateZ(0);-ms-transform:translateZ(0);transform:translateZ(0)}.montage-Flow-camera,.montage-Flow-Repetition{-webkit-transform-style:preserve-3d;-moz-transform-style:preserve-3d;-ms-transform-style:preserve-3d;transform-style:preserve-3d}.montage-Flow-Repetition .no-transition,.montage-Flow-Repetition .no-transition *{-webkit-transition:none!important;-moz-transition:none!important;-ms-transition:none!important;transition:none!important}.montage-Flow-Repetition>div{position:absolute;top:50%;left:50%;width:0;height:0;-webkit-transform:translateZ(0);-moz-transform:translateZ(0);-ms-transform:translateZ(0);transform:translateZ(0);-webkit-transform-style:preserve-3d;-moz-transform-style:preserve-3d;-ms-transform-style:preserve-3d;transform-style:preserve-3d}.montage-Flow-Slot{position:absolute;top:50%;left:50%;-webkit-transform:translate3d(-50%,-50%,0);-moz-transform:translate3d(-50%,-50%,0);-ms-transform:translate3d(-50%,-50%,0);transform:translate3d(-50%,-50%,0)}.montage-Flow.camera-disabled .montage-Flow-Repetition>div,.montage-Flow.camera-disabled .montage-Flow-Slot{top:0;left:0}</style><script type=text/montage-serialization>{"repetition":{"prototype":"ui/repetition.reel","properties":{"element":{"#":"montage-flow-repetition"}},"bindings":{"isSelectionEnabled":{"<-":"@owner.isSelectionEnabled"},"visibleIndexes":{"<-":"@owner._visibleIndexes"},"contentController":{"<-":"@owner.contentController"}}},"flowTranslateComposer":{"prototype":"ui/flow.reel/flow-translate-composer","properties":{"flow":{"@":"owner"},"invertAxis":true,"allowFloats":true,"minScroll":0},"bindings":{"maxScroll":{"<-":"@owner.length"},"_momentumDuration":{"<-":"@owner.momentumDuration"},"translateStride":{"<-":"@owner.stride"},"scrollingMode":{"<-":"@owner.scrollingMode"},"linearScrollingVector":{"<-":"@owner.linearScrollingVector"},"isLimitedToSingleStride":{"<-":"@owner.isLimitedToSingleStride"},"delegate":{"<-":"@owner"}}},"slot":{"prototype":"ui/slot.reel","properties":{"element":{"#":"montage-flow-slot"}},"bindings":{"content":{"<->":"@owner.slotContent"}}},"owner":{"properties":{"element":{"#":"montage-flow"},"_repetition":{"@":"repetition"},"_flowTranslateComposer":{"@":"flowTranslateComposer"},"_cameraElement":{"#":"montage-flow-camera"}},"bindings":{"scroll":{"<->":"@flowTranslateComposer.scroll"},"selection":{"<->":"@repetition.contentController.selection"},"selectedIndexes":{"<-":"@repetition.selectedIndexes"},"activeIndexes":{"<-":"@repetition.activeIndexes"},"draggedSlideIndex":{"<-":"@flowTranslateComposer._closerIndex"},"_firstIteration":{"<-":"@repetition._drawnIterations.0"}}},":iteration":{"alias":"@repetition:iteration"}}</script></head><body><div data-montage-id=montage-flow class=montage-Flow><div data-montage-id=montage-flow-camera class=montage-Flow-camera><div data-montage-id=montage-flow-repetition class=montage-Flow-Repetition><div data-montage-id=wrapper><div data-param=*></div></div></div><div data-montage-id=montage-flow-slot class=montage-Flow-Slot></div></div></div></body></html>'}),montageDefine("c50fb48","runtime/scene-renderer",{dependencies:["runtime/dependencies/gl-matrix","runtime/technique","runtime/pass","runtime/builtin-assets"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix");var n=e("runtime/technique").Technique,r=e("runtime/pass").ScenePass,a=e("runtime/builtin-assets").BuiltInAssets;t.SceneRenderer=Object.create(Object.prototype,{loadPickingTechnique:{value:function(){var e=this,t=a.assetWithName("pickingTechnique");t.then(function(t){e.technique.rootPass.sceneRenderer.pickingTechnique=t},function(e){},function(e){})}},createTechniqueIfNeeded:{value:function(){if(!this._technique){this._technique=Object.create(n).init();var e=Object.create(r).init();this._technique.passes={defaultPass:e}}}},_webGLRenderer:{value:null,writable:!0},_technique:{value:null,writable:!0},technique:{get:function(){return this._technique},set:function(e){this._technique=e}},compressedMeshDelegate:{value:{handleError:function(e,t){console.log("ERROR:vertexAttributeBufferDelegate:"+e+" :"+t)},decompressAttribsInner_:function(e,t,i,n,r,a,s,o){for(var l=0,u=t;u<i;u++){var c=e.charCodeAt(u);l+=c>>1^-(1&c),n[r]=o*(l+s),r+=a}},decompressIndices_:function(e,t,i,n,r){for(var a=0,s=0;s<i;s++){var o=e.charCodeAt(t++);n[r++]=a-o,0==o&&a++}},decompressMesh:function(e,t,i,n){for(var r=i.decodeScales.length,a=i.decodeOffsets,s=i.decodeScales,o=t.attribRange[0],l=t.attribRange[1],u=o,c=new Float32Array(r*l),h=0;h<r;h++){var d=u+l,m=s[h];m&&this.decompressAttribsInner_(e,u,d,c,h,r,a[h],m),u=d}var p=(t.indexRange[0],3*t.indexRange[1]),g=new Uint16Array(p);this.decompressIndices_(e,u,p,g,0),n(c,g,null,t)},convert:function(e,t){var i=t.mesh.compression;if("won-compression"==i.type){var n=i.indexRange;n&&(n[0]+3*n[1],this.decompressMesh(e,i,i,function(e,i,n,r){t.renderer.setupCompressedMesh(t.mesh,e,i)}))}else{var r=Module.testDecode(e),a=0,s=0;t.mesh,i.compressedData&&(s=i.compressedData.verticesCount,a=i.compressedData.indicesCount/3);for(var o=new ArrayBuffer(r.length),l=new Uint8Array(o),u=0,c=r.length;u<c;u++)l[u]=r.charCodeAt(u);var h=new Uint16Array(o,0,3*a),d=o.slice(Uint16Array.BYTES_PER_ELEMENT*a*3,Uint16Array.BYTES_PER_ELEMENT*a*3+Float32Array.BYTES_PER_ELEMENT*s*3),m=new Float32Array(d),p=Uint16Array.BYTES_PER_ELEMENT*a*3+Float32Array.BYTES_PER_ELEMENT*s*3,g=o.slice(p,p+Float32Array.BYTES_PER_ELEMENT*s*3),f=new Float32Array(g),v=p+Float32Array.BYTES_PER_ELEMENT*s*3,_=o.slice(v,v+Float32Array.BYTES_PER_ELEMENT*s*2),b=new Float32Array(_);t.renderer.setupCompressedMesh2(t.mesh,s,m,f,b,h)}return e},resourceAvailable:function(e,t){}}},scene:{get:function(){return this.technique.rootPass.scene},set:function(e){var t=this,i=this.technique.rootPass.scene;i!=e&&(this.technique.rootPass.scene=e,this.scene.rootNode.apply(function(e,i,n){e.meshes&&e.meshes.forEach(function(e){if(e.compression){var i="text";e.compression.compressedData.mode&&"binary"==e.compression.compressedData.mode&&(i="arraybuffer"),e.compression.compressedData.requestType=i,t.webGLRenderer.resourceManager.getResource(e.compression.compressedData,t.compressedMeshDelegate,{
mesh:e,renderer:t.webGLRenderer})}},this)},!0,null))}},webGLRenderer:{get:function(){return this._webGLRenderer},set:function(e){this._webGLRenderer=e}},init:{value:function(e,t){return this.webGLRenderer=e,this.createTechniqueIfNeeded(),this.loadPickingTechnique(),this}},render:{value:function(e,t){this.technique&&this.technique.execute(this.webGLRenderer,e,t)}}})}}),montageDefine("22a41ee","ui/overview.reel/overview.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Overview{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center;height:90px;padding:0 30px;color:#eee;font-size:12px;background-color:hsla(0,0%,20%,.65);pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.Overview-logo{height:65px;margin-left:-3px}.Overview-price{font-size:24px;text-shadow:0 2px 2px hsla(0,0%,0%,.75);white-space:nowrap;letter-spacing:1px}@media (orientation:landscape) and (max-width:900px) and (min-height:300px){.EcoScore{display:none}}@media (orientation:landscape) and (max-width:700px) and (min-height:300px){.Overview-logo{display:none}.Overview-price{text-align:center;-box-flex:1;flex:1}}@media (orientation:landscape) and (max-width:560px) and (min-height:300px){.Overview{display:none}}@media (orientation:landscape) and (max-width:880px) and (max-height:299px){.Overview{height:auto;padding:10px 20px;background-color:hsla(0,0%,20%,.8)}.Overview-logo{height:30px}.EcoScore-bar{padding-top:0}.EcoScore-title{display:none}.Overview-price{font-size:18px}}@media (orientation:landscape) and (max-width:720px) and (max-height:299px){.Overview{display:none}}@media (orientation:portrait){.Overview{padding:20px;height:50px}}@media (orientation:portrait) and (max-width:460px){.EcoScore-title{display:none}}@media (orientation:portrait) and (max-height:450px),(orientation:portrait) and (max-width:400px){.Overview{height:auto;padding:10px 20px;background-color:hsla(0,0%,20%,.8)}.Overview-logo{height:30px}.EcoScore-bar{padding-top:0}.EcoScore-title{display:none}.Overview-price{font-size:15px}}@media (orientation:portrait) and (max-height:450px){.Overview{padding-right:60px}.usdoe-CostGraph-consumptionBar{width:70px}}@media (orientation:portrait) and (max-height:400px){.Overview{top:0}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/overview.reel","properties":{"element":{"#":"Overview"}}},"ecoScore":{"prototype":"ui/eco-score.reel","properties":{"element":{"#":"ecoScore"},"maxConsumption":10000},"bindings":{"baseConsumption":{"<-":"@owner.configuration.baseConsumption"},"ecoConsumption":{"<-":"@owner.configuration.totalConsumption"}}},"logo":{"prototype":"digit/ui/image.reel","properties":{"element":{"#":"logo"},"src":"../../assets/images/logo-dark.png"}},"numberConverter":{"prototype":"montage/core/converter/number-converter","properties":{"decimals":0,"shorten":false}},"total":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"text"},"value":"Total","converter":{"@":"currencyConverter"}},"bindings":{"value":{"<-":"@owner.configuration.totalPrice"}}},"currencyConverter":{"prototype":"montage/core/converter/currency-converter","properties":{"shorten":false,"decimals":0,"currency":"$","showCurrencyBeforeNumber":true}}}</script></head><body><div data-montage-id=Overview class=Overview><img data-montage-id=logo class=Overview-logo><div data-montage-id=ecoScore class=Overview-score></div><div data-montage-id=text class=Overview-price></div></div></body></html>'}),montageDefine("c50fb48","runtime/projection",{dependencies:["runtime/dependencies/gl-matrix","runtime/base"],factory:function(e,t,i){var n=window;!function(e,n){"object"==typeof t?n(i.exports):"function"==typeof define&&define.amd?define([],function(){return n(e)}):n(e)}(this,function(i){var r;"object"==typeof t?(e("runtime/dependencies/gl-matrix"),r=e("runtime/base").Base):r=n.Base;var a=Object.create(r,{_matrix:{value:null,writable:!0},_type:{value:null,writable:!0},_xfov:{value:0,writable:!0},_yfov:{value:0,writable:!0},_xmag:{value:0,writable:!0},_ymag:{value:0,writable:!0},_znear:{value:0,writable:!0},_zfar:{value:0,writable:!0},_aspectRatio:{value:0,writable:!0},_dirtyFlag:{value:!1,writable:!0},projection:{get:function(){return this._type},set:function(e){this._type!==e&&(this._type=e,this._dirtyFlag=!0)}},xfov:{get:function(){return this._xfov},set:function(e){this._xfov!==e&&(this._xfov=e,this._dirtyFlag=!0)}},yfov:{get:function(){return this._yfov},set:function(e){this._yfov!==e&&(this._yfov=e,this._dirtyFlag=!0)}},xmag:{get:function(){return this._xmag},set:function(e){this._xmag!==e&&(this._xmag=e,this._dirtyFlag=!0)}},ymag:{get:function(){return this._ymag},set:function(e){this._ymag!==e&&(this._ymag=e,this._dirtyFlag=!0)}},znear:{get:function(){return this._znear},set:function(e){this._znear!==e&&(this._znear=e,this._dirtyFlag=!0)}},zfar:{get:function(){return this._zfar},set:function(e){this._zfar!==e&&(this._zfar=e,this._dirtyFlag=!0)}},aspectRatio:{get:function(){return this._aspectRatio},set:function(e){var t=this.matrix;t&&(this.yfov?t[0]=this._scaleX/e:this.xfov&&(t[5]=this._scaleY*e)),this._aspectRatio=e}},_scaleX:{value:0,writable:!0},_scaleY:{value:0,writable:!0},matrix:{get:function(){if(this._dirtyFlag){if("perspective"===this.projection){var e=3.14159265359/360,t=0,i=0;this.yfov&&(i=1/Math.tan(this.yfov*e)),t=this.xfov?1/Math.tan(this.xfov*e):i,0==i&&(i=t),this._scaleX=t,this._scaleY=i,this._matrix=mat4.create(),this._matrix[0]=t,this._matrix[1]=0,this._matrix[2]=0,this._matrix[3]=0,this._matrix[4]=0,this._matrix[5]=i,this._matrix[6]=0,this._matrix[7]=0,this._matrix[8]=0,this._matrix[9]=0,this._matrix[10]=(this.zfar+this.znear)/(this.znear-this.zfar),this._matrix[11]=-1,this._matrix[12]=0,this._matrix[13]=0,this._matrix[14]=2*this.zfar*this.znear/(this.znear-this.zfar),this._matrix[15]=0}else"orthographic"===this.projection?this._matrix=mat4.ortho(-this.xmag,this.xmag,-this.ymag,this.ymag,this.znear,this.zfar):console.log("WARNING: unhandled camera type:"+type);this._dirtyFlag=!1}return this._matrix},set:function(e){this._matrix=e}},initWithDescription:{value:function(e){this.__Base_init(),this.projection=e.projection?e.projection:null,this.xfov=e.xfov?e.xfov:0,this.yfov=e.yfov?e.yfov:0,this.xmag=e.xmag?e.xmag:1,this.ymag=e.ymag?e.ymag:1,this.znear="undefined"!=typeof e.znear?e.znear:1,this.zfar=e.zfar?e.zfar:100,this.aspectRatio=e.aspect_ratio?e.aspect_ratio:0,this.aspectRatio||(this.aspectRatio=e.aspectRatio?e.aspectRatio:0),this._dirtyFlag=!0}},init:{value:function(){this.__Base_init(),this.projection=null,this.xfov=0,this.yfov=0,this.xmag=1,this.ymag=1,this.znear=1,this.zfar=100,this.aspectRatio=4/3,this._dirtyFlag=!0}}});return i&&(i.Projection=a),a})}}),montageDefine("b0111a3","ui/substitution.reel/substitution",{dependencies:["../slot.reel","../../core/promise","../../core/logger"],factory:function(e,t,i){var n=e("../slot.reel").Slot,r=e("../../core/promise").Promise;e("../../core/logger").logger("substitution"),t.Substitution=n.specialize({hasTemplate:{enumerable:!1,value:!1},constructor:{value:function(){this._switchElements=Object.create(null),this._switchComponents=Object.create(null),this._switchComponentTreeLoaded=Object.create(null)}},_allChildComponents:{value:null},deserializedFromTemplate:{value:function(){this._allChildComponents=this.childComponents.slice(0),this.switchValue&&this._loadSwitchComponentTree(this.switchValue)}},_switchElements:{value:null},_switchComponentTreeLoaded:{value:null},addSwitchElement:{value:function(e,t){if(t.parentNode)throw new Error("Can't handle elements inside the DOM.");this._switchElements[e]=t,this._switchComponents[e]=t.component,this._findFringeComponents(t,this._allChildComponents)}},_findFringeComponents:{value:function(e,t){var i;if(t=t||[],e.component)t.push(e.component);else{i=e.children;for(var n,r=0;n=i[r];r++)this._findFringeComponents(n,t)}return t}},_drawnSwitchValue:{value:null},_switchValue:{value:null},switchValue:{get:function(){return this._switchValue},set:function(e){this._switchValue===e||this._isSwitchingContent||(this._switchValue=e,this._firstDraw||this.isDeserializing||this._loadContent(e))}},enterDocument:{value:function(e){var t;if(n.prototype.enterDocument.apply(this,arguments),e){t=this.getDomArgumentNames();for(var i,r=0;i=t[r];r++)this._switchElements[i]=this.extractDomArgument(i),this._switchComponents[i]=this._switchElements[i].component;this._loadContent(this.switchValue),this._updateComponentDom()}}},_loadContent:{value:function(e){var t=typeof e;this.content=this._switchElements[e]||null,"string"!==t&&"number"!==t||this._switchComponentTreeLoaded[e]||this._loadSwitchComponentTree(e)}},contentDidChange:{value:function(e,t){n.prototype.contentDidChange.call(this,e,t),this._drawnSwitchValue&&this._switchComponents[this._drawnSwitchValue]&&(this._switchElements[this._drawnSwitchValue]=this._switchComponents[this._drawnSwitchValue].element),this._drawnSwitchValue=this._switchValue}},_loadSwitchComponentTree:{value:function(e){var t,i,n=this,a=this._allChildComponents,s=this._switchElements[e],o=this.element,l=this.canDrawGate,u=[];s||(s=this._getSubstitutionDomArgument(e));for(var c=0;c<a.length;c++){for(t=a[c],i=t.element;i!==s&&i!==o&&i.parentNode;)i=i.parentNode;i===s&&u.push(t.loadComponentTree())}u.length>0?(l.setField(e+"ComponentTreeLoaded",!1),r.all(u).then(function(){n._switchComponentTreeLoaded[e]=!0,l.setField(e+"ComponentTreeLoaded",!0),n._canDraw=!0,n.needsDraw=!0})):(this._switchComponentTreeLoaded[e]=!0,this.needsDraw=!0)}},_getSubstitutionDomArgument:{value:function(e){var t,i,n,r,a,s,o=this._ownerDocumentPart.template;n=this.element,t=n.querySelectorAll("*["+this.DOM_ARG_ATTRIBUTE+"='"+e+"']");e:for(var l,u=0;l=t[u];u++){for(i=l;(i=i.parentNode)!==n;)if(r=o.getElementId(i),r&&(a=o.getSerialization(),s=a.getSerializationLabelsWithElements(r),s.length>0))continue e;return l}}},shouldLoadComponentTree:{value:!1},transition:{value:null}})}}),montageDefine("22a41ee","ui/panel-flow.reel/panel-flow",{dependencies:["montage/ui/component","montage/composer/key-composer"],factory:function(e,t,i){var n=e("montage/ui/component").Component;e("montage/composer/key-composer").KeyComposer,t.PanelFlow=n.specialize({constructor:{value:function(){this["super"](),this.defineBinding("flow.content",{"<-":"content"}),this.defineBinding("content.defined() ? null : flow.contentController",{"<-":"contentController"})}},handleKeydown:{value:function(e){var t=e.keyCode||e.which;38===t?(this.scrollToPanel(Math.floor(this.flow.scroll-1)),e.preventDefault()):40===t&&(this.scrollToPanel(Math.ceil(this.flow.scroll+1)),e.preventDefault())}},enterDocument:{value:function(e){e&&(document.addEventListener("keydown",this,!1),this._originalFlowPaths=this.flow.paths)}},__height:{value:null},_height:{get:function(){return this.__height},set:function(e){this.__height=e}},__numberOfIterations:{value:null},_numberOfIterations:{get:function(){return this.__numberOfIterations},set:function(e){this.__numberOfIterations=e}},__rowHeight:{value:null},_rowHeight:{get:function(){return this.__rowHeight},set:function(e){this.__rowHeight=e}},__firstIteration:{value:null},_firstIteration:{get:function(){return this.__firstIteration},set:function(e){this.__firstIteration=e,this.needsDraw=!0}},willDraw:{value:function(){var e,t,i,n,r,a,s=[];if("undefined"!=typeof this.__firstIteration&&null!==this.__firstIteration){for(this._width=this.element.clientWidth,this._height=this.element.clientHeight,this._rowHeight=this.__firstIteration.firstElement.clientHeight+20,this.flow.linearScrollingVector=[0,-500*this.__rowHeight/this.__height],n=0;n<this._originalFlowPaths.length;n++){t=this._originalFlowPaths[n],s.push({});for(i in t)if(t.hasOwnProperty(i))if("knots"===i)for(s[n].knots=[],r=0;r<t[i].length;r++){s[n].knots.push(e={});for(a in t[i][r])if(t[i][r].hasOwnProperty(a))switch(a){case"knotPosition":case"nextHandlerPosition":case"previousHandlerPosition":e[a]=[t[i][r][a][0],t[i][r][a][1]*this.__rowHeight/300,t[i][r][a][2]];break;default:e[a]=t[i][r][a]}}else s[n][i]=t[i]}this.flow.paths=s,this.flow.cameraTargetPoint=[0,this.__rowHeight,0],this.flow.cameraPosition=[0,this.__rowHeight,this.__height/2],this.flow.cameraFov=90,this.flow.boundingBoxSize=[1,40*this.__rowHeight,0]}}},_hideNext:{value:!1},draw:{value:function(){this._hideNext&&this.nextPageElement.classList.add("hidden")}},content:{value:null},contentController:{value:null},_scroll:{value:null},scroll:{get:function(){return this._scroll},set:function(e){this._scroll=e,null===this.currentPanelIndex&&this.didTranslateEnd()}},_currentPanelIndex:{value:null},currentPanelIndex:{get:function(){return this._currentPanelIndex},set:function(e){this._currentPanelIndex=e}},didTranslateStart:{value:function(){this.dispatchEventNamed("flowTranslateStart",!0,!1),this._hideNext=!0,this.classList.add("scrolling"),this.needsDraw=!0}},didTranslateEnd:{value:function(){this._currentPanelIndex!==Math.round(this.scroll)&&(this.currentPanelIndex=Math.round(this.scroll)),this.classList.remove("scrolling"),this.needsDraw=!0}},scrollToPanel:{value:function(e){this.flow.startScrollingIndexToOffset(e,0)}}})}}),montageDefine("b0111a3","ui/base/abstract-text-field",{dependencies:["./abstract-control","../../composer/key-composer","../../core/deprecate"],factory:function(e,t,i){var n=e("./abstract-control").AbstractControl,r=e("../../composer/key-composer").KeyComposer,a=e("../../core/deprecate");t.AbstractTextField=n.specialize({constructor:{value:function s(){if(this.constructor===s)throw new Error("AbstractTextField cannot be instantiated.");this.defineBindings({"classList.has('montage--disabled')":{"<-":"!enabled"}})}},hasTemplate:{value:!1},acceptsActiveTarget:{get:function(){return this.callDelegateMethod("shouldBeginEditing",this)!==!1}},delegate:{value:null},enabled:{value:!0},_placeholder:{value:null},placeholderValue:{set:function(e){a.deprecationWarning("placeholderValue","placeholder"),this.placeholder=e},get:function(){return this.placeholder}},placeholder:{set:function(e){this._placeholder=e,this.needsDraw=!0},get:function(){return this._placeholder}},_value:{value:null},value:{set:function(e){e!==this._value&&(this.hasFocus&&!this.callDelegateMethod("shouldAcceptValue",this,e)||(this._value=e,this.needsDraw=!0))},get:function(){return this._value}},errorMessage:{value:null},converter:{value:null},_hasFocus:{value:!1},hasFocus:{set:function(e){this._hasFocus=e},get:function(){return this._hasFocus}},__keyComposer:{value:null},_keyComposer:{get:function(){return this.__keyComposer||(this.__keyComposer=new r,this.__keyComposer.component=this,this.__keyComposer.keys="enter",this.addComposer(this.__keyComposer)),this.__keyComposer}},handleKeyPress:{value:function(e){this.enabled&&e.keyComposer===this._keyComposer&&this.dispatchActionEvent()}},prepareForActivationEvents:{value:function(){this._keyComposer.addEventListener("keyPress",this,!1)}},enterDocument:{value:function(e){e&&(this.element.addEventListener("input",this,!1),this.element.addEventListener("change",this,!1))}},draw:{value:function(){var e,t=this.value,i=this.element.selectionStart,n=this.element.selectionEnd;this.converter&&(t=this.converter.convert(t)),e=typeof t,null===t||"undefined"===e?this.element.value="":"boolean"===e||"object"===e||"number"===e?this.element.value=t.toString():this.element.value=t,this.eventManager.activeTarget===this&&"function"==typeof this.element.setSelectionRange&&this.element.setSelectionRange(i,n),this._placeholder&&this.element.setAttribute("placeholder",this._placeholder),this.element.disabled=!this.enabled}},handleChange:{value:function(){this._updateValueFromDom()}},handleInput:{value:function(e){this._updateValueFromDom()}},willBecomeActiveTarget:{value:function(e){this.hasFocus=!0,this.callDelegateMethod("didBeginEditing",this)}},surrendersActiveTarget:{value:function(e){return this.callDelegateMethod("shouldEndEditing",this)!==!1&&(this._hasFocus=!1,this.callDelegateMethod("didEndEditing",this),!0)}},_updateValueFromDom:{value:function(){var e,t=e=this.element.value;if(this.converter)try{t=this.converter.revert(e),this.errorMessage=null}catch(i){this.errorMessage=i.message||i}this._value!==t&&(this._value=t,this.dispatchOwnPropertyChange("value",this._value),this.callDelegateMethod("didChange",this)),this.converter&&(this.needsDraw=!0)}}})}}),montageDefine("7f00df0","core/rotation-composer",{dependencies:["montage/composer/composer","montage/composer/translate-composer"],factory:function(e,t,i){var n=e("montage/composer/composer").Composer,r=e("montage/composer/translate-composer").TranslateComposer;t.RotationComposer=n.specialize({_unit:{value:"radians"},unit:{get:function(){return this._unit},set:function(e){"degrees"===e?this._unit="degrees":this._unit="radians"}},constructor:{value:function(){this["super"](),this._translateComposer=new r,this._translateComposer.hasMomentum=!1,this._translateComposer.hasBouncing=!1}},load:{value:function(){this.component.addComposerForElement(this._translateComposer,this.element),this._translateComposer.load(),this._translateComposer.addEventListener("translateStart",this,!1),this._translateComposer.addEventListener("translateEnd",this,!1),this._translateComposer.addEventListener("translate",this,!1)}},unload:{value:function(){}},handleTranslateStart:{value:function(){var e=this._translateComposer.pointerStartEventPosition,t=e.pageX-this.center.pageX,i=e.pageY-this.center.pageY;this._translateComposer.translateX=e.pageX,this._translateComposer.translateY=e.pageY,this._previousAngle=Math.atan2(i,t),this._deltaAngle=0,this._dispatchRotateStart()}},handleTranslateEnd:{value:function(){this._dispatchRotateEnd()}},handleTranslate:{value:function(e){var t=e.translateX-this.center.pageX,i=e.translateY-this.center.pageY,n=Math.atan2(i,t),r=n-this._previousAngle;r>Math.PI?r-=2*Math.PI:r<-Math.PI&&(r+=2*Math.PI),this.angleInRadians+=r,this._deltaAngle=r,this._previousAngle=n,this._dispatchRotate()}},angleInRadians:{value:0},_deltaAngle:{value:0},_dispatchRotateStart:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("rotateStart",!0,!0,null),e.unit=this._unit,"radians"===this._unit?(e.rotation=this.angleInRadians,e.deltaRotation=this._deltaAngle):(e.rotation=180*this.angleInRadians/Math.PI,e.deltaRotation=180*this._deltaAngle/Math.PI),this.dispatchEvent(e)}},_dispatchRotate:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("rotate",!0,!0,null),e.unit=this._unit,"radians"===this._unit?(e.rotation=this.angleInRadians,e.deltaRotation=this._deltaAngle):(e.rotation=180*this.angleInRadians/Math.PI,e.deltaRotation=180*this._deltaAngle/Math.PI),this.dispatchEvent(e)}},_dispatchRotateEnd:{value:function(){var e=document.createEvent("CustomEvent");e.initCustomEvent("rotateEnd",!0,!0,null),e.unit=this._unit,e.deltaRotation=0,"radians"===this._unit?e.rotation=this.angleInRadians:e.rotation=180*this.angleInRadians/Math.PI,this.dispatchEvent(e)}},center:{value:null},_start:{value:null},_translateComposer:{value:null}})}}),montageDefine("5711b7d","punycode",{dependencies:[],factory:function(e,t,i){!function(e){function n(e){throw RangeError(L[e])}function r(e,t){for(var i=e.length;i--;)e[i]=t(e[i]);return e}function a(e,t){var i=".";return r(e.split(i),t).join(i)}function s(e){for(var t,i,r=[],a=0,s=e.length;a<s;)t=e.charCodeAt(a++),55296==(63488&t)&&(i=e.charCodeAt(a++),55296==(64512&t)&&56320==(64512&i)||n("ucs2decode"),t=((1023&t)<<10)+(1023&i)+65536),r.push(t);return r}function o(e){return r(e,function(e){var t="";return 55296==(63488&e)&&n("ucs2encode"),e>65535&&(e-=65536,t+=M(e>>>10&1023|55296),e=56320|1023&e),t+=M(e)}).join("")}function l(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:y}function u(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function c(e,t,i){var n=0;for(e=i?I(e/T):e>>1,e+=I(e/t);e>O*C>>1;n+=y)e=I(e/O);return I(n+(O+1)*e/(e+x))}function h(e){var t,i,r,a,s,u,h,d,m,p,g=[],f=e.length,v=0,_=P,b=S;for(i=e.lastIndexOf(A),i<0&&(i=0),r=0;r<i;++r)e.charCodeAt(r)>=128&&n("not-basic"),g.push(e.charCodeAt(r));for(a=i>0?i+1:0;a<f;){for(s=v,u=1,h=y;a>=f&&n("invalid-input"),d=l(e.charCodeAt(a++)),(d>=y||d>I((w-v)/u))&&n("overflow"),v+=d*u,m=h<=b?E:h>=b+C?C:h-b,!(d<m);h+=y)p=y-m,u>I(w/p)&&n("overflow"),u*=p;t=g.length+1,b=c(v-s,t,0==s),I(v/t)>w-_&&n("overflow"),_+=I(v/t),v%=t,g.splice(v++,0,_)}return o(g)}function d(e){var t,i,r,a,o,l,h,d,m,p,g,f,v,_,b,x=[];for(e=s(e),f=e.length,t=P,i=0,o=S,l=0;l<f;++l)g=e[l],g<128&&x.push(M(g));for(r=a=x.length,a&&x.push(A);r<f;){for(h=w,l=0;l<f;++l)g=e[l],g>=t&&g<h&&(h=g);for(v=r+1,h-t>I((w-i)/v)&&n("overflow"),i+=(h-t)*v,t=h,l=0;l<f;++l)if(g=e[l],g<t&&++i>w&&n("overflow"),g==t){for(d=i,m=y;p=m<=o?E:m>=o+C?C:m-o,!(d<p);m+=y)b=d-p,_=y-p,x.push(M(u(p+b%_,0))),d=I(b/_);x.push(M(u(d,0))),o=c(i,v,r==a),i=0,++r}++i,++t}return x.join("")}function m(e){return a(e,function(e){return D.test(e)?h(e.slice(4).toLowerCase()):e})}function p(e){return a(e,function(e){return R.test(e)?"xn--"+d(e):e})}var g,f,v="function"==typeof define&&"object"==typeof define.amd&&define.amd&&define,_="object"==typeof t&&t,b="object"==typeof i&&i,w=2147483647,y=36,E=1,C=26,x=38,T=700,S=72,P=128,A="-",R=/[^ -~]/,D=/^xn--/,L={overflow:"Overflow: input needs wider integers to process.",ucs2decode:"UCS-2(decode): illegal sequence",ucs2encode:"UCS-2(encode): illegal value","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},O=y-E,I=Math.floor,M=String.fromCharCode;if(g={version:"1.0.0",ucs2:{decode:s,encode:o},decode:h,encode:d,toASCII:p,toUnicode:m},_)if(b&&b.exports==_)b.exports=g;else for(f in g)g.hasOwnProperty(f)&&(_[f]=g[f]);else v?define("punycode",g):e.punycode=g}(this)}}),montageDefine("449c0c3","lru-set",{dependencies:["./shim","./set","./generic-collection","./generic-set","./listen/property-changes","./listen/range-changes","lru-set"],factory:function(e,t,i){"use strict";function n(e,t,i,a,s){return this instanceof n?(t=t||1/0,i=i||Object.equals,a=a||Object.hash,s=s||Function.noop,this.store=new r((void 0),i,a),this.contentEquals=i,this.contentHash=a,this.getDefault=s,this.capacity=t,this.length=0,void this.addEach(e)):new n(e,t,i,a,s)}var r=(e("./shim"),e("./set").CollectionsSet),a=e("./generic-collection"),s=e("./generic-set"),o=e("./listen/property-changes"),l=e("./listen/range-changes");i.exports=n,n.LruSet=n,Object.addEach(n.prototype,a.prototype),Object.addEach(n.prototype,s.prototype),Object.addEach(n.prototype,o.prototype),Object.addEach(n.prototype,l.prototype),Object.defineProperty(n.prototype,"size",a._sizePropertyDescriptor),n.from=a.from,n.prototype.constructClone=function(e){return new this.constructor(e,this.capacity,this.contentEquals,this.contentHash,this.getDefault)},n.prototype.has=function(e){return this.store.has(e)},n.prototype.get=function(e,t){if(t)throw new Error("LruSet#get does not support second argument: equals");return e=this.store.get(e),void 0!==e?(this.store["delete"](e),this.store.add(e)):e=this.getDefault(e),e},n.prototype.add=function(e){var t,i=this.store.has(e),n=[],r=[];return i?(this.store["delete"](e),this.store.add(e)):this.capacity>0&&(n.push(e),this.length>=this.capacity&&(t=this.store.order.head.next,r.push(t.value)),this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange(n,r,0),this.store.add(e),r.length>0&&this.store["delete"](t.value),this.length=this.length+n.length-r.length,this.dispatchesRangeChanges&&this.dispatchRangeChange(n,r,0)),n.length!==r.length},n.prototype["delete"]=function(e,t){if(t)throw new Error("LruSet#delete does not support second argument: equals");var i=this.store.has(e);return i&&(this.dispatchesRangeChanges&&this.dispatchBeforeRangeChange([],[e],0),this.store["delete"](e),this.length--,this.dispatchesRangeChanges&&this.dispatchRangeChange([],[e],0)),i},n.prototype.one=function(){if(this.length>0)return this.store.one()},n.prototype.clear=function(){this.store.clear(),this.length=0},n.prototype.reduce=function(e,t){var i=arguments[2],n=this.store,r=0;return n.reduce(function(t,n){return e.call(i,t,n,r++,this)},t,this)},n.prototype.reduceRight=function(e,t){var i=arguments[2],n=this.store,r=this.length-1;return n.reduceRight(function(t,n){return e.call(i,t,n,r--,this)},t,this)},n.prototype.iterate=function(){return this.store.iterate()}}}),montageDefine("b0111a3","composer/key-composer",{dependencies:["../core/core","./composer"],factory:function(e,t,i){var n=e("../core/core").Montage,r=e("./composer").Composer,a="keyPress",s="longKeyPress",o="keyRelease",l=t.KeyComposer=r.specialize({_shouldDispatchEvent:{value:!1},shouldDispatchLongPress:{value:!1},_longPressTimeout:{value:null},_keyRegistered:{value:!1},_keys:{value:null},keys:{get:function(){return this._keys},set:function(e){this._keyRegistered?(c.defaultKeyManager.unregisterKey(this),this._keys=e,c.defaultKeyManager.registerKey(this)):this._keys=e}},load:{value:function(){this._shouldDispatchEvent&&!this._keyRegistered&&(c.defaultKeyManager.registerKey(this),this._keyRegistered=!0)}},unload:{value:function(){c.defaultKeyManager.unregisterKey(this),this._keyRegistered=!1}},addEventListener:{value:function(e,t,i){var n=this.component;r.prototype.addEventListener.call(this,e,t,i),e!=a&&e!=s&&e!=o||(this._shouldDispatchEvent=!0,e==s&&(this._shouldDispatchLongPress=!0),this._isLoaded?this._keyRegistered||(c.defaultKeyManager.registerKey(this),this._keyRegistered=!0):n&&"function"!=typeof n.addComposer&&(this.element||(this.element=window),this.component.loadComposer(this)))}},deserializedFromTemplate:{value:function(){var e=this.component;null===this.identifier&&(this.identifier=n.getInfoForObject(this).label),e&&("function"==typeof e.addComposer?e.addComposer(this):this._isLoaded||(this.element||(this.element=window),this.component.loadComposer(this)))}}},{createKey:{value:function(e,t,i){var n=this;return this===l&&(n=new l),i||(i=e.identifier?e.identifier+t.toLowerCase().replace(/[ +]/g).toCapitalized():t.toLowerCase().replace(/[ +]/g)),n.keys=t,n.identifier=i,e.addComposer(n),n}},createGlobalKey:{value:function(e,t,i){var n=this;return this===l&&(n=new l),n.keys=t,n.identifier=i,e.addComposerForElement(n,window),n}}}),u=null,c=n.specialize({_defaultKeyManager:{value:null},_loadingDefaultKeyManager:{value:!1},_keysToRegister:{value:[]},registerKey:{value:function(t){var i=this;this._defaultKeyManager?this._defaultKeyManager.registerKey(t):(this._keysToRegister.push(t),this._loadingDefaultKeyManager||(this._loadingDefaultKeyManager=!0,e.async("core/event/key-manager").then(function(e){var t=i._defaultKeyManager=e.defaultKeyManager;i._keysToRegister.forEach(function(e){t.registerKey(e)}),i._keysToRegister.length=0})))}},unregisterKey:{value:function(e){this._defaultKeyManager&&this._defaultKeyManager.unregisterKey(e)}}},{defaultKeyManager:{get:function(){return u||(u=new c),this._defaultKeyManager?this._defaultKeyManager:u}}})}}),montageDefine("c50fb48","runtime/mesh-resource-loader",{dependencies:["runtime/resource-loader"],factory:function(e,t,i){var n=e("runtime/resource-loader").ResourceLoader;t.MeshResourceLoader=Object.create(n,{meshes:{value:null,writable:!0},fireMeshesDidLoadIfNeeded:{value:function(){var e=Object.keys(this._trackedIds);e&&0==e.length&&this.delegate&&this.delegate.meshesDidLoad&&this.delegate.meshesDidLoad(this.meshes)}},resourceAvailable:{value:function(e){this._removeTrackedId(e),this.fireMeshesDidLoadIfNeeded()}},_fetchResources:{value:function(e,t,i){var n=this.webGLRenderer.webGLContext;e.webGLContext=n;var r=Object.keys(t);r.forEach(function(r){var a=this.webGLRenderer.resourceManager.getResource(t[r],e,null==i?n:t[r]);null==a&&this._addTrackedId(r)},this)}},_fetchAllResources:{value:function(e){this.webGLRenderer.webGLContext,this._fetchResources(this.webGLRenderer.vertexAttributeBufferDelegate,e.vertexBuffers,!0),this._fetchResources(this.webGLRenderer.indicesDelegate,e.allIndices),this._fetchResources(this.webGLRenderer.textureDelegate,e.textures),this._fetchResources(this.webGLRenderer.programDelegate,e.programs),this.fireMeshesDidLoadIfNeeded()}},_trackProgramsFromMaterial:{value:function(e,t){var i=e.technique;if(i)for(var n in i.passes){var r=i.passes[n],a=r.instanceProgram;a&&(t[a.program.id]=a.program,this._addTrackedId(a.program.id))}}},_trackTexturesFromMaterial:{value:function(e,t){var i=e.parameters;if(i){var n=Object.keys(i);n.length>0&&n.forEach(function(e){var n=i[e];if(n&&n.value){var r=n.value;"texture"===r.type&&(t[r.id]=r,this._addTrackedId(r.id))}},this)}}},_trackIndicesFromPrimitive:{value:function(e,t){var i=e.indices;t[i.id]=i,this._addTrackedId(i.id)}},_trackVertexBuffersFromPrimitive:{value:function(e,t){for(var i in e.semantics){var n=e.semantics[i];t[n.id]=n,this._addTrackedId(n.id)}}},_trackMesh:{value:function(e,t,i){e.primitives.forEach(function(e){this._trackTexturesFromMaterial(e.material,t.textures),this._trackIndicesFromPrimitive(e,t.allIndices),this._trackVertexBuffersFromPrimitive(e,t.vertexBuffers),this._trackProgramsFromMaterial(e.material,t.programs)},this)}},_trackMeshes:{value:function(e){this.meshes.forEach(function(t){this._trackMesh(t,e,this.webGLRenderer)},this)}},loadMeshes:{value:function(){var e={};e.textures={},e.allIndices={},e.vertexBuffers={},e.programs={},this._trackMeshes(e),this._fetchAllResources(e,this.webGLRenderer)}},init:{value:function(e,t,i){return this.delegate=i,this.webGLRenderer=t,this.meshes=e,t.resourceManager.observers.push(this),this}}})}}),montageDefine("d3659d0","q-connection",{dependencies:["q","collections/lru-map","./lib/uuid","./adapt"],factory:function(e,t,i){function n(){}function r(e,t,i){function r(){n.apply(null,[w].concat(Array.prototype.slice.call(arguments)))}function h(t){r("receive:",t),a.when(e.get(),h).done(),d(t)}function d(e){e=JSON.parse(e),r("receive: parsed message",e),y[e.type]&&b.has(e.to)&&y[e.type](e)}function m(e){if(b.has(e))return b.get(e).promise;var t=a.defer();return b.set(e,t),t.promise}function p(e,t){r("resolve:","L"+JSON.stringify(e),JSON.stringify(t),typeof t),b.get(e).resolve(t)}function g(t){return a.makePromise({when:function(){return this}},function(i,n){var a=_(),s=m(a);return r("sending:","R"+JSON.stringify(t),JSON.stringify(i),JSON.stringify(f(n))),e.put(JSON.stringify({type:"send",to:t,from:a,op:i,args:f(n)})),s})}function f(e){if(void 0===e)return{"%":"undefined"};if(Object(e)!==e)return e;if(a.isPromise(e)||"function"==typeof e){var t=_();return m(t),p(t,e),{"@":t,type:typeof e}}if(e instanceof Error)return{message:e.message,stack:e.stack};if(Array.isArray(e))return e.map(f);if("object"==typeof e){var i={};for(var n in e)if(c.call(e,n)){var r=n.replace(/[@!%\\]/,function(e){return"\\"+e});i[r]=f(e[n])}return i}return e}function v(e){if(Object(e)!==e)return e;if(e["%"])return"undefined"===e["%"]?void 0:a.reject(new TypeError("Unrecognized type: "+e["%"]));if(e["!"])return a.reject(e["!"]);if(e["@"]){var t=g(e["@"]);return"function"===e.type?function(){return a.fapply(t,Array.prototype.slice.call(arguments))}:t}if(Array.isArray(e))return e.map(v);var i={};for(var n in e)if(c.call(e,n)){var r=n.replace(/\\([\\!@%])/,function(e,t){return t});i[r]=v(e[n])}return i}i=i||{};var _=i.makeId||function(){return o.generate()},b=s(null,i.max||1/0);e=l(e,i.origin);var w=Math.random().toString(16).slice(2,4).toUpperCase()+":";a.when(e.get(),h).done();var y={resolve:function(e){b.has(e.to)&&p(e.to,v(e.resolution))},send:function(t){var i=b.get(t.to).promise,n=a.dispatch(i,t.op,v(t.args));a.when(n,function(i){try{i=f(i)}catch(n){try{i={"!":f(n)}}catch(n){i={"!":null}}}var r=JSON.stringify({type:"resolve",to:t.from,resolution:i});e.put(r)},function(i){try{i=f(i)}catch(n){try{i=f(n)}catch(n){i=null}}envelope=JSON.stringify({type:"resolve",to:t.from,resolution:{"!":i}}),e.put(envelope)}).done()}};return m(u),p(u,t),g(u);
}var a=e("q"),s=e("collections/lru-map"),o=e("./lib/uuid"),l=e("./adapt"),u="",c=Object.prototype.hasOwnProperty;i.exports=r}}),montageDefine("22a41ee","ui/cards/thermostat.reel/thermostat.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Card-content--thermostat{min-width:346px}@media (orientation:landscape) and (max-height:600px){.Card-content--thermostat{min-width:0;height:190px}.Thermostat-den{position:absolute;bottom:-80px;-webkit-transform:scale(.6);transform:scale(.6)}}@media (orientation:landscape) and (max-height:400px){.Card-content--thermostat{display:none}}@media (orientation:landscape) and (max-height:299px){.Thermostat .Card-content:nth-child(2){display:block}.Thermostat .Card--hasOptions{display:none}}@media (orientation:portrait){.Card-content--thermostat{margin-top:40px;min-width:310px}.Thermostat-den{margin-left:-20px}}@media (orientation:portrait) and (max-width:700px){.Card-content--thermostat{position:relative;min-width:0;height:100%;margin-top:0}.Thermostat-den{position:absolute;top:50%;left:50%;-webkit-transform:scale(.7);transform:scale(.7);margin:-170px}.Thermostat .Card--hasOptions{margin-top:18px;border-top:1px solid hsl(0,0%,90%);border-left:none}}@media (orientation:portrait) and (max-width:560px){.Card-content--thermostat{display:none}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/cards/thermostat.reel","properties":{"element":{"#":"thermostat"}},"bindings":{"ownerComponent.temperatureDelta":{"<-":"@den.temperatureDelta"}}},"booleanOptionField1":{"prototype":"ui/option-fields/boolean-option-field.reel","properties":{"element":{"#":"booleanOptionField"}},"bindings":{"configurationOption":{"<-":"@owner.configurationSet.optionMap.get(\'thermostat\')"}}},"den":{"prototype":"den/ui/den.reel","properties":{"element":{"#":"den"},"src":"den.png"}},"title":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"title"},"value":"Thermostat"}}}</script></head><body><div data-montage-id=thermostat class="Thermostat Card"><section class="Card-content Card-content--thermostat"><div data-montage-id=den class=Thermostat-den></div></section><section class=Card-content><h1 data-montage-id=title class=Card-title>Thermostat</h1><p class=Card-description>Install a smart thermostat that maintains the perfect temperature while minimizing power use by adapting to your schedule.</p><div data-montage-id=booleanOptionField class=Card--hasOptions></div></section></div></body></html>'}),montageDefine("b0111a3","window-loader/montage-window",{dependencies:["../core/core"],factory:function(e,t,i){var n=e("../core/core").Montage;t.MontageWindow=n.specialize({_application:{value:null},application:{get:function(){return this._application},set:function(e){null===this._application&&(this._application=e,this.focused&&this._setFocusedWindow(this))}},_window:{value:null},window:{get:function(){return this._window},set:function(e){if(null===this._window){var t=e.document.body;this._window=e,e.addEventListener("beforeunload",this,!0),e.addEventListener("focus",this,!0),e.addEventListener("mousedown",this,!0),null===t.getAttribute("tabIndex")&&(t.setAttribute("tabIndex",-1),t.focus())}}},document:{get:function(){return this._window.document}},_component:{value:null},component:{get:function(){return this._component},set:function(e){null===this._component&&(this._component=e)}},title:{get:function(){return this.document.title},set:function(e){this.document.title=e}},focused:{value:!1},focus:{value:function(){this._window&&this._window.focus()}},_setFocusedWindow:{value:function(e){var t,i,n,r=this.application;if(r._multipleWindow){t=r.windows;for(n in t)i=t[n],i.window===e?i.focused!==!0&&(i.focused=!0,"z-order"==r.windowsSortOrder?(t.splice(n,1),t.unshift(i)):"reverse-z-order"==r.windowsSortOrder&&(t.splice(n,1),t.push(i))):i.focused=!1}else this.focused=!0}},closed:{get:function(){return!!this._window&&this._window.closed}},close:{value:function(){this._window&&this._window.close()}},resizeTo:{value:function(e,t){this._window&&this._window.resizeTo(e,t)}},moveTo:{value:function(e,t){this._window&&this._window.moveTo(e,t)}},captureFocus:{value:function(e){var t=this.application;if(!this.application)return void(this.focused=!0);if(t.parentApplication)t.mainApplication.window.captureFocus(e);else{var i=(e.target.ownerDocument?e.target.ownerDocument.defaultView:null)||e.target.defaultView||e.target;this._setFocusedWindow(i)}}},captureMousedown:{value:function(e){this.captureFocus(e)}},captureBeforeunload:{value:function(e){var t,i=this.application,n=i.windows,r=i.attachedWindows;i.attachedWindows=[];for(var t in r)r[t].close();i.parentApplication&&(r=i.parentApplication.attachedWindows,t=r.indexOf(this),t!==-1&&r.splice(t,1),t=n.indexOf(this),t!==-1&&n.splice(t,1),this.window.removeEventListener("beforeunload",this,!0),this.close())}}})}}),montageDefine("b0111a3","core/converter/number-converter",{dependencies:["./converter","./converter","./converter","./converter","../shim/string"],factory:function(e,t,i){var n=e("./converter").Converter,r=e("./converter").Validator,a=e("./converter").isNumber,s=e("./converter").isDef,o=(e("../shim/string"),/^([\-]?\d+\.?\d*)([K,M,G,T,P,k,m,u,n]?)[B]?$/),l=["P","T","B","M","K","","m","u","n"],u=t.NUMERIC_SCALES_SI_={"":1,n:1e-9,u:1e-6,m:.001,k:1e3,K:1e3,M:1e6,B:1e9,T:1e12,P:1e15},c=t.NUMERIC_SCALES_BINARY_={"":1,n:Math.pow(1024,-3),u:Math.pow(1024,-2),m:1/1024,k:1024,K:1024,M:Math.pow(1024,2),G:Math.pow(1024,3),T:Math.pow(1024,4),P:Math.pow(1024,5)},h=t._numericValueToString=function(e,t,i,n,r){r=r||l;var a=e,o="",u=1;e<0&&(e=-e);for(var c=0;c<r.length;c++){var h=r[c];if(u=t[h],e>=u||u<=1&&e>.1*u){o=h;break}}o?n&&(o+=n):u=1;var d=Math.pow(10,s(i)?i:2);return Math.round(a/u*d)/d+o},d=function(e,t){var i=e.match(o);return i?i[1]*t[i[2]]:NaN},m=(t.stringToNumericValue=function(e){return e.endsWith("B")?d(e,c):d(e,u)},t.numericValueToString=function(e,t){return h(e,u,t)}),p=t.NumberValidator=r.specialize({allowFloat:{value:!0},allowNegative:{value:!0},validate:{value:function(e){var t;return e=e||"",e=e.replace(/,/g,""),t=a(e)?e:this.allowFloat===!0?parseFloat(e,10):parseInt(e,10),isNaN(t)?{message:"Invalid Number"}:t}}});t.NumberConverter=n.specialize({allowPartialConversion:{value:!1},validator:{value:new p},shorten:{value:null},decimals:{value:2},forceDecimals:{value:!1},round:{value:null},_reg:{value:/(\d+)(\d{3})/},allowFloat:{value:!0},allowNegative:{value:!0},_makeReadable:{value:function(e,t,i){t=t||",",i=i||".";for(var n=e.toString().split("."),r=n[0];this._reg.test(r);)r=r.replace(this._reg,"$1"+t+"$2");var a=n.length>1?n[1]:"";if(this.forceDecimals)for(;a.length<this.decimals;)a+="0";var s=a.length>0?i+a:"";return r+s}},convert:{value:function(e){if(this.shorten)return m(e,this.decimals);var t;if(this.round)t=Number(Math.round(e)).toString();else{var i=Math.pow(10,this.decimals||2),n=1;t=Number(Math.round(e/n*i)/i)}return this._makeReadable(t)}},revert:{value:function(e){this.validator.allowFloat=this.allowFloat,this.validator.allowNegative=this.allowNegative;var t=this.validator.validate(e);if(a(t))return t;throw new Error(t.message)}}})}}),montageDefine("22a41ee","ui/static-view.reel/static-view",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.StaticView=n.specialize({currentPanel:{value:null},constructor:{value:function(){this["super"]()}},templateDidLoad:{value:function(){this.addPathChangeListener("configuration.configurationMap.get('staircase').optionMap.get('material')._selectedOption",this,"handleStaircaseMaterialChange"),this.addPathChangeListener("configuration.configurationMap.get('kitchen').optionMap.get('appliances')._selectedOption",this,"handleKitchenAppliancesChange"),this.addPathChangeListener("configuration.configurationMap.get('counters').optionMap.get('material')._selectedOption",this,"handleCountertopMaterialChange"),this.addPathChangeListener("currentPanel",this,"handleCurrentPanelChange")}},_currentViewpointClassName:{value:null},handleCurrentPanelChange:{value:function(e){this._currentViewpointClassName&&(this.classList.remove(this._currentViewpointClassName),this._currentViewpointClassName=null),e&&(this._currentViewpointClassName="StaticView--"+e.panelKey,this.classList.add(this._currentViewpointClassName))}},handleStaircaseMaterialChange:{value:function(e){var t=this.templateObjects.staircase,i="ConfigPreview--staircase-pine";if(e)switch(e.name){case"FSC Pine":break;case"Dark Ash":i="ConfigPreview--staircase-ash";break;case"Dark Walnut":i="ConfigPreview--staircase-walnut";break;case"Deep Cherry":i="ConfigPreview--staircase-bold";break;default:i=""}t.className=i}},handleKitchenAppliancesChange:{value:function(e){var t=this.templateObjects.kitchen,i="ConfigPreview--kitchen";if(e)switch(e.name){case"Gütersloh":i="ConfigPreview--kitchen-gutersloh";break;case"Norse":i="ConfigPreview--kitchen-norse";break;case"Vortex":i="ConfigPreview--kitchen-vortex"}t.className=i}},handleCountertopMaterialChange:{value:function(e){var t=this.templateObjects.countertop,i="ConfigPreview--countertop-paper";if(e)switch(e.name){case"Black Quartz":i="ConfigPreview--countertop-quartz";break;case"Paper Composite":break;case"Bamboo":i="ConfigPreview--countertop-bamboo";break;case"Cement and Fly Ash":i="ConfigPreview--countertop-cement";break;default:i=""}t.className=i}}})}}),montageDefine("3ef65ed","package.json",{exports:{name:"digit",description:"Touch-optimized MontageJS components for tablets and phones.",version:"3.0.0",license:"BSD-3-Clause",repository:{type:"git",url:"git+https://github.com/montagejs/digit.git"},dependencies:{montage:"^17.0.7"},devDependencies:{concurrently:"^3.4.0","http-server":"^0.9.0","jasmine-console-reporter":"^1.2.7","jasmine-core":"^2.5.2",karma:"^1.5.0","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-firefox-launcher":"^1.0.1","karma-jasmine":"^1.1.0","karma-phantomjs-launcher":"^1.0.2","montage-testing":"git://github.com/montagejs/montage-testing.git#master",open:"0.0.5"},scripts:{test:"node test/run-node.js","test:karma":"karma start --no-auto-watch --single-run","test:karma-dev":"karma start --auto-watch --no-single-run","test:jasmine":'concurrently "http-server -a localhost -p 8085" "open http://localhost:8085/test/run.html"',"start:demo":'concurrently "http-server -a localhost -p 8085" "open http://localhost:8085/demo/sizing/index.html"',"start:overview":'concurrently "http-server -a localhost -p 8085" "open http://localhost:8085/overview/index.html"'},exclude:["overview","test"],gitHead:"a46d7aa68cbf985e6f4b322096a1e2a022c14035",bugs:{url:"https://github.com/montagejs/digit/issues"},homepage:"https://github.com/montagejs/digit#readme",_id:"digit@3.0.0",_shasum:"1d2be43a34f5aa1684c22934a4b2b6b5f80638f0",_from:"digit@>=3.0.0 <4.0.0",_npmVersion:"2.15.11",_nodeVersion:"4.8.0",_npmUser:{name:"hthetiot",email:"hthetiot@gmail.com"},dist:{shasum:"1d2be43a34f5aa1684c22934a4b2b6b5f80638f0",tarball:"https://registry.npmjs.org/digit/-/digit-3.0.0.tgz"},maintainers:[{name:"francoisfrisch",email:"francoisfrisch@gmail.com"},{name:"hthetiot",email:"hthetiot@gmail.com"},{name:"marchant",email:"benoit@montagestudio.com"},{name:"montage-bot",email:"francoisfrisch@gmail.com"}],_npmOperationalInternal:{host:"s3://npm-registry-packages",tmp:"tmp/digit-3.0.0.tgz_1495575626923_0.7017284843605012"},directories:{},_resolved:"https://registry.npmjs.org/digit/-/digit-3.0.0.tgz",main:"index",hash:"3ef65ed",mappings:{montage:{name:"montage",hash:"b0111a3",location:"../montage@b0111a3/"}},production:!0,useScriptInjection:!0}}),montageDefine("c50fb48","runtime/material",{dependencies:["montage","runtime/component-3d"],factory:function(e,t,i){var n=(e("montage").Montage,e("runtime/component-3d").Component3D);t.Material=n.specialize({constructor:{value:function(){this["super"](),this.addRangeAtPathChangeListener("filterColor",this,"handleFilterColorChange"),this.addOwnPropertyChangeListener("glTFElement",this),this.addOwnPropertyChangeListener("image",this),this.addOwnPropertyChangeListener("opacity",this)}},filterColor:{value:[1,1,1,1]},handleGlTFElementChange:{value:function(){this.handleFilterColorChange(),this.handleImageChange(),this.handleOpacityChange()}},handleFilterColorChange:{value:function(e,t,i){null!=this.glTFElement&&this.glTFElement.parameters.filterColor&&(this.glTFElement.parameters.filterColor.value=this.filterColor,this.scene&&this.scene.dispatchEventNamed("materialUpdate",!0,!1,this))}},handleOpacityChange:{value:function(){null!=this.glTFElement&&this.glTFElement.parameters.transparency&&(this.glTFElement.parameters.transparency.value=this.opacity,this.scene&&this.scene.dispatchEventNamed("materialUpdate",!0,!1,this))}},handleImageChange:{value:function(){if(null!=this.glTFElement&&this.glTFElement.parameters.diffuse&&this._image){var e=this.resolvePathIfNeeded(this._image),t=this.parameterForImagePath(e);this.glTFElement.parameters.diffuse=t,this.scene&&this.scene.dispatchEventNamed("textureUpdate",!0,!1,t)}}},parameterForImagePath:{value:function(e){var t={magFilter:"LINEAR",minFilter:"LINEAR",type:"sampler",wrapS:"REPEAT",wrapT:"REPEAT"},i={id:"source-"+e,type:"image",baseId:"source-"+e,description:{path:e}},n={baseId:"texture-"+e,id:"texture-"+e,format:"RGBA",internalFormat:"RGBA",sampler:t,source:i,type:"texture",target:"TEXTURE_2D"},r={parameter:"diffuse",value:n};return r}},_image:{value:null,writable:!0},image:{set:function(e){if(e&&0!=e.length){var t=e.toLowerCase();t.indexOf(".jpg")==-1&&t.indexOf(".jpeg")==-1&&t.indexOf(".png")==-1||this._image!=e&&(this._image=e)}},get:function(){return this._image}},_opacity:{value:1,writable:!0},opacity:{set:function(e){this._opacity!=e&&(this._opacity=e)},get:function(){return this._opacity}}})}}),montageDefine("8987d1b","package.json",{exports:{name:"q",version:"1.5.1",description:"A library for promises (CommonJS/Promises/A,B,D)",homepage:"https://github.com/kriskowal/q",author:{name:"Kris Kowal",email:"kris@cixar.com",url:"https://github.com/kriskowal"},keywords:["q","promise","promises","promises-a","promises-aplus","deferred","future","async","flow control","fluent","browser","node"],contributors:[{name:"Kris Kowal",email:"kris@cixar.com",url:"https://github.com/kriskowal"},{name:"Irakli Gozalishvili",email:"rfobic@gmail.com",url:"http://jeditoolkit.com"},{name:"Domenic Denicola",email:"domenic@domenicdenicola.com",url:"http://domenicdenicola.com"}],bugs:{url:"http://github.com/kriskowal/q/issues"},license:"MIT",main:"q.js",files:["LICENSE","q.js","queue.js"],repository:{type:"git",url:"git://github.com/kriskowal/q.git"},engines:{node:">=0.6.0",teleport:">=0.2.0"},dependencies:{},devDependencies:{cover:"*",grunt:"~0.4.1","grunt-cli":"~0.1.9","grunt-contrib-uglify":"~0.9.1","jasmine-node":"1.11.0",jshint:"~2.1.9",matcha:"~0.2.0",opener:"*","promises-aplus-tests":"1.x"},scripts:{test:"npm ls -s && jasmine-node spec && promises-aplus-tests spec/aplus-adapter && npm run -s lint","test-browser":"opener spec/q-spec.html",benchmark:"matcha",lint:"jshint q.js",cover:"cover run jasmine-node spec && cover report html && opener cover_html/index.html",minify:"grunt",prepublish:"grunt"},directories:{test:"./spec"},gitHead:"c2f5a6f35456389a806acca50bfd929cbe30c4cb",_id:"q@1.5.1",_shasum:"7e32f75b41381291d04611f1bf14109ac00651d7",_from:"q@latest",_npmVersion:"2.14.2",_nodeVersion:"0.10.32",_npmUser:{name:"kriskowal",email:"kris.kowal@cixar.com"},dist:{shasum:"7e32f75b41381291d04611f1bf14109ac00651d7",tarball:"https://registry.npmjs.org/q/-/q-1.5.1.tgz"},maintainers:[{name:"kriskowal",email:"kris.kowal@cixar.com"},{name:"domenic",email:"domenic@domenicdenicola.com"}],_npmOperationalInternal:{host:"s3://npm-registry-packages",tmp:"tmp/q-1.5.1.tgz_1508435736930_0.7891315249726176"},_resolved:"https://registry.npmjs.org/q/-/q-1.5.1.tgz",hash:"8987d1b",mappings:{},production:!0,useScriptInjection:!0}}),montageDefine("b0111a3","core/extras/dom",{dependencies:[],factory:function(e,t,i){if("undefined"!=typeof Node){var n=Node.prototype;n.get=function(e){return this.getAttribute(e)||this[e]},n.parentOf=function(e){for(;(e=e.parentNode)&&e!==this;);return!!e}}if("undefined"!=typeof Element){var r=Element.prototype;Object.defineProperty(r,"set",{value:function(e,t,i){var n,r,a,s,o,l=e.indexOf(".",i);i=i||0,r=e.substring(i,l===-1?e.length:l),l===-1?this.setAttribute(r,t):(a=e.lastIndexOf("."),"style"===r?(s=e.substring(l+1,e.length),this.style[s]=t):"classList"===r?(o=e.substring(l+1,e.length),t?this.classList.add(o):this.classList.remove(o)):(n=this.get(e.substring(0,a)))&&(n[e.substring(a+1,e.length)]=t))},enumerable:!1});var a="classList";if(!r.hasOwnProperty(a)){var s=/^\s+|\s+$/g,o=function(e,t){e.setAttribute("class",t.join(" "))},l=function(e,t){if(""===t)throw"SYNTAX_ERR";if(/\s/.test(t))throw"INVALID_CHARACTER_ERR";return e.indexOf(t)},u=function(){var e=this,t=e.getAttribute("class")||"";return t=t.replace(s,"").split(/\s+/),{length:t.length,item:function(e){return t[e]||null},contains:function(e){return l(t,e)!==-1},add:function(i){l(t,i)===-1&&(t.push(i),this.length=t.length,o(e,t))},remove:function(i){var n=l(t,i);n!==-1&&(t.splice(n,1),this.length=t.length,o(e,t))},toggle:function(e){l(t,e)===-1?this.add(e):this.remove(e)},toString:function(){return e.getAttribute("class")||""}}};Object.defineProperty?Object.defineProperty(r,a,{get:u,enumerable:!0}):Object.prototype.__defineGetter__&&r.__defineGetter__(a,u)}}if("undefined"!=typeof Node){var c=Object.getPrototypeOf(document);c.addRule=function(e,t){var i,n;if(null==(i=document.styleSheets[0])){var r=document.createElement("style");r.type="text/css",document.head.appendChild(r),i=document.styleSheets[0]}else n=document.getRule(e,i);n||i.insertRule(e+" "+t,i.cssRules.length)},c.getRule=function(e,t){var i;if(t.cssRules)for(var n=0;i=t.cssRules[n];n++){if(i.name&&i.name===e)return i;if(i.selectorText===e)return i}}}}}),montageDefine("22a41ee","ui/cards/introduction.reel/introduction.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Introduction .Card-logo{height:134px;margin-left:-7px;margin-bottom:74px}.Introduction-link{text-decoration:none;color:#000}.Introduction-link:hover{color:#555}@media (orientation:landscape) and (max-height:719px){.Introduction .Card-featured{display:none}}@media (orientation:landscape) and (max-height:600px){.Introduction .Card-logo{position:absolute;margin-bottom:0;height:60px;bottom:146px;right:76px}}@media (orientation:landscape) and (max-height:400px){.Introduction .Card-logo{display:none}}@media (orientation:portrait){.Introduction .Card-logo{display:none}}@media (orientation:portrait) and (min-width:561px){.Introduction .Card--disclaimer{margin-top:50px}.Introduction .Card-featured{left:50%;bottom:auto;top:140px}}@media (orientation:portrait) and (max-width:560px){.Card-featured{display:none}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/cards/introduction.reel","properties":{"element":{"#":"introduction"}}},"logo":{"prototype":"digit/ui/image.reel","properties":{"element":{"#":"logo"},"src":"../../../assets/images/logo.png"}}}</script></head><body><div data-montage-id=introduction class="Introduction Card"><section class=Card-content><img data-montage-id=logo class=Card-logo><h1 class=Card-title>Welcome</h1><p class=Card-description>Create a beautiful, high quality, environmentally conscious home using this interactive brochure. Get started by choosing the finishes, options, and appliances best suited to meet your needs.</p></section><section class=Card-content><p class=Card--disclaimer>Photographic reproductions may not be representative of the full range of color, texture, and grain variations which can occur in the product itself.</p><p>Crafted with <a class=Introduction-link href=http://montagestudio.com>Montage Studio</a></p></section></div></body></html>'}),montageDefine("22a41ee","ui/cards/window.reel/window.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Window .Card-hero{height:180px;margin-bottom:16px}@media (orientation:landscape) and (max-height:600px){.Window .Card-hero{bottom:64px;right:60px;height:90px}}@media (orientation:landscape) and (max-height:500px){.Window .Card-hero{display:none}}@media (orientation:landscape) and (max-height:400px){.Window .Card-option--rangeField{margin-top:0}}@media (orientation:portrait) and (max-width:560px){.Window .Card-option--rangeField{margin-top:0}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/cards/window.reel","properties":{"element":{"#":"window"}}},"hero":{"prototype":"digit/ui/image.reel","properties":{"element":{"#":"hero"},"src":"window.jpg"}},"title":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"title"},"value":"Windows"}},"glassField":{"prototype":"ui/option-fields/choice-option-field.reel","properties":{"element":{"#":"glassField"}},"bindings":{"configurationOption":{"<-":"@owner.configurationSet.optionMap.get(\'glass\')"}}},"coatingField":{"prototype":"ui/option-fields/range-option-field.reel","properties":{"element":{"#":"coatingField"}},"bindings":{"configurationOption":{"<-":"@owner.configurationSet.optionMap.get(\'coating\')"}}}}</script></head><body><div data-montage-id=window class="Window Card"><section class=Card-content><div data-montage-id=hero class=Card-hero></div><h1 data-montage-id=title class=Card-title></h1><p class=Card-description>Enhance your view with window options and UV coating that help regulate and protect for your interior environment.</p></section><section class="Card-content Card--hasOptions"><div data-montage-id=glassField></div><div data-montage-id=coatingField></div></section></div></body></html>'}),montageDefine("c50fb48","runtime/component-3d",{dependencies:["montage","runtime/glTF-node","montage/core/target","montage","montage"],factory:function(e,t,i){var n=(e("montage").Montage,e("runtime/glTF-node").glTFNode,e("montage/core/target").Target);t.Component3D=n.specialize({self:{get:function(){return this}},constructor:{value:function(){this._hasUnresolvedId=!0,this["super"]()}},_glTFElement:{value:null,writable:!0},glTFElement:{get:function(){return this._glTFElement},set:function(e){this._glTFElement=e}},_scene:{value:null,writable:!0},scene:{get:function(){return this._scene},set:function(e){this._scene=e,this._sceneDidChange()}},baseURL:{get:function(){return this.scene?this.scene.glTFElement.baseURL:null}},_isAbsolutePath:{value:function(e){var t=new RegExp("^"+window.location.protocol,"i");return!!e.match(t)}},resolvePathIfNeeded:{value:function(e){return this._isAbsolutePath(e)?e:this.baseURL+e}},_hasUnresolvedId:{value:!1,writable:!0},handleStatusChange:{value:function(e,t,i){"loaded"===e&&this._id&&(this.glTFElement=this.scene.glTFElement.ids[this._id],this.glTFElement&&(this._hasUnresolvedId=!1))}},resolveIdIfNeeded:{value:function(){if(this._hasUnresolvedId&&null!=this.scene){if("loaded"!==this.scene.status)return void this.scene.addOwnPropertyChangeListener("status",this);this._id&&"loaded"===this.scene.status&&(this.glTFElement=this.scene.glTFElement.ids[this._id],this.glTFElement&&(this._hasUnresolvedId=!1))}}},_idDidChange:{value:function(){this.resolveIdIfNeeded()}},_sceneDidChange:{value:function(){this.resolveIdIfNeeded()}},_id:{value:null,writable:!0},id:{enumerable:!0,get:function(){return this._id},set:function(e){e!=this._id&&(this._id=e,this._idDidChange())}},initWithScene:{value:function(e){return this.scene=e,this}},blueprintModuleId:e("montage")._blueprintModuleIdDescriptor,blueprint:e("montage")._blueprintDescriptor})}}),montageDefine("22a41ee","ui/main.reel/main",{dependencies:["montage/ui/component","ui/cards/introduction.reel"],factory:function(e,t,i){var n=e("montage/ui/component").Component,r=e("ui/cards/introduction.reel").Introduction;t.Main=n.specialize({constructor:{value:function(){this["super"]()}},panelDescriptors:{value:null},currentPanelKey:{value:null},configuration:{value:null},_hasBeenResized:{value:!1},_supportsWebGL:{value:null},supportsWebGL:{get:function(){if(null===this._supportsWebGL){var e={premultipliedAlpha:!1,antialias:!0,preserveDrawingBuffer:!1},t=document.createElement("canvas"),i=t.getContext("experimental-webgl",e)||t.getContext("webgl",e);this._supportsWebGL=!!i}return this._supportsWebGL}},viewKey:{value:null},sceneView:{value:null},templateDidLoad:{value:function(){this.viewKey=this.supportsWebGL?"webgl":"static",this.addEventListener("firstDraw",this)}},enterDocument:{value:function(e){e&&this.element.ownerDocument.defaultView.addEventListener("resize",this,!1)}},willDraw:{value:function(){if(this._hasBeenResized){var e=this.sceneView;this.sceneView&&(e.width=this.viewPortElement.offsetWidth,e.height=this.viewPortElement.offsetHeight,this._hasBeenResized=!1)}}},handleAction:{value:function(e){var t,i,n,r=e.detail?e.detail.get("panelKey"):void 0,a=this.panelDescriptors;if(r){for(t=0;!n&&(i=a[t]);t++)if(r===i.panelKey){n=i;break}t>-1&&(this.templateObjects.panelFlow.scrollToPanel(t),this.currentPanel=n)}}},_autoActivateRideTimeout:{value:null},handleFirstDraw:{value:function(e){if(e.target instanceof r){this.removeEventListener("firstDraw",this);var t=this;this._autoActivateRideTimeout=setTimeout(function(){t._autoActivateRideTimeout=null,t.sceneView&&"function"==typeof t.sceneView.play&&t.sceneView.play()},2200)}this._hasBeenResized=!0,this.needsDraw=!0}},handleResize:{value:function(){this._hasBeenResized=!0,this.needsDraw=!0}}})}}),montageDefine("22a41ee","ui/cards/staircase.reel/staircase.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Staircase .Card-hero{height:188px}.Staircase .OptionField:nth-child(4) .digit-RadioButton{background-image:url(assets/static/staircase-pine.jpg)}.Staircase .OptionField:nth-child(3) .digit-RadioButton{background-image:url(assets/static/staircase-bold.jpg)}.Staircase .OptionField:nth-child(2) .digit-RadioButton{background-image:url(assets/static/staircase-ash.jpg)}.Staircase .OptionField:nth-child(1) .digit-RadioButton{background-image:url(assets/static/staircase-walnut.jpg)}@media (orientation:landscape) and (max-height:600px){.Staircase .Card-hero{bottom:79px;right:49px;height:70px}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/cards/staircase.reel","properties":{"element":{"#":"staircase"}}},"hero":{"prototype":"digit/ui/image.reel","properties":{"element":{"#":"hero"},"src":"staircase.jpg"}},"staircaseField":{"prototype":"ui/option-fields/choice-option-field.reel","properties":{"element":{"#":"staircaseField"}},"bindings":{"configurationOption":{"<-":"@owner.configurationSet.optionMap.get(\'material\')"}}},"title":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"title"},"value":"Staircase"}}}</script></head><body><div data-montage-id=staircase class="Staircase Card"><section class=Card-content><img data-montage-id=hero class=Card-hero src=""><h1 data-montage-id=title class=Card-title></h1><p class=Card-description>Accent your interior design with staircase options sourced from responsibly managed forests.</p></section><section class="Card-content Card--hasOptions Custom--hasSwatches"><div data-montage-id=staircaseField></div></section></div></body></html>'}),montageDefine("22a41ee","ui/cards/kitchen.reel/kitchen.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Kitchen .Card-hero{height:200px;margin-bottom:.6em}.Kitchen .OptionField:nth-child(1) .digit-RadioButton{background-image:url(assets/static/kitchen-gutersloh.jpg)}.Kitchen .OptionField:nth-child(2) .digit-RadioButton{background-image:url(assets/static/kitchen-norse.jpg)}.Kitchen .OptionField:nth-child(3) .digit-RadioButton{background-image:url(assets/static/kitchen-vortex.jpg)}.Kitchen .OptionField:nth-child(4) .digit-RadioButton{background:hsl(0,0%,80%)}@media (orientation:landscape) and (max-height:600px){.Kitchen .Card-hero{height:80px;bottom:73px;right:134px}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/cards/kitchen.reel","properties":{"element":{"#":"kitchen"}}},"kitchenHero":{"prototype":"digit/ui/image.reel","properties":{"element":{"#":"kitchenHero"},"src":"kitchen.jpg"}},"appliancesField":{"prototype":"ui/option-fields/choice-option-field.reel","properties":{"element":{"#":"appliancesField"}},"bindings":{"configurationOption":{"<-":"@owner.configurationSet.optionMap.get(\'appliances\')"}}},"title":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"title"},"value":"Kitchen"}}}</script></head><body><div data-montage-id=kitchen class="Kitchen Card"><section class=Card-content><img data-montage-id=kitchenHero class=Card-hero><h1 data-montage-id=title class=Card-title></h1><p class=Card-description>Select energy-efficient appliances that meet your needs. Each set includes a refrigerator, range, and stove top.</p></section><section class="Card-content Card--hasOptions Custom--hasSwatches"><div data-montage-id=appliancesField></div></section></div></body></html>'}),montageDefine("c50fb48","runtime/skin",{dependencies:["runtime/dependencies/gl-matrix","runtime/base","runtime/transform","runtime/utilities"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix"),e("runtime/base").Base,e("runtime/transform").Transform,e("runtime/utilities").Utilities,t.Skin=Object.create(Object.prototype,{jointsIds:{value:null,writable:!0},nodesForSkeleton:{value:null,writable:!0},bindShapeMatrix:{value:null,writable:!0},inverseBindMatricesDescription:{value:null,writable:!0},matricesForSkeleton:{value:null,writable:!0},sources:{value:null,writable:!0},init:{value:function(){return this.jointsIds=[],this.nodesForSkeleton={},this.matricesForSkeleton={},this.sources=[],this}},inverseBindMatricesDelegate:{value:{handleError:function(e,t){console.log("ERROR:vertexAttributeBufferDelegate:"+e+" :"+t)},convert:function(e,t){return new Float32Array(e)},resourceAvailable:function(e,t){}}},process:{value:function(e,t){var i=Object.keys(this.nodesForSkeleton),n=mat4.create();mat4.inverse(e.worldTransform,n),i.forEach(function(e){var i=this.nodesForSkeleton[e],r=this.matricesForSkeleton[e];if(!r){var a=16*this.jointsIds.length;r=new Float32Array(a),this.matricesForSkeleton[e]=r;for(var s=mat4.identity(),o=0;o<a;o++)r[o]=s[o%16]}var l=t.getResource(this.inverseBindMatricesDescription,this.inverseBindMatricesDelegate);l&&this.sources.forEach(function(e){for(var t=e,a=this.bindShapeMatrix,s=this.jointsIds.length,o=mat4.create(),u=0;u<s;u++){for(var c=0;c<16;c++)o[c]=l[16*u+c];var h=i[u].worldTransform,d=mat4.identity();mat4.multiply(d,n),mat4.multiply(d,h),mat4.multiply(d,o),mat4.multiply(d,a);for(var c=0;c<16;c++)r[16*u+c]=d[c]}t.primitives.forEach(function(e){e.material.parameters&&(e.material.parameters.jointMat.value=r)},this)},this)},this)}}})}}),montageDefine("22a41ee","ui/cards/countertops.reel/countertops.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Countertops .Card-hero{height:180px;margin-bottom:4px}.Countertops .OptionField:nth-child(4) .digit-RadioButton{background-image:url(assets/static/countertop-paper.jpg)}.Countertops .OptionField:nth-child(3) .digit-RadioButton{background-image:url(assets/static/countertop-bamboo.jpg)}.Countertops .OptionField:nth-child(2) .digit-RadioButton{background-image:url(assets/static/countertop-cement.jpg)}.Countertops .OptionField:nth-child(1) .digit-RadioButton{background-image:url(assets/static/countertop-quartz.jpg)}@media (orientation:landscape) and (max-height:600px){.Countertops .Card-hero{bottom:67px;right:50px;height:80px}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/cards/countertops.reel","properties":{"element":{"#":"Countertops"}}},"hero":{"prototype":"digit/ui/image.reel","properties":{"element":{"#":"hero"},"src":"countertops.jpg"}},"materialField":{"prototype":"ui/option-fields/choice-option-field.reel","properties":{"element":{"#":"materialField"}},"bindings":{"configurationOption":{"<-":"@owner.configurationSet.optionMap.get(\'material\')"}}}}</script></head><body><div data-montage-id=Countertops class="Countertops Card"><section class=Card-content><img data-montage-id=hero class=Card-hero><h1 class=Card-title>Countertop</h1><p class=Card-description>Choose from a set of stylish and sustainable countertops for the hardest working surface in your home.</p></section><section class="Card-content Card--hasOptions Custom--hasSwatches"><div data-montage-id=materialField></div></section></div></body></html>'
}),montageDefine("d3659d0","package.json",{exports:{name:"q-connection",version:"0.5.3",description:"An inter-worker asynchronous promise communication system.",homepage:"http://github.com/kriskowal/q-connection/",author:{name:"Kris Kowal",email:"kris@cixar.com",url:"http://github.com/kriskowal/"},contributors:[{name:"Kris Kowal",email:"kris@cixar.com",url:"http://github.com/kriskowal/"},{name:"Irakli Gozalishvili",email:"rfobic@gmail.com",url:"http://jeditoolkit.com/"}],credits:["Mark Miller <erights@google.com>"],bugs:{url:"http://github.com/kriskowal/q-connection/issues"},licenses:[{type:"MIT",url:"http://github.com/kriskowal/q-connection/raw/master/LICENSE"}],main:"q-connection.js",dependencies:{q:"~0.9.2",collections:"~0.0.0"},devDependencies:{"jasmine-node":"*",cover:"*",opener:"*"},scripts:{test:"jasmine-node spec",cover:"cover run node_modules/jasmine-node/bin/jasmine-node spec && cover report html && opener cover_html/index.html"},repository:{type:"git",url:"git://github.com/kriskowal/q-connection.git"},engines:{node:">=0.2.0",jetpack:">=0.9.0"},_id:"q-connection@0.5.3",dist:{shasum:"a9f9457287e1a4946f4460a32543d066016a046f",tarball:"https://registry.npmjs.org/q-connection/-/q-connection-0.5.3.tgz"},_from:"q-connection@0.5.3",_npmVersion:"1.2.15",_npmUser:{name:"kriskowal",email:"kris.kowal@cixar.com"},maintainers:[{name:"kriskowal",email:"kris.kowal@cixar.com"}],directories:{},_shasum:"a9f9457287e1a4946f4460a32543d066016a046f",_resolved:"https://registry.npmjs.org/q-connection/-/q-connection-0.5.3.tgz",hash:"d3659d0",mappings:{q:{name:"q",hash:"8987d1b",location:"../q@8987d1b/"},collections:{name:"collections",hash:"449c0c3",location:"../collections@449c0c3/"}},production:!0,useScriptInjection:!0}}),montageDefine("b0111a3","ui/base/abstract-checkbox",{dependencies:["./abstract-control","../../composer/press-composer"],factory:function(e,t,i){var n=e("./abstract-control").AbstractControl,r=e("../../composer/press-composer").PressComposer;t.AbstractCheckbox=n.specialize({constructor:{value:function a(){if(this.constructor===a)throw new Error("AbstractCheckbox cannot be instantiated.");this._pressComposer=new r,this.addComposer(this._pressComposer),this.defineBindings({"classList.has('montage--disabled')":{"<-":"!enabled"},"classList.has('montage--active')":{"<-":"active"},"classList.has('montage-Checkbox--checked')":{"<-":"checked"}})}},hasTemplate:{value:!1},active:{value:!1},value:{value:null},_checked:{value:!1},checked:{set:function(e){this._checked=e},get:function(){return this._checked}},enabled:{value:!0},_pressComposer:{value:null},enterDocument:{value:function(e){e&&this.element.setAttribute("role","checkbox")}},draw:{value:function(){this.checked?this.element.setAttribute("aria-checked","true"):this.element.setAttribute("aria-checked","false")}},toggleChecked:{value:function(){this.enabled&&(this.checked=!this.checked,this.dispatchActionEvent())}},handlePressStart:{value:function(e){this.active=!0,e.touch&&document.addEventListener("touchmove",this,!1)}},handlePress:{value:function(){this.active=!1,this.toggleChecked()}},handlePressCancel:{value:function(){this.active=!1,document.removeEventListener("touchmove",this,!1)}},prepareForActivationEvents:{value:function(){this._pressComposer.addEventListener("pressStart",this,!1),this._pressComposer.addEventListener("press",this,!1),this._pressComposer.addEventListener("pressCancel",this,!1)}},activate:{value:function(){this.toggleChecked()}}})}}),montageDefine("c50fb48","runtime/transform-helper",{dependencies:["runtime/dependencies/gl-matrix","runtime/base","runtime/utilities"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix"),e("runtime/base").Base,e("runtime/utilities").Utilities,t.TransformHelper=Object.create(Object.prototype,{_viewMatrix:{value:null,writable:!0},_worldViewMatrix:{value:null,writable:!0},_worldViewInverseTransposeMatrix:{value:null,writable:!0},_dirty:{value:!0,writable:!0},_id:{value:0,writable:!0},transformWillChange:{value:function(e,t,i){this._dirty=!0}},transformDidChange:{value:function(e){}},_node:{value:null,writable:!0},node:{set:function(e){this._node!=e&&(this._node&&this._node.transform.removeObserver(this),this._node=e,this._node&&this._node.transform.addObserver(this),this._dirty=!0)},get:function(){return this._node}},_viewMatrix:{value:null,writable:!0},viewMatrix:{set:function(e){this._viewMatrix=e,this._dirty=!0},get:function(){return this._viewMatrix}},transformDidUpdate:{value:function(e){this._dirty=!0}},updateMatricesIfNeeded:{value:function(){this._dirty&&(mat4.multiply(this._viewMatrix,this._node.worldMatrix,this._worldViewMatrix),mat4.toInverseMat3(this._worldViewMatrix,this._worldViewInverseTransposeMatrix),mat3.transpose(this._worldViewInverseTransposeMatrix),this._dirty=!1)}},worldViewMatrix:{get:function(){return this._dirty&&this.updateMatricesIfNeeded(),this._worldViewMatrix}},worldViewInverseTransposeMatrix:{get:function(){return this._dirty&&this.updateMatricesIfNeeded(),this._worldViewInverseTransposeMatrix}},init:{value:function(){return this._viewMatrix=mat4.identity(),this._worldViewMatrix=mat4.identity(),this._worldViewInverseTransposeMatrix=mat3.identity(),this}}})}}),montageDefine("b0111a3","core/radio-button-controller",{dependencies:["./core","./range-controller","./core","./core"],factory:function(e,t,i){var n=e("./core").Montage,r=e("./range-controller").RangeController;t.RadioButtonController=n.specialize({_radioButtons:{value:null},_content:{value:null},content:{get:function(){return this.getPath("contentController.content")},set:function(e){this.contentController=(new r).initWithContent(e)}},contentController:{value:null},selectedRadioButton:{value:null},_value:{value:null},value:{set:function(e){this._value!==e&&(this._value=e,this._updateRadioButtons())},get:function(){return this._value}},constructor:{value:function(){this._radioButtons=[],this.addRangeAtPathChangeListener("_radioButtons.map{checked}",this,"handleRadioButtonChange"),this.defineBinding("value ",{"<->":"contentController.selection.0"})}},_updateRadioButtons:{value:function(){for(var e=this._value,t=0,i=this._radioButtons.length;t<i;t++)if(e===this._radioButtons[t].value){this._radioButtons[t].checked=!0;break}}},registerRadioButton:{value:function(e){this._radioButtons.indexOf(e)===-1&&(this._radioButtons.push(e),this._updateRadioButtons())}},unregisterRadioButton:{value:function(e){var t=this._radioButtons.indexOf(e);t>=0&&(this._radioButtons.splice(t,1),e===this.selectedRadioButton&&(this.selectedRadioButton=null))}},handleRadioButtonChange:{value:function(e,t,i){if(e[0]===!0)for(var n=0,r=this._radioButtons.length;n<r;n++)n===i?(this.selectedRadioButton=this._radioButtons[n],this.value=this.selectedRadioButton.value):this._radioButtons[n].checked=!1}}},{blueprintModuleId:e("./core")._blueprintModuleIdDescriptor,blueprint:e("./core")._blueprintDescriptor})}}),montageDefine("b0111a3","core/geometry/point",{dependencies:["../core"],factory:function(e,t,i){var n=e("../core").Montage,r=t.Point=n.specialize({init:{enumerable:!1,value:function(e,t){return this.x=null===e?0:e,this.y=null===t?0:t,this}},x:{enumerable:!0,value:0},y:{enumerable:!0,value:0}},{interpolate:{enumerable:!1,value:function(e,i,n,r){var a,s;return a=i.x+(n.x-i.x)*e,s=i.y+(n.y-i.y)*e,r>0&&(a=Math.round(a*r)/r,s=Math.round(s*r)/r),(new t.Point).init(a,s)}}}),a=function(e){var t,i,n,r,a=e.ownerDocument;if(e&&a){if(i=a.documentElement,n=a.body,r=a.defaultView,e!==n){if(t=e.getBoundingClientRect(),i.parentOf(e)){var s=i.clientTop||n.clientTop||0,o=i.clientLeft||n.clientLeft||0,l=r.pageYOffset||i.scrollTop||n.scrollTop,u=r.pageXOffset||i.scrollLeft||n.scrollLeft,c=t.top+l-s,h=t.left+u-o;return{top:c,left:h}}return{top:t.top,left:t.left}}return{top:n.offsetTop,left:n.offsetLeft}}return null},s=null,o=function(){r.convertPointFromNodeToPage=function(e,t){return t?(s.x=t.x,s.y=t.y):(s.x=0,s.y=0),t=webkitConvertPointFromNodeToPage(e,s),t?(new r).init(t.x,t.y):null},r.convertPointFromPageToNode=function(e,t){return t?(s.x=t.x,s.y=t.y):(s.x=0,s.y=0),t=webkitConvertPointFromPageToNode(e,s),t?(new r).init(t.x,t.y):null}},l=function(){r.convertPointFromNodeToPage=function(e,t){if(!e||"undefined"!=typeof e.x)return null;var i;return(i=a(e))?(new r).init((t?t.x:0)+i.left,(t?t.y:0)+i.top):(new r).init(t?t.x:0,t?t.y:0)},r.convertPointFromPageToNode=function(e,t){if(!e||"undefined"!=typeof e.x)return null;var i;return(i=a(e))?(new r).init((t?t.x:0)-i.left,(t?t.y:0)-i.top):(new r).init(t?t.x:0,t?t.y:0)}};"undefined"!=typeof WebKitPoint?(s=new WebKitPoint(0,0),o()):l()}}),montageDefine("c50fb48","runtime/scene",{dependencies:["montage","runtime/component-3d","runtime/runtime-tf-loader","url","runtime/scene-resource-loader","q"],factory:function(e,t,i){var n=(e("montage").Montage,e("runtime/component-3d").Component3D),r=e("runtime/runtime-tf-loader").RuntimeTFLoader,a=e("url"),s=e("runtime/scene-resource-loader").SceneResourceLoader,o=e("q");t.Scene=n.specialize({constructor:{value:function(){this["super"]()}},_resourcesLoaded:{value:!1,writable:!0},sceneResourcesDidPrepare:{value:function(){this._resourcesLoaded||(this._prepareToRenderDefer&&this._prepareToRenderDefer.resolve(),this._resourcesLoaded=!0,this.dispatchEventNamed("resourcesDidLoad",!0,!1,this),this.status="loaded",console.log("resourcesDidLoad"))}},isLoaded:{value:function(){return"loaded"==this.status}},status:{value:0,writable:!0},path:{set:function(t){if(t){if(t.indexOf(".json")===-1)return;var i=a.parse(t);if(!i.scheme){var n=Object.keys(e.packages);t=a.resolve(n[0],t)}}if(t!==this._path){var s={};if(s.loadCompleted=function(e){this.totalBufferSize=o.totalBufferSize,this.glTFElement=e,this.status="loaded",console.log("scene loaded:"+this._path)}.bind(this),t){var o=Object.create(r);this.status="loading",o.initWithPath(t),o.delegate=s,o.load(null,null)}else this.scene=null;this._path=t}},get:function(){return this._path}},_prepareToRenderDefer:{value:null,writable:!0},prepareToRender:{value:function(e){if(null==this._prepareToRenderDefer){this._prepareToRenderDefer=o.defer();var t=Object.create(s).init(this.glTFElement,e,this);t.loadScene()}return this._prepareToRenderDefer.promise}},init:{value:function(){return this.initWithScene(this)}}})}}),montageDefine("22a41ee","ui/option-fields/range-option-field.reel/range-option-field.html",{text:'<!DOCTYPE html><html><head><title></title><style>.RangeOptionField .Card-option-labelArea{padding-left:0}.RangeOptionField-slider{margin-top:12px;margin-bottom:5px;width:100%}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"rangeOptionField"}}},"rangeSlider":{"prototype":"digit/ui/slider.reel","properties":{"element":{"#":"rangeSlider"},"step":10},"bindings":{"min":{"<-":"@owner.configurationOption.minValue"},"max":{"<-":"@owner.configurationOption.maxValue"},"value":{"<->":"@owner.configurationOption.value"}}},"name":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"name"},"value":"Text"},"bindings":{"value":{"<-":"@owner.configurationOption.name"}}},"price":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"price"},"converter":{"@":"currencyConverter"}},"bindings":{"value":{"<-":"@owner.configurationOption.price"}}},"currencyConverter":{"prototype":"montage/core/converter/currency-converter","properties":{"shorten":false,"decimals":0,"showCurrencyBeforeNumber":true}}}</script></head><body><div data-montage-id=rangeOptionField class=RangeOptionField><label class=Card-option--rangeField><div class=Card-option-labelArea><strong class=Card-option-label data-montage-id=name></strong> <span class=Card-option-price data-montage-id=price></span></div><div data-montage-id=rangeSlider class="Custom RangeOptionField-slider"></div></label></div></body></html>'}),montageDefine("22a41ee","ui/eco-score.reel/eco-score.html",{text:'<!DOCTYPE html><html><head><title></title><style>.EcoScore{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.EcoScore-grade{color:#c5e265;font-size:14px;line-height:22px}.EcoScore-bar{padding-top:2px;margin-left:6px}.EcoScore-title{margin:0;height:45px;-moz-box-sizing:border-box;box-sizing:border-box;padding-top:3px;padding-right:6px;font-size:18px;line-height:18px;font-weight:400;text-align:right;text-shadow:0 2px 2px hsla(0,0%,0%,.5);border-right:1px solid hsla(0,0%,100%,.3)}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/eco-score.reel","properties":{"element":{"#":"ecoScore"}},"bindings":{"grade":{"<-":"@owner.gradeLevels.entries().filter{this[1] <= (@owner.ecoSavings - @owner.baseSavings)}.max{this[1]}[0]"}}},"cost-graph":{"prototype":"usdoe/ui/cost-graph.reel","properties":{"element":{"#":"cost-graph"}},"bindings":{"average":{"<-":"@owner.baseSavings"},"consumption":{"<-":"@owner.ecoSavings"},"max":{"<-":"@owner.maxSavings"}}},"grade":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"grade"}},"bindings":{"value":{"<-":"@owner.grade"}}}}</script></head><body><div data-montage-id=ecoScore class=EcoScore><h1 class=EcoScore-title>Eco<br>Score</h1><div class=EcoScore-bar><div data-montage-id=grade class=EcoScore-grade></div><div data-montage-id=cost-graph class=EcoScore-costGraph></div></div></div></body></html>'}),montageDefine("449c0c3","lru-map",{dependencies:["./shim","./lru-set","./generic-collection","./generic-map","./listen/property-changes","./listen/map-changes","lru-map"],factory:function(e,t,i){"use strict";function n(e,t,i,a,s){return this instanceof n?(i=i||Object.equals,a=a||Object.hash,s=s||Function.noop,this.contentEquals=i,this.contentHash=a,this.getDefault=s,this.store=new r((void 0),t,function(e,t){return i(e.key,t.key)},function(e){return a(e.key)}),this.length=0,void this.addEach(e)):new n(e,t,i,a,s)}var r=(e("./shim"),e("./lru-set")),a=e("./generic-collection"),s=e("./generic-map"),o=e("./listen/property-changes"),l=e("./listen/map-changes");i.exports=n,n.LruMap=n,Object.addEach(n.prototype,a.prototype),Object.addEach(n.prototype,s.prototype),Object.addEach(n.prototype,o.prototype),Object.addEach(n.prototype,l.prototype),Object.defineProperty(n.prototype,"size",a._sizePropertyDescriptor),n.from=a.from,n.prototype.constructClone=function(e){return new this.constructor(e,this.maxLength,this.contentEquals,this.contentHash,this.getDefault)},n.prototype.log=function(e,t){t=t||this.stringify,this.store.log(e,t)},n.prototype.stringify=function(e,t){return t+JSON.stringify(e.key)+": "+JSON.stringify(e.value)},n.prototype.addMapChangeListener=function(){if(!this.dispatchesMapChanges){var e=this;this.store.addBeforeRangeChangeListener(function(t,i){t.length&&i.length&&e.dispatchBeforeMapChange(i[0].key,void 0)}),this.store.addRangeChangeListener(function(t,i){t.length&&i.length&&e.dispatchMapChange(i[0].key,void 0)})}l.prototype.addMapChangeListener.apply(this,arguments)}}}),montageDefine("22a41ee","ui/option-fields/boolean-option-field.reel/boolean-option-field.html",{text:'<!DOCTYPE html><html><head><title></title><script type=text/montage-serialization>{"owner":{"prototype":"ui/option-fields/boolean-option-field.reel","properties":{"element":{"#":"BooleanOptionField"},"labelAreaElement":{"#":"labelArea"}}},"chosenCheckbox":{"prototype":"digit/ui/checkbox.reel","properties":{"element":{"#":"chosenCheckbox"},"checked":true},"bindings":{"checked":{"<->":"@owner.configurationOption.chosen"}}},"name":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"name"},"value":"Text"},"bindings":{"value":{"<-":"@owner.configurationOption.name"}}},"price":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"price"},"value":"Text","converter":{"@":"currencyConverter"}},"bindings":{"value":{"<-":"@owner.configurationOption.price"}}},"currencyConverter":{"prototype":"montage/core/converter/currency-converter","properties":{"shorten":false,"decimals":0,"showCurrencyBeforeNumber":true}}}</script></head><body><div data-montage-id=BooleanOptionField class="Card-option--booleanField BooleanOptionField"><input data-montage-id=chosenCheckbox class=Custom type=checkbox><div class=Card-option-labelArea data-montage-id=labelArea><strong class=Card-option-label data-montage-id=name></strong> <span class=Card-option-price data-montage-id=price></span></div></div></body></html>'}),montageDefine("b0111a3","core/gate",{dependencies:["./core","./logger","collections/map"],factory:function(e,t,i){var n=e("./core").Montage,r=e("./logger").logger("gate"),a=e("collections/map");t.Gate=n.specialize({init:{enumerable:!1,value:function(){return this.reset(),this}},initWithDelegate:{enumerable:!1,value:function(e){return this.reset(),this.delegate=e,this}},initWithDescriptor:{enumerable:!1,value:function(e){var t;this.reset();for(t in e)this.setField(t,e[t].value);return this}},count:{value:0},table:{value:null},getField:{enumerable:!1,value:function(e){var t=this.table;return!t||t[e]}},setField:{enumerable:!1,value:function(e,t){var i,n=this.table||(this.table=new a),s=this.count;i=n[e],"undefined"!=typeof i||t?"undefined"!=typeof i&&i!==t?t?this.count--:this.count++:t&&r.isDebug&&r.debug(this,e+" was not set before."):this.count++,n[e]=!!t,0===this.count&&s>0?this.callDelegateMethod(!0):0===s&&this.count>0&&this.callDelegateMethod(!1)}},removeField:{enumerable:!1,value:function(e){var t=this.table,i=t[e];"undefined"==typeof i||i||this.count--,delete t[e]}},delegate:{enumerable:!1,value:null},callDelegateMethod:{value:function(e){var t;this.delegate&&"function"==typeof(t=this.delegate["gateDidBecome"+(e?"True":"False")])&&t.call(this.delegate,this)},enumerable:!1},value:{enumerable:!1,get:function(){return 0===this.count}},reset:{enumerable:!1,value:function(){this.table={},this.count=0}},toString:{value:function(){var e,t,i=this._fields,n="";for(e=0;t=i[e];e++)n+=t+"["+(this._value&i[t])+"], ";return n}}})}}),montageDefine("22a41ee","ui/cards/laundry.reel/laundry.html",{text:'<!DOCTYPE html><html><head><title></title><style>.Laundry .Card-hero{height:182px;margin-bottom:-18px}@media (orientation:landscape) and (max-height:600px){.Laundry .Card-hero{height:100px;bottom:64px;right:61px}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/cards/laundry.reel","properties":{"element":{"#":"laundry"}}},"dryerField":{"prototype":"ui/option-fields/boolean-option-field.reel","properties":{"element":{"#":"dryerField"}},"bindings":{"configurationOption":{"<-":"@owner.configurationSet.optionMap.get(\'dryer\')"}}},"laundryHero":{"prototype":"digit/ui/image.reel","properties":{"element":{"#":"laundryHero"},"src":"laundry.jpg"}},"washerField":{"prototype":"ui/option-fields/boolean-option-field.reel","properties":{"element":{"#":"washerField"}},"bindings":{"configurationOption":{"<-":"@owner.configurationSet.optionMap.get(\'washer\')"}}}}</script></head><body><div data-montage-id=laundry class="Laundry Card"><section class=Card-content><img data-montage-id=laundryHero class=Card-hero><h1 class=Card-title>Laundry</h1><p class=Card-description>Save water, electricity, and the environment with these eco-friendly washing machines and dryers.</p></section><section class="Card-content Card--hasOptions"><div data-montage-id=washerField></div><div data-montage-id=dryerField></div></section></div></body></html>'}),montageDefine("22a41ee","ui/option-fields/choice-option-field.reel/option-field.reel/option-field.html",{text:'<!DOCTYPE html><html><head><title></title><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"optionField"},"labelAreaElement":{"#":"labelArea"}}},"chosenRadioButton":{"prototype":"digit/ui/radio-button.reel","properties":{"element":{"#":"chosenRadioButton"}},"bindings":{"value":{"<-":"@owner.option"},"radioButtonController":{"<-":"@owner.radioButtonController"}}},"name":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"name"},"value":"Text"},"bindings":{"value":{"<-":"@owner.option.name"}}},"price":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"price"},"value":"Text","converter":{"@":"currencyConverter"}},"bindings":{"value":{"<-":"@owner.option.price"}}},"currencyConverter":{"prototype":"montage/core/converter/currency-converter","properties":{"shorten":false,"decimals":0,"showCurrencyBeforeNumber":true}}}</script></head><body><div data-montage-id=optionField class=OptionField><div class=Card-option--choiceField><input data-montage-id=chosenRadioButton class=Custom type=radio><div class=Card-option-labelArea data-montage-id=labelArea><strong class=Card-option-label data-montage-id=name></strong> <span class=Card-option-price data-montage-id=price></span></div></div></div></body></html>'}),montageDefine("22a41ee","ui/cards/solar-panels.reel/solar-panels.html",{text:'<!DOCTYPE html><html><head><title></title><style>.SolarPanels .Card-hero{height:140px}@media (orientation:landscape) and (max-height:600px){.SolarPanels .Card-title{width:140px}.SolarPanels .Card-hero{bottom:80px;right:50px;height:90px}}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/cards/solar-panels.reel","properties":{"element":{"#":"solarPanels"}}},"solarPanelsField":{"prototype":"ui/option-fields/choice-option-field.reel","properties":{"element":{"#":"solarPanelsField"}},"bindings":{"configurationOption":{"<-":"@owner.configurationSet.optionMap.get(\'solar-panel\')"}}},"hero":{"prototype":"digit/ui/image.reel","properties":{"element":{"#":"hero"},"src":"solar-panels.jpg"}},"title":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"title"},"value":"Solar Panels"}}}</script></head><body><div data-montage-id=solarPanels class="SolarPanels Card"><section class=Card-content><div data-montage-id=hero class=Card-hero></div><h1 data-montage-id=title class=Card-title></h1><p class=Card-description>Reduce or eliminate electric costs while maintaining an aesthetic exterior with one of these solar systems.</p></section><section class="Card-content Card--hasOptions"><div data-montage-id=solarPanelsField></div></section></div></body></html>'}),montageDefine("b0111a3","core/document-part",{dependencies:["./core","./logger","./promise","./event/event-manager"],factory:function(e,t,i){var n=e("./core").Montage,r=(e("./logger").logger("document-part"),e("./promise").Promise),a=e("./event/event-manager").defaultEventManager,s=n.specialize({parentDocumentPart:{value:null},template:{value:null},fragment:{value:null},objects:{value:null},childComponents:{value:null},parameters:{value:null},initWithTemplateAndFragment:{value:function(e,t){this.template=e,this.fragment=t,this.objects=null,this.childComponents=[],this.parameters=null}},startActingAsTopComponent:{value:function(){this.fragment&&a.registerEventHandlerForElement(this,this.fragment)}},stopActingAsTopComponent:{value:function(){this.fragment&&a.unregisterEventHandlerForElement(this.fragment)}},addChildComponent:{value:function(e){this.childComponents.indexOf(e)==-1&&this.childComponents.push(e)}},removeChildComponent:{value:function(e){var t=this.childComponents,i=t.indexOf(e);i>-1&&(t.splice(i,1),e._parentComponent=null,e._alternateParentComponent=null)}},_addToDrawList:{value:Function.noop},_componentTreeLoadedDeferred:{value:null},loadComponentTree:{value:function(){if(!this._componentTreeLoadedDeferred){for(var e=[],t=this.childComponents,i=0,n=t.length;i<n;i++)e.push(t[i].loadComponentTree());this._componentTreeLoadedDeferred=r.all(e)}return this._componentTreeLoadedDeferred}}});t.DocumentPart=s}}),montageDefine("22a41ee","ui/static-view.reel/config-preview.reel/config-preview.html",{text:'<!DOCTYPE html><html><head><title></title><style>.ConfigPreview{display:none;position:relative;-moz-box-sizing:border-box;box-sizing:border-box;margin:20px auto;width:150px;height:150px;border-radius:75px;border:4px solid #c5e265;background-repeat:no-repeat;background-position:center;background-size:cover;background-color:#fff;box-shadow:0 2px 10px hsla(0,0%,0%,.3);-webkit-transition:background .3s;transition:background .3s}.StaticView--counters .ConfigPreview[data-montage-id="countertop"],.StaticView--kitchen .ConfigPreview[data-montage-id="kitchen"],.StaticView--staircase .ConfigPreview[data-montage-id="staircase"]{display:block}.ConfigPreview-label{display:block;margin:0;font-weight:400;font-size:16px;line-height:142px;text-align:center;color:#fff;text-shadow:0 2px 2px hsla(0,0%,0%,.4)}</style><script type=text/montage-serialization>{"owner":{"prototype":"ui/static-view.reel/config-preview.reel","properties":{"element":{"#":"configPreview"}}},"label":{"prototype":"montage/ui/text.reel","properties":{"element":{"#":"text"},"value":"Text"},"bindings":{"value":{"<-":"@owner.label"}}}}</script></head><body><div data-montage-id=configPreview class=ConfigPreview><h1 data-montage-id=text class=ConfigPreview-label></h1></div></body></html>'}),montageDefine("c50fb48","runtime/mesh",{dependencies:["runtime/dependencies/gl-matrix","runtime/base","runtime/utilities"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix");var n=e("runtime/base").Base,r=e("runtime/utilities").Utilities;t.Mesh=Object.create(n,{PRIMITIVES:{value:"primitives"},_primitives:{value:null,writable:!0},primitives:{enumerable:!0,get:function(){return this._primitives},set:function(e){this._primitives=e}},step:{value:0,writable:!0},loadedPrimitivesCount:{value:0,writable:!0},loaded:{get:function(){return this.loadedPrimitivesCount===this.primitives.length}},_id:{value:null,writable:!0},id:{enumerable:!0,get:function(){return this._id},set:function(e){this._id=e}},_name:{value:null,writable:!0},name:{enumerable:!0,get:function(){return this._name},set:function(e){this._name=e}},_computeBBOXIfNeeded:{enumerable:!1,value:function(){if(!this._boundingBox&&this.primitives){var e=this.primitives.length;if(e>0){var t=this.primitives[0].boundingBox;if(t){var i;for(i=1;i<e;i++)this.primitives[i].boundingBox&&(t=r.mergeBBox(t,this.primitives[i].boundingBox));this._boundingBox=t}}}}},_boundingBox:{value:null,writable:!0},boundingBox:{enumerable:!0,get:function(){return this._computeBBOXIfNeeded(),this._boundingBox},set:function(e){this._boundingBox=e}},init:{value:function(){return this.__Base_init(),this._primitives=[],this}}})}}),montageDefine("c50fb48","runtime/node-wrapper",{dependencies:["runtime/dependencies/gl-matrix","runtime/utilities","runtime/transform-helper"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix");var n=(e("runtime/utilities").Utilities,e("runtime/transform-helper").TransformHelper);t.NodeWrapper=Object.create(Object.prototype,{_transformHelper:{value:null,writable:!0},node:{get:function(){return this._transformHelper.node}},init:{value:function(e){return this._transformHelper=Object.create(n).init(),this._transformHelper.node=e,this}},viewPointWillChange:{value:function(e,t,i){}},viewPointDidChange:{value:function(){this._transformHelper.viewPoint=this._scenePassRenderer.viewPoint}},viewPointMatrixDidUpdate:{value:function(){this._transformHelper.transformDidUpdate()}},scenePassRenderer:{get:function(){return this._scenePassRenderer},set:function(e){this._scenePassRenderer!=e&&(this._scenePassRenderer&&this._scenePassRenderer.removeObserver(this),this._scenePassRenderer=e,this._transformHelper.viewMatrix=e._viewPointMatrix,this._scenePassRenderer&&this._scenePassRenderer.addObserver(this))}},worldMatrix:{get:function(){return this.node.worldMatrix}},worldViewMatrix:{get:function(){return this._transformHelper.worldViewMatrix}},worldViewInverseTransposeMatrix:{get:function(){return this._transformHelper.worldViewInverseTransposeMatrix}}})}}),montageDefine("c50fb48","runtime/primitive",{dependencies:["runtime/dependencies/gl-matrix","runtime/utilities"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix"),e("runtime/utilities").Utilities,t.Primitive=Object.create(Object.prototype,{_attributesCount:{enumerable:!1,value:0,writable:!0},attributesCount:{enumerable:!1,get:function(){return this._attributesCount}},init:{value:function(){return this.step=0,this.semantics={},this}},_semantics:{enumerable:!1,value:null,writable:!0},semantics:{enumerable:!0,get:function(){return this._semantics},set:function(e){this._semantics=e}},addVertexAttribute:{enumerable:!1,value:function(e){if("POSITION"===e.semantic){var t=null,i=e.attribute;i.min&&i.max&&(t=[i.min,i.max]),this.boundingBox=t}this.semantics[e.semantics]||(this.semantics[e.semantic]=e.attribute,this._attributesCount++)}},_computeBBOXIfNeeded:{enumerable:!1,value:function(){}},_boundingBox:{value:null,writable:!0},boundingBox:{enumerable:!0,get:function(){return this._computeBBOXIfNeeded(),this._boundingBox},set:function(e){this._boundingBox=e}},_indices:{enumerable:!1,value:null,writable:!0},indices:{get:function(){return this._indices},set:function(e){this._indices=e}},_material:{enumerable:!1,value:null,writable:!0},material:{get:function(){return this._material},set:function(e){this._material=e}}})}}),montageDefine("5711b7d","package.json",{exports:{name:"punycode",version:"1.0.0",description:"A robust Punycode converter that fully complies to RFC 3492 and RFC 5891, and works on nearly all JavaScript platforms.",homepage:"http://mths.be/punycode",main:"punycode.js",keywords:["punycode","unicode","idn","url","domain"],licenses:[{type:"MIT",url:"http://mths.be/mit"},{type:"GPL",url:"http://mths.be/gpl"}],author:{name:"Mathias Bynens",email:"mathias@qiwi.be",url:"http://mathiasbynens.be/"},maintainers:[{name:"wizard",email:"wizard@roborooter.com"},{name:"mathias",email:"mathias@qiwi.be"}],bugs:{url:"https://github.com/bestiejs/punycode.js/issues"},repository:{type:"git",url:"git://github.com/bestiejs/punycode.js.git"},engines:["node","rhino"],directories:{doc:"docs",test:"tests"},_npmUser:{name:"mathias",email:"mathias@qiwi.be"},_id:"punycode@1.0.0",dependencies:{},devDependencies:{},_engineSupported:!0,_npmVersion:"1.0.106",_nodeVersion:"v0.6.8",_defaultsLoaded:!0,dist:{shasum:"ce9e6c6e9c1db5827174fceb12ff4938700a1bd3",tarball:"http://registry.npmjs.org/punycode/-/punycode-1.0.0.tgz"},_shasum:"ce9e6c6e9c1db5827174fceb12ff4938700a1bd3",_resolved:"https://registry.npmjs.org/punycode/-/punycode-1.0.0.tgz",_from:"punycode@>=1.0.0 <1.1.0",hash:"5711b7d",mappings:{},production:!0,useScriptInjection:!0}}),montageDefine("41fea9e","ui/cost-graph.reel/cost-graph.html",{text:'<!DOCTYPE html><html><head><title></title><style>.usdoe-CostGraph{position:relative;font-size:0;line-height:0}.usdoe-CostGraph .usdoe-Bar{display:inline-block;height:14px}.usdoe-CostGraph-consumptionBar{width:100px;background-color:hsla(0,0%,60%,.9);border-radius:4px;box-shadow:inset 0 1px 4px hsla(0,0%,0%,.2)}.usdoe-CostGraph-consumptionBar .usdoe-Bar-level{border-radius:inherit;background:hsl(74,65%,65%) -webkit-linear-gradient(top,hsla(0,0%,100%,.06),hsla(0,0%,0%,.06));background:hsl(74,65%,65%) linear-gradient(to bottom,hsla(0,0%,100%,.06),hsla(0,0%,0%,.06));box-shadow:inset 0 1px 1px 1px hsla(0,0%,100%,.3),inset 0 -1px 1px hsla(0,0%,0%,.2);-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0)}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"costGraph"}}},"consumptionCost":{"prototype":"./bar.reel","properties":{"element":{"#":"consumptionCost"},"label":"you"},"bindings":{"maxValue":{"<-":"@owner.max"},"value":{"<-":"@owner.consumption"}}}}</script></head><body><div data-montage-id=costGraph class=usdoe-CostGraph><span class=usdoe-CostGraph-consumptionBar data-montage-id=consumptionCost></span></div></body></html>'}),montageDefine("c50fb48","package.json",{exports:{name:"glTF-webgl-viewer",version:"0.1.0",dependencies:{digit:"^0.4.0",matte:"^0.3.2",montage:"^0.14.15",q:"^1.5.1",url:"0.7.9"},repository:{type:"git",url:"git+https://github.com/fabrobinet/glTF-webgl-viewer.git"},gitHead:"3f04cc780acc7930e9fac3469d21bda3debbf2e1",readmeFilename:"README.md",description:"Montage viewer for [glTF](https://github.com/KhronosGroup/glTF/blob/master/specification/README.md) specification",
bugs:{url:"https://github.com/fabrobinet/glTF-webgl-viewer/issues"},homepage:"https://github.com/fabrobinet/glTF-webgl-viewer#readme",_id:"glTF-webgl-viewer@0.1.0",_shasum:"4382d57b54b7e68f28a903cde132a33fd15734e9",_from:"git+https://github.com/cdebost/glTF-webgl-viewer.git#3f04cc780acc7930e9fac3469d21bda3debbf2e1",_resolved:"git+https://github.com/cdebost/glTF-webgl-viewer.git#3f04cc780acc7930e9fac3469d21bda3debbf2e1",main:"index",hash:"c50fb48",mappings:{digit:{name:"digit",hash:"3ef65ed",location:"../digit@3ef65ed/"},matte:{name:"matte",hash:"d2ccbef",location:"../matte@d2ccbef/"},montage:{name:"montage",hash:"b0111a3",location:"../montage@b0111a3/"},q:{name:"q",hash:"8987d1b",location:"../q@8987d1b/"},url:{name:"url",hash:"d73ac5e",location:"../url@d73ac5e/"}},production:!0,useScriptInjection:!0}}),montageDefine("1407ef0","package.json",{exports:{name:"querystring",id:"querystring",version:"0.1.0",description:"Node's querystring module for all engines.",keywords:["commonjs","query","querystring"],author:{name:"Irakli Gozalishvili",email:"rfobic@gmail.com"},repository:{type:"git",url:"git://github.com/Gozala/querystring.git",web:"https://github.com/Gozala/querystring"},bugs:{url:"http://github.com/Gozala/querystring/issues/"},devDependencies:{test:">=0.4.3"},main:"./querystring.js",engines:{node:">=0.4.x"},scripts:{test:"node tests/test-querystring.js"},_npmUser:{name:"gozala",email:"rfobic@gmail.com"},_id:"querystring@0.1.0",dependencies:{},_engineSupported:!0,_npmVersion:"1.0.101",_nodeVersion:"v0.5.9",_defaultsLoaded:!0,dist:{shasum:"cb76a26cda0a10a94163fcdb3e132827f04b7b10",tarball:"http://registry.npmjs.org/querystring/-/querystring-0.1.0.tgz"},maintainers:[{name:"gozala",email:"rfobic@gmail.com"}],directories:{},_shasum:"cb76a26cda0a10a94163fcdb3e132827f04b7b10",_resolved:"https://registry.npmjs.org/querystring/-/querystring-0.1.0.tgz",_from:"querystring@>=0.1.0 <0.2.0",homepage:"https://github.com/Gozala/querystring#readme",hash:"1407ef0",mappings:{},production:!0,useScriptInjection:!0}}),montageDefine("22a41ee","ui/eco-score.reel/eco-score",{dependencies:["montage/ui/component","usdoe/service/electricity","montage/collections/map"],factory:function(e,t,i){var n=e("montage/ui/component").Component,r=e("usdoe/service/electricity").Electricity,a=e("montage/collections/map"),s=94085;t.EcoScore=n.specialize({constructor:{value:function(){this["super"](),this.defineBindings({baseSavings:{"<-":"(averageConsumption - baseConsumption) * kwhPrice / 100"},ecoSavings:{"<-":"(averageConsumption - ecoConsumption) * kwhPrice / 100"},maxSavings:{"<-":"(maxConsumption - averageConsumption) * kwhPrice / 100"}})}},baseConsumption:{value:6e3},ecoConsumption:{value:5200},maxConsumption:{value:1e4},maxSavings:{value:null},_averageConsumption:{value:null},averageConsumption:{get:function(){return null==this._averageConsumption&&(this._averageConsumption=Math.round(r.getAverageAnnualConsumption(s))),this._averageConsumption}},_kwhPrice:{value:null},kwhPrice:{get:function(){return null==this._kwhPrice&&(this._kwhPrice=r.getKwhPrice(s)),this._kwhPrice}},baseSavings:{value:null},ecoSavings:{value:null},grade:{value:null},gradeLevels:{value:a.from({Average:0,Good:1,Excellent:185,Perfect:369})}})}}),montageDefine("b0111a3","core/target",{dependencies:["./core","./event/event-manager","./event/mutable-event"],factory:function(e,t,i){var n=e("./core").Montage,r=e("./event/event-manager").defaultEventManager,a=e("./event/mutable-event").MutableEvent;t.Target=n.specialize({acceptsActiveTarget:{serializable:!1,value:!1},isActiveTarget:{get:function(){return this===r.activeTarget}},willBecomeActiveTarget:{value:Function.noop},didBecomeActiveTarget:{value:Function.noop},surrendersActiveTarget:{value:function(e){return!0}},nextTarget:{serializable:!1,value:null},dispatchEvent:{value:function(e){var t=e instanceof a?e:a.fromEvent(e);return t.target=this,r.handleEvent(t),!e.defaultPrevented}},dispatchEventNamed:{value:function(e,t,i,n){var s=a.fromType(e,t,i,n);return s.target=this,r.handleEvent(s),!s.defaultPrevented}},addEventListener:{value:function(e,t,i){t&&r.registerEventListener(this,e,t,i)}},removeEventListener:{value:function(e,t,i){t&&r.unregisterEventListener(this,e,t,i)}},loadComposer:{value:function(e){e&&!e._isLoaded&&(e._resolveDefaults(),e.load(),e._isLoaded=!0)}},unloadComposer:{value:function(e){e&&e._isLoaded&&(e.unload(),e._isLoaded=!1)}}})}}),montageDefine("22a41ee","ui/navigation.reel/navigation",{dependencies:["montage/ui/component","montage/composer/press-composer"],factory:function(e,t,i){var n=e("montage/ui/component").Component,r=e("montage/composer/press-composer").PressComposer;t.Navigation=n.specialize({_dismissPressComposer:{value:null},constructor:{value:function(){this["super"](),this._dismissPressComposer=new r}},panelDescriptors:{value:null},currentPanelIndex:{value:null},configuration:{value:null},_isShown:{value:!1},isShown:{get:function(){return this._isShown},set:function(e){e!==this._isShown&&(this._isShown=e,e?this._dismissPressComposer.load():this._dismissPressComposer.unload())}},handlePressStart:{value:function(e){if(this.isShown){var t=e.targetElement,i=this.element;i.contains(t)||(this.isShown=!1),this._dismissPressComposer.cancelPress()}}},handleAction:{value:function(e){this.currentPanelIndex=e.detail.get("index")}},enterDocument:{value:function(e){e&&(this.addComposerForElement(this._dismissPressComposer,this.element.ownerDocument),this._dismissPressComposer.addEventListener("pressStart",this,!1),this.isShown||this._dismissPressComposer.unload())}}})}}),montageDefine("22a41ee","ui/call-back/later.reel/later.html",{text:'<!DOCTYPE html><html><head><title></title><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"Later"}}},"call":{"prototype":"digit/ui/button.reel","properties":{"element":{"#":"call"},"enabled":true,"label":"Call Later"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"callNow":{"prototype":"digit/ui/button.reel","properties":{"element":{"#":"callNow"},"enabled":true,"label":"Call Now"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"number":{"prototype":"digit/ui/text-field.reel","properties":{"element":{"#":"number"},"placeholder":"Text"},"bindings":{"value":{"<->":"@owner.controller.phoneNumber"}}}}</script></head><body><div data-montage-id=Later class=Later><span class=CallBack-label>Phone Number:</span> <input data-montage-id=number class="Custom CallBack-input" type=tel><div data-montage-id=call></div><button data-montage-id=callNow class="Custom Custom--action CallBack-button"></button></div></body></html>'}),montageDefine("d73ac5e","package.json",{exports:{author:{name:"Joyent",url:"http://www.joyent.com"},name:"url",description:"Node.JS url module",keywords:["ender","pakmanager","url"],publishConfig:{registry:"http://registry.npmjs.org"},version:"0.7.9",homepage:"http://nodejs.org/api/url.html",repository:{type:"git",url:"git://github.com/coolaj86/node.git"},main:"./url.js",directories:{lib:"."},engines:{node:">= 0.2.0",ender:">= 0.5.0"},dependencies:{querystring:">=0.1.0 <0.2.0",punycode:">=1.0.0 <1.1.0"},devDependencies:{},_id:"url@0.7.9",dist:{shasum:"1959b1a8b361fc017b59513a7c7fa9827f5e4ed0",tarball:"http://registry.npmjs.org/url/-/url-0.7.9.tgz"},maintainers:[{name:"coolaj86",email:"coolaj86@gmail.com"}],_shasum:"1959b1a8b361fc017b59513a7c7fa9827f5e4ed0",_resolved:"https://registry.npmjs.org/url/-/url-0.7.9.tgz",_from:"url@0.7.9",bugs:{url:"https://github.com/coolaj86/node/issues"},hash:"d73ac5e",mappings:{querystring:{name:"querystring",hash:"1407ef0",location:"../querystring@1407ef0/"},punycode:{name:"punycode",hash:"5711b7d",location:"../punycode@5711b7d/"}},production:!0,useScriptInjection:!0}}),montageDefine("22a41ee","ui/option-fields/choice-option-field.reel/choice-option-field.html",{text:'<!DOCTYPE html><html><head><title></title><script type=text/montage-serialization>{"owner":{"prototype":"ui/option-fields/choice-option-field.reel","properties":{"element":{"#":"choiceOptionField"}}},"repetition":{"prototype":"montage/ui/repetition.reel","properties":{"element":{"#":"repetition"}},"bindings":{"contentController":{"<-":"@owner.configurationOption.options"}}},"radioButtonController":{"prototype":"montage/core/radio-button-controller","bindings":{"contentController":{"<-":"@owner.configurationOption.options"}}},"optionField":{"prototype":"./option-field.reel","properties":{"element":{"#":"optionField"},"radioButtonController":{"@":"radioButtonController"}},"bindings":{"option":{"<-":"@repetition:iteration.object"}}}}</script></head><body><div data-montage-id=choiceOptionField class=ChoiceOptionField><div data-montage-id=repetition><div data-montage-id=optionField></div></div></div></body></html>'}),montageDefine("c50fb48","runtime/node",{dependencies:["montage","runtime/component-3d"],factory:function(e,t,i){var n=(e("montage").Montage,e("runtime/component-3d").Component3D);t.Node=n.specialize({constructor:{value:function(){this["super"](),this.addOwnPropertyChangeListener("hidden",this),this.addOwnPropertyChangeListener("glTFElement",this)}},handleGlTFElementChange:{value:function(){this.handleHiddenChange()}},handleHiddenChange:{value:function(){null!=this.glTFElement&&(this.glTFElement.hidden=this._hidden,this.scene.dispatchEventNamed("materialUpdate",!0,!1,this))}},_hidden:{value:!1,writable:!0},hidden:{set:function(e){this._hidden!=e&&(this._hidden=e)},get:function(){return this._hidden}},_observers:{value:null,writable:!0},addObserver:{value:function(e){null==this._observers&&(this._observers=[]),this._observers.indexOf(e)===-1?this._observers.push(e):console.log("WARNING attempt to add 2 times the same observer in glTFNode")}},removeObserver:{value:function(e){if(this._observers){var t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}}}})}}),montageDefine("c50fb48","runtime/animation-manager",{dependencies:["runtime/dependencies/gl-matrix","runtime/base","runtime/animation"],factory:function(e,t,i){e("runtime/dependencies/gl-matrix");var n=e("runtime/base").Base;e("runtime/animation").Animation,t.AnimationManager=Object.create(n,{_animations:{value:null,writable:!0},animations:{get:function(){return this._animations},set:function(e){this._animations!=e&&(this._animations=e)}},targets:{get:function(){var e=[];return null!=this._animations&&this._animations.forEach(function(t){t.channels.forEach(function(t){e.push(t.target.id)},this)},this),e}},hasAnimation:{value:function(e,t){return null!=this._animations&&(null==t&&(t=this.targets),t.indexOf(e)!==-1)}},nodeHasAnimatedAncestor:{value:function(e){do{if(this.hasAnimation(e.id))return!0;e=e.parent}while(null!=e);return!1}},updateTargetsAtTime:{value:function(e,t){this.animations&&this.animations.forEach(function(i){i.updateTargetsAtTime(e,t)},this)}},init:{value:function(){return this.__Base_init(),this.animations=[],this}}})}}),montageDefine("c50fb48","runtime/builtin-assets",{dependencies:["q","runtime/runtime-tf-loader"],factory:function(e,t,i){var n=e("q"),r=e("runtime/runtime-tf-loader").RuntimeTFLoader;t.BuiltInAssets=Object.create(Object.prototype,{_deferredForName:{value:{},writable:!0},_assetInfos:{value:{},writable:!0},registerBuiltinAssetsIfNeeded:{value:function(){var t=e.location+"assets/picking/picking.json",i=e.location+"assets/gradient/gradient.json";this._assetInfos.pickingTechnique={location:t,options:{ids:["pickingTechnique"]}},this._assetInfos.gradient={location:i}}},assetInfosForName:{value:function(e){return this.registerBuiltinAssetsIfNeeded(),this._assetInfos[e]}},assetWithName:{value:function(e,t){var i=this._deferredForName[e];if(!i){i=n.defer(),this._deferredForName[e]=i;var a={};a.loadCompleted=function(e){i.resolve(e)}.bind(this);var s=Object.create(r),o=this.assetInfosForName(e);o?(s.initWithPath(o.location),s.delegate=a,s.load(null,o.options)):i.reject("ERROR:"+e+" isn't registered as a built-in asset")}return i.promise}}})}}),montageDefine("b0111a3","composer/composer",{dependencies:["../core/target"],factory:function(e,t,i){var n=e("../core/target").Target;t.Composer=n.specialize({_component:{value:null},component:{get:function(){return this._component},set:function(e){this._component=e}},_element:{value:null},element:{get:function(){return this._element},set:function(e){this._element=e}},lazyLoad:{value:!0},_needsFrame:{value:!1},needsFrame:{set:function(e){this._needsFrame!==e&&(this._needsFrame=e,this._component&&e&&this._component.scheduleComposer(this))},get:function(){return this._needsFrame}},frame:{value:Function.noop},_resolveDefaults:{value:function(){this.element||null!=this.element||null==this.component||(this.element=this.component.element)}},_isLoaded:{value:!1},isLoaded:{get:function(){return this._isLoaded}},load:{value:Function.noop},unload:{value:Function.noop},deserializedFromTemplate:{value:function(){this.component&&this.component.addComposer(this)}}},{isCoordinateOutsideRadius:{value:function(e,t,i){return e*e+t*t>i*i}}})}}),montageDefine("1407ef0","querystring",{dependencies:[],factory:function(e,t,i){("undefined"==typeof define?function(n){n(e,t,i)}:define)(function(e,t,i,n){"use strict";var r=t;r.unescape=decodeURIComponent,r.escape=encodeURIComponent;var a=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};r.stringify=r.encode=function(e,t,i,s){switch(t=t||"&",i=i||"=",e=null===e?n:e,typeof e){case"object":return Object.keys(e).map(function(n){return Array.isArray(e[n])?e[n].map(function(e){return r.escape(a(n))+i+r.escape(a(e))}).join(t):r.escape(a(n))+i+r.escape(a(e[n]))}).join(t);default:return s?r.escape(a(s))+i+r.escape(a(e)):""}},r.parse=r.decode=function(e,t,i){t=t||"&",i=i||"=";var n={};return"string"!=typeof e||0===e.length?n:(e.split(t).forEach(function(e){var t=e.split(i),a=r.unescape(t[0],!0),s=r.unescape(t.slice(1).join(i),!0);a in n?Array.isArray(n[a])?n[a].push(s):n[a]=[n[a],s]:n[a]=s}),n)}})}}),montageDefine("41fea9e","ui/cost-graph.reel/bar.reel/bar",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Bar=n.specialize({constructor:{value:function(){this["super"]()}},enterDocument:{value:function(e){e&&("webkitTransform"in this.element.style?this._transform="webkitTransform":"MozTransform"in this.element.style?this._transform="MozTransform":"msTransform"in this.element.style?this._transform="msTransform":this._transform="transform")}},_value:{value:0},value:{set:function(e){e!==this._value&&(this._value=e,this.needsDraw=!0)},get:function(){return this._value}},_maxValue:{value:null},maxValue:{set:function(e){e!==this._maxValue&&(this._maxValue=e,this.needsDraw=!0)},get:function(){return this._maxValue}},label:{value:null},_levelElement:{value:null},draw:{value:function(){var e;e=Math.min(Math.floor(100*this._value/this._maxValue),100),this._levelElement.style[this._transform]="translate3d("+(e-100)+"%, 0, 0)"}}})}}),montageDefine("22a41ee","ui/call-back/now.reel/now.html",{text:'<!DOCTYPE html><html><head><title></title><script type=text/montage-serialization>{"owner":{"prototype":"ui/call-back/now.reel","properties":{"element":{"#":"Now"}}},"call":{"prototype":"digit/ui/button.reel","properties":{"element":{"#":"call"},"enabled":true,"label":"Call Me Now"},"listeners":[{"type":"action","listener":{"@":"owner"}}]},"number":{"prototype":"digit/ui/text-field.reel","properties":{"element":{"#":"number"}},"bindings":{"value":{"<->":"@owner.controller.phoneNumber"}},"listeners":[{"type":"action","listener":{"@":"owner"}}]}}</script></head><body><div data-montage-id=Now class=Now><span class=CallBack-label>Enter Your Phone Number:</span> <input data-montage-id=number class="Custom CallBack-input" type=tel> <button data-montage-id=call class="Custom Custom--action CallBack-button"></button></div></body></html>'}),montageDefine("22a41ee","ui/call-back/calling-now.reel/calling-now.html",{text:'<!DOCTYPE html><html><head><title></title><script type=text/montage-serialization>{"owner":{"prototype":"ui/call-back/calling-now.reel","properties":{"element":{"#":"Calling"}}},"callStatus":{"prototype":"digit/ui/text.reel","properties":{"element":{"#":"callStatus"},"value":"Text"},"bindings":{"value":{"<-":"@owner.controller.callStatus"}}},"cancel":{"prototype":"digit/ui/button.reel","properties":{"element":{"#":"button"},"enabled":true,"label":"Cancel"},"listeners":[{"type":"action","listener":{"@":"owner"}}]}}</script></head><body><div data-montage-id=Calling class=Calling><strong class=CallBack--activity data-montage-id=callStatus></strong><section class=CallBack-controls><button data-montage-id=button class="Custom Custom--cancel CallBack-button"></button></section></div></body></html>'}),montageDefine("c50fb48","runtime/scene-resource-loader",{dependencies:["runtime/resource-loader","runtime/mesh-resource-loader"],factory:function(e,t,i){var n=e("runtime/resource-loader").ResourceLoader,r=e("runtime/mesh-resource-loader").MeshResourceLoader;t.SceneResourceLoader=Object.create(n,{_scene:{value:null,writable:!0},scene:{get:function(){return this._scene},set:function(e){this._scene=e}},meshesDidLoad:{value:function(){this.delegate&&this.delegate.sceneResourcesDidPrepare(this.scene)}},loadScene:{value:function(){var e=this;if(this.scene){var t=this.scene.rootNode,i={},n=[];t.apply(function(e,t,r){return e.meshes&&e.meshes.length&&e.meshes.forEach(function(e){null==i[e.id]&&(n.push(e),i[e.id]=e)},this),null},!0,null);var a=Object.create(r).init(n,e.webGLRenderer,this);a.loadMeshes()}}},init:{value:function(e,t,i){return i&&(this.delegate=i),this.webGLRenderer=t,this.scene=e,t.resourceManager.observers.push(this),this}}})}}),montageDefine("c50fb48","runtime/technique",{dependencies:["runtime/base"],factory:function(e,t,i){var n=e("runtime/base").Base;t.Technique=Object.create(n,{_parameters:{value:null,writable:!0},_passName:{value:null,writable:!0},_passes:{value:null,writable:!0},init:{value:function(){return this.__Base_init(),this.passes={},this}},parameters:{get:function(){return this._parameters},set:function(e){this._parameters=e}},passName:{get:function(){return this._passName},set:function(e){this._passName!=e&&(this._passName=e)}},rootPass:{get:function(){return this._passes[this.passName]}},passesDidChange:{value:function(){var e=Object.keys(this.passes);this.passName=1==e.length?e[0]:null}},passes:{get:function(){return this._passes},set:function(e){this._passes!=e&&(this._passes=e,this.passesDidChange())}},execute:{value:function(e,t,i){e.resetStates(),this.rootPass.execute(e,t,i)}}})}}),montageDefine("b0111a3","ui/slot.reel/slot",{dependencies:["../component"],factory:function(e,t,i){var n=e("../component").Component;t.Slot=n.specialize({hasTemplate:{enumerable:!1,value:!1},delegate:{value:null},_content:{value:null},enterDocument:{value:function(e){e&&this.element.classList.add("montage-Slot")}},content:{get:function(){return this._content},set:function(e){var t,i;e&&"undefined"!=typeof e.needsDraw?(i=this._content,e.element?t=e.element:(t=document.createElement("div"),this.delegate&&"function"==typeof this.delegate.slotElementForComponent&&(t=this.delegate.slotElementForComponent(this,e,t)),e.element=t),this.domContent=t,e.needsDraw=!0):this.domContent=e,this._content=e,this.needsDraw=!0}},contentDidChange:{value:function(){this.delegate&&"function"==typeof this.delegate.slotDidSwitchContent&&this.delegate.slotDidSwitchContent(this)}}})}}),montageDefine("d3659d0","adapt",{dependencies:["q","q/queue"],factory:function(e,t,i){function n(e,t){var i;if(e.postMessage)i=function(i){e.postMessage(i,t)};else{if(!e.send){if(e.get&&e.put)return e;throw new Error("An adaptable message port required")}var n=r.defer();i=n.promise,e.on?n.resolve(e.send):e.addEventListener&&(e.addEventListener("open",function(){n.resolve(e.send)}),e.addEventListener("close",function(){s.close(),n.reject("Connection closed.")}))}var s=a();e.on?e.on("message",function(e){s.put(e)},!1):e.addEventListener?e.addEventListener("message",function(e){s.put(e.data)},!1):e.onmessage=function(e){s.put(e.data)},e.start&&e.start();var o=function(){return e.close&&e.close(),s.close()};return{get:s.get,put:function(t){return r.invoke(i,"call",e,t)},close:o,closed:s.closed}}var r=e("q"),a=e("q/queue");i.exports=n}}),montageDefine("22a41ee","ui/cards/call-back.reel/call-back",{dependencies:["montage/ui/component","../../../core/call-controller"],factory:function(e,t,i){var n=e("montage/ui/component").Component,r=e("../../../core/call-controller").CallController;t.CallBack=n.specialize({constructor:{value:function(){this["super"](),this.callController=new r,this.callController.delegate=this,this.templateObjects={callController:this.callController},this.defineBinding("currentState",{"<-":"_stateChart.currentState.name"}),this.checkAlive()}},checkAlive:{value:function(){this.callController.alive().then(function(){this.currentStep="callNow"}.bind(this)).caught(function(){this.currentStep="unavailable"}.bind(this))}},callControllerStateDidChange:{value:function(e,t){this.currentStep=t}},callController:{value:null},currentStep:{value:"callNow"}})}}),montageDefine("b0111a3","ui/text.reel/text",{dependencies:["../component"],factory:function(e,t,i){var n=e("../component").Component;t.Text=n.specialize({hasTemplate:{value:!1},_value:{value:null},value:{get:function(){return this._value},set:function(e){this._value!==e&&(this._value=e,this.needsDraw=!0)}},converter:{value:null},defaultValue:{value:""},_valueNode:{value:null},_RANGE:{value:document.createRange()},enterDocument:{value:function(e){if(e){var t=this._RANGE;t.selectNodeContents(this.element),t.deleteContents(),this._valueNode=document.createTextNode(""),t.insertNode(this._valueNode),this.element.classList.add("montage-Text")}}},draw:{value:function(){var e="undefined"!=typeof this._value&&null!==this._value?this._value:this.defaultValue;this._valueNode.data=this.converter?this.converter.convert(e):e}}})}}),montageDefine("22a41ee","core/substitution-delay",{dependencies:["montage"],factory:function(e,t,i){var n=e("montage").Montage;t.SubstitutionDelay=n.specialize({constructor:{value:function(){this["super"](),this.switchValue=Object.create(null)}},enabled:{value:!0},excluded:{value:null},delay:{value:2e3},delaySwitchValue:{value:"none"},_getSwitchValuePropertyDescriptor:{value:function(e){var t,i=this.delay,r=this.delaySwitchValue;return t=!!this.enabled&&this.excluded&&this.excluded.indexOf(e)>=0,{configurable:!0,get:function(){var a=this;return t?e:(setTimeout(function(){t||(t=!0,n.dispatchOwnPropertyChange.call(a,e,e))},i),r)}}}},switchValue:{value:null},switchValues:{set:function(e){for(var t=0;t<e.length;t++)Object.defineProperty(this.switchValue,e[t],this._getSwitchValuePropertyDescriptor(e[t]))}}})}}),montageDefine("41fea9e","ui/cost-graph.reel/bar.reel/bar.html",{text:'<!DOCTYPE html><html><head><title></title><style>.usdoe-Bar{position:relative;width:100%;height:15px;overflow:hidden}.usdoe-Bar-level{position:absolute;left:0;top:0;bottom:0;right:0;-webkit-transition:-webkit-transform 400ms;transition:transform 400ms;background-color:#00f;text-align:center}.usdoe-Bar-value{top:-1.2em}.usdoe-Bar-value,.usdoe-Bar-label{display:block;position:absolute;left:0;right:0}.usdoe-Bar-label{bottom:-1.2em}</style><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"Bar"},"_levelElement":{"#":"level"}}}}</script></head><body><div data-montage-id=Bar class=usdoe-Bar>&nbsp;<div class=usdoe-Bar-level data-montage-id=level></div></div></body></html>'}),montageDefine("22a41ee","ui/static-view.reel/config-preview.reel/config-preview",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.ConfigPreview=n.specialize({constructor:{value:function(){this["super"]()}},_className:{value:null},className:{get:function(){return this._className},set:function(e){e!==this._className&&(this._className=e,this.needsDraw=!0)}},_currentConfigurationClassName:{value:null},draw:{value:function(){var e;this._currentConfigurationClassName&&(this.element.classList.remove(this._currentConfigurationClassName),this._currentConfigurationClassName=null),this.className&&(e=this.className,this.element.classList.add(e),this._currentConfigurationClassName=e)}}})}}),montageDefine("c50fb48","runtime/resource-description",{dependencies:[],factory:function(e,t,i){window,!function(e,n){"object"==typeof t?n(i.exports):"function"==typeof define&&define.amd?define([],function(){return n(e)}):n(e)}(this,function(e){var t=Object.create(Object.prototype,{_description:{value:null,writable:!0},_id:{value:null,writable:!0},_type:{value:null,writable:!0},init:{enumerable:!0,value:function(e,t){return this._id=e,this._description=t,this}},description:{enumerable:!0,get:function(){return this._description}},id:{enumerable:!0,get:function(){return this._id},set:function(e){this._id=e}},type:{enumerable:!0,get:function(){return this._type},set:function(e){this._type=e}}});return e&&(e.ResourceDescription=t),t})}}),montageDefine("b0111a3","core/event/action-event-listener",{dependencies:["../core","../core","../core"],factory:function(e,t,i){var n=e("../core").Montage;t.ActionEventListener=n.specialize({handler:{value:null},action:{value:null},initWithHandler_action_:{value:function(e,t){return this.handler=e,this.action=t,this}},handleEvent:{value:function(e){if("function"==typeof this.action){var t=this.handler?this.handler:this;this.action.call(t,e)}else this.handler&&this.action&&this.handler[this.action](e)}},serializeProperties:{value:function(e){e.set("handler",this.handler,"reference"),e.set("action",this.action)}}},{blueprintModuleId:e("../core")._blueprintModuleIdDescriptor,blueprint:e("../core")._blueprintDescriptor})}}),montageDefine("22a41ee","ui/call-back/calling-later.reel/calling-later.html",{text:'<!DOCTYPE html><html><head><title></title><script type=text/montage-serialization>{"owner":{"prototype":"ui/call-back/calling-later.reel","properties":{"element":{"#":"CallingLater"}}},"button1":{"prototype":"digit/ui/button.reel","properties":{"element":{"#":"button"},"enabled":true,"label":"Cancel"},"listeners":[{"type":"action","listener":{"@":"owner"}}]}}</script></head><body><div data-montage-id=CallingLater class=CallingLater><strong class=CallBack--activity>Calling</strong> <button data-montage-id=button class="Custom Custom--cancel CallBack-button"></button></div></body></html>'}),montageDefine("22a41ee","ui/navigation.reel/nav-item.reel/nav-item",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.NavItem=n.specialize({constructor:{value:function(){this["super"]()}},_panelKey:{value:null},panelKey:{get:function(){return this._panelKey},set:function(e){e!==this._panelKey&&(this._panelKey=e,this.needsDraw=!0)}},_currentNavigationClassName:{value:null},draw:{value:function(){var e;this._currentNavigationClassName&&(this.element.classList.remove(this._currentNavigationClassName),this._currentNavigationClassName=null),this.panelKey&&(e="NavItem--"+this.panelKey,this.element.classList.add(e),this._currentNavigationClassName=e)}}})}}),montageDefine("41fea9e","service/electricity",{dependencies:["montage"],factory:function(e,t,i){var n=e("montage").Montage;t.Electricity=n.specialize({constructor:{value:function(){this["super"]()}}},{getAverageAnnualSpending:{value:function(e){return this.getKwhPrice(e)*this._getAnnualConsumption(e)/(100*this._getAnnualConsumers(e))}},getAverageAnnualConsumption:{value:function(e){return this._getAnnualConsumption(e)/this._getAnnualConsumers(e)}},getKwhPrice:{value:function(e){return 14.78}},_getAnnualConsumers:{value:function(e){return 13002980}},_getAnnualConsumption:{value:function(e){return 88472275920}},_getStateByZipCode:{value:function(e){return"California"}}})}}),montageDefine("b0111a3","ui/base/abstract-control",{dependencies:["../component","collections/map"],factory:function(e,t,i){var n=e("../component").Component,r=e("collections/map");t.AbstractControl=n.specialize({dispatchActionEvent:{value:function(){return this.dispatchEvent(this.createActionEvent())}},_detail:{value:null},detail:{get:function(){return null==this._detail&&(this._detail=new r),this._detail}},createActionEvent:{value:function(){var e,t=document.createEvent("CustomEvent");return e=this._detail,t.initCustomEvent("action",!0,!0,e),t}},disabled:{get:function(){return!this.enabled},set:function(e){"boolean"==typeof e&&(this.enabled=!e)}}})}}),montageDefine("22a41ee","ui/option-fields/choice-option-field.reel/option-field.reel/option-field",{dependencies:["montage/ui/component","montage/composer/press-composer"],factory:function(e,t,i){var n=e("montage/ui/component").Component,r=e("montage/composer/press-composer").PressComposer;t.OptionField=n.specialize({constructor:{value:function(){this["super"](),this._pressComposer=new r,this.addComposerForElement(this._pressComposer,this.labelAreaElement),this._pressComposer.addEventListener("press",this,!1)}},_pressComposer:{value:null},handlePress:{value:function(){var e=this.templateObjects.chosenRadioButton;e.checked||(e.checked=!0)}}})}}),montageDefine("22a41ee","ui/option-fields/boolean-option-field.reel/boolean-option-field",{dependencies:["montage/ui/component","montage/composer/press-composer"],factory:function(e,t,i){var n=e("montage/ui/component").Component,r=e("montage/composer/press-composer").PressComposer;t.BooleanOptionField=n.specialize({constructor:{value:function(){this["super"](),this._pressComposer=new r,this.addComposerForElement(this._pressComposer,this.labelAreaElement),this._pressComposer.addEventListener("press",this,!1)}},_pressComposer:{value:null},handlePress:{value:function(){var e=this.templateObjects.chosenCheckbox;e.checked=!e.checked}}})}}),montageDefine("b0111a3","core/converter/converter",{dependencies:["../core","../core","../core"],factory:function(e,t,i){var n=e("../core").Montage,r="[object Number]",a=Object.prototype.toString,s=function(e){return a.call(e)===r};t.isNumber=s;var o=function(e){return e&&"undefined"!=typeof e};t.isDef=o,t.Validator=n.specialize({validate:{value:null}}),t.Converter=n.specialize({allowPartialConversion:{value:!0},convert:{enumerable:!1,value:null},revert:{enumerable:!1,value:null}},{blueprintModuleId:e("../core")._blueprintModuleIdDescriptor,blueprint:e("../core")._blueprintDescriptor})}}),montageDefine("b0111a3","core/converter/currency-converter",{dependencies:["./number-converter"],factory:function(e,t,i){var n=e("./number-converter").NumberConverter;t.CurrencyConverter=n.specialize({currency:{value:"$"},decimals:{value:2},useParensForNegative:{value:!1},showCurrencyBeforeNumber:{value:!1},forceDecimals:{value:!0},convert:{value:function(e){var t=this["super"](e);return e<0&&this.useParensForNegative&&(t="("+t.substring(1,t.length)+")"),t=this.showCurrencyBeforeNumber?this.currency+" "+t:t+" "+this.currency}}})}}),montageDefine("8987d1b","queue",{dependencies:["./q"],factory:function(e,t,i){function n(){var e=r.defer(),t=r.defer();return{put:function(t){var i=r.defer();e.resolve({head:t,tail:i.promise}),e.resolve=i.resolve},get:function(){var i=e.promise.get("head");return e.promise=e.promise.get("tail"),i.fail(function(e){throw t.resolve(e),e})},closed:t.promise,close:function(i){i=i||new Error("Can't get value from closed queue");var n={head:r.reject(i)};return n.tail=n,e.resolve(n),t.promise}}}var r=e("./q");i.exports=n}}),montageDefine("b0111a3","core/shim/string",{dependencies:[],factory:function(e,t,i){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e){return this.length>=e.length&&this.slice(0,e.length)===e},writable:!0,configurable:!0}),String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(e){var t=this.length,i=e.length;return t>=i&&this.indexOf(e,t-i)!==-1},writable:!0,configurable:!0})}}),montageDefine("c50fb48","runtime/resource-loader",{
dependencies:[],factory:function(e,t,i){t.ResourceLoader=Object.create(Object.prototype,{webGLRenderer:{value:null,writable:!0},delegate:{value:null,writable:!0},_trackedIds:{value:null,writable:!0},_addTrackedId:{value:function(e){null==this._trackedIds&&(this._trackedIds={}),this._trackedIds[e]=!0}},_removeTrackedId:{value:function(e){null==this._trackedIds[e]||delete this._trackedIds[e]}}})}}),montageDefine("22a41ee","ui/call-back/now.reel/now",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Now=n.specialize({constructor:{value:function(){this["super"]()}},enterDocument:{value:function(){}},exitDocument:{value:function(){}},controller:{value:null},handleAction:{value:function(){this.controller.call()}},handleCallLaterAction:{value:function(){this.controller.later()}}})}}),montageDefine("c50fb48","ui/view.reel/view.html",{text:'<!DOCTYPE html><html><head><title></title><script type=text/montage-serialization>{"owner":{"prototype":"ui/view.reel","properties":{"element":{"#":"component"}}},"canvas":{"value":{"#":"canvas"}}}</script></head><body><div data-montage-id=component class=ColladaView><canvas data-montage-id=canvas></canvas></div></body></html>'}),montageDefine("22a41ee","ui/call-back/later.reel/later",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Later=n.specialize({constructor:{value:function(){this["super"]()}},handleCallAction:{value:function(){this.controller.call()}},handleCallNowAction:{value:function(){this.controller.now()}},controller:{value:null}})}}),montageDefine("41fea9e","package.json",{exports:{name:"usdoe",version:"0.1.0","private":!0,dependencies:{montage:"~0.13.2",digit:"~0.3.1"},main:"index",hash:"41fea9e",mappings:{montage:{name:"montage",hash:"b0111a3",location:"../montage@b0111a3/"},digit:{name:"digit",hash:"3ef65ed",location:"../digit@3ef65ed/"}},production:!0,useScriptInjection:!0}}),montageDefine("7f00df0","package.json",{exports:{name:"den",version:"0.1.0","private":!0,dependencies:{montage:"~0.13.2",digit:"~0.3.1"},main:"index",hash:"7f00df0",mappings:{montage:{name:"montage",hash:"b0111a3",location:"../montage@b0111a3/"},digit:{name:"digit",hash:"3ef65ed",location:"../digit@3ef65ed/"}},production:!0,useScriptInjection:!0}}),montageDefine("22a41ee","ui/call-back/calling-later.reel/calling-later",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.CallingLater=n.specialize({constructor:{value:function(){this["super"]()}},controller:{value:null},handleCancelAction:{value:function(){this.controller.cancel()}}})}}),montageDefine("22a41ee","ui/call-back/calling-now.reel/calling-now",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.CallingNow=n.specialize({constructor:{value:function(){this["super"]()}},controller:{value:null},handleCancelAction:{value:function(){this.controller.cancel()}}})}}),montageDefine("c50fb48","runtime/camera",{dependencies:["runtime/base"],factory:function(e,t,i){var n=e("runtime/base").Base;t.Camera=Object.create(n,{_projection:{value:null,writable:!0},projection:{get:function(){return this._projection},set:function(e){this._projection=e}},init:{value:function(){return this.__Base_init(),this}}})}}),montageDefine("22a41ee","ui/navigation.reel/nav-item.reel/nav-item.html",{text:'<!DOCTYPE html><html><head><title></title><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"navItem"}}}}</script></head><body><div data-montage-id=navItem class=NavItem><div data-param=*></div></div></body></html>'}),montageDefine("3ef65ed","ui/radio-button.reel/radio-button",{dependencies:["montage/ui/base/abstract-radio-button"],factory:function(e,t,i){var n=e("montage/ui/base/abstract-radio-button").AbstractRadioButton;CLASS_PREFIX="digit-RadioButton",t.RadioButton=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("3ef65ed","ui/button.reel/button",{dependencies:["montage/ui/base/abstract-button"],factory:function(e,t,i){var n=e("montage/ui/base/abstract-button").AbstractButton;t.Button=n.specialize({hasTemplate:{value:!0},constructor:{value:function(){this["super"](),this.classList.add("digit-Button")}}})}}),montageDefine("3ef65ed","ui/text.reel/text.html",{text:'<!DOCTYPE html><html><head><title></title><style>[data-montage-skin="light"] .digit-Text{color:hsl(0,0%,40%);text-shadow:0 1px 0 hsla(0,0%,100%,.8)}[data-montage-skin="dark"] .digit-Text{color:hsl(0,0%,80%)}</style></head><body></body></html>'}),montageDefine("41fea9e","ui/cost-graph.reel/cost-graph",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.CostGraph=n.specialize({constructor:{value:function(){this["super"]()}},max:{value:null},average:{value:null},consumption:{value:null}})}}),montageDefine("c50fb48","runtime/base",{dependencies:[],factory:function(e,t,i){t.Base=Object.create(Object.prototype,{_properties:{value:null,writable:!0},properties:{get:function(){return this._properties},set:function(e){this._properties=e}},__Base_init:{value:function(){this._properties={}}}})}}),montageDefine("3ef65ed","ui/text-field.reel/text-field",{dependencies:["montage/ui/base/abstract-text-field"],factory:function(e,t,i){var n=e("montage/ui/base/abstract-text-field").AbstractTextField;t.TextField=n.specialize({hasTemplate:{value:!0},constructor:{value:function(){this["super"]()}}})}}),montageDefine("3ef65ed","ui/image.reel/image.html",{text:'<!DOCTYPE html><html><head><title></title><script type=text/montage-serialization>{"owner":{"properties":{"element":{"#":"image"}}}}</script></head><body><img data-montage-id=image class=digit-Image></body></html>'}),montageDefine("22a41ee","ui/option-fields/choice-option-field.reel/choice-option-field",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.ChoiceOptionField=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("22a41ee","ui/option-fields/range-option-field.reel/range-option-field",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.RangeOptionField=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("22a41ee","ui/cards/staircase.reel/staircase",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Staircase=n.specialize({constructor:{value:function(){this["super"]()}},configurationSet:{value:null}})}}),montageDefine("3ef65ed","ui/text.reel/text",{dependencies:["montage/ui/text.reel"],factory:function(e,t,i){var n=e("montage/ui/text.reel").Text;t.Text=n.specialize({hasTemplate:{value:!0},constructor:{value:function(){this["super"](),this.classList.add("digit-Text")}}})}}),montageDefine("3ef65ed","ui/checkbox.reel/checkbox",{dependencies:["montage/ui/base/abstract-checkbox"],factory:function(e,t,i){var n=e("montage/ui/base/abstract-checkbox").AbstractCheckbox;t.Checkbox=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("22a41ee","ui/overview.reel/overview",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Overview=n.specialize({configuration:{value:null},constructor:{value:function(){this["super"]()}}})}}),montageDefine("3ef65ed","ui/slider.reel/slider",{dependencies:["montage/ui/base/abstract-slider"],factory:function(e,t,i){var n=e("montage/ui/base/abstract-slider").AbstractSlider;t.Slider=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("22a41ee","ui/cards/introduction.reel/introduction",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Introduction=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("22a41ee","ui/cards/solar-panels.reel/solar-panels",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.SolarPanels=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("22a41ee","ui/cards/countertops.reel/countertops",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Countertops=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("22a41ee","ui/cards/thermostat.reel/thermostat",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Thermostat=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("22a41ee","ui/cards/laundry.reel/laundry",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Laundry=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("22a41ee","ui/cards/kitchen.reel/kitchen",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Kitchen=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("d3659d0","lib/uuid",{dependencies:[],factory:function(e,t,i){function n(){return r(8)+"-"+r(4)+"-4"+r(3)+"-"+r(8)+r(4)}function r(e){return(Math.random().toString(16)+"00000000").slice(2,2+e).toUpperCase()}t.generate=n}}),montageDefine("22a41ee","ui/cards/window.reel/window",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Window=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("22a41ee","ui/summary.reel/summary",{dependencies:["montage/ui/component"],factory:function(e,t,i){var n=e("montage/ui/component").Component;t.Summary=n.specialize({constructor:{value:function(){this["super"]()}}})}}),montageDefine("3ef65ed","ui/image.reel/image",{dependencies:["montage/ui/base/abstract-image"],factory:function(e,t,i){var n=e("montage/ui/base/abstract-image").AbstractImage;t.Image=n.specialize({})}}),montageDefine("b0111a3","core/dom",{dependencies:["./extras/dom"],factory:function(e,t,i){e("./extras/dom")}});
bundleLoaded("run-tests.html.bundle-1-0.js")